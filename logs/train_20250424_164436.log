2025-04-24 16:44:42,271	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=2902585)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=2902585)[0m                                                              'optimizer',
[36m(TaskRunner pid=2902585)[0m                                                              'extra']},
[36m(TaskRunner pid=2902585)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2902585)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2902585)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2902585)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2902585)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2902585)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2902585)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2902585)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2902585)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2902585)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2902585)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2902585)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2902585)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2902585)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=2902585)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2902585)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2902585)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=2902585)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2902585)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2902585)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2902585)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2902585)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2902585)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m                                  'ppo_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=2902585)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2902585)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2902585)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2902585)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2902585)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2902585)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2902585)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2902585)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2902585)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2902585)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2902585)[0m                                  'override_config': {},
[36m(TaskRunner pid=2902585)[0m                                  'path': '/home/wangyc/.cache/modelscope/hub/models/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=2902585)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2902585)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=2902585)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=2902585)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2902585)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2902585)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=2902585)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2902585)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2902585)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=2902585)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=2902585)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2902585)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2902585)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2902585)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2902585)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=2902585)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2902585)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=2902585)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2902585)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2902585)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2902585)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=2902585)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2902585)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2902585)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2902585)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2902585)[0m                                    'n': 6,
[36m(TaskRunner pid=2902585)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2902585)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2902585)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=2902585)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2902585)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=2902585)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2902585)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2902585)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=2902585)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2902585)[0m                                                   'n': 1,
[36m(TaskRunner pid=2902585)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2902585)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2902585)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2902585)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=2902585)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2902585)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=2902585)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2902585)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2902585)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2902585)[0m WARNING:2025-04-24 16:44:52,973:Waiting for register center actor vaHdQU_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2911751)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2911751)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(TaskRunner pid=2902585)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2902585)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2902585)[0m                'lam': 1.0,
[36m(TaskRunner pid=2902585)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2902585)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=2902585)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2902585)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2902585)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2902585)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2902585)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2902585)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2902585)[0m                       'external_lib': None,
[36m(TaskRunner pid=2902585)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2902585)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2902585)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2902585)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2902585)[0m                       'override_config': {},
[36m(TaskRunner pid=2902585)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2902585)[0m                       'tokenizer_path': '/home/wangyc/.cache/modelscope/hub/models/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=2902585)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=2902585)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=2902585)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2902585)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2902585)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2902585)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2902585)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2902585)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2902585)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2902585)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2902585)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2902585)[0m             'rollout_n': 6,
[36m(TaskRunner pid=2902585)[0m             'shuffle': False,
[36m(TaskRunner pid=2902585)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2902585)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2902585)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2902585)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2902585)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2902585)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=2902585)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2902585)[0m           'image_key': 'images',
[36m(TaskRunner pid=2902585)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2902585)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=2902585)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2902585)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2902585)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2902585)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2902585)[0m           'shuffle': True,
[36m(TaskRunner pid=2902585)[0m           'tokenizer': None,
[36m(TaskRunner pid=2902585)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=2902585)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=2902585)[0m           'truncation': 'error',
[36m(TaskRunner pid=2902585)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=2902585)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=2902585)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2902585)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=2902585)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2902585)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2902585)[0m                   'max_length': None,
[36m(TaskRunner pid=2902585)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2902585)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2902585)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2902585)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2902585)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2902585)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2902585)[0m                             'input_tokenizer': '/home/wangyc/.cache/modelscope/hub/models/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=2902585)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2902585)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=2902585)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2902585)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2902585)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2902585)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2902585)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2902585)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2902585)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2902585)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=2902585)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2902585)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=2902585)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2902585)[0m              'logger': ['console'],
[36m(TaskRunner pid=2902585)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2902585)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2902585)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2902585)[0m              'nnodes': 1,
[36m(TaskRunner pid=2902585)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=2902585)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2902585)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2902585)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2902585)[0m              'save_freq': 50,
[36m(TaskRunner pid=2902585)[0m              'test_freq': 10,
[36m(TaskRunner pid=2902585)[0m              'total_epochs': 2,
[36m(TaskRunner pid=2902585)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2902585)[0m              'val_before_train': True}}
[36m(TaskRunner pid=2902585)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=2902585)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2902585)[0m dataset len: 8448
[36m(TaskRunner pid=2902585)[0m dataset len: 2113
[36m(TaskRunner pid=2902585)[0m Size of train dataloader: 66
[36m(TaskRunner pid=2902585)[0m Total training steps: 132
[36m(WorkerDict pid=2911751)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 64.98it/s]
[36m(WorkerDict pid=2905626)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 53.30it/s]
[36m(WorkerDict pid=2911746)[0m [rank4]:[W424 16:45:08.859765335 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 4]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=2911744)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2905626)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2911741)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 60.94it/s][32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=2911750)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 66.08it/s]
[36m(WorkerDict pid=2911740)[0m [rank1]:[W424 16:45:08.048897815 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.49s/it]
[36m(WorkerDict pid=2911740)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911740)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.44s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.33s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.37s/it]
[36m(WorkerDict pid=2911744)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2911744)[0m   warnings.warn(
[36m(WorkerDict pid=2911751)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.84s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911751)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.75s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.79s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2905626)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2905626)[0m   "architectures": [
[36m(WorkerDict pid=2905626)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2905626)[0m   ],
[36m(WorkerDict pid=2905626)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2905626)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2905626)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2905626)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=2905626)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2905626)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=2905626)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2905626)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=2905626)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2905626)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=2905626)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=2905626)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=2905626)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2905626)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2905626)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2905626)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2905626)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=2905626)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=2905626)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2905626)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=2905626)[0m   "use_cache": true,
[36m(WorkerDict pid=2905626)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2905626)[0m   "vocab_size": 152064
[36m(WorkerDict pid=2905626)[0m }
[36m(WorkerDict pid=2905626)[0m 
[36m(WorkerDict pid=2911746)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2905626)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2905626)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=2905626)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eeeb9bfa8c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eeeb9bfa7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2905626)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2911750)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2911741)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f0062e268c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f0062e267a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2905626)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2905626)[0m   "architectures": [
[36m(WorkerDict pid=2905626)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2905626)[0m   ],
[36m(WorkerDict pid=2905626)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2905626)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2905626)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2905626)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=2905626)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2905626)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=2905626)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2905626)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=2905626)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2905626)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=2905626)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=2905626)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=2905626)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2905626)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2905626)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2905626)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2905626)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=2905626)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=2905626)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2905626)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=2905626)[0m   "use_cache": true,
[36m(WorkerDict pid=2905626)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2905626)[0m   "vocab_size": 152064
[36m(WorkerDict pid=2905626)[0m }
[36m(WorkerDict pid=2905626)[0m 
[36m(WorkerDict pid=2911741)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2911746)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2905626)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=2905626)[0m wrap_policy: functools.partial(<function _or_policy at 0x7eeeb9bfa8c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7eeeb9bfa7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2911746)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=2911746)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2911751)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2911741)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f0062e268c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f0062e267a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911744)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2905626)[0m Before building vllm rollout, memory allocated (GB): 3.5471720695495605, memory reserved (GB): 19.66015625
[36m(WorkerDict pid=2911744)[0m WARNING 04-24 16:45:42 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2905626)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2905626)[0m Actor use_remove_padding=True[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2911744)[0m WARNING 04-24 16:45:42 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7faf54197460>
[36m(WorkerDict pid=2911746)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2911744)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2905626)[0m WARNING 04-24 16:45:43 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2905626)[0m WARNING 04-24 16:45:44 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7eedbc433b20>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911741)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=2905626)[0m After building vllm rollout, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(WorkerDict pid=2905626)[0m After building sharding manager, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(TaskRunner pid=2902585)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=2902585)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=2911750)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911750)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2902585)[0m Training Progress:   1%|          | 1/132 [01:19<2:54:33, 79.95s/it]
[36m(TaskRunner pid=2902585)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2902585)[0m Training from scratch
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=2911750)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æœ¬é¢˜è€ƒæŸ¥å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†éƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¹™çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚å› æ­¤ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> é€‰é¡¹Bã€Cã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚{BCD}
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 1.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 0.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m ("Initial validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2902585)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': "
[36m(TaskRunner pid=2902585)[0m  "np.float64(0.9557501183151916), 'val-aux/jec-qa-1-multi-choice/score/std@1': "
[36m(TaskRunner pid=2902585)[0m  "np.float64(0.0), 'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(0.9557501183151917), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(9.470785621802389e-17), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(0.9557501183151917), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(9.470785621802389e-17), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(TaskRunner pid=2902585)[0m step:0 - val-core/jec-qa-1-multi-choice/reward/mean@1:0.956 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:0.956 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.956 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:1 - global_seqlen/min:57077.000 - global_seqlen/max:61927.000 - global_seqlen/minmax_diff:4850.000 - global_seqlen/balanced_min:59187.000 - global_seqlen/balanced_max:59188.000 - global_seqlen/mean:59187.375 - actor/entropy_loss:1.193 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.048 - perf/mfu/actor:0.408 - perf/max_memory_allocated_gb:42.564 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:43.257 - actor/lr:0.000 - critic/score/mean:0.861 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.861 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:312.270 - response_length/max:834.000 - response_length/min:103.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.297 - timing_s/old_log_prob:6.521 - timing_s/ref:11.003 - timing_s/adv:0.343 - timing_s/update_actor:37.292 - timing_s/step:79.484 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.023 - perf/total_num_tokens:473499.000 - perf/time_per_step:79.484 - perf/throughput:744.645
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:   2%|â–         | 2/132 [02:35<2:47:15, 77.19s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   2%|â–         | 3/132 [03:53<2:46:40, 77.52s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   3%|â–         | 4/132 [05:10<2:44:57, 77.33s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   4%|â–         | 5/132 [06:23<2:40:39, 75.90s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   5%|â–         | 6/132 [07:37<2:38:00, 75.24s/it]
[36m(TaskRunner pid=2902585)[0m step:2 - global_seqlen/min:57249.000 - global_seqlen/max:63404.000 - global_seqlen/minmax_diff:6155.000 - global_seqlen/balanced_min:59924.000 - global_seqlen/balanced_max:59924.000 - global_seqlen/mean:59924.000 - actor/entropy_loss:1.211 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.801 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:43.524 - actor/lr:0.000 - critic/score/mean:0.872 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.872 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:319.029 - response_length/max:721.000 - response_length/min:119.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.707 - timing_s/old_log_prob:6.438 - timing_s/ref:6.598 - timing_s/adv:0.332 - timing_s/update_actor:38.154 - timing_s/step:75.247 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:479392.000 - perf/time_per_step:75.247 - perf/throughput:796.359
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:3 - global_seqlen/min:57434.000 - global_seqlen/max:60811.000 - global_seqlen/minmax_diff:3377.000 - global_seqlen/balanced_min:58791.000 - global_seqlen/balanced_max:58792.000 - global_seqlen/mean:58791.125 - actor/entropy_loss:1.143 - actor/kl_loss:0.003 - actor/kl_coef:0.001 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.831 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:43.430 - actor/lr:0.000 - critic/score/mean:1.071 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.071 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:309.993 - response_length/max:895.000 - response_length/min:111.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.856 - timing_s/old_log_prob:6.445 - timing_s/ref:6.594 - timing_s/adv:0.328 - timing_s/update_actor:38.650 - timing_s/step:77.890 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:470329.000 - perf/time_per_step:77.890 - perf/throughput:754.793
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:4 - global_seqlen/min:55880.000 - global_seqlen/max:60596.000 - global_seqlen/minmax_diff:4716.000 - global_seqlen/balanced_min:59073.000 - global_seqlen/balanced_max:59073.000 - global_seqlen/mean:59073.000 - actor/entropy_loss:1.178 - actor/kl_loss:0.008 - actor/kl_coef:0.001 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.765 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:43.609 - actor/lr:0.000 - critic/score/mean:1.287 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.287 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:309.711 - response_length/max:837.000 - response_length/min:101.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.633 - prompt_length/max:513.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.967 - timing_s/old_log_prob:6.522 - timing_s/ref:6.642 - timing_s/adv:0.333 - timing_s/update_actor:38.521 - timing_s/step:77.009 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:472584.000 - perf/time_per_step:77.009 - perf/throughput:767.088
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:5 - global_seqlen/min:55572.000 - global_seqlen/max:63130.000 - global_seqlen/minmax_diff:7558.000 - global_seqlen/balanced_min:58868.000 - global_seqlen/balanced_max:58869.000 - global_seqlen/mean:58868.375 - actor/entropy_loss:1.097 - actor/kl_loss:0.013 - actor/kl_coef:0.001 - actor/pg_loss:-0.140 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.706 - perf/mfu/actor:0.412 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.617 - actor/lr:0.000 - critic/score/mean:1.375 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.375 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.022 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:305.048 - response_length/max:705.000 - response_length/min:118.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.164 - prompt_length/max:499.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.135 - timing_s/old_log_prob:6.490 - timing_s/ref:6.654 - timing_s/adv:0.326 - timing_s/update_actor:36.729 - timing_s/step:73.354 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:470947.000 - perf/time_per_step:73.354 - perf/throughput:802.526
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:6 - global_seqlen/min:56754.000 - global_seqlen/max:60477.000 - global_seqlen/minmax_diff:3723.000 - global_seqlen/balanced_min:58684.000 - global_seqlen/balanced_max:58685.000 - global_seqlen/mean:58684.750 - actor/entropy_loss:1.101 - actor/kl_loss:0.009 - actor/kl_coef:0.001 - actor/pg_loss:0.137 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.689 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.721 - actor/lr:0.000 - critic/score/mean:1.409 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.409 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:298.987 - response_length/max:667.000 - response_length/min:127.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.312 - prompt_length/max:547.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.355 - timing_s/old_log_prob:6.423 - timing_s/ref:6.526 - timing_s/adv:0.324 - timing_s/update_actor:38.287 - timing_s/step:73.937 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:469478.000 - perf/time_per_step:73.937 - perf/throughput:793.717
[36m(TaskRunner pid=2902585)[0m Training Progress:   5%|â–Œ         | 7/132 [08:51<2:35:36, 74.69s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   6%|â–Œ         | 8/132 [10:09<2:36:35, 75.77s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   7%|â–‹         | 9/132 [11:22<2:33:48, 75.03s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:7 - global_seqlen/min:57060.000 - global_seqlen/max:61911.000 - global_seqlen/minmax_diff:4851.000 - global_seqlen/balanced_min:58978.000 - global_seqlen/balanced_max:58978.000 - global_seqlen/mean:58978.000 - actor/entropy_loss:1.105 - actor/kl_loss:0.017 - actor/kl_coef:0.001 - actor/pg_loss:-0.066 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.702 - perf/mfu/actor:0.402 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.681 - actor/lr:0.000 - critic/score/mean:1.383 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.383 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:304.385 - response_length/max:686.000 - response_length/min:106.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.969 - prompt_length/max:505.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.521 - timing_s/old_log_prob:6.417 - timing_s/ref:6.538 - timing_s/adv:0.325 - timing_s/update_actor:37.711 - timing_s/step:73.531 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:471824.000 - perf/time_per_step:73.531 - perf/throughput:802.081
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:8 - global_seqlen/min:55802.000 - global_seqlen/max:59256.000 - global_seqlen/minmax_diff:3454.000 - global_seqlen/balanced_min:57070.000 - global_seqlen/balanced_max:57258.000 - global_seqlen/mean:57094.125 - actor/entropy_loss:1.041 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:0.045 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.697 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.706 - actor/lr:0.000 - critic/score/mean:1.393 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.393 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:294.090 - response_length/max:1024.000 - response_length/min:101.000 - response_length/clip_ratio:0.001 - prompt_length/mean:300.641 - prompt_length/max:446.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.266 - timing_s/old_log_prob:6.144 - timing_s/ref:6.359 - timing_s/adv:0.311 - timing_s/update_actor:37.952 - timing_s/step:78.056 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:456753.000 - perf/time_per_step:78.056 - perf/throughput:731.447
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:9 - global_seqlen/min:56608.000 - global_seqlen/max:61343.000 - global_seqlen/minmax_diff:4735.000 - global_seqlen/balanced_min:59161.000 - global_seqlen/balanced_max:59162.000 - global_seqlen/mean:59161.250 - actor/entropy_loss:1.031 - actor/kl_loss:0.024 - actor/kl_coef:0.001 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.728 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.718 - actor/lr:0.000 - critic/score/mean:1.423 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.423 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:300.911 - response_length/max:633.000 - response_length/min:93.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.352 - prompt_length/max:514.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.157 - timing_s/old_log_prob:6.400 - timing_s/ref:6.526 - timing_s/adv:0.325 - timing_s/update_actor:37.911 - timing_s/step:73.343 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:473290.000 - perf/time_per_step:73.343 - perf/throughput:806.642
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> è¯¥é¢˜æ¶‰åŠå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œéœ€è¦åˆ†æç”²ä¹™äºŒäººçš„è¡Œä¸ºå’Œæ•…æ„æ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aï¼šç”²ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½æ¶‰åŠå›½å®¶ç§˜å¯†çš„çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Aé€‰é¡¹é”™è¯¯ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bï¼šç”²ä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½å‚ä¸äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Bé€‰é¡¹æ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m Training Progress:   8%|â–Š         | 10/132 [14:51<3:56:49, 116.47s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   8%|â–Š         | 11/132 [16:05<3:28:35, 103.43s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:   9%|â–‰         | 12/132 [17:17<3:07:42, 93.86s/it] 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cï¼šç”²çš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œè¿™ç§è¡Œä¸ºæ„æˆâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€ã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€è®ºå¤„ã€‚æ‰€ä»¥Cé€‰é¡¹æ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dï¼šä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œè¿™ç§è¡Œä¸ºæ„æˆâ€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€ã€‚å› æ­¤ï¼Œå¯¹ä¹™åº”ä»¥â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€è®ºå¤„ã€‚æ‰€ä»¥Dé€‰é¡¹æ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:10 - global_seqlen/min:56967.000 - global_seqlen/max:66803.000 - global_seqlen/minmax_diff:9836.000 - global_seqlen/balanced_min:59408.000 - global_seqlen/balanced_max:59409.000 - global_seqlen/mean:59408.500 - actor/entropy_loss:1.042 - actor/kl_loss:0.025 - actor/kl_coef:0.001 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.683 - perf/mfu/actor:0.402 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.660 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.429 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.429 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.429 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.348 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.348 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:299.198 - response_length/max:708.000 - response_length/min:102.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.641 - prompt_length/max:640.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.711 - timing_s/old_log_prob:6.455 - timing_s/ref:6.614 - timing_s/adv:0.320 - timing_s/update_actor:37.944 - timing_s/testing:134.196 - timing_s/step:209.261 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:475268.000 - perf/time_per_step:209.261 - perf/throughput:283.896
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:11 - global_seqlen/min:55505.000 - global_seqlen/max:64706.000 - global_seqlen/minmax_diff:9201.000 - global_seqlen/balanced_min:58851.000 - global_seqlen/balanced_max:58852.000 - global_seqlen/mean:58851.750 - actor/entropy_loss:0.988 - actor/kl_loss:0.025 - actor/kl_coef:0.001 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.728 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.818 - actor/lr:0.000 - critic/score/mean:1.464 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.464 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:299.305 - response_length/max:641.000 - response_length/min:124.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.734 - prompt_length/max:613.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.245 - timing_s/old_log_prob:6.399 - timing_s/ref:6.541 - timing_s/adv:0.324 - timing_s/update_actor:39.305 - timing_s/step:73.836 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:470814.000 - perf/time_per_step:73.836 - perf/throughput:797.057
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:12 - global_seqlen/min:54065.000 - global_seqlen/max:62676.000 - global_seqlen/minmax_diff:8611.000 - global_seqlen/balanced_min:59176.000 - global_seqlen/balanced_max:59177.000 - global_seqlen/mean:59176.125 - actor/entropy_loss:0.982 - actor/kl_loss:0.032 - actor/kl_coef:0.001 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.657 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.727 - actor/lr:0.000 - critic/score/mean:1.413 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.413 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:296.613 - response_length/max:561.000 - response_length/min:140.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.805 - prompt_length/max:647.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.363 - timing_s/old_log_prob:6.425 - timing_s/ref:6.504 - timing_s/adv:0.318 - timing_s/update_actor:38.298 - timing_s/step:71.931 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.089 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:473409.000 - perf/time_per_step:71.931 - perf/throughput:822.682
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  10%|â–‰         | 13/132 [18:30<2:53:37, 87.54s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  11%|â–ˆ         | 14/132 [19:40<2:41:25, 82.08s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  11%|â–ˆâ–        | 15/132 [20:51<2:33:38, 78.79s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  12%|â–ˆâ–        | 16/132 [22:08<2:31:27, 78.34s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  13%|â–ˆâ–        | 17/132 [23:17<2:24:42, 75.50s/it]
[36m(TaskRunner pid=2902585)[0m step:13 - global_seqlen/min:55305.000 - global_seqlen/max:61520.000 - global_seqlen/minmax_diff:6215.000 - global_seqlen/balanced_min:57878.000 - global_seqlen/balanced_max:57879.000 - global_seqlen/mean:57878.375 - actor/entropy_loss:0.906 - actor/kl_loss:0.029 - actor/kl_coef:0.001 - actor/pg_loss:-0.059 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.761 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.671 - actor/lr:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:292.853 - response_length/max:668.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.047 - prompt_length/max:509.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.320 - timing_s/old_log_prob:6.330 - timing_s/ref:6.487 - timing_s/adv:0.325 - timing_s/update_actor:37.517 - timing_s/step:72.997 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:463027.000 - perf/time_per_step:72.997 - perf/throughput:792.889
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:14 - global_seqlen/min:54441.000 - global_seqlen/max:59700.000 - global_seqlen/minmax_diff:5259.000 - global_seqlen/balanced_min:57049.000 - global_seqlen/balanced_max:57050.000 - global_seqlen/mean:57049.875 - actor/entropy_loss:0.851 - actor/kl_loss:0.044 - actor/kl_coef:0.001 - actor/pg_loss:0.066 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.724 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.815 - actor/lr:0.000 - critic/score/mean:1.432 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.432 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.023 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:289.668 - response_length/max:552.000 - response_length/min:128.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.602 - prompt_length/max:614.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.354 - timing_s/old_log_prob:6.147 - timing_s/ref:6.335 - timing_s/adv:0.320 - timing_s/update_actor:36.271 - timing_s/step:69.453 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:456399.000 - perf/time_per_step:69.453 - perf/throughput:821.423
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:15 - global_seqlen/min:55523.000 - global_seqlen/max:61683.000 - global_seqlen/minmax_diff:6160.000 - global_seqlen/balanced_min:58168.000 - global_seqlen/balanced_max:58169.000 - global_seqlen/mean:58168.375 - actor/entropy_loss:0.899 - actor/kl_loss:0.056 - actor/kl_coef:0.001 - actor/pg_loss:0.033 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.674 - perf/mfu/actor:0.398 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.846 - actor/lr:0.000 - critic/score/mean:1.445 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.445 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:293.999 - response_length/max:542.000 - response_length/min:122.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.922 - prompt_length/max:562.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.391 - timing_s/old_log_prob:6.329 - timing_s/ref:6.479 - timing_s/adv:0.331 - timing_s/update_actor:37.575 - timing_s/step:71.133 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.090 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:465347.000 - perf/time_per_step:71.133 - perf/throughput:817.746
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:16 - global_seqlen/min:54177.000 - global_seqlen/max:60452.000 - global_seqlen/minmax_diff:6275.000 - global_seqlen/balanced_min:57139.000 - global_seqlen/balanced_max:57140.000 - global_seqlen/mean:57139.250 - actor/entropy_loss:0.859 - actor/kl_loss:0.071 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.675 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.851 - actor/lr:0.000 - critic/score/mean:1.394 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.394 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.490 - response_length/max:722.000 - response_length/min:127.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.711 - prompt_length/max:820.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.169 - timing_s/old_log_prob:6.219 - timing_s/ref:6.400 - timing_s/adv:0.311 - timing_s/update_actor:37.148 - timing_s/step:77.271 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:457114.000 - perf/time_per_step:77.271 - perf/throughput:739.463
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:17 - global_seqlen/min:52957.000 - global_seqlen/max:59973.000 - global_seqlen/minmax_diff:7016.000 - global_seqlen/balanced_min:56289.000 - global_seqlen/balanced_max:56290.000 - global_seqlen/mean:56289.500 - actor/entropy_loss:0.834 - actor/kl_loss:0.075 - actor/kl_coef:0.001 - actor/pg_loss:-0.054 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.740 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.719 - perf/cpu_memory_used_gb:43.842 - actor/lr:0.000 - critic/score/mean:1.443 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.443 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:274.677 - response_length/max:518.000 - response_length/min:101.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:798.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.735 - timing_s/old_log_prob:6.137 - timing_s/ref:6.384 - timing_s/adv:0.318 - timing_s/update_actor:36.215 - timing_s/step:68.811 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:450316.000 - perf/time_per_step:68.811 - perf/throughput:818.026
[36m(TaskRunner pid=2902585)[0m Training Progress:  14%|â–ˆâ–        | 18/132 [24:27<2:20:16, 73.83s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  14%|â–ˆâ–        | 19/132 [25:39<2:18:03, 73.31s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:18 - global_seqlen/min:54713.000 - global_seqlen/max:59204.000 - global_seqlen/minmax_diff:4491.000 - global_seqlen/balanced_min:56490.000 - global_seqlen/balanced_max:56491.000 - global_seqlen/mean:56490.125 - actor/entropy_loss:0.832 - actor/kl_loss:0.064 - actor/kl_coef:0.001 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.724 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.829 - actor/lr:0.000 - critic/score/mean:1.412 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.412 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.900 - response_length/max:527.000 - response_length/min:93.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.539 - prompt_length/max:574.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.823 - timing_s/old_log_prob:6.244 - timing_s/ref:6.467 - timing_s/adv:0.316 - timing_s/update_actor:37.054 - timing_s/step:69.928 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:451921.000 - perf/time_per_step:69.928 - perf/throughput:807.833
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:19 - global_seqlen/min:54661.000 - global_seqlen/max:61845.000 - global_seqlen/minmax_diff:7184.000 - global_seqlen/balanced_min:56945.000 - global_seqlen/balanced_max:56945.000 - global_seqlen/mean:56945.000 - actor/entropy_loss:0.770 - actor/kl_loss:0.063 - actor/kl_coef:0.001 - actor/pg_loss:-0.100 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.667 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.777 - actor/lr:0.000 - critic/score/mean:1.433 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.433 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:284.958 - response_length/max:708.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.219 - prompt_length/max:638.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.528 - timing_s/old_log_prob:6.208 - timing_s/ref:6.409 - timing_s/adv:0.316 - timing_s/update_actor:36.588 - timing_s/step:72.066 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:455560.000 - perf/time_per_step:72.066 - perf/throughput:790.174
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œåªè¦åœ¨å…±åŒçŠ¯ç½ªèŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å³å¯ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å’Œå…±åŒçš„è¡Œä¸ºï¼Œç¬¦åˆå…±åŒçŠ¯ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„å†…å®¹ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„å†…å®¹ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m Training Progress:  15%|â–ˆâ–Œ        | 20/132 [29:01<3:29:10, 112.06s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  16%|â–ˆâ–Œ        | 21/132 [30:09<3:02:36, 98.71s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  17%|â–ˆâ–‹        | 22/132 [31:19<2:45:13, 90.13s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  17%|â–ˆâ–‹        | 23/132 [32:31<2:33:55, 84.73s/it]
[36m(TaskRunner pid=2902585)[0m step:20 - global_seqlen/min:54209.000 - global_seqlen/max:59587.000 - global_seqlen/minmax_diff:5378.000 - global_seqlen/balanced_min:56891.000 - global_seqlen/balanced_max:56892.000 - global_seqlen/mean:56891.125 - actor/entropy_loss:0.759 - actor/kl_loss:0.066 - actor/kl_coef:0.001 - actor/pg_loss:-0.142 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.862 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.910 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.474 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.474 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.474 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.474 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.474 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.474 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.431 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.431 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:282.085 - response_length/max:531.000 - response_length/min:116.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.531 - prompt_length/max:516.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.712 - timing_s/old_log_prob:6.185 - timing_s/ref:6.324 - timing_s/adv:0.316 - timing_s/update_actor:35.677 - timing_s/testing:132.110 - timing_s/step:202.352 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:455129.000 - perf/time_per_step:202.352 - perf/throughput:281.149
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:21 - global_seqlen/min:53311.000 - global_seqlen/max:58962.000 - global_seqlen/minmax_diff:5651.000 - global_seqlen/balanced_min:56323.000 - global_seqlen/balanced_max:56324.000 - global_seqlen/mean:56323.625 - actor/entropy_loss:0.737 - actor/kl_loss:0.093 - actor/kl_coef:0.001 - actor/pg_loss:0.038 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.724 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.976 - actor/lr:0.000 - critic/score/mean:1.443 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.443 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.868 - response_length/max:531.000 - response_length/min:106.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.836 - prompt_length/max:555.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.862 - timing_s/old_log_prob:5.963 - timing_s/ref:6.212 - timing_s/adv:0.311 - timing_s/update_actor:36.186 - timing_s/step:67.559 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.090 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:450589.000 - perf/time_per_step:67.559 - perf/throughput:833.695
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:22 - global_seqlen/min:53796.000 - global_seqlen/max:58545.000 - global_seqlen/minmax_diff:4749.000 - global_seqlen/balanced_min:55766.000 - global_seqlen/balanced_max:55766.000 - global_seqlen/mean:55766.000 - actor/entropy_loss:0.727 - actor/kl_loss:0.078 - actor/kl_coef:0.001 - actor/pg_loss:-0.037 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.789 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.834 - actor/lr:0.000 - critic/score/mean:1.463 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.463 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.865 - response_length/max:554.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.031 - prompt_length/max:480.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.404 - timing_s/old_log_prob:6.043 - timing_s/ref:6.268 - timing_s/adv:0.318 - timing_s/update_actor:36.042 - timing_s/step:70.095 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446128.000 - perf/time_per_step:70.095 - perf/throughput:795.578
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:23 - global_seqlen/min:51875.000 - global_seqlen/max:61362.000 - global_seqlen/minmax_diff:9487.000 - global_seqlen/balanced_min:56829.000 - global_seqlen/balanced_max:56829.000 - global_seqlen/mean:56829.000 - actor/entropy_loss:0.717 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:-0.128 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.693 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.789 - actor/lr:0.000 - critic/score/mean:1.427 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.427 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.688 - response_length/max:641.000 - response_length/min:88.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.281 - prompt_length/max:511.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.424 - timing_s/old_log_prob:6.210 - timing_s/ref:6.414 - timing_s/adv:0.328 - timing_s/update_actor:37.730 - timing_s/step:72.131 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:454632.000 - perf/time_per_step:72.131 - perf/throughput:787.863
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  18%|â–ˆâ–Š        | 24/132 [33:42<2:25:12, 80.67s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  19%|â–ˆâ–‰        | 25/132 [34:52<2:17:53, 77.32s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  20%|â–ˆâ–‰        | 26/132 [36:02<2:12:31, 75.02s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  20%|â–ˆâ–ˆ        | 27/132 [37:10<2:07:39, 72.95s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  21%|â–ˆâ–ˆ        | 28/132 [38:17<2:03:41, 71.36s/it]
[36m(TaskRunner pid=2902585)[0m step:24 - global_seqlen/min:51181.000 - global_seqlen/max:58947.000 - global_seqlen/minmax_diff:7766.000 - global_seqlen/balanced_min:55319.000 - global_seqlen/balanced_max:55341.000 - global_seqlen/mean:55337.625 - actor/entropy_loss:0.683 - actor/kl_loss:0.054 - actor/kl_coef:0.001 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.852 - actor/lr:0.000 - critic/score/mean:1.447 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.447 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:264.199 - response_length/max:637.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.234 - prompt_length/max:798.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.092 - timing_s/old_log_prob:6.065 - timing_s/ref:6.333 - timing_s/adv:0.307 - timing_s/update_actor:37.365 - timing_s/step:71.188 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:442701.000 - perf/time_per_step:71.188 - perf/throughput:777.347
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:25 - global_seqlen/min:54511.000 - global_seqlen/max:62217.000 - global_seqlen/minmax_diff:7706.000 - global_seqlen/balanced_min:57260.000 - global_seqlen/balanced_max:57260.000 - global_seqlen/mean:57260.000 - actor/entropy_loss:0.731 - actor/kl_loss:0.054 - actor/kl_coef:0.001 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.641 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.999 - actor/lr:0.000 - critic/score/mean:1.395 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.395 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:274.849 - response_length/max:483.000 - response_length/min:135.000 - response_length/clip_ratio:0.000 - prompt_length/mean:321.609 - prompt_length/max:561.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.193 - timing_s/old_log_prob:6.288 - timing_s/ref:6.459 - timing_s/adv:0.319 - timing_s/update_actor:37.129 - timing_s/step:69.411 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:458080.000 - perf/time_per_step:69.411 - perf/throughput:824.944
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:26 - global_seqlen/min:53942.000 - global_seqlen/max:64541.000 - global_seqlen/minmax_diff:10599.000 - global_seqlen/balanced_min:57258.000 - global_seqlen/balanced_max:57259.000 - global_seqlen/mean:57258.500 - actor/entropy_loss:0.688 - actor/kl_loss:0.048 - actor/kl_coef:0.001 - actor/pg_loss:0.097 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.647 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.787 - actor/lr:0.000 - critic/score/mean:1.478 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.478 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.357 - response_length/max:555.000 - response_length/min:95.000 - response_length/clip_ratio:0.000 - prompt_length/mean:328.086 - prompt_length/max:765.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.786 - timing_s/old_log_prob:6.226 - timing_s/ref:6.380 - timing_s/adv:0.312 - timing_s/update_actor:36.887 - timing_s/step:69.611 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:458068.000 - perf/time_per_step:69.611 - perf/throughput:822.547
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:27 - global_seqlen/min:51140.000 - global_seqlen/max:57517.000 - global_seqlen/minmax_diff:6377.000 - global_seqlen/balanced_min:54949.000 - global_seqlen/balanced_max:54950.000 - global_seqlen/mean:54949.125 - actor/entropy_loss:0.691 - actor/kl_loss:0.060 - actor/kl_coef:0.001 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.655 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.884 - actor/lr:0.000 - critic/score/mean:1.429 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.429 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:263.465 - response_length/max:478.000 - response_length/min:96.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.922 - prompt_length/max:551.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.097 - timing_s/old_log_prob:6.039 - timing_s/ref:6.237 - timing_s/adv:0.305 - timing_s/update_actor:36.410 - timing_s/step:68.110 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:439593.000 - perf/time_per_step:68.110 - perf/throughput:806.774
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:28 - global_seqlen/min:50575.000 - global_seqlen/max:57053.000 - global_seqlen/minmax_diff:6478.000 - global_seqlen/balanced_min:53275.000 - global_seqlen/balanced_max:53276.000 - global_seqlen/mean:53275.500 - actor/entropy_loss:0.675 - actor/kl_loss:0.066 - actor/kl_coef:0.001 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.670 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.878 - actor/lr:0.000 - critic/score/mean:1.484 - critic/score/max:2.000 - critic/score/min:0.300 - critic/rewards/mean:1.484 - critic/rewards/max:2.000 - critic/rewards/min:0.300 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.516 - response_length/max:507.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:297.438 - prompt_length/max:536.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.251 - timing_s/old_log_prob:5.831 - timing_s/ref:6.117 - timing_s/adv:0.312 - timing_s/update_actor:36.083 - timing_s/step:67.614 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:426204.000 - perf/time_per_step:67.614 - perf/throughput:787.930
[36m(TaskRunner pid=2902585)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 29/132 [39:28<2:02:23, 71.30s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 30/132 [42:50<3:07:28, 110.28s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:29 - global_seqlen/min:51356.000 - global_seqlen/max:59081.000 - global_seqlen/minmax_diff:7725.000 - global_seqlen/balanced_min:55848.000 - global_seqlen/balanced_max:55848.000 - global_seqlen/mean:55848.000 - actor/entropy_loss:0.654 - actor/kl_loss:0.071 - actor/kl_coef:0.001 - actor/pg_loss:0.051 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.627 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.833 - actor/lr:0.000 - critic/score/mean:1.404 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.404 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:271.031 - response_length/max:614.000 - response_length/min:106.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.719 - prompt_length/max:548.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.163 - timing_s/old_log_prob:6.162 - timing_s/ref:6.375 - timing_s/adv:0.321 - timing_s/update_actor:37.095 - timing_s/step:71.138 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446784.000 - perf/time_per_step:71.138 - perf/throughput:785.062
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aè®¤ä¸ºç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œåªè¦åœ¨å…±åŒå®æ–½çŠ¯ç½ªè¡Œä¸ºçš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å³å¯ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bè®¤ä¸ºç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°çš„è¡Œä¸ºï¼Œç¬¦åˆå…±åŒçŠ¯ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cè®¤ä¸ºå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„å†…å®¹ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dè®¤ä¸ºå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„å†…å®¹ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆåˆ†æï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:30 - global_seqlen/min:52422.000 - global_seqlen/max:58149.000 - global_seqlen/minmax_diff:5727.000 - global_seqlen/balanced_min:54174.000 - global_seqlen/balanced_max:54175.000 - global_seqlen/mean:54174.125 - actor/entropy_loss:0.633 - actor/kl_loss:0.068 - actor/kl_coef:0.001 - actor/pg_loss:-0.171 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.661 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:43.909 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.488 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.488 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.488 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.488 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.488 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.488 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:262.728 - response_length/max:598.000 - response_length/min:101.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.586 - prompt_length/max:567.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.440 - timing_s/old_log_prob:5.952 - timing_s/ref:6.211 - timing_s/adv:0.305 - timing_s/update_actor:36.399 - timing_s/testing:131.883 - timing_s/step:201.215 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:433393.000 - perf/time_per_step:201.215 - perf/throughput:269.235
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 31/132 [43:57<2:43:53, 97.37s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 32/132 [45:09<2:29:28, 89.68s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 33/132 [46:20<2:18:42, 84.07s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 34/132 [47:32<2:11:27, 80.48s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 35/132 [48:43<2:05:51, 77.85s/it]
[36m(TaskRunner pid=2902585)[0m step:31 - global_seqlen/min:52578.000 - global_seqlen/max:59514.000 - global_seqlen/minmax_diff:6936.000 - global_seqlen/balanced_min:54705.000 - global_seqlen/balanced_max:54706.000 - global_seqlen/mean:54705.250 - actor/entropy_loss:0.621 - actor/kl_loss:0.056 - actor/kl_coef:0.001 - actor/pg_loss:-0.118 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.643 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.250 - actor/lr:0.000 - critic/score/mean:1.462 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.462 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.017 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.017 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.760 - response_length/max:482.000 - response_length/min:94.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.086 - prompt_length/max:513.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.521 - timing_s/old_log_prob:5.908 - timing_s/ref:6.158 - timing_s/adv:0.311 - timing_s/update_actor:36.287 - timing_s/step:67.210 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.090 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:437642.000 - perf/time_per_step:67.210 - perf/throughput:813.943
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:32 - global_seqlen/min:55178.000 - global_seqlen/max:57485.000 - global_seqlen/minmax_diff:2307.000 - global_seqlen/balanced_min:56469.000 - global_seqlen/balanced_max:56470.000 - global_seqlen/mean:56469.875 - actor/entropy_loss:0.633 - actor/kl_loss:0.071 - actor/kl_coef:0.001 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.631 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.014 - actor/lr:0.000 - critic/score/mean:1.467 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.467 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.173 - response_length/max:645.000 - response_length/min:118.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.055 - prompt_length/max:522.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.622 - timing_s/old_log_prob:6.137 - timing_s/ref:6.393 - timing_s/adv:0.312 - timing_s/update_actor:37.258 - timing_s/step:71.743 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:451759.000 - perf/time_per_step:71.743 - perf/throughput:787.115
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:33 - global_seqlen/min:52861.000 - global_seqlen/max:58320.000 - global_seqlen/minmax_diff:5459.000 - global_seqlen/balanced_min:55145.000 - global_seqlen/balanced_max:55146.000 - global_seqlen/mean:55145.375 - actor/entropy_loss:0.617 - actor/kl_loss:0.064 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.623 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.478 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.719 - actor/lr:0.000 - critic/score/mean:1.516 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.516 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.892 - response_length/max:629.000 - response_length/min:95.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.539 - prompt_length/max:521.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.207 - timing_s/old_log_prob:6.067 - timing_s/ref:6.297 - timing_s/adv:0.318 - timing_s/update_actor:36.977 - timing_s/step:70.896 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:441163.000 - perf/time_per_step:70.896 - perf/throughput:777.836
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:34 - global_seqlen/min:53816.000 - global_seqlen/max:59688.000 - global_seqlen/minmax_diff:5872.000 - global_seqlen/balanced_min:56738.000 - global_seqlen/balanced_max:56739.000 - global_seqlen/mean:56738.125 - actor/entropy_loss:0.581 - actor/kl_loss:0.061 - actor/kl_coef:0.001 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.594 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.060 - actor/lr:0.000 - critic/score/mean:1.452 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.452 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:277.085 - response_length/max:635.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.938 - prompt_length/max:558.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.639 - timing_s/old_log_prob:6.203 - timing_s/ref:6.499 - timing_s/adv:0.330 - timing_s/update_actor:37.391 - timing_s/step:72.086 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:453905.000 - perf/time_per_step:72.086 - perf/throughput:787.087
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:35 - global_seqlen/min:53761.000 - global_seqlen/max:59119.000 - global_seqlen/minmax_diff:5358.000 - global_seqlen/balanced_min:56241.000 - global_seqlen/balanced_max:56242.000 - global_seqlen/mean:56241.750 - actor/entropy_loss:0.610 - actor/kl_loss:0.063 - actor/kl_coef:0.001 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.647 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:45.307 - actor/lr:0.000 - critic/score/mean:1.455 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.455 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:271.711 - response_length/max:609.000 - response_length/min:101.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.141 - prompt_length/max:544.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.118 - timing_s/old_log_prob:6.255 - timing_s/ref:6.410 - timing_s/adv:0.320 - timing_s/update_actor:37.567 - timing_s/step:71.695 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:449934.000 - perf/time_per_step:71.695 - perf/throughput:784.462
[36m(TaskRunner pid=2902585)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 36/132 [49:54<2:01:10, 75.74s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 37/132 [51:03<1:56:37, 73.65s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 38/132 [52:12<1:53:11, 72.25s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  30%|â–ˆâ–ˆâ–‰       | 39/132 [53:20<1:50:10, 71.09s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:36 - global_seqlen/min:55171.000 - global_seqlen/max:60458.000 - global_seqlen/minmax_diff:5287.000 - global_seqlen/balanced_min:57578.000 - global_seqlen/balanced_max:57579.000 - global_seqlen/mean:57578.250 - actor/entropy_loss:0.562 - actor/kl_loss:0.080 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.596 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.400 - actor/lr:0.000 - critic/score/mean:1.484 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.484 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:279.641 - response_length/max:549.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.133 - prompt_length/max:567.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.205 - timing_s/old_log_prob:6.265 - timing_s/ref:6.422 - timing_s/adv:0.316 - timing_s/update_actor:37.532 - timing_s/step:70.768 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:460626.000 - perf/time_per_step:70.768 - perf/throughput:813.621
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:37 - global_seqlen/min:53097.000 - global_seqlen/max:58099.000 - global_seqlen/minmax_diff:5002.000 - global_seqlen/balanced_min:56231.000 - global_seqlen/balanced_max:56232.000 - global_seqlen/mean:56231.250 - actor/entropy_loss:0.554 - actor/kl_loss:0.067 - actor/kl_coef:0.001 - actor/pg_loss:0.053 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.593 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.485 - actor/lr:0.000 - critic/score/mean:1.520 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.520 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:270.641 - response_length/max:500.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.102 - prompt_length/max:462.000 - prompt_length/min:229.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.487 - timing_s/old_log_prob:6.074 - timing_s/ref:6.332 - timing_s/adv:0.311 - timing_s/update_actor:36.546 - timing_s/step:68.776 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:449850.000 - perf/time_per_step:68.776 - perf/throughput:817.595
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:38 - global_seqlen/min:52082.000 - global_seqlen/max:57716.000 - global_seqlen/minmax_diff:5634.000 - global_seqlen/balanced_min:55841.000 - global_seqlen/balanced_max:55842.000 - global_seqlen/mean:55841.875 - actor/entropy_loss:0.543 - actor/kl_loss:0.074 - actor/kl_coef:0.001 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.682 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.346 - actor/lr:0.000 - critic/score/mean:1.506 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.506 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.132 - response_length/max:516.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.555 - prompt_length/max:504.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.474 - timing_s/old_log_prob:6.070 - timing_s/ref:6.283 - timing_s/adv:0.315 - timing_s/update_actor:36.790 - timing_s/step:68.951 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446735.000 - perf/time_per_step:68.951 - perf/throughput:809.878
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:39 - global_seqlen/min:50207.000 - global_seqlen/max:60951.000 - global_seqlen/minmax_diff:10744.000 - global_seqlen/balanced_min:55605.000 - global_seqlen/balanced_max:55606.000 - global_seqlen/mean:55605.375 - actor/entropy_loss:0.521 - actor/kl_loss:0.096 - actor/kl_coef:0.001 - actor/pg_loss:-0.042 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.741 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.364 - actor/lr:0.000 - critic/score/mean:1.480 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.480 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:259.934 - response_length/max:522.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.289 - prompt_length/max:789.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.495 - timing_s/old_log_prob:6.102 - timing_s/ref:6.286 - timing_s/adv:0.403 - timing_s/update_actor:36.028 - timing_s/step:68.339 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:444843.000 - perf/time_per_step:68.339 - perf/throughput:813.667
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [56:41<2:48:33, 109.92s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 41/132 [57:49<2:27:26, 97.21s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 42/132 [59:02<2:15:06, 90.07s/it]
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„ã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººçš„æ•…æ„å†…å®¹ä¸åŒã€‚ä½†æ˜¯ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aè®¤ä¸ºç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªï¼Œè¿™æ˜¯ä¸æ­£ç¡®çš„ï¼Œå› ä¸ºå…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å†…å®¹ï¼Œåªéœ€è¦å…±åŒå®æ–½çŠ¯ç½ªè¡Œä¸ºã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bè®¤ä¸ºç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Œè¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¸”ä»–ä»¬å…±åŒå®æ–½äº†è¯¥è¡Œä¸ºã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cè®¤ä¸ºå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œè¿™æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„ç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dè®¤ä¸ºå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œè¿™ä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™çš„æ•…æ„ç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:40 - global_seqlen/min:50144.000 - global_seqlen/max:57569.000 - global_seqlen/minmax_diff:7425.000 - global_seqlen/balanced_min:54511.000 - global_seqlen/balanced_max:54512.000 - global_seqlen/mean:54511.375 - actor/entropy_loss:0.511 - actor/kl_loss:0.080 - actor/kl_coef:0.001 - actor/pg_loss:-0.087 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.689 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.300 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.518 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.518 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.518 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.518 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.518 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.518 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.489 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.489 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.053 - response_length/max:537.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.773 - prompt_length/max:595.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.685 - timing_s/old_log_prob:6.120 - timing_s/ref:6.343 - timing_s/adv:0.304 - timing_s/update_actor:36.715 - timing_s/testing:131.333 - timing_s/step:200.526 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:436091.000 - perf/time_per_step:200.526 - perf/throughput:271.842
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:41 - global_seqlen/min:52656.000 - global_seqlen/max:56108.000 - global_seqlen/minmax_diff:3452.000 - global_seqlen/balanced_min:54738.000 - global_seqlen/balanced_max:54739.000 - global_seqlen/mean:54738.875 - actor/entropy_loss:0.496 - actor/kl_loss:0.085 - actor/kl_coef:0.001 - actor/pg_loss:-0.080 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.586 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.243 - actor/lr:0.000 - critic/score/mean:1.519 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.519 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:261.728 - response_length/max:526.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.469 - prompt_length/max:583.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.012 - timing_s/old_log_prob:6.007 - timing_s/ref:6.234 - timing_s/adv:0.316 - timing_s/update_actor:35.877 - timing_s/step:67.473 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:437911.000 - perf/time_per_step:67.473 - perf/throughput:811.268
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:42 - global_seqlen/min:53439.000 - global_seqlen/max:60181.000 - global_seqlen/minmax_diff:6742.000 - global_seqlen/balanced_min:56633.000 - global_seqlen/balanced_max:56634.000 - global_seqlen/mean:56633.250 - actor/entropy_loss:0.473 - actor/kl_loss:0.086 - actor/kl_coef:0.001 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.161 - actor/lr:0.000 - critic/score/mean:1.514 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.514 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:270.688 - response_length/max:743.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.242 - prompt_length/max:628.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.315 - timing_s/old_log_prob:6.166 - timing_s/ref:6.441 - timing_s/adv:0.323 - timing_s/update_actor:37.117 - timing_s/step:73.386 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:453066.000 - perf/time_per_step:73.386 - perf/throughput:771.721
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 43/132 [1:00:12<2:04:38, 84.03s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 44/132 [1:01:27<1:59:12, 81.28s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 45/132 [1:02:41<1:54:56, 79.27s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–      | 46/132 [1:03:52<1:49:48, 76.61s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 47/132 [1:05:04<1:46:51, 75.43s/it]
[36m(TaskRunner pid=2902585)[0m step:43 - global_seqlen/min:53804.000 - global_seqlen/max:58569.000 - global_seqlen/minmax_diff:4765.000 - global_seqlen/balanced_min:56848.000 - global_seqlen/balanced_max:56849.000 - global_seqlen/mean:56848.125 - actor/entropy_loss:0.461 - actor/kl_loss:0.080 - actor/kl_coef:0.001 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.601 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.218 - actor/lr:0.000 - critic/score/mean:1.485 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.485 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:278.746 - response_length/max:513.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.422 - prompt_length/max:535.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.502 - timing_s/old_log_prob:6.263 - timing_s/ref:6.517 - timing_s/adv:0.307 - timing_s/update_actor:37.304 - timing_s/step:69.916 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:454785.000 - perf/time_per_step:69.916 - perf/throughput:813.091
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:44 - global_seqlen/min:52962.000 - global_seqlen/max:62013.000 - global_seqlen/minmax_diff:9051.000 - global_seqlen/balanced_min:56402.000 - global_seqlen/balanced_max:56403.000 - global_seqlen/mean:56402.125 - actor/entropy_loss:0.474 - actor/kl_loss:0.089 - actor/kl_coef:0.001 - actor/pg_loss:0.130 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.597 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.219 - actor/lr:0.000 - critic/score/mean:1.526 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.526 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.021 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.021 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.850 - response_length/max:853.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:808.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.754 - timing_s/old_log_prob:6.090 - timing_s/ref:6.305 - timing_s/adv:0.314 - timing_s/update_actor:37.357 - timing_s/step:74.837 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:451217.000 - perf/time_per_step:74.837 - perf/throughput:753.664
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:45 - global_seqlen/min:54382.000 - global_seqlen/max:60635.000 - global_seqlen/minmax_diff:6253.000 - global_seqlen/balanced_min:56784.000 - global_seqlen/balanced_max:56785.000 - global_seqlen/mean:56784.625 - actor/entropy_loss:0.466 - actor/kl_loss:0.074 - actor/kl_coef:0.001 - actor/pg_loss:0.095 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.579 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.322 - actor/lr:0.000 - critic/score/mean:1.519 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.519 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:280.116 - response_length/max:763.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.391 - prompt_length/max:611.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.541 - timing_s/old_log_prob:6.215 - timing_s/ref:6.403 - timing_s/adv:0.328 - timing_s/update_actor:38.048 - timing_s/step:74.560 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:454277.000 - perf/time_per_step:74.560 - perf/throughput:761.597
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:46 - global_seqlen/min:50954.000 - global_seqlen/max:58873.000 - global_seqlen/minmax_diff:7919.000 - global_seqlen/balanced_min:56583.000 - global_seqlen/balanced_max:56583.000 - global_seqlen/mean:56583.000 - actor/entropy_loss:0.450 - actor/kl_loss:0.084 - actor/kl_coef:0.001 - actor/pg_loss:0.134 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.630 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.104 - actor/lr:0.000 - critic/score/mean:1.516 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.516 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:285.219 - response_length/max:581.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.188 - prompt_length/max:485.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.686 - timing_s/old_log_prob:6.176 - timing_s/ref:6.404 - timing_s/adv:0.315 - timing_s/update_actor:36.751 - timing_s/step:70.359 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:452664.000 - perf/time_per_step:70.359 - perf/throughput:804.203
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:47 - global_seqlen/min:51683.000 - global_seqlen/max:59983.000 - global_seqlen/minmax_diff:8300.000 - global_seqlen/balanced_min:55972.000 - global_seqlen/balanced_max:55973.000 - global_seqlen/mean:55972.750 - actor/entropy_loss:0.468 - actor/kl_loss:0.083 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.532 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.190 - actor/lr:0.000 - critic/score/mean:1.527 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.527 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:280.831 - response_length/max:728.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.219 - prompt_length/max:455.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.239 - timing_s/old_log_prob:6.066 - timing_s/ref:6.314 - timing_s/adv:0.316 - timing_s/update_actor:36.694 - timing_s/step:72.655 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:447782.000 - perf/time_per_step:72.655 - perf/throughput:770.386
[36m(TaskRunner pid=2902585)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [1:06:15<1:43:39, 74.05s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/132 [1:07:27<1:41:19, 73.24s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:48 - global_seqlen/min:54048.000 - global_seqlen/max:61025.000 - global_seqlen/minmax_diff:6977.000 - global_seqlen/balanced_min:57264.000 - global_seqlen/balanced_max:57265.000 - global_seqlen/mean:57264.250 - actor/entropy_loss:0.479 - actor/kl_loss:0.092 - actor/kl_coef:0.001 - actor/pg_loss:-0.125 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.578 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.382 - actor/lr:0.000 - critic/score/mean:1.540 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.540 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:290.526 - response_length/max:584.000 - response_length/min:54.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:485.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.719 - timing_s/old_log_prob:6.222 - timing_s/ref:6.434 - timing_s/adv:0.326 - timing_s/update_actor:37.076 - timing_s/step:70.804 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:458114.000 - perf/time_per_step:70.804 - perf/throughput:808.772
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:49 - global_seqlen/min:53927.000 - global_seqlen/max:61004.000 - global_seqlen/minmax_diff:7077.000 - global_seqlen/balanced_min:57800.000 - global_seqlen/balanced_max:57801.000 - global_seqlen/mean:57800.625 - actor/entropy_loss:0.474 - actor/kl_loss:0.083 - actor/kl_coef:0.001 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.585 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.301 - actor/lr:0.000 - critic/score/mean:1.520 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.520 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:291.934 - response_length/max:549.000 - response_length/min:92.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.156 - prompt_length/max:503.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.431 - timing_s/old_log_prob:6.348 - timing_s/ref:6.454 - timing_s/adv:0.322 - timing_s/update_actor:37.713 - timing_s/step:71.298 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:462405.000 - perf/time_per_step:71.298 - perf/throughput:810.692
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é¦–å…ˆï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªçš„æ•…æ„å¯ä»¥æ˜¯éƒ¨åˆ†ä¸€è‡´çš„ï¼Œå³å…±åŒçŠ¯ç½ªäººè™½ç„¶åœ¨æŸäº›æ–¹é¢æ•…æ„å†…å®¹ä¸åŒï¼Œä½†åœ¨å…±åŒçŠ¯ç½ªèŒƒå›´å†…æ•…æ„å†…å®¹ä¸€è‡´å³å¯æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å…·æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m å…¶æ¬¡ï¼Œå¯¹äºç”²æŸï¼Œè™½ç„¶ä»–çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä½†ä»–çš„è¡Œä¸ºå·²ç»è¶…å‡ºäº†éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´ï¼Œå› æ­¤åº”å½“ä»¥æ›´ä¸ºä¸¥é‡çš„ç½ªåå®šç½ªå¤„ç½šï¼Œå³ä»¥â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€è®ºå¤„ã€‚æ‰€ä»¥é€‰é¡¹Cæ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m å¯¹äºä¹™æŸï¼Œä»–çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä»–çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤åº”å½“ä»¥â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€è®ºå¤„ã€‚æ‰€ä»¥é€‰é¡¹Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2902585)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [1:11:10<2:41:35, 118.24s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [1:12:19<2:19:42, 103.49s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [1:13:31<2:05:32, 94.15s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 53/132 [1:14:48<1:57:16, 89.06s/it]
[36m(TaskRunner pid=2902585)[0m step:50 - global_seqlen/min:56311.000 - global_seqlen/max:60123.000 - global_seqlen/minmax_diff:3812.000 - global_seqlen/balanced_min:57704.000 - global_seqlen/balanced_max:57705.000 - global_seqlen/mean:57704.250 - actor/entropy_loss:0.461 - actor/kl_loss:0.102 - actor/kl_coef:0.001 - actor/pg_loss:-0.087 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.591 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.463 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.535 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.535 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.535 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.535 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.535 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.535 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.499 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.499 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:281.078 - response_length/max:685.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.008 - prompt_length/max:771.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.690 - timing_s/old_log_prob:6.538 - timing_s/ref:6.701 - timing_s/adv:0.323 - timing_s/update_actor:38.613 - timing_s/testing:127.064 - timing_s/save_checkpoint:21.237 - timing_s/step:223.187 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:461634.000 - perf/time_per_step:223.187 - perf/throughput:258.547
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:51 - global_seqlen/min:53631.000 - global_seqlen/max:58598.000 - global_seqlen/minmax_diff:4967.000 - global_seqlen/balanced_min:56048.000 - global_seqlen/balanced_max:56049.000 - global_seqlen/mean:56048.125 - actor/entropy_loss:0.443 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.602 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:45.791 - actor/lr:0.000 - critic/score/mean:1.488 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.488 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.772 - response_length/max:551.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.454 - timing_s/old_log_prob:6.035 - timing_s/ref:6.245 - timing_s/adv:0.315 - timing_s/update_actor:36.987 - timing_s/step:69.064 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448385.000 - perf/time_per_step:69.064 - perf/throughput:811.535
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:52 - global_seqlen/min:53251.000 - global_seqlen/max:62195.000 - global_seqlen/minmax_diff:8944.000 - global_seqlen/balanced_min:57837.000 - global_seqlen/balanced_max:57838.000 - global_seqlen/mean:57837.375 - actor/entropy_loss:0.454 - actor/kl_loss:0.095 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.662 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.979 - actor/lr:0.000 - critic/score/mean:1.542 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.542 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:279.309 - response_length/max:607.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.164 - prompt_length/max:578.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.251 - timing_s/old_log_prob:6.323 - timing_s/ref:6.517 - timing_s/adv:0.322 - timing_s/update_actor:37.905 - timing_s/step:72.339 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:462699.000 - perf/time_per_step:72.339 - perf/throughput:799.533
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:53 - global_seqlen/min:52662.000 - global_seqlen/max:62230.000 - global_seqlen/minmax_diff:9568.000 - global_seqlen/balanced_min:56028.000 - global_seqlen/balanced_max:56031.000 - global_seqlen/mean:56028.750 - actor/entropy_loss:0.455 - actor/kl_loss:0.108 - actor/kl_coef:0.001 - actor/pg_loss:0.131 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.650 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.793 - actor/lr:0.000 - critic/score/mean:1.574 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.574 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:274.719 - response_length/max:1024.000 - response_length/min:67.000 - response_length/clip_ratio:0.001 - prompt_length/mean:308.914 - prompt_length/max:542.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.626 - timing_s/old_log_prob:6.079 - timing_s/ref:6.336 - timing_s/adv:0.314 - timing_s/update_actor:36.769 - timing_s/step:77.162 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448230.000 - perf/time_per_step:77.162 - perf/throughput:726.114
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 54/132 [1:15:59<1:48:37, 83.55s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 55/132 [1:17:11<1:42:40, 80.00s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [1:18:21<1:37:24, 76.90s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/132 [1:19:30<1:33:29, 74.79s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 58/132 [1:20:44<1:31:42, 74.36s/it]
[36m(TaskRunner pid=2902585)[0m step:54 - global_seqlen/min:52492.000 - global_seqlen/max:60389.000 - global_seqlen/minmax_diff:7897.000 - global_seqlen/balanced_min:56574.000 - global_seqlen/balanced_max:56575.000 - global_seqlen/mean:56574.250 - actor/entropy_loss:0.461 - actor/kl_loss:0.111 - actor/kl_coef:0.001 - actor/pg_loss:0.051 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.658 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.833 - actor/lr:0.000 - critic/score/mean:1.560 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.560 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.456 - response_length/max:619.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.859 - prompt_length/max:563.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.721 - timing_s/old_log_prob:6.152 - timing_s/ref:6.358 - timing_s/adv:0.314 - timing_s/update_actor:37.103 - timing_s/step:70.669 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:452594.000 - perf/time_per_step:70.669 - perf/throughput:800.557
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:55 - global_seqlen/min:53803.000 - global_seqlen/max:59689.000 - global_seqlen/minmax_diff:5886.000 - global_seqlen/balanced_min:56847.000 - global_seqlen/balanced_max:56848.000 - global_seqlen/mean:56847.750 - actor/entropy_loss:0.461 - actor/kl_loss:0.111 - actor/kl_coef:0.001 - actor/pg_loss:0.004 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.532 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.767 - actor/lr:0.000 - critic/score/mean:1.555 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.555 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.021 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.500 - response_length/max:590.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.664 - prompt_length/max:615.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.069 - timing_s/old_log_prob:6.255 - timing_s/ref:6.418 - timing_s/adv:0.321 - timing_s/update_actor:37.621 - timing_s/step:71.705 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:454782.000 - perf/time_per_step:71.705 - perf/throughput:792.798
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:56 - global_seqlen/min:52012.000 - global_seqlen/max:60570.000 - global_seqlen/minmax_diff:8558.000 - global_seqlen/balanced_min:55812.000 - global_seqlen/balanced_max:55813.000 - global_seqlen/mean:55812.625 - actor/entropy_loss:0.458 - actor/kl_loss:0.092 - actor/kl_coef:0.001 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.551 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.889 - actor/lr:0.000 - critic/score/mean:1.475 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.475 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:280.061 - response_length/max:555.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.320 - prompt_length/max:679.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.375 - timing_s/old_log_prob:6.084 - timing_s/ref:6.313 - timing_s/adv:0.317 - timing_s/update_actor:36.526 - timing_s/step:69.636 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446501.000 - perf/time_per_step:69.636 - perf/throughput:801.496
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:57 - global_seqlen/min:54157.000 - global_seqlen/max:59302.000 - global_seqlen/minmax_diff:5145.000 - global_seqlen/balanced_min:57251.000 - global_seqlen/balanced_max:57252.000 - global_seqlen/mean:57251.250 - actor/entropy_loss:0.451 - actor/kl_loss:0.110 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.605 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.825 - actor/lr:0.000 - critic/score/mean:1.532 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.532 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.023 - response_length/max:528.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.344 - prompt_length/max:685.000 - prompt_length/min:234.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.162 - timing_s/old_log_prob:6.229 - timing_s/ref:6.378 - timing_s/adv:0.322 - timing_s/update_actor:36.712 - timing_s/step:69.827 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:458010.000 - perf/time_per_step:69.827 - perf/throughput:819.897
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:58 - global_seqlen/min:54096.000 - global_seqlen/max:61552.000 - global_seqlen/minmax_diff:7456.000 - global_seqlen/balanced_min:57167.000 - global_seqlen/balanced_max:57168.000 - global_seqlen/mean:57167.250 - actor/entropy_loss:0.441 - actor/kl_loss:0.104 - actor/kl_coef:0.001 - actor/pg_loss:-0.061 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.585 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.832 - actor/lr:0.000 - critic/score/mean:1.509 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.509 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:285.180 - response_length/max:676.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.312 - prompt_length/max:540.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.101 - timing_s/old_log_prob:6.224 - timing_s/ref:6.463 - timing_s/adv:0.323 - timing_s/update_actor:38.194 - timing_s/step:73.330 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:457338.000 - perf/time_per_step:73.330 - perf/throughput:779.586
[36m(TaskRunner pid=2902585)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 59/132 [1:21:54<1:29:03, 73.19s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:59 - global_seqlen/min:50500.000 - global_seqlen/max:59400.000 - global_seqlen/minmax_diff:8900.000 - global_seqlen/balanced_min:56015.000 - global_seqlen/balanced_max:56016.000 - global_seqlen/mean:56015.875 - actor/entropy_loss:0.433 - actor/kl_loss:0.105 - actor/kl_coef:0.001 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.602 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.890 - actor/lr:0.000 - critic/score/mean:1.554 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.554 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:277.960 - response_length/max:578.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.539 - prompt_length/max:585.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.913 - timing_s/old_log_prob:6.175 - timing_s/ref:6.296 - timing_s/adv:0.317 - timing_s/update_actor:36.715 - timing_s/step:70.443 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448127.000 - perf/time_per_step:70.443 - perf/throughput:795.197
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é¦–å…ˆï¼Œæˆ‘ä»¬æ¥çœ‹é€‰é¡¹Aï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸éœ€è¦æ‰€æœ‰å…±çŠ¯çš„æ•…æ„å®Œå…¨ä¸€è‡´ï¼Œåªè¦åœ¨å…±åŒçŠ¯ç½ªèŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å³å¯ã€‚ç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„ï¼Œå› æ­¤å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m å…¶æ¬¡ï¼Œæˆ‘ä»¬æ¥çœ‹é€‰é¡¹Bï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚ç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„ï¼Œå› æ­¤å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç„¶åï¼Œæˆ‘ä»¬æ¥çœ‹é€‰é¡¹Cï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®å…¶æ•…æ„ï¼Œåº”ä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m æœ€åï¼Œæˆ‘ä»¬æ¥çœ‹é€‰é¡¹Dï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ã€‚ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®å…¶æ•…æ„ï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> "{BCD}" </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [1:25:23<2:16:31, 113.76s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/132 [1:26:35<1:59:50, 101.27s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 62/132 [1:27:45<1:47:08, 91.84s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 63/132 [1:28:55<1:38:22, 85.55s/it]
[36m(TaskRunner pid=2902585)[0m step:60 - global_seqlen/min:54715.000 - global_seqlen/max:62084.000 - global_seqlen/minmax_diff:7369.000 - global_seqlen/balanced_min:58057.000 - global_seqlen/balanced_max:58058.000 - global_seqlen/mean:58057.250 - actor/entropy_loss:0.419 - actor/kl_loss:0.118 - actor/kl_coef:0.001 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.566 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:44.815 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.560 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.560 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.560 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.560 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.560 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.560 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.516 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.516 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:287.966 - response_length/max:764.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.797 - prompt_length/max:604.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.914 - timing_s/old_log_prob:6.374 - timing_s/ref:6.509 - timing_s/adv:0.318 - timing_s/update_actor:38.746 - timing_s/testing:132.531 - timing_s/step:208.415 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:464458.000 - perf/time_per_step:208.415 - perf/throughput:278.566
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:61 - global_seqlen/min:50431.000 - global_seqlen/max:58856.000 - global_seqlen/minmax_diff:8425.000 - global_seqlen/balanced_min:55745.000 - global_seqlen/balanced_max:55745.000 - global_seqlen/mean:55745.000 - actor/entropy_loss:0.402 - actor/kl_loss:0.116 - actor/kl_coef:0.001 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.574 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.683 - actor/lr:0.000 - critic/score/mean:1.602 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.602 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.693 - response_length/max:793.000 - response_length/min:94.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.984 - prompt_length/max:576.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.911 - timing_s/old_log_prob:5.999 - timing_s/ref:6.266 - timing_s/adv:0.304 - timing_s/update_actor:36.596 - timing_s/step:72.103 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:445960.000 - perf/time_per_step:72.103 - perf/throughput:773.128
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:62 - global_seqlen/min:53573.000 - global_seqlen/max:62204.000 - global_seqlen/minmax_diff:8631.000 - global_seqlen/balanced_min:57331.000 - global_seqlen/balanced_max:57332.000 - global_seqlen/mean:57331.250 - actor/entropy_loss:0.410 - actor/kl_loss:0.137 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.652 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.661 - actor/lr:0.000 - critic/score/mean:1.511 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.511 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.091 - response_length/max:556.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.109 - prompt_length/max:640.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.980 - timing_s/old_log_prob:6.210 - timing_s/ref:6.411 - timing_s/adv:0.312 - timing_s/update_actor:36.882 - timing_s/step:69.817 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:458650.000 - perf/time_per_step:69.817 - perf/throughput:821.160
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:63 - global_seqlen/min:52085.000 - global_seqlen/max:59467.000 - global_seqlen/minmax_diff:7382.000 - global_seqlen/balanced_min:56909.000 - global_seqlen/balanced_max:56909.000 - global_seqlen/mean:56909.000 - actor/entropy_loss:0.392 - actor/kl_loss:0.110 - actor/kl_coef:0.001 - actor/pg_loss:0.043 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.626 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.560 - actor/lr:0.000 - critic/score/mean:1.546 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.546 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:279.052 - response_length/max:532.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.750 - prompt_length/max:820.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.060 - timing_s/old_log_prob:6.194 - timing_s/ref:6.416 - timing_s/adv:0.306 - timing_s/update_actor:37.860 - timing_s/step:70.856 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:455272.000 - perf/time_per_step:70.856 - perf/throughput:803.161
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [1:30:13<1:34:09, 83.09s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/132 [1:31:24<1:28:55, 79.64s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 66/132 [1:32:34<1:24:26, 76.76s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 67/132 [1:33:45<1:21:16, 75.02s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [1:34:54<1:17:49, 72.96s/it]
[36m(TaskRunner pid=2902585)[0m step:64 - global_seqlen/min:53234.000 - global_seqlen/max:62476.000 - global_seqlen/minmax_diff:9242.000 - global_seqlen/balanced_min:57403.000 - global_seqlen/balanced_max:57599.000 - global_seqlen/mean:57427.625 - actor/entropy_loss:0.399 - actor/kl_loss:0.104 - actor/kl_coef:0.001 - actor/pg_loss:-0.094 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.608 - perf/mfu/actor:0.403 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.621 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:286.087 - response_length/max:1024.000 - response_length/min:92.000 - response_length/clip_ratio:0.001 - prompt_length/mean:312.117 - prompt_length/max:518.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.814 - timing_s/old_log_prob:6.215 - timing_s/ref:6.390 - timing_s/adv:0.323 - timing_s/update_actor:36.552 - timing_s/step:77.317 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:459421.000 - perf/time_per_step:77.317 - perf/throughput:742.756
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:65 - global_seqlen/min:53574.000 - global_seqlen/max:59105.000 - global_seqlen/minmax_diff:5531.000 - global_seqlen/balanced_min:56117.000 - global_seqlen/balanced_max:56118.000 - global_seqlen/mean:56117.750 - actor/entropy_loss:0.393 - actor/kl_loss:0.127 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.676 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.585 - actor/lr:0.000 - critic/score/mean:1.579 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.579 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.263 - response_length/max:650.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.297 - prompt_length/max:492.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.322 - timing_s/old_log_prob:6.231 - timing_s/ref:6.384 - timing_s/adv:0.305 - timing_s/update_actor:37.299 - timing_s/step:71.561 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448942.000 - perf/time_per_step:71.561 - perf/throughput:784.194
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:66 - global_seqlen/min:51151.000 - global_seqlen/max:59900.000 - global_seqlen/minmax_diff:8749.000 - global_seqlen/balanced_min:55147.000 - global_seqlen/balanced_max:55148.000 - global_seqlen/mean:55147.875 - actor/entropy_loss:0.381 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:0.032 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.567 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.543 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.426 - response_length/max:564.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.031 - prompt_length/max:609.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.485 - timing_s/old_log_prob:6.124 - timing_s/ref:6.355 - timing_s/adv:0.308 - timing_s/update_actor:36.750 - timing_s/step:70.042 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:441183.000 - perf/time_per_step:70.042 - perf/throughput:787.357
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:67 - global_seqlen/min:50883.000 - global_seqlen/max:57721.000 - global_seqlen/minmax_diff:6838.000 - global_seqlen/balanced_min:54358.000 - global_seqlen/balanced_max:54359.000 - global_seqlen/mean:54358.750 - actor/entropy_loss:0.379 - actor/kl_loss:0.145 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.638 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.493 - actor/lr:0.000 - critic/score/mean:1.564 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.564 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.565 - response_length/max:616.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.672 - prompt_length/max:576.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.874 - timing_s/old_log_prob:6.081 - timing_s/ref:6.326 - timing_s/adv:0.312 - timing_s/update_actor:36.702 - timing_s/step:70.339 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:434870.000 - perf/time_per_step:70.339 - perf/throughput:772.808
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:68 - global_seqlen/min:50442.000 - global_seqlen/max:56774.000 - global_seqlen/minmax_diff:6332.000 - global_seqlen/balanced_min:53365.000 - global_seqlen/balanced_max:53366.000 - global_seqlen/mean:53365.625 - actor/entropy_loss:0.374 - actor/kl_loss:0.133 - actor/kl_coef:0.001 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.652 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.437 - actor/lr:0.000 - critic/score/mean:1.549 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.549 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.236 - response_length/max:559.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:298.656 - prompt_length/max:433.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.613 - timing_s/old_log_prob:5.897 - timing_s/ref:6.138 - timing_s/adv:0.303 - timing_s/update_actor:36.164 - timing_s/step:68.141 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:426925.000 - perf/time_per_step:68.141 - perf/throughput:783.167
[36m(TaskRunner pid=2902585)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/132 [1:36:03<1:15:29, 71.89s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/132 [1:39:17<1:52:14, 108.62s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:69 - global_seqlen/min:52431.000 - global_seqlen/max:58714.000 - global_seqlen/minmax_diff:6283.000 - global_seqlen/balanced_min:54607.000 - global_seqlen/balanced_max:54608.000 - global_seqlen/mean:54607.375 - actor/entropy_loss:0.392 - actor/kl_loss:0.132 - actor/kl_coef:0.001 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.657 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.432 - actor/lr:0.000 - critic/score/mean:1.589 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.589 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.655 - response_length/max:595.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.172 - prompt_length/max:614.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.182 - timing_s/old_log_prob:5.999 - timing_s/ref:6.225 - timing_s/adv:0.307 - timing_s/update_actor:36.635 - timing_s/step:69.368 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:436859.000 - perf/time_per_step:69.368 - perf/throughput:787.210
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªè¦æ±‚å„å…±çŠ¯äººä¹‹é—´å…·æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººçš„æ•…æ„å†…å®¹ä¸åŒã€‚ä½†æ˜¯ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬å…·æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å…·æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²å’Œä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å…·æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œå› æ­¤å¯¹ç”²åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œå› æ­¤å¯¹ä¹™åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:70 - global_seqlen/min:49933.000 - global_seqlen/max:57345.000 - global_seqlen/minmax_diff:7412.000 - global_seqlen/balanced_min:54672.000 - global_seqlen/balanced_max:54673.000 - global_seqlen/mean:54672.875 - actor/entropy_loss:0.384 - actor/kl_loss:0.123 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.587 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.540 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.574 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.574 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.574 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.574 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.574 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.574 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.558 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.558 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.306 - response_length/max:604.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.203 - prompt_length/max:542.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.506 - timing_s/old_log_prob:5.941 - timing_s/ref:6.197 - timing_s/adv:0.313 - timing_s/update_actor:36.352 - timing_s/testing:124.982 - timing_s/step:194.312 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:437383.000 - perf/time_per_step:194.312 - perf/throughput:281.366
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 71/132 [1:40:27<1:38:39, 97.04s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [1:41:39<1:29:24, 89.40s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 73/132 [1:42:50<1:22:23, 83.78s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 74/132 [1:43:59<1:16:57, 79.61s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 75/132 [1:45:08<1:12:21, 76.17s/it]
[36m(TaskRunner pid=2902585)[0m step:71 - global_seqlen/min:51907.000 - global_seqlen/max:57746.000 - global_seqlen/minmax_diff:5839.000 - global_seqlen/balanced_min:54817.000 - global_seqlen/balanced_max:54818.000 - global_seqlen/mean:54817.625 - actor/entropy_loss:0.364 - actor/kl_loss:0.125 - actor/kl_coef:0.001 - actor/pg_loss:0.053 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.619 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.571 - actor/lr:0.000 - critic/score/mean:1.641 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.641 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:258.736 - response_length/max:619.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.281 - prompt_length/max:771.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.858 - timing_s/old_log_prob:5.988 - timing_s/ref:6.246 - timing_s/adv:0.312 - timing_s/update_actor:36.566 - timing_s/step:69.999 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:438541.000 - perf/time_per_step:69.999 - perf/throughput:783.123
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:72 - global_seqlen/min:52367.000 - global_seqlen/max:59153.000 - global_seqlen/minmax_diff:6786.000 - global_seqlen/balanced_min:54704.000 - global_seqlen/balanced_max:54705.000 - global_seqlen/mean:54704.875 - actor/entropy_loss:0.370 - actor/kl_loss:0.133 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.493 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.575 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:259.100 - response_length/max:697.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.742 - prompt_length/max:480.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.355 - timing_s/old_log_prob:6.117 - timing_s/ref:6.388 - timing_s/adv:0.305 - timing_s/update_actor:36.365 - timing_s/step:71.550 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:437639.000 - perf/time_per_step:71.550 - perf/throughput:764.566
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:73 - global_seqlen/min:52323.000 - global_seqlen/max:56170.000 - global_seqlen/minmax_diff:3847.000 - global_seqlen/balanced_min:54388.000 - global_seqlen/balanced_max:54389.000 - global_seqlen/mean:54388.250 - actor/entropy_loss:0.371 - actor/kl_loss:0.144 - actor/kl_coef:0.001 - actor/pg_loss:-0.078 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.688 - actor/lr:0.000 - critic/score/mean:1.617 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.617 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.263 - response_length/max:666.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.281 - prompt_length/max:534.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.756 - timing_s/old_log_prob:5.913 - timing_s/ref:6.209 - timing_s/adv:0.306 - timing_s/update_actor:36.430 - timing_s/step:70.634 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:435106.000 - perf/time_per_step:70.634 - perf/throughput:769.998
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:74 - global_seqlen/min:51795.000 - global_seqlen/max:58459.000 - global_seqlen/minmax_diff:6664.000 - global_seqlen/balanced_min:54150.000 - global_seqlen/balanced_max:54151.000 - global_seqlen/mean:54150.500 - actor/entropy_loss:0.351 - actor/kl_loss:0.119 - actor/kl_coef:0.001 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.532 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.588 - actor/lr:0.000 - critic/score/mean:1.518 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.518 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.451 - response_length/max:643.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.617 - prompt_length/max:563.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.831 - timing_s/old_log_prob:5.946 - timing_s/ref:6.265 - timing_s/adv:0.307 - timing_s/update_actor:36.473 - timing_s/step:69.844 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:433204.000 - perf/time_per_step:69.844 - perf/throughput:775.301
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:75 - global_seqlen/min:49448.000 - global_seqlen/max:57469.000 - global_seqlen/minmax_diff:8021.000 - global_seqlen/balanced_min:53669.000 - global_seqlen/balanced_max:53670.000 - global_seqlen/mean:53669.375 - actor/entropy_loss:0.354 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:-0.028 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.662 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.622 - actor/lr:0.000 - critic/score/mean:1.578 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.578 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:246.236 - response_length/max:546.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.820 - prompt_length/max:679.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.600 - timing_s/old_log_prob:5.962 - timing_s/ref:6.241 - timing_s/adv:0.309 - timing_s/update_actor:35.964 - timing_s/step:68.098 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:429355.000 - perf/time_per_step:68.098 - perf/throughput:788.124
[36m(TaskRunner pid=2902585)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [1:46:17<1:09:05, 74.02s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/132 [1:47:26<1:06:36, 72.66s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 78/132 [1:48:38<1:05:15, 72.51s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 79/132 [1:49:47<1:03:06, 71.45s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:76 - global_seqlen/min:54087.000 - global_seqlen/max:57734.000 - global_seqlen/minmax_diff:3647.000 - global_seqlen/balanced_min:56082.000 - global_seqlen/balanced_max:56083.000 - global_seqlen/mean:56082.125 - actor/entropy_loss:0.365 - actor/kl_loss:0.138 - actor/kl_coef:0.001 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.595 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.781 - actor/lr:0.000 - critic/score/mean:1.514 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.514 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.197 - response_length/max:556.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.992 - prompt_length/max:585.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.950 - timing_s/old_log_prob:6.071 - timing_s/ref:6.276 - timing_s/adv:0.315 - timing_s/update_actor:36.341 - timing_s/step:68.980 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448657.000 - perf/time_per_step:68.980 - perf/throughput:813.021
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:77 - global_seqlen/min:50754.000 - global_seqlen/max:55706.000 - global_seqlen/minmax_diff:4952.000 - global_seqlen/balanced_min:53978.000 - global_seqlen/balanced_max:53979.000 - global_seqlen/mean:53978.500 - actor/entropy_loss:0.360 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:-0.080 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.663 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.676 - actor/lr:0.000 - critic/score/mean:1.631 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.631 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.878 - response_length/max:633.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.398 - prompt_length/max:532.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.784 - timing_s/old_log_prob:5.885 - timing_s/ref:6.147 - timing_s/adv:0.311 - timing_s/update_actor:36.310 - timing_s/step:69.460 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:431828.000 - perf/time_per_step:69.460 - perf/throughput:777.120
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:78 - global_seqlen/min:53603.000 - global_seqlen/max:57853.000 - global_seqlen/minmax_diff:4250.000 - global_seqlen/balanced_min:55491.000 - global_seqlen/balanced_max:55492.000 - global_seqlen/mean:55491.250 - actor/entropy_loss:0.357 - actor/kl_loss:0.139 - actor/kl_coef:0.001 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.589 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.698 - actor/lr:0.000 - critic/score/mean:1.610 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.610 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.698 - response_length/max:714.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.336 - prompt_length/max:546.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.336 - timing_s/old_log_prob:6.163 - timing_s/ref:6.370 - timing_s/adv:0.313 - timing_s/update_actor:36.930 - timing_s/step:72.136 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:443930.000 - perf/time_per_step:72.136 - perf/throughput:769.257
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:79 - global_seqlen/min:51509.000 - global_seqlen/max:58681.000 - global_seqlen/minmax_diff:7172.000 - global_seqlen/balanced_min:54759.000 - global_seqlen/balanced_max:54760.000 - global_seqlen/mean:54759.375 - actor/entropy_loss:0.349 - actor/kl_loss:0.154 - actor/kl_coef:0.001 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.655 - actor/lr:0.000 - critic/score/mean:1.613 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.613 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:261.238 - response_length/max:577.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.172 - prompt_length/max:495.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.351 - timing_s/old_log_prob:5.945 - timing_s/ref:6.212 - timing_s/adv:0.323 - timing_s/update_actor:36.092 - timing_s/step:68.943 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:438075.000 - perf/time_per_step:68.943 - perf/throughput:794.267
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [1:53:11<1:36:17, 111.11s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 81/132 [1:54:19<1:23:34, 98.33s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/132 [1:55:30<1:15:03, 90.06s/it]
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™äº›è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸå¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å› æ­¤ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:80 - global_seqlen/min:51227.000 - global_seqlen/max:59749.000 - global_seqlen/minmax_diff:8522.000 - global_seqlen/balanced_min:55733.000 - global_seqlen/balanced_max:55733.000 - global_seqlen/mean:55733.000 - actor/entropy_loss:0.347 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:0.110 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.637 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.670 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.582 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.582 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.582 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.582 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.582 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.582 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:263.716 - response_length/max:662.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.836 - prompt_length/max:561.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.536 - timing_s/old_log_prob:6.128 - timing_s/ref:6.361 - timing_s/adv:0.324 - timing_s/update_actor:37.332 - timing_s/testing:131.921 - timing_s/step:203.630 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:445864.000 - perf/time_per_step:203.630 - perf/throughput:273.698
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:81 - global_seqlen/min:52971.000 - global_seqlen/max:57199.000 - global_seqlen/minmax_diff:4228.000 - global_seqlen/balanced_min:54799.000 - global_seqlen/balanced_max:54800.000 - global_seqlen/mean:54799.250 - actor/entropy_loss:0.334 - actor/kl_loss:0.158 - actor/kl_coef:0.001 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.566 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.647 - actor/lr:0.000 - critic/score/mean:1.582 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.582 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:258.638 - response_length/max:566.000 - response_length/min:88.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.188 - prompt_length/max:566.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.336 - timing_s/old_log_prob:5.925 - timing_s/ref:6.178 - timing_s/adv:0.308 - timing_s/update_actor:36.726 - timing_s/step:68.500 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:438394.000 - perf/time_per_step:68.500 - perf/throughput:799.987
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:82 - global_seqlen/min:51701.000 - global_seqlen/max:57548.000 - global_seqlen/minmax_diff:5847.000 - global_seqlen/balanced_min:54821.000 - global_seqlen/balanced_max:54822.000 - global_seqlen/mean:54821.625 - actor/entropy_loss:0.328 - actor/kl_loss:0.129 - actor/kl_coef:0.001 - actor/pg_loss:-0.087 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.580 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.834 - actor/lr:0.000 - critic/score/mean:1.580 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.580 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.051 - response_length/max:633.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.008 - prompt_length/max:505.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.908 - timing_s/old_log_prob:6.094 - timing_s/ref:6.281 - timing_s/adv:0.313 - timing_s/update_actor:37.111 - timing_s/step:70.755 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:438573.000 - perf/time_per_step:70.755 - perf/throughput:774.809
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/132 [1:56:40<1:08:37, 84.03s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 84/132 [1:57:50<1:03:56, 79.92s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/132 [1:59:01<1:00:18, 76.99s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 86/132 [2:00:14<58:09, 75.85s/it]  
[36m(TaskRunner pid=2902585)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 87/132 [2:01:26<56:10, 74.91s/it]
[36m(TaskRunner pid=2902585)[0m step:83 - global_seqlen/min:53961.000 - global_seqlen/max:57167.000 - global_seqlen/minmax_diff:3206.000 - global_seqlen/balanced_min:55532.000 - global_seqlen/balanced_max:55533.000 - global_seqlen/mean:55532.125 - actor/entropy_loss:0.328 - actor/kl_loss:0.162 - actor/kl_coef:0.001 - actor/pg_loss:-0.026 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.490 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.698 - actor/lr:0.000 - critic/score/mean:1.632 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.632 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.647 - response_length/max:594.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.812 - prompt_length/max:551.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.794 - timing_s/old_log_prob:6.040 - timing_s/ref:6.274 - timing_s/adv:0.321 - timing_s/update_actor:36.429 - timing_s/step:69.878 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:444257.000 - perf/time_per_step:69.878 - perf/throughput:794.704
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:84 - global_seqlen/min:53887.000 - global_seqlen/max:60728.000 - global_seqlen/minmax_diff:6841.000 - global_seqlen/balanced_min:56479.000 - global_seqlen/balanced_max:56480.000 - global_seqlen/mean:56479.625 - actor/entropy_loss:0.321 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.585 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.820 - actor/lr:0.000 - critic/score/mean:1.605 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.605 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.018 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.900 - response_length/max:591.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.430 - prompt_length/max:502.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.594 - timing_s/old_log_prob:6.147 - timing_s/ref:6.459 - timing_s/adv:0.315 - timing_s/update_actor:36.774 - timing_s/step:70.314 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:451837.000 - perf/time_per_step:70.314 - perf/throughput:803.245
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:85 - global_seqlen/min:51369.000 - global_seqlen/max:58946.000 - global_seqlen/minmax_diff:7577.000 - global_seqlen/balanced_min:55513.000 - global_seqlen/balanced_max:55514.000 - global_seqlen/mean:55513.250 - actor/entropy_loss:0.319 - actor/kl_loss:0.151 - actor/kl_coef:0.001 - actor/pg_loss:0.061 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.581 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.685 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.474 - response_length/max:554.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.789 - prompt_length/max:630.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.862 - timing_s/old_log_prob:6.111 - timing_s/ref:6.366 - timing_s/adv:0.315 - timing_s/update_actor:37.448 - timing_s/step:70.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:444106.000 - perf/time_per_step:70.122 - perf/throughput:791.665
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:86 - global_seqlen/min:54797.000 - global_seqlen/max:60530.000 - global_seqlen/minmax_diff:5733.000 - global_seqlen/balanced_min:58137.000 - global_seqlen/balanced_max:58138.000 - global_seqlen/mean:58137.500 - actor/entropy_loss:0.329 - actor/kl_loss:0.145 - actor/kl_coef:0.001 - actor/pg_loss:0.069 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.623 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.684 - actor/lr:0.000 - critic/score/mean:1.572 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.572 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:278.880 - response_length/max:637.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:326.719 - prompt_length/max:615.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.701 - timing_s/old_log_prob:6.348 - timing_s/ref:6.490 - timing_s/adv:0.318 - timing_s/update_actor:38.285 - timing_s/step:73.168 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:465100.000 - perf/time_per_step:73.168 - perf/throughput:794.581
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:87 - global_seqlen/min:51395.000 - global_seqlen/max:59542.000 - global_seqlen/minmax_diff:8147.000 - global_seqlen/balanced_min:56170.000 - global_seqlen/balanced_max:56171.000 - global_seqlen/mean:56170.250 - actor/entropy_loss:0.345 - actor/kl_loss:0.130 - actor/kl_coef:0.001 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.684 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.709 - actor/lr:0.000 - critic/score/mean:1.547 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.547 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.044 - response_length/max:698.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:318.062 - prompt_length/max:522.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.070 - timing_s/old_log_prob:6.111 - timing_s/ref:6.282 - timing_s/adv:0.321 - timing_s/update_actor:37.880 - timing_s/step:72.684 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:449362.000 - perf/time_per_step:72.684 - perf/throughput:772.800
[36m(TaskRunner pid=2902585)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [2:02:35<53:38, 73.15s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/132 [2:03:44<51:25, 71.75s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:88 - global_seqlen/min:53890.000 - global_seqlen/max:58269.000 - global_seqlen/minmax_diff:4379.000 - global_seqlen/balanced_min:55679.000 - global_seqlen/balanced_max:55680.000 - global_seqlen/mean:55679.875 - actor/entropy_loss:0.325 - actor/kl_loss:0.130 - actor/kl_coef:0.001 - actor/pg_loss:0.087 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.606 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.739 - actor/lr:0.000 - critic/score/mean:1.604 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.604 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.967 - response_length/max:534.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.031 - prompt_length/max:593.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.679 - timing_s/old_log_prob:6.134 - timing_s/ref:6.391 - timing_s/adv:0.309 - timing_s/update_actor:36.467 - timing_s/step:69.009 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:445439.000 - perf/time_per_step:69.009 - perf/throughput:806.844
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:89 - global_seqlen/min:50204.000 - global_seqlen/max:56116.000 - global_seqlen/minmax_diff:5912.000 - global_seqlen/balanced_min:54284.000 - global_seqlen/balanced_max:54285.000 - global_seqlen/mean:54284.250 - actor/entropy_loss:0.324 - actor/kl_loss:0.154 - actor/kl_coef:0.001 - actor/pg_loss:0.059 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.606 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.825 - actor/lr:0.000 - critic/score/mean:1.622 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.622 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:259.484 - response_length/max:593.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:529.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.103 - timing_s/old_log_prob:5.984 - timing_s/ref:6.225 - timing_s/adv:0.310 - timing_s/update_actor:35.826 - timing_s/step:68.471 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:434274.000 - perf/time_per_step:68.471 - perf/throughput:792.807
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™äº›è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²å’Œä¹™å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²å’Œä¹™çš„æ•…æ„ä¸åŒï¼Œä½†å¹¶ä¸å½±å“ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿æ²¡æœ‰å®é™…ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ç›¸åº”çš„ç½ªåå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿æ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 90/132 [2:06:59<1:16:08, 108.78s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 91/132 [2:08:08<1:06:11, 96.88s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [2:09:21<59:45, 89.64s/it]  
[36m(TaskRunner pid=2902585)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 93/132 [2:10:31<54:28, 83.81s/it]
[36m(TaskRunner pid=2902585)[0m step:90 - global_seqlen/min:51325.000 - global_seqlen/max:60332.000 - global_seqlen/minmax_diff:9007.000 - global_seqlen/balanced_min:55072.000 - global_seqlen/balanced_max:55073.000 - global_seqlen/mean:55072.125 - actor/entropy_loss:0.317 - actor/kl_loss:0.141 - actor/kl_coef:0.001 - actor/pg_loss:0.106 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.520 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.781 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.593 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.593 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.593 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.593 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.593 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.593 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.609 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.609 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.277 - response_length/max:478.000 - response_length/min:53.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.391 - prompt_length/max:647.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.553 - timing_s/old_log_prob:5.973 - timing_s/ref:6.184 - timing_s/adv:0.320 - timing_s/update_actor:36.908 - timing_s/testing:127.190 - timing_s/step:195.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:440577.000 - perf/time_per_step:195.149 - perf/throughput:282.205
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:91 - global_seqlen/min:49002.000 - global_seqlen/max:59334.000 - global_seqlen/minmax_diff:10332.000 - global_seqlen/balanced_min:53926.000 - global_seqlen/balanced_max:53927.000 - global_seqlen/mean:53926.250 - actor/entropy_loss:0.317 - actor/kl_loss:0.124 - actor/kl_coef:0.001 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.570 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.695 - actor/lr:0.000 - critic/score/mean:1.600 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.600 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.716 - response_length/max:610.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:536.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.300 - timing_s/old_log_prob:5.848 - timing_s/ref:6.106 - timing_s/adv:0.306 - timing_s/update_actor:36.476 - timing_s/step:69.064 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:431410.000 - perf/time_per_step:69.064 - perf/throughput:780.812
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:92 - global_seqlen/min:52256.000 - global_seqlen/max:60655.000 - global_seqlen/minmax_diff:8399.000 - global_seqlen/balanced_min:57102.000 - global_seqlen/balanced_max:57103.000 - global_seqlen/mean:57102.625 - actor/entropy_loss:0.311 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:0.125 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.469 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.724 - actor/lr:0.000 - critic/score/mean:1.569 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.569 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:274.819 - response_length/max:722.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.000 - prompt_length/max:798.000 - prompt_length/min:236.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.458 - timing_s/old_log_prob:6.313 - timing_s/ref:6.438 - timing_s/adv:0.327 - timing_s/update_actor:37.192 - timing_s/step:72.747 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:456821.000 - perf/time_per_step:72.747 - perf/throughput:784.950
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:93 - global_seqlen/min:52702.000 - global_seqlen/max:59552.000 - global_seqlen/minmax_diff:6850.000 - global_seqlen/balanced_min:56222.000 - global_seqlen/balanced_max:56223.000 - global_seqlen/mean:56222.375 - actor/entropy_loss:0.313 - actor/kl_loss:0.148 - actor/kl_coef:0.001 - actor/pg_loss:-0.084 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.617 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.820 - actor/lr:0.000 - critic/score/mean:1.572 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.572 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.290 - response_length/max:544.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.359 - prompt_length/max:522.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.883 - timing_s/old_log_prob:6.176 - timing_s/ref:6.362 - timing_s/adv:0.314 - timing_s/update_actor:37.413 - timing_s/step:70.173 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:449779.000 - perf/time_per_step:70.173 - perf/throughput:801.195
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 94/132 [2:11:40<50:16, 79.39s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/132 [2:12:49<46:54, 76.07s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 96/132 [2:13:58<44:30, 74.17s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 97/132 [2:15:09<42:36, 73.05s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 98/132 [2:16:21<41:11, 72.69s/it]
[36m(TaskRunner pid=2902585)[0m step:94 - global_seqlen/min:53162.000 - global_seqlen/max:58272.000 - global_seqlen/minmax_diff:5110.000 - global_seqlen/balanced_min:55489.000 - global_seqlen/balanced_max:55490.000 - global_seqlen/mean:55489.125 - actor/entropy_loss:0.322 - actor/kl_loss:0.171 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.590 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.872 - actor/lr:0.000 - critic/score/mean:1.597 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.597 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:263.152 - response_length/max:583.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.859 - prompt_length/max:798.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.209 - timing_s/old_log_prob:5.977 - timing_s/ref:6.229 - timing_s/adv:0.314 - timing_s/update_actor:36.307 - timing_s/step:69.057 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:443913.000 - perf/time_per_step:69.057 - perf/throughput:803.527
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:95 - global_seqlen/min:50810.000 - global_seqlen/max:58668.000 - global_seqlen/minmax_diff:7858.000 - global_seqlen/balanced_min:54889.000 - global_seqlen/balanced_max:54889.000 - global_seqlen/mean:54889.000 - actor/entropy_loss:0.308 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.070 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.742 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.773 - actor/lr:0.000 - critic/score/mean:1.624 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.624 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:264.167 - response_length/max:501.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.594 - prompt_length/max:507.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.354 - timing_s/old_log_prob:6.040 - timing_s/ref:6.296 - timing_s/adv:0.319 - timing_s/update_actor:36.265 - timing_s/step:68.298 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:439112.000 - perf/time_per_step:68.298 - perf/throughput:803.668
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:96 - global_seqlen/min:52605.000 - global_seqlen/max:57837.000 - global_seqlen/minmax_diff:5232.000 - global_seqlen/balanced_min:54896.000 - global_seqlen/balanced_max:54897.000 - global_seqlen/mean:54896.125 - actor/entropy_loss:0.303 - actor/kl_loss:0.155 - actor/kl_coef:0.001 - actor/pg_loss:0.087 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.837 - actor/lr:0.000 - critic/score/mean:1.581 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.581 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:258.764 - response_length/max:586.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.070 - prompt_length/max:583.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.536 - timing_s/old_log_prob:5.963 - timing_s/ref:6.246 - timing_s/adv:0.309 - timing_s/update_actor:36.644 - timing_s/step:69.724 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:439169.000 - perf/time_per_step:69.724 - perf/throughput:787.339
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:97 - global_seqlen/min:54832.000 - global_seqlen/max:59868.000 - global_seqlen/minmax_diff:5036.000 - global_seqlen/balanced_min:56437.000 - global_seqlen/balanced_max:56438.000 - global_seqlen/mean:56437.250 - actor/entropy_loss:0.307 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.589 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.737 - actor/lr:0.000 - critic/score/mean:1.606 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.606 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.677 - response_length/max:535.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.211 - prompt_length/max:820.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.700 - timing_s/old_log_prob:6.281 - timing_s/ref:6.445 - timing_s/adv:0.315 - timing_s/update_actor:37.640 - timing_s/step:70.404 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:451498.000 - perf/time_per_step:70.404 - perf/throughput:801.614
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:98 - global_seqlen/min:54656.000 - global_seqlen/max:58808.000 - global_seqlen/minmax_diff:4152.000 - global_seqlen/balanced_min:56655.000 - global_seqlen/balanced_max:56656.000 - global_seqlen/mean:56655.375 - actor/entropy_loss:0.296 - actor/kl_loss:0.138 - actor/kl_coef:0.001 - actor/pg_loss:0.003 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.609 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.881 - actor/lr:0.000 - critic/score/mean:1.611 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.611 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.215 - response_length/max:618.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.945 - prompt_length/max:552.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.645 - timing_s/old_log_prob:6.240 - timing_s/ref:6.397 - timing_s/adv:0.317 - timing_s/update_actor:37.195 - timing_s/step:71.819 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:453243.000 - perf/time_per_step:71.819 - perf/throughput:788.860
[36m(TaskRunner pid=2902585)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 99/132 [2:17:31<39:33, 71.94s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:99 - global_seqlen/min:52521.000 - global_seqlen/max:61090.000 - global_seqlen/minmax_diff:8569.000 - global_seqlen/balanced_min:55922.000 - global_seqlen/balanced_max:55923.000 - global_seqlen/mean:55922.250 - actor/entropy_loss:0.316 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:-0.053 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.562 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.716 - actor/lr:0.000 - critic/score/mean:1.615 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.615 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.812 - response_length/max:598.000 - response_length/min:96.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.711 - prompt_length/max:590.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.595 - timing_s/old_log_prob:6.145 - timing_s/ref:6.368 - timing_s/adv:0.312 - timing_s/update_actor:36.668 - timing_s/step:70.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:447378.000 - perf/time_per_step:70.114 - perf/throughput:797.592
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™äº›è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸå¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿å®é™…ä¸Šæ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ç›¸åº”çš„ç½ªåå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿æ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2902585)[0m Training Progress:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [2:21:13<1:02:28, 117.14s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 101/132 [2:22:22<53:03, 102.69s/it]  
[36m(TaskRunner pid=2902585)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 102/132 [2:23:32<46:22, 92.74s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 103/132 [2:24:41<41:24, 85.67s/it]
[36m(TaskRunner pid=2902585)[0m step:100 - global_seqlen/min:52990.000 - global_seqlen/max:58745.000 - global_seqlen/minmax_diff:5755.000 - global_seqlen/balanced_min:55763.000 - global_seqlen/balanced_max:55764.000 - global_seqlen/mean:55763.250 - actor/entropy_loss:0.323 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:0.137 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.548 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.743 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.604 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.604 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.604 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.875 - response_length/max:509.000 - response_length/min:106.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.992 - prompt_length/max:628.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.386 - timing_s/old_log_prob:6.014 - timing_s/ref:6.243 - timing_s/adv:0.315 - timing_s/update_actor:36.092 - timing_s/testing:132.933 - timing_s/save_checkpoint:21.581 - timing_s/step:222.585 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446106.000 - perf/time_per_step:222.585 - perf/throughput:250.525
[36m(WorkerDict pid=2911751)[0m [rank-7]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911751)[0m [rank-7]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911751)[0m [rank-7]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_7.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:101 - global_seqlen/min:50531.000 - global_seqlen/max:59272.000 - global_seqlen/minmax_diff:8741.000 - global_seqlen/balanced_min:54361.000 - global_seqlen/balanced_max:54362.000 - global_seqlen/mean:54361.250 - actor/entropy_loss:0.307 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.543 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.773 - actor/lr:0.000 - critic/score/mean:1.625 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.625 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.052 - response_length/max:588.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.211 - prompt_length/max:503.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.052 - timing_s/old_log_prob:5.937 - timing_s/ref:6.225 - timing_s/adv:0.306 - timing_s/update_actor:36.379 - timing_s/step:68.933 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:434890.000 - perf/time_per_step:68.933 - perf/throughput:788.609
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:102 - global_seqlen/min:51895.000 - global_seqlen/max:59773.000 - global_seqlen/minmax_diff:7878.000 - global_seqlen/balanced_min:56206.000 - global_seqlen/balanced_max:56207.000 - global_seqlen/mean:56206.750 - actor/entropy_loss:0.311 - actor/kl_loss:0.146 - actor/kl_coef:0.001 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.521 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.208 - actor/lr:0.000 - critic/score/mean:1.612 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.612 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:274.112 - response_length/max:593.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.375 - prompt_length/max:514.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.219 - timing_s/old_log_prob:6.120 - timing_s/ref:6.272 - timing_s/adv:0.319 - timing_s/update_actor:36.562 - timing_s/step:69.518 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:449654.000 - perf/time_per_step:69.518 - perf/throughput:808.521
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:103 - global_seqlen/min:51887.000 - global_seqlen/max:59762.000 - global_seqlen/minmax_diff:7875.000 - global_seqlen/balanced_min:55404.000 - global_seqlen/balanced_max:55405.000 - global_seqlen/mean:55404.625 - actor/entropy_loss:0.315 - actor/kl_loss:0.177 - actor/kl_coef:0.001 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.565 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.031 - actor/lr:0.000 - critic/score/mean:1.611 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.611 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.608 - response_length/max:532.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.523 - prompt_length/max:565.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.869 - timing_s/old_log_prob:6.027 - timing_s/ref:6.329 - timing_s/adv:0.308 - timing_s/update_actor:36.596 - timing_s/step:69.157 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:443237.000 - perf/time_per_step:69.157 - perf/throughput:801.145
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [2:25:50<37:37, 80.63s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/132 [2:27:01<34:58, 77.72s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 106/132 [2:28:11<32:41, 75.43s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 107/132 [2:29:20<30:40, 73.60s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/132 [2:30:29<28:53, 72.23s/it]
[36m(TaskRunner pid=2902585)[0m step:104 - global_seqlen/min:52516.000 - global_seqlen/max:55577.000 - global_seqlen/minmax_diff:3061.000 - global_seqlen/balanced_min:54406.000 - global_seqlen/balanced_max:54407.000 - global_seqlen/mean:54406.375 - actor/entropy_loss:0.311 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:-0.056 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.534 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.057 - actor/lr:0.000 - critic/score/mean:1.655 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.655 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.092 - response_length/max:501.000 - response_length/min:94.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:581.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.320 - timing_s/old_log_prob:5.994 - timing_s/ref:6.267 - timing_s/adv:0.315 - timing_s/update_actor:36.928 - timing_s/step:68.846 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:435251.000 - perf/time_per_step:68.846 - perf/throughput:790.267
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:105 - global_seqlen/min:49599.000 - global_seqlen/max:58908.000 - global_seqlen/minmax_diff:9309.000 - global_seqlen/balanced_min:55121.000 - global_seqlen/balanced_max:55122.000 - global_seqlen/mean:55121.500 - actor/entropy_loss:0.333 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.109 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.626 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.140 - actor/lr:0.000 - critic/score/mean:1.580 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.580 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:258.862 - response_length/max:700.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.320 - prompt_length/max:613.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.717 - timing_s/old_log_prob:6.106 - timing_s/ref:6.344 - timing_s/adv:0.311 - timing_s/update_actor:36.398 - timing_s/step:70.899 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:440972.000 - perf/time_per_step:70.899 - perf/throughput:777.464
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:106 - global_seqlen/min:53291.000 - global_seqlen/max:58837.000 - global_seqlen/minmax_diff:5546.000 - global_seqlen/balanced_min:55876.000 - global_seqlen/balanced_max:55877.000 - global_seqlen/mean:55876.375 - actor/entropy_loss:0.311 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.595 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.048 - actor/lr:0.000 - critic/score/mean:1.588 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.588 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:264.421 - response_length/max:572.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.625 - prompt_length/max:820.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.980 - timing_s/old_log_prob:6.103 - timing_s/ref:6.319 - timing_s/adv:0.339 - timing_s/update_actor:37.297 - timing_s/step:70.065 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:447011.000 - perf/time_per_step:70.065 - perf/throughput:797.498
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:107 - global_seqlen/min:51187.000 - global_seqlen/max:58477.000 - global_seqlen/minmax_diff:7290.000 - global_seqlen/balanced_min:54595.000 - global_seqlen/balanced_max:54596.000 - global_seqlen/mean:54595.625 - actor/entropy_loss:0.309 - actor/kl_loss:0.138 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.155 - actor/lr:0.000 - critic/score/mean:1.603 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.603 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:262.009 - response_length/max:545.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.695 - prompt_length/max:539.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.914 - timing_s/old_log_prob:6.032 - timing_s/ref:6.230 - timing_s/adv:0.305 - timing_s/update_actor:36.786 - timing_s/step:69.286 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:436765.000 - perf/time_per_step:69.286 - perf/throughput:787.977
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:108 - global_seqlen/min:50449.000 - global_seqlen/max:58431.000 - global_seqlen/minmax_diff:7982.000 - global_seqlen/balanced_min:54575.000 - global_seqlen/balanced_max:54576.000 - global_seqlen/mean:54575.625 - actor/entropy_loss:0.296 - actor/kl_loss:0.165 - actor/kl_coef:0.001 - actor/pg_loss:-0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.550 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.019 - actor/lr:0.000 - critic/score/mean:1.671 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.671 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:262.824 - response_length/max:500.000 - response_length/min:107.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.672 - prompt_length/max:531.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.184 - timing_s/old_log_prob:5.955 - timing_s/ref:6.271 - timing_s/adv:0.320 - timing_s/update_actor:37.223 - timing_s/step:68.979 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:436605.000 - perf/time_per_step:68.979 - perf/throughput:791.197
[36m(TaskRunner pid=2902585)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/132 [2:31:39<27:21, 71.36s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 110/132 [2:34:59<40:21, 110.07s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:109 - global_seqlen/min:51910.000 - global_seqlen/max:58341.000 - global_seqlen/minmax_diff:6431.000 - global_seqlen/balanced_min:55144.000 - global_seqlen/balanced_max:55145.000 - global_seqlen/mean:55144.250 - actor/entropy_loss:0.300 - actor/kl_loss:0.196 - actor/kl_coef:0.001 - actor/pg_loss:0.050 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.555 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.083 - actor/lr:0.000 - critic/score/mean:1.634 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.634 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.411 - response_length/max:561.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.008 - prompt_length/max:685.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.878 - timing_s/old_log_prob:6.050 - timing_s/ref:6.253 - timing_s/adv:0.315 - timing_s/update_actor:36.775 - timing_s/step:69.298 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:441154.000 - perf/time_per_step:69.298 - perf/throughput:795.759
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„ç›¸å…³è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™äº›è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸå¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿å®é™…ä¸Šæ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§ç›¸åº”çš„ç½ªåå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿æ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿå¯ä»¥æŒ‰ç…§éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªå®šç½ªã€‚å› æ­¤ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:110 - global_seqlen/min:54064.000 - global_seqlen/max:59680.000 - global_seqlen/minmax_diff:5616.000 - global_seqlen/balanced_min:56283.000 - global_seqlen/balanced_max:56284.000 - global_seqlen/mean:56283.875 - actor/entropy_loss:0.290 - actor/kl_loss:0.137 - actor/kl_coef:0.001 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.655 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.122 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.603 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.603 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.603 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.603 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.603 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.603 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.606 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.606 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:271.439 - response_length/max:597.000 - response_length/min:91.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.852 - prompt_length/max:545.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.735 - timing_s/old_log_prob:6.100 - timing_s/ref:6.291 - timing_s/adv:0.318 - timing_s/update_actor:37.428 - timing_s/testing:126.499 - timing_s/step:200.396 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:450271.000 - perf/time_per_step:200.396 - perf/throughput:280.864
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 111/132 [2:36:10<34:23, 98.28s/it] 
[36m(TaskRunner pid=2902585)[0m Training Progress:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 112/132 [2:37:22<30:06, 90.33s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 113/132 [2:38:32<26:41, 84.27s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 114/132 [2:39:44<24:10, 80.58s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 115/132 [2:40:59<22:21, 78.89s/it]
[36m(TaskRunner pid=2902585)[0m step:111 - global_seqlen/min:53014.000 - global_seqlen/max:58831.000 - global_seqlen/minmax_diff:5817.000 - global_seqlen/balanced_min:55618.000 - global_seqlen/balanced_max:55619.000 - global_seqlen/mean:55618.250 - actor/entropy_loss:0.283 - actor/kl_loss:0.133 - actor/kl_coef:0.001 - actor/pg_loss:-0.131 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.517 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.957 - actor/lr:0.000 - critic/score/mean:1.541 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.541 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:271.380 - response_length/max:636.000 - response_length/min:106.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.977 - prompt_length/max:640.000 - prompt_length/min:232.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.757 - timing_s/old_log_prob:6.018 - timing_s/ref:6.260 - timing_s/adv:0.314 - timing_s/update_actor:37.384 - timing_s/step:70.761 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:444946.000 - perf/time_per_step:70.761 - perf/throughput:785.997
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:112 - global_seqlen/min:50303.000 - global_seqlen/max:60248.000 - global_seqlen/minmax_diff:9945.000 - global_seqlen/balanced_min:55825.000 - global_seqlen/balanced_max:55826.000 - global_seqlen/mean:55825.625 - actor/entropy_loss:0.275 - actor/kl_loss:0.164 - actor/kl_coef:0.001 - actor/pg_loss:0.086 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.385 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.109 - actor/lr:0.000 - critic/score/mean:1.626 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.626 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.021 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.021 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:273.095 - response_length/max:634.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.422 - prompt_length/max:574.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.029 - timing_s/old_log_prob:6.128 - timing_s/ref:6.359 - timing_s/adv:0.316 - timing_s/update_actor:36.911 - timing_s/step:71.769 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:446605.000 - perf/time_per_step:71.769 - perf/throughput:777.854
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:113 - global_seqlen/min:53674.000 - global_seqlen/max:57339.000 - global_seqlen/minmax_diff:3665.000 - global_seqlen/balanced_min:55279.000 - global_seqlen/balanced_max:55279.000 - global_seqlen/mean:55279.000 - actor/entropy_loss:0.286 - actor/kl_loss:0.146 - actor/kl_coef:0.001 - actor/pg_loss:0.061 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.540 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.068 - actor/lr:0.000 - critic/score/mean:1.625 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.625 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:269.839 - response_length/max:527.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.984 - prompt_length/max:487.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.814 - timing_s/old_log_prob:6.063 - timing_s/ref:6.424 - timing_s/adv:0.307 - timing_s/update_actor:37.459 - timing_s/step:70.093 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:442232.000 - perf/time_per_step:70.093 - perf/throughput:788.654
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:114 - global_seqlen/min:52077.000 - global_seqlen/max:59888.000 - global_seqlen/minmax_diff:7811.000 - global_seqlen/balanced_min:56105.000 - global_seqlen/balanced_max:56106.000 - global_seqlen/mean:56105.500 - actor/entropy_loss:0.293 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.530 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.102 - actor/lr:0.000 - critic/score/mean:1.644 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.644 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:280.417 - response_length/max:610.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:512.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.170 - timing_s/old_log_prob:6.146 - timing_s/ref:6.399 - timing_s/adv:0.321 - timing_s/update_actor:37.906 - timing_s/step:71.963 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:448844.000 - perf/time_per_step:71.963 - perf/throughput:779.645
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:115 - global_seqlen/min:54611.000 - global_seqlen/max:61402.000 - global_seqlen/minmax_diff:6791.000 - global_seqlen/balanced_min:56917.000 - global_seqlen/balanced_max:56918.000 - global_seqlen/mean:56917.875 - actor/entropy_loss:0.302 - actor/kl_loss:0.159 - actor/kl_coef:0.001 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.558 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.797 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.013 - actor/lr:0.000 - critic/score/mean:1.607 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.607 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:287.684 - response_length/max:757.000 - response_length/min:122.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.211 - prompt_length/max:516.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.088 - timing_s/old_log_prob:6.267 - timing_s/ref:6.458 - timing_s/adv:0.311 - timing_s/update_actor:37.720 - timing_s/step:74.872 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:455343.000 - perf/time_per_step:74.872 - perf/throughput:760.203
[36m(TaskRunner pid=2902585)[0m Training Progress:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [2:42:10<20:28, 76.76s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/132 [2:43:22<18:47, 75.17s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 118/132 [2:44:36<17:26, 74.76s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 119/132 [2:45:50<16:08, 74.52s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:116 - global_seqlen/min:54556.000 - global_seqlen/max:63093.000 - global_seqlen/minmax_diff:8537.000 - global_seqlen/balanced_min:56934.000 - global_seqlen/balanced_max:56935.000 - global_seqlen/mean:56934.875 - actor/entropy_loss:0.302 - actor/kl_loss:0.171 - actor/kl_coef:0.001 - actor/pg_loss:-0.004 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.494 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.112 - actor/lr:0.000 - critic/score/mean:1.638 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.638 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.579 - response_length/max:681.000 - response_length/min:111.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.492 - prompt_length/max:808.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.974 - timing_s/old_log_prob:6.217 - timing_s/ref:6.416 - timing_s/adv:0.317 - timing_s/update_actor:36.814 - timing_s/step:71.761 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:455479.000 - perf/time_per_step:71.761 - perf/throughput:793.394
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:117 - global_seqlen/min:55933.000 - global_seqlen/max:62668.000 - global_seqlen/minmax_diff:6735.000 - global_seqlen/balanced_min:59131.000 - global_seqlen/balanced_max:59132.000 - global_seqlen/mean:59131.500 - actor/entropy_loss:0.302 - actor/kl_loss:0.148 - actor/kl_coef:0.001 - actor/pg_loss:0.081 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.461 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.165 - actor/lr:0.000 - critic/score/mean:1.645 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.645 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:295.578 - response_length/max:560.000 - response_length/min:128.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.375 - prompt_length/max:609.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.535 - timing_s/old_log_prob:6.398 - timing_s/ref:6.563 - timing_s/adv:0.331 - timing_s/update_actor:37.601 - timing_s/step:71.454 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.090 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:473052.000 - perf/time_per_step:71.454 - perf/throughput:827.552
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:118 - global_seqlen/min:54953.000 - global_seqlen/max:62331.000 - global_seqlen/minmax_diff:7378.000 - global_seqlen/balanced_min:58130.000 - global_seqlen/balanced_max:58131.000 - global_seqlen/mean:58130.750 - actor/entropy_loss:0.292 - actor/kl_loss:0.158 - actor/kl_coef:0.001 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.426 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.199 - actor/lr:0.000 - critic/score/mean:1.590 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.590 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:301.661 - response_length/max:726.000 - response_length/min:130.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.867 - prompt_length/max:512.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.387 - timing_s/old_log_prob:6.314 - timing_s/ref:6.509 - timing_s/adv:0.331 - timing_s/update_actor:37.212 - timing_s/step:73.777 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:465046.000 - perf/time_per_step:73.777 - perf/throughput:787.920
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:119 - global_seqlen/min:54447.000 - global_seqlen/max:61814.000 - global_seqlen/minmax_diff:7367.000 - global_seqlen/balanced_min:58562.000 - global_seqlen/balanced_max:58563.000 - global_seqlen/mean:58562.500 - actor/entropy_loss:0.319 - actor/kl_loss:0.144 - actor/kl_coef:0.001 - actor/pg_loss:0.054 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.518 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:41.979 - actor/lr:0.000 - critic/score/mean:1.674 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.674 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:291.448 - response_length/max:610.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:318.578 - prompt_length/max:611.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.856 - timing_s/old_log_prob:6.571 - timing_s/ref:6.701 - timing_s/adv:0.319 - timing_s/update_actor:38.448 - timing_s/step:73.922 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:468500.000 - perf/time_per_step:73.922 - perf/throughput:792.218
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m Training Progress:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [2:49:13<22:36, 113.05s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/132 [2:50:24<18:27, 100.68s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 122/132 [2:51:36<15:20, 92.02s/it] 
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„ç›¸å…³è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™äº›è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å¯ä»¥è§†ä¸ºå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºå³ä½¿æ•…æ„ä¸åŒï¼Œä½†å¦‚æœè¡Œä¸ºåœ¨åŒä¸€ä¸ªç½ªåèŒƒå›´å†…ï¼Œä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œå› æ­¤å¯ä»¥åœ¨è¿™ä¸€ç½ªåä¸‹æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººæœ‰ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå³ä½¿å®é™…ä¸Šæ²¡æœ‰ä¸ºå¢ƒå¤–æä¾›ï¼Œä¹Ÿåº”ä»¥ç›¸åº”çš„ç½ªåè®ºå¤„ï¼Œå³ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®å…¶è¡Œä¸ºæ€§è´¨ï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m step:120 - global_seqlen/min:55624.000 - global_seqlen/max:61529.000 - global_seqlen/minmax_diff:5905.000 - global_seqlen/balanced_min:58685.000 - global_seqlen/balanced_max:58686.000 - global_seqlen/mean:58685.125 - actor/entropy_loss:0.304 - actor/kl_loss:0.146 - actor/kl_coef:0.001 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.464 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.032 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.612 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.612 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.612 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.678 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.678 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:301.819 - response_length/max:642.000 - response_length/min:115.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.484 - prompt_length/max:550.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.004 - timing_s/old_log_prob:6.440 - timing_s/ref:6.527 - timing_s/adv:0.325 - timing_s/update_actor:37.723 - timing_s/testing:129.896 - timing_s/step:202.936 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:469481.000 - perf/time_per_step:202.936 - perf/throughput:289.181
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:121 - global_seqlen/min:55740.000 - global_seqlen/max:61839.000 - global_seqlen/minmax_diff:6099.000 - global_seqlen/balanced_min:59588.000 - global_seqlen/balanced_max:59589.000 - global_seqlen/mean:59588.250 - actor/entropy_loss:0.289 - actor/kl_loss:0.131 - actor/kl_coef:0.001 - actor/pg_loss:0.185 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.473 - perf/mfu/actor:0.416 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.119 - actor/lr:0.000 - critic/score/mean:1.650 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.650 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:309.852 - response_length/max:665.000 - response_length/min:122.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.859 - prompt_length/max:443.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.785 - timing_s/old_log_prob:6.387 - timing_s/ref:6.490 - timing_s/adv:0.322 - timing_s/update_actor:36.777 - timing_s/step:71.792 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.077 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:476706.000 - perf/time_per_step:71.792 - perf/throughput:830.008
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:122 - global_seqlen/min:55896.000 - global_seqlen/max:61452.000 - global_seqlen/minmax_diff:5556.000 - global_seqlen/balanced_min:58861.000 - global_seqlen/balanced_max:58862.000 - global_seqlen/mean:58861.875 - actor/entropy_loss:0.310 - actor/kl_loss:0.143 - actor/kl_coef:0.001 - actor/pg_loss:0.101 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.485 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.274 - actor/lr:0.000 - critic/score/mean:1.633 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.633 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:298.980 - response_length/max:592.000 - response_length/min:119.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.164 - prompt_length/max:640.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.293 - timing_s/old_log_prob:6.331 - timing_s/ref:6.463 - timing_s/adv:0.320 - timing_s/update_actor:37.377 - timing_s/step:71.807 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:470895.000 - perf/time_per_step:71.807 - perf/throughput:819.722
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m Training Progress:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 123/132 [2:52:52<13:05, 87.23s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [2:54:05<11:03, 82.97s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 125/132 [2:55:19<09:21, 80.28s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 126/132 [2:56:31<07:47, 77.83s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 127/132 [2:57:47<06:25, 77.04s/it]
[36m(TaskRunner pid=2902585)[0m step:123 - global_seqlen/min:57326.000 - global_seqlen/max:65611.000 - global_seqlen/minmax_diff:8285.000 - global_seqlen/balanced_min:61689.000 - global_seqlen/balanced_max:61690.000 - global_seqlen/mean:61689.375 - actor/entropy_loss:0.296 - actor/kl_loss:0.134 - actor/kl_coef:0.001 - actor/pg_loss:-0.064 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.505 - perf/mfu/actor:0.407 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.131 - actor/lr:0.000 - critic/score/mean:1.649 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.649 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:318.832 - response_length/max:685.000 - response_length/min:102.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.766 - prompt_length/max:541.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.355 - timing_s/old_log_prob:6.621 - timing_s/ref:6.742 - timing_s/adv:0.332 - timing_s/update_actor:38.937 - timing_s/step:76.020 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:493515.000 - perf/time_per_step:76.020 - perf/throughput:811.485
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:124 - global_seqlen/min:56933.000 - global_seqlen/max:60140.000 - global_seqlen/minmax_diff:3207.000 - global_seqlen/balanced_min:58014.000 - global_seqlen/balanced_max:58015.000 - global_seqlen/mean:58014.125 - actor/entropy_loss:0.297 - actor/kl_loss:0.168 - actor/kl_coef:0.001 - actor/pg_loss:-0.057 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.503 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.168 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:300.493 - response_length/max:616.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.820 - prompt_length/max:555.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.926 - timing_s/old_log_prob:6.271 - timing_s/ref:6.446 - timing_s/adv:0.328 - timing_s/update_actor:37.997 - timing_s/step:72.993 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:464113.000 - perf/time_per_step:72.993 - perf/throughput:794.796
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:125 - global_seqlen/min:55160.000 - global_seqlen/max:62785.000 - global_seqlen/minmax_diff:7625.000 - global_seqlen/balanced_min:57675.000 - global_seqlen/balanced_max:57676.000 - global_seqlen/mean:57675.750 - actor/entropy_loss:0.299 - actor/kl_loss:0.147 - actor/kl_coef:0.001 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.435 - perf/mfu/actor:0.398 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.178 - actor/lr:0.000 - critic/score/mean:1.647 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.647 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:296.039 - response_length/max:587.000 - response_length/min:124.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.750 - prompt_length/max:583.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.676 - timing_s/old_log_prob:6.279 - timing_s/ref:6.441 - timing_s/adv:0.328 - timing_s/update_actor:37.233 - timing_s/step:73.981 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:461406.000 - perf/time_per_step:73.981 - perf/throughput:779.600
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:126 - global_seqlen/min:55112.000 - global_seqlen/max:63867.000 - global_seqlen/minmax_diff:8755.000 - global_seqlen/balanced_min:59157.000 - global_seqlen/balanced_max:59158.000 - global_seqlen/mean:59157.375 - actor/entropy_loss:0.286 - actor/kl_loss:0.155 - actor/kl_coef:0.001 - actor/pg_loss:0.154 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.510 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.179 - actor/lr:0.000 - critic/score/mean:1.599 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.599 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:304.160 - response_length/max:544.000 - response_length/min:111.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.062 - prompt_length/max:567.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.327 - timing_s/old_log_prob:6.458 - timing_s/ref:6.573 - timing_s/adv:0.330 - timing_s/update_actor:38.396 - timing_s/step:72.108 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.087 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:473259.000 - perf/time_per_step:72.108 - perf/throughput:820.401
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:127 - global_seqlen/min:57639.000 - global_seqlen/max:61202.000 - global_seqlen/minmax_diff:3563.000 - global_seqlen/balanced_min:58868.000 - global_seqlen/balanced_max:58869.000 - global_seqlen/mean:58868.125 - actor/entropy_loss:0.296 - actor/kl_loss:0.143 - actor/kl_coef:0.001 - actor/pg_loss:0.075 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.508 - perf/mfu/actor:0.406 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.229 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:304.702 - response_length/max:808.000 - response_length/min:127.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.508 - prompt_length/max:604.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.690 - timing_s/old_log_prob:6.381 - timing_s/ref:6.543 - timing_s/adv:0.324 - timing_s/update_actor:37.204 - timing_s/step:75.164 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:470945.000 - perf/time_per_step:75.164 - perf/throughput:783.195
[36m(TaskRunner pid=2902585)[0m Training Progress:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [2:59:02<05:05, 76.42s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 129/132 [3:00:16<03:47, 75.77s/it]
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:128 - global_seqlen/min:56278.000 - global_seqlen/max:62736.000 - global_seqlen/minmax_diff:6458.000 - global_seqlen/balanced_min:59391.000 - global_seqlen/balanced_max:59392.000 - global_seqlen/mean:59391.625 - actor/entropy_loss:0.294 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.436 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.182 - actor/lr:0.000 - critic/score/mean:1.637 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.637 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:305.577 - response_length/max:696.000 - response_length/min:142.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.086 - prompt_length/max:789.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.303 - timing_s/old_log_prob:6.527 - timing_s/ref:6.629 - timing_s/adv:0.323 - timing_s/update_actor:38.093 - timing_s/step:74.936 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:475133.000 - perf/time_per_step:74.936 - perf/throughput:792.560
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:129 - global_seqlen/min:55681.000 - global_seqlen/max:61122.000 - global_seqlen/minmax_diff:5441.000 - global_seqlen/balanced_min:58202.000 - global_seqlen/balanced_max:58203.000 - global_seqlen/mean:58202.875 - actor/entropy_loss:0.286 - actor/kl_loss:0.186 - actor/kl_coef:0.001 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.490 - perf/mfu/actor:0.402 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.274 - actor/lr:0.000 - critic/score/mean:1.589 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.589 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:301.475 - response_length/max:751.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.805 - prompt_length/max:441.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.024 - timing_s/old_log_prob:6.264 - timing_s/ref:6.419 - timing_s/adv:0.318 - timing_s/update_actor:37.184 - timing_s/step:74.237 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:465623.000 - perf/time_per_step:74.237 - perf/throughput:784.010
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•åŠç›¸å…³å¸æ³•è§£é‡Šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œéœ€è¦è€ƒè™‘å…±åŒçŠ¯ç½ªäººçš„æ•…æ„å†…å®¹æ˜¯å¦ä¸€è‡´ã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸæ•…æ„ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸæ•…æ„ä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä¸¤äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²å’Œä¹™çš„æ•…æ„ä¸åŒï¼Œä¸èƒ½å› ä¸ºæ•…æ„ä¸åŒå°±è®¤å®šä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å…±åŒå®æ–½äº†è¯¥è¡Œä¸ºï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥çš„ï¼Œåº”å½“ä»¥ç›¸åº”çš„ç½ªåè®ºå¤„ï¼Œå› æ­¤å¯¹ç”²åº”ä»¥ç›¸åº”çš„ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¦‚æœè¡Œä¸ºäººéæ³•è·å–å›½å®¶ç§˜å¯†çš„ï¼Œåº”å½“ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå› æ­¤å¯¹ä¹™åº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 130/132 [3:03:44<03:50, 115.34s/it]
[36m(TaskRunner pid=2902585)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [3:04:56<01:42, 102.47s/it]
[36m(TaskRunner pid=2902585)[0m step:130 - global_seqlen/min:55814.000 - global_seqlen/max:60469.000 - global_seqlen/minmax_diff:4655.000 - global_seqlen/balanced_min:59038.000 - global_seqlen/balanced_max:59039.000 - global_seqlen/mean:59038.125 - actor/entropy_loss:0.287 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.111 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.500 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.310 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.617 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.617 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.617 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.637 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.637 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:299.816 - response_length/max:977.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.164 - prompt_length/max:765.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.046 - timing_s/old_log_prob:6.472 - timing_s/ref:6.594 - timing_s/adv:0.342 - timing_s/update_actor:38.284 - timing_s/testing:128.891 - timing_s/step:207.652 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:472305.000 - perf/time_per_step:207.652 - perf/throughput:284.313
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m step:131 - global_seqlen/min:55472.000 - global_seqlen/max:61091.000 - global_seqlen/minmax_diff:5619.000 - global_seqlen/balanced_min:58744.000 - global_seqlen/balanced_max:58745.000 - global_seqlen/mean:58744.375 - actor/entropy_loss:0.289 - actor/kl_loss:0.180 - actor/kl_coef:0.001 - actor/pg_loss:-0.057 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.467 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.165 - actor/lr:0.000 - critic/score/mean:1.596 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.596 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.018 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:297.647 - response_length/max:616.000 - response_length/min:107.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.273 - prompt_length/max:445.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.304 - timing_s/old_log_prob:6.247 - timing_s/ref:6.374 - timing_s/adv:0.322 - timing_s/update_actor:38.130 - timing_s/step:72.414 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:469955.000 - perf/time_per_step:72.414 - perf/throughput:811.228
[36m(TaskRunner pid=2902585)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2902585)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2902585)[0m validation generation end
[36m(TaskRunner pid=2902585)[0m [prompt] system
[36m(TaskRunner pid=2902585)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2902585)[0m user
[36m(TaskRunner pid=2902585)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2902585)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2902585)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2902585)[0m assistant
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•åŠç›¸å…³å¸æ³•è§£é‡Šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œéœ€è¦è€ƒè™‘å…±åŒçŠ¯ç½ªäººçš„æ•…æ„å†…å®¹æ˜¯å¦ä¸€è‡´ã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸæ•…æ„ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸæ•…æ„ä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä¸¤äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²å’Œä¹™çš„æ•…æ„ä¸åŒï¼Œä½†å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Bæ­£ç¡®ï¼Œå› ä¸ºç”²å’Œä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œå› æ­¤å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Cæ­£ç¡®ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œå› æ­¤å¯¹ç”²åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m é€‰é¡¹Dæ­£ç¡®ï¼Œå› ä¸ºä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œå› æ­¤å¯¹ä¹™åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m ç»¼åˆè€ƒè™‘ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2902585)[0m 
[36m(TaskRunner pid=2902585)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2902585)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2902585)[0m [score] 2.0
[36m(TaskRunner pid=2902585)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2902585)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2905626)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2902585)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [3:08:44<01:26, 86.45s/it] 
[36m(TaskRunner pid=2902585)[0m step:132 - global_seqlen/min:54801.000 - global_seqlen/max:62055.000 - global_seqlen/minmax_diff:7254.000 - global_seqlen/balanced_min:58223.000 - global_seqlen/balanced_max:58224.000 - global_seqlen/mean:58223.875 - actor/entropy_loss:0.283 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:-0.043 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.420 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:44.147 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:42.154 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.612 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.612 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.612 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.612 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.566 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.566 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.018 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:292.717 - response_length/max:633.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.781 - prompt_length/max:498.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.831 - timing_s/old_log_prob:6.325 - timing_s/ref:6.511 - timing_s/adv:0.318 - timing_s/update_actor:38.090 - timing_s/testing:133.423 - timing_s/save_checkpoint:21.871 - timing_s/step:228.392 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:465791.000 - perf/time_per_step:228.392 - perf/throughput:254.930
[36m(TaskRunner pid=2902585)[0m ("Final validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(1.6117368570391848), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(1.6117368570391848), '
[36m(TaskRunner pid=2902585)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(1.6117368570391848), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': "
[36m(TaskRunner pid=2902585)[0m  "np.float64(1.6117368670137247), 'val-aux/jec-qa-1-multi-choice/score/std@1': "
[36m(TaskRunner pid=2902585)[0m  "np.float64(0.0), 'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(1.6117368670137247), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(9.28951399686359e-17), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(1.6117368670137247), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=2902585)[0m  'np.float64(9.28951399686359e-17), '
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=2902585)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2911741)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
