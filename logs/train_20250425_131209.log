2025-04-25 13:12:15,531	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=1996834)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=1996834)[0m                                                              'optimizer',
[36m(TaskRunner pid=1996834)[0m                                                              'extra']},
[36m(TaskRunner pid=1996834)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=1996834)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=1996834)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=1996834)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=1996834)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=1996834)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1996834)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=1996834)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=1996834)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1996834)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=1996834)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=1996834)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=1996834)[0m                                  'loss_agg_mode': 'seq-mean-token-sum-norm',
[36m(TaskRunner pid=1996834)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=1996834)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=1996834)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1996834)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=1996834)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=1996834)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=1996834)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=1996834)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=1996834)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1996834)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m                                  'ppo_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=1996834)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1996834)[0m                                  'shuffle': False,
[36m(TaskRunner pid=1996834)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=1996834)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1996834)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=1996834)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=1996834)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=1996834)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=1996834)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1996834)[0m                                  'external_lib': None,
[36m(TaskRunner pid=1996834)[0m                                  'override_config': {},
[36m(TaskRunner pid=1996834)[0m                                  'path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1996834)[0m                                  'use_liger': False,
[36m(TaskRunner pid=1996834)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=1996834)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=1996834)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1996834)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1996834)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1996834)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1996834)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=1996834)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=1996834)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=1996834)[0m                                    'do_sample': True,
[36m(TaskRunner pid=1996834)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=1996834)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=1996834)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=1996834)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=1996834)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=1996834)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=1996834)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=1996834)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=1996834)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1996834)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1996834)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1996834)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=1996834)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=1996834)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=1996834)[0m                                    'n': 6,
[36m(TaskRunner pid=1996834)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=1996834)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=1996834)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=1996834)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=1996834)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=1996834)[0m                                    'top_k': -1,
[36m(TaskRunner pid=1996834)[0m                                    'top_p': 1,
[36m(TaskRunner pid=1996834)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=1996834)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=1996834)[0m                                                   'n': 1,
[36m(TaskRunner pid=1996834)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=1996834)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=1996834)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=1996834)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=1996834)[0m                'gamma': 1.0,
[36m(TaskRunner pid=1996834)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=1996834)[0m                            'kl_coef': 0,
[36m(TaskRunner pid=1996834)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=1996834)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1996834)[0m WARNING:2025-04-25 13:12:26,550:Waiting for register center actor oPQUVg_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2005903)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2005903)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2005903)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(TaskRunner pid=1996834)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=1996834)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=1996834)[0m                'lam': 1.0,
[36m(TaskRunner pid=1996834)[0m                'norm_adv_by_std_in_grpo': False,
[36m(TaskRunner pid=1996834)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=1996834)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=1996834)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=1996834)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1996834)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1996834)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=1996834)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1996834)[0m                       'external_lib': None,
[36m(TaskRunner pid=1996834)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1996834)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=1996834)[0m                                       'param_offload': False,
[36m(TaskRunner pid=1996834)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1996834)[0m                       'override_config': {},
[36m(TaskRunner pid=1996834)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=1996834)[0m                       'tokenizer_path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1996834)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=1996834)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=1996834)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1996834)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=1996834)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=1996834)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=1996834)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=1996834)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=1996834)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1996834)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1996834)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1996834)[0m             'rollout_n': 6,
[36m(TaskRunner pid=1996834)[0m             'shuffle': False,
[36m(TaskRunner pid=1996834)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=1996834)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1996834)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=1996834)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=1996834)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=1996834)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=1996834)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=1996834)[0m           'image_key': 'images',
[36m(TaskRunner pid=1996834)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=1996834)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=1996834)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=1996834)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=1996834)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=1996834)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=1996834)[0m           'shuffle': True,
[36m(TaskRunner pid=1996834)[0m           'tokenizer': None,
[36m(TaskRunner pid=1996834)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=1996834)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=1996834)[0m           'truncation': 'error',
[36m(TaskRunner pid=1996834)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=1996834)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=1996834)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=1996834)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=1996834)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=1996834)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1996834)[0m                   'max_length': None,
[36m(TaskRunner pid=1996834)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=1996834)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1996834)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=1996834)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1996834)[0m                                             'param_offload': False,
[36m(TaskRunner pid=1996834)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1996834)[0m                             'input_tokenizer': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1996834)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=1996834)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=1996834)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=1996834)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=1996834)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1996834)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=1996834)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=1996834)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=1996834)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=1996834)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=1996834)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=1996834)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=1996834)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=1996834)[0m              'logger': ['console'],
[36m(TaskRunner pid=1996834)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=1996834)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=1996834)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=1996834)[0m              'nnodes': 1,
[36m(TaskRunner pid=1996834)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=1996834)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=1996834)[0m              'resume_from_path': None,
[36m(TaskRunner pid=1996834)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=1996834)[0m              'save_freq': 50,
[36m(TaskRunner pid=1996834)[0m              'test_freq': 10,
[36m(TaskRunner pid=1996834)[0m              'total_epochs': 2,
[36m(TaskRunner pid=1996834)[0m              'total_training_steps': None,
[36m(TaskRunner pid=1996834)[0m              'val_before_train': True}}
[36m(TaskRunner pid=1996834)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=1996834)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=1996834)[0m dataset len: 8448
[36m(TaskRunner pid=1996834)[0m dataset len: 2113
[36m(TaskRunner pid=1996834)[0m Size of train dataloader: 66
[36m(TaskRunner pid=1996834)[0m Total training steps: 132
[36m(WorkerDict pid=1999600)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2005906)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.41s/it]
[36m(WorkerDict pid=2005912)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2005912)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005912)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005906)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.69s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=1999600)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.51s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.56s/it]
[36m(WorkerDict pid=1999600)[0m [rank0]:[W425 13:12:56.736374864 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=2005903)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2005903)[0m   warnings.warn(
[36m(WorkerDict pid=2005912)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.88s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005912)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.82s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.85s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005912)[0m [rank4]:[W425 13:12:57.839327355 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 4]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1999600)[0m   "architectures": [
[36m(WorkerDict pid=1999600)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1999600)[0m   ],
[36m(WorkerDict pid=1999600)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1999600)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1999600)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1999600)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1999600)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1999600)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1999600)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1999600)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1999600)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1999600)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1999600)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1999600)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1999600)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1999600)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1999600)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1999600)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1999600)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1999600)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1999600)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1999600)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1999600)[0m   "use_cache": true,
[36m(WorkerDict pid=1999600)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1999600)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1999600)[0m }
[36m(WorkerDict pid=1999600)[0m 
[36m(WorkerDict pid=1999600)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1999600)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1999600)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1999600)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f2661e228c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f2661e227a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2005912)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=2005912)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2005912)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005906)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fa18851a8c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fa18851a7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1999600)[0m Before building vllm rollout, memory allocated (GB): 3.570071220397949, memory reserved (GB): 17.36328125
[36m(WorkerDict pid=2005912)[0m WARNING 04-25 13:13:10 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=1999600)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1999600)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005912)[0m WARNING 04-25 13:13:11 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f2b981063e0>
[36m(WorkerDict pid=2005912)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2005903)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=1999600)[0m WARNING 04-25 13:13:12 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1999600)[0m WARNING 04-25 13:13:13 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f254cf547c0>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005919)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=1999600)[0m After building vllm rollout, memory allocated (GB): 20.051848888397217, memory reserved (GB): 20.453125
[36m(WorkerDict pid=1999600)[0m After building sharding manager, memory allocated (GB): 20.051848888397217, memory reserved (GB): 20.453125
[36m(TaskRunner pid=1996834)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=1996834)[0m Found checkpoint: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(TaskRunner pid=1996834)[0m Load from checkpoint folder: /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(TaskRunner pid=1996834)[0m Setting global step to 50
[36m(TaskRunner pid=1996834)[0m Resuming from /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=1999600)[0m [rank-0]: Loading from /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt and /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/optim_world_size_8_rank_0.pt and /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=2005916)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005906)[0m [rank-3]: Loading from /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_3.pt and /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/optim_world_size_8_rank_3.pt and /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1996834)[0m user
[36m(TaskRunner pid=1996834)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1996834)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m assistant
[36m(TaskRunner pid=1996834)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=2005916)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2005916)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1996834)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [01:02<1:24:47, 62.80s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [02:05<1:23:28, 62.60s/it]
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m [response] <æ€è€ƒ> è¯¥é¢˜æ¶‰åŠå…±åŒçŠ¯ç½ªçš„è®¤å®šä»¥åŠä¸åŒæ•…æ„åœ¨å…±åŒçŠ¯ç½ªä¸­çš„å¤„ç†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä¸¤äººçš„è¡Œä¸ºåœ¨å®¢è§‚ä¸Šæ˜¯ç›¸åŒçš„ï¼Œå³å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªçš„æ•…æ„åªè¦æ±‚åœ¨å…±åŒçŠ¯ç½ªè¡Œä¸ºçš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å³å¯ï¼Œè€Œä¸è¦æ±‚åœ¨çŠ¯ç½ªç›®çš„ä¸Šå®Œå…¨ä¸€è‡´ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1996834)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1996834)[0m [score] 2.0
[36m(TaskRunner pid=1996834)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1996834)[0m ("Initial validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(1.4951727451783923), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1996834)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(1.4951727451783923), '
[36m(TaskRunner pid=1996834)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(1.4951727451783923), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': "
[36m(TaskRunner pid=1996834)[0m  "np.float64(1.4951727401798391), 'val-aux/jec-qa-1-multi-choice/score/std@1': "
[36m(TaskRunner pid=1996834)[0m  "np.float64(0.0), 'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(1.4951727401798391), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(4.655265498428247e-17), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(1.4951727401798391), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=1996834)[0m  'np.float64(4.655265498428247e-17), '
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=1996834)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(TaskRunner pid=1996834)[0m step:50 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.495 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.495 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.495 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:51 - global_seqlen/min:46721.000 - global_seqlen/max:52844.000 - global_seqlen/minmax_diff:6123.000 - global_seqlen/balanced_min:50597.000 - global_seqlen/balanced_max:50598.000 - global_seqlen/mean:50597.500 - actor/entropy_loss:87.649 - actor/pg_loss:-0.151 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.063 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:45.228 - perf/max_memory_reserved_gb:59.486 - perf/cpu_memory_used_gb:40.118 - actor/lr:0.000 - critic/score/mean:1.477 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.477 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:218.995 - response_length/max:752.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.481 - timing_s/old_log_prob:5.760 - timing_s/adv:0.272 - timing_s/update_actor:34.837 - timing_s/step:62.374 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:404780.000 - perf/time_per_step:62.374 - perf/throughput:811.197
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:52 - global_seqlen/min:48168.000 - global_seqlen/max:57084.000 - global_seqlen/minmax_diff:8916.000 - global_seqlen/balanced_min:52317.000 - global_seqlen/balanced_max:52318.000 - global_seqlen/mean:52317.750 - actor/entropy_loss:84.422 - actor/pg_loss:-0.090 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.065 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:45.463 - perf/max_memory_reserved_gb:59.486 - perf/cpu_memory_used_gb:40.254 - actor/lr:0.000 - critic/score/mean:1.515 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.515 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:221.812 - response_length/max:656.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.164 - prompt_length/max:578.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.515 - timing_s/old_log_prob:5.633 - timing_s/adv:0.279 - timing_s/update_actor:35.965 - timing_s/step:62.412 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:418542.000 - perf/time_per_step:62.412 - perf/throughput:838.262
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 53/132 [03:07<1:22:00, 62.29s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 54/132 [04:09<1:20:59, 62.30s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 55/132 [05:08<1:18:35, 61.24s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [06:08<1:17:02, 60.82s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/132 [07:08<1:15:32, 60.44s/it]
[36m(TaskRunner pid=1996834)[0m step:53 - global_seqlen/min:47344.000 - global_seqlen/max:56223.000 - global_seqlen/minmax_diff:8879.000 - global_seqlen/balanced_min:50290.000 - global_seqlen/balanced_max:50291.000 - global_seqlen/mean:50290.500 - actor/entropy_loss:79.251 - actor/pg_loss:-0.109 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.931 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:45.463 - perf/max_memory_reserved_gb:59.486 - perf/cpu_memory_used_gb:40.262 - actor/lr:0.000 - critic/score/mean:1.509 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.509 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:214.945 - response_length/max:718.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.914 - prompt_length/max:542.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.642 - timing_s/old_log_prob:5.552 - timing_s/adv:0.281 - timing_s/update_actor:34.407 - timing_s/step:61.900 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:402324.000 - perf/time_per_step:61.900 - perf/throughput:812.448
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:54 - global_seqlen/min:46978.000 - global_seqlen/max:56217.000 - global_seqlen/minmax_diff:9239.000 - global_seqlen/balanced_min:51610.000 - global_seqlen/balanced_max:51610.000 - global_seqlen/mean:51610.000 - actor/entropy_loss:79.352 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.046 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.486 - perf/cpu_memory_used_gb:40.399 - actor/lr:0.000 - critic/score/mean:1.501 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.501 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:223.745 - response_length/max:685.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.859 - prompt_length/max:563.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.344 - timing_s/old_log_prob:5.698 - timing_s/adv:0.289 - timing_s/update_actor:34.935 - timing_s/step:62.288 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:412880.000 - perf/time_per_step:62.288 - perf/throughput:828.574
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:55 - global_seqlen/min:49626.000 - global_seqlen/max:53169.000 - global_seqlen/minmax_diff:3543.000 - global_seqlen/balanced_min:51516.000 - global_seqlen/balanced_max:51517.000 - global_seqlen/mean:51516.500 - actor/entropy_loss:77.498 - actor/pg_loss:0.114 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.824 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.224 - actor/lr:0.000 - critic/score/mean:1.499 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.499 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:220.966 - response_length/max:552.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.664 - prompt_length/max:615.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.856 - timing_s/old_log_prob:5.730 - timing_s/adv:0.279 - timing_s/update_actor:34.467 - timing_s/step:59.352 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:412132.000 - perf/time_per_step:59.352 - perf/throughput:867.979
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:56 - global_seqlen/min:47715.000 - global_seqlen/max:54506.000 - global_seqlen/minmax_diff:6791.000 - global_seqlen/balanced_min:50665.000 - global_seqlen/balanced_max:50665.000 - global_seqlen/mean:50665.000 - actor/entropy_loss:74.165 - actor/pg_loss:0.108 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.024 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.404 - actor/lr:0.000 - critic/score/mean:1.455 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.455 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:226.440 - response_length/max:545.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.320 - prompt_length/max:679.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.279 - timing_s/old_log_prob:5.530 - timing_s/adv:0.277 - timing_s/update_actor:34.870 - timing_s/step:59.979 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:405320.000 - perf/time_per_step:59.979 - perf/throughput:844.715
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:57 - global_seqlen/min:46825.000 - global_seqlen/max:52499.000 - global_seqlen/minmax_diff:5674.000 - global_seqlen/balanced_min:50081.000 - global_seqlen/balanced_max:50082.000 - global_seqlen/mean:50081.375 - actor/entropy_loss:66.820 - actor/pg_loss:-0.121 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.106 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.531 - actor/lr:0.000 - critic/score/mean:1.466 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.466 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.007 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:208.337 - response_length/max:528.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.344 - prompt_length/max:685.000 - prompt_length/min:234.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.874 - timing_s/old_log_prob:5.597 - timing_s/adv:0.275 - timing_s/update_actor:34.876 - timing_s/step:59.640 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:400651.000 - perf/time_per_step:59.640 - perf/throughput:839.733
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 58/132 [08:06<1:13:32, 59.62s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 59/132 [09:06<1:12:43, 59.77s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [12:23<2:02:42, 102.26s/it]
[36m(TaskRunner pid=1996834)[0m step:58 - global_seqlen/min:45835.000 - global_seqlen/max:53186.000 - global_seqlen/minmax_diff:7351.000 - global_seqlen/balanced_min:49409.000 - global_seqlen/balanced_max:49410.000 - global_seqlen/mean:49409.500 - actor/entropy_loss:65.236 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.923 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.404 - actor/lr:0.000 - critic/score/mean:1.492 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.492 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:204.370 - response_length/max:510.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.312 - prompt_length/max:540.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.280 - timing_s/old_log_prob:5.389 - timing_s/adv:0.276 - timing_s/update_actor:33.893 - timing_s/step:57.865 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:395276.000 - perf/time_per_step:57.865 - perf/throughput:853.874
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:59 - global_seqlen/min:43189.000 - global_seqlen/max:51674.000 - global_seqlen/minmax_diff:8485.000 - global_seqlen/balanced_min:48149.000 - global_seqlen/balanced_max:48150.000 - global_seqlen/mean:48149.125 - actor/entropy_loss:61.154 - actor/pg_loss:-0.111 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.899 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.364 - actor/lr:0.000 - critic/score/mean:1.515 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.515 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:196.014 - response_length/max:678.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.539 - prompt_length/max:585.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.684 - timing_s/old_log_prob:5.386 - timing_s/adv:0.275 - timing_s/update_actor:33.707 - timing_s/step:60.070 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:385193.000 - perf/time_per_step:60.070 - perf/throughput:801.556
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1996834)[0m user
[36m(TaskRunner pid=1996834)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1996834)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m assistant
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…ï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯BCDã€‚ç­”æ¡ˆæ˜¯{BCD}ã€‚ </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1996834)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1996834)[0m [score] 2.0
[36m(TaskRunner pid=1996834)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1996834)[0m step:60 - global_seqlen/min:46277.000 - global_seqlen/max:54688.000 - global_seqlen/minmax_diff:8411.000 - global_seqlen/balanced_min:51020.000 - global_seqlen/balanced_max:51217.000 - global_seqlen/mean:51045.000 - actor/entropy_loss:64.162 - actor/pg_loss:0.407 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.853 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.521 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.531 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.531 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.531 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.531 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.531 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.531 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.487 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.487 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-1.667 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-1.667 - response_length/mean:214.922 - response_length/max:1024.000 - response_length/min:51.000 - response_length/clip_ratio:0.001 - prompt_length/mean:316.797 - prompt_length/max:604.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.365 - timing_s/old_log_prob:5.710 - timing_s/adv:0.281 - timing_s/update_actor:35.524 - timing_s/testing:129.076 - timing_s/step:197.339 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:408360.000 - perf/time_per_step:197.339 - perf/throughput:258.666
[36m(TaskRunner pid=1996834)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/132 [13:22<1:45:09, 88.87s/it] 
[36m(TaskRunner pid=1996834)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 62/132 [14:21<1:33:03, 79.77s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 63/132 [15:20<1:24:38, 73.60s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [16:27<1:21:08, 71.60s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/132 [17:26<1:15:41, 67.78s/it]
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:61 - global_seqlen/min:42821.000 - global_seqlen/max:50369.000 - global_seqlen/minmax_diff:7548.000 - global_seqlen/balanced_min:48086.000 - global_seqlen/balanced_max:48087.000 - global_seqlen/mean:48086.875 - actor/entropy_loss:57.368 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.845 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.622 - actor/lr:0.000 - critic/score/mean:1.576 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.576 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:196.921 - response_length/max:585.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.984 - prompt_length/max:576.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.516 - timing_s/old_log_prob:5.335 - timing_s/adv:0.273 - timing_s/update_actor:34.338 - timing_s/step:58.485 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:384695.000 - perf/time_per_step:58.485 - perf/throughput:822.212
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:62 - global_seqlen/min:46531.000 - global_seqlen/max:55367.000 - global_seqlen/minmax_diff:8836.000 - global_seqlen/balanced_min:49581.000 - global_seqlen/balanced_max:49582.000 - global_seqlen/mean:49581.625 - actor/entropy_loss:60.608 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.048 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.646 - actor/lr:0.000 - critic/score/mean:1.486 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.486 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.850 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.850 - response_length/mean:202.366 - response_length/max:554.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.109 - prompt_length/max:640.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.683 - timing_s/old_log_prob:5.448 - timing_s/adv:0.274 - timing_s/update_actor:34.524 - timing_s/step:58.949 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:396653.000 - perf/time_per_step:58.949 - perf/throughput:841.092
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:63 - global_seqlen/min:44698.000 - global_seqlen/max:53414.000 - global_seqlen/minmax_diff:8716.000 - global_seqlen/balanced_min:49526.000 - global_seqlen/balanced_max:49527.000 - global_seqlen/mean:49526.125 - actor/entropy_loss:58.876 - actor/pg_loss:0.143 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.965 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:44.679 - actor/lr:0.000 - critic/score/mean:1.523 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.523 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:202.147 - response_length/max:608.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.750 - prompt_length/max:820.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.544 - timing_s/old_log_prob:5.575 - timing_s/adv:0.279 - timing_s/update_actor:33.968 - timing_s/step:59.389 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:396209.000 - perf/time_per_step:59.389 - perf/throughput:833.924
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:64 - global_seqlen/min:47143.000 - global_seqlen/max:54376.000 - global_seqlen/minmax_diff:7233.000 - global_seqlen/balanced_min:49638.000 - global_seqlen/balanced_max:49800.000 - global_seqlen/mean:49660.250 - actor/entropy_loss:57.270 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.813 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:59.908 - perf/cpu_memory_used_gb:40.676 - actor/lr:0.000 - critic/score/mean:1.499 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.499 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:205.177 - response_length/max:990.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.117 - prompt_length/max:518.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.173 - timing_s/old_log_prob:5.562 - timing_s/adv:0.275 - timing_s/update_actor:34.900 - timing_s/step:66.933 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.166 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:397282.000 - perf/time_per_step:66.933 - perf/throughput:741.940
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:65 - global_seqlen/min:46031.000 - global_seqlen/max:51682.000 - global_seqlen/minmax_diff:5651.000 - global_seqlen/balanced_min:48934.000 - global_seqlen/balanced_max:48934.000 - global_seqlen/mean:48934.000 - actor/entropy_loss:54.258 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.882 - perf/mfu/actor:0.360 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.096 - perf/cpu_memory_used_gb:40.697 - actor/lr:0.000 - critic/score/mean:1.547 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.547 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:201.432 - response_length/max:523.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.297 - prompt_length/max:492.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.350 - timing_s/old_log_prob:5.485 - timing_s/adv:0.275 - timing_s/update_actor:34.774 - timing_s/step:58.903 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:391472.000 - perf/time_per_step:58.903 - perf/throughput:830.758
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 66/132 [18:26<1:12:05, 65.53s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 67/132 [19:26<1:09:05, 63.78s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [20:25<1:06:25, 62.27s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/132 [21:25<1:04:50, 61.76s/it]
[36m(TaskRunner pid=1996834)[0m step:66 - global_seqlen/min:44655.000 - global_seqlen/max:51854.000 - global_seqlen/minmax_diff:7199.000 - global_seqlen/balanced_min:48640.000 - global_seqlen/balanced_max:48641.000 - global_seqlen/mean:48640.375 - actor/entropy_loss:50.674 - actor/pg_loss:-0.132 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.914 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.096 - perf/cpu_memory_used_gb:40.747 - actor/lr:0.000 - critic/score/mean:1.538 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.538 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:199.639 - response_length/max:645.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.031 - prompt_length/max:609.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.273 - timing_s/old_log_prob:5.393 - timing_s/adv:0.272 - timing_s/update_actor:34.339 - timing_s/step:60.296 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:389123.000 - perf/time_per_step:60.296 - perf/throughput:806.692
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:67 - global_seqlen/min:46036.000 - global_seqlen/max:52038.000 - global_seqlen/minmax_diff:6002.000 - global_seqlen/balanced_min:48984.000 - global_seqlen/balanced_max:48985.000 - global_seqlen/mean:48984.875 - actor/entropy_loss:48.444 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.775 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.096 - perf/cpu_memory_used_gb:40.945 - actor/lr:0.000 - critic/score/mean:1.519 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.519 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:201.587 - response_length/max:566.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.672 - prompt_length/max:576.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.231 - timing_s/old_log_prob:5.468 - timing_s/adv:0.272 - timing_s/update_actor:34.150 - timing_s/step:59.149 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:391879.000 - perf/time_per_step:59.149 - perf/throughput:828.163
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:68 - global_seqlen/min:44510.000 - global_seqlen/max:49351.000 - global_seqlen/minmax_diff:4841.000 - global_seqlen/balanced_min:47260.000 - global_seqlen/balanced_max:47261.000 - global_seqlen/mean:47260.625 - actor/entropy_loss:45.228 - actor/pg_loss:-0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.848 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.096 - perf/cpu_memory_used_gb:40.905 - actor/lr:0.000 - critic/score/mean:1.518 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.518 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:193.642 - response_length/max:637.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:298.656 - prompt_length/max:433.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.713 - timing_s/old_log_prob:5.299 - timing_s/adv:0.268 - timing_s/update_actor:33.448 - timing_s/step:58.748 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:378085.000 - perf/time_per_step:58.748 - perf/throughput:804.463
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:69 - global_seqlen/min:47099.000 - global_seqlen/max:51619.000 - global_seqlen/minmax_diff:4520.000 - global_seqlen/balanced_min:48385.000 - global_seqlen/balanced_max:48385.000 - global_seqlen/mean:48385.000 - actor/entropy_loss:45.591 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.712 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.096 - perf/cpu_memory_used_gb:40.587 - actor/lr:0.000 - critic/score/mean:1.558 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.558 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:190.839 - response_length/max:704.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.172 - prompt_length/max:614.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.817 - timing_s/old_log_prob:5.357 - timing_s/adv:0.270 - timing_s/update_actor:34.069 - timing_s/step:60.537 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:387080.000 - perf/time_per_step:60.537 - perf/throughput:799.259
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1996834)[0m user
[36m(TaskRunner pid=1996834)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1996834)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m assistant
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/132 [24:34<1:43:11, 99.87s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 71/132 [25:41<1:31:21, 89.85s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [26:38<1:20:02, 80.04s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 73/132 [27:37<1:12:29, 73.71s/it]
[36m(TaskRunner pid=1996834)[0m [response] <æ€è€ƒ> è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°å…±åŒçŠ¯ç½ªçš„è®¤å®šå’ŒçŠ¯ç½ªæ„æˆçš„ç†è§£ã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„è§„å®šï¼Œç”²æŸçš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ä½†æ˜¯ï¼Œç”±äºç”²ä¹™å…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Bæ˜¯æ­£ç¡®çš„ï¼Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œæ‰€ä»¥é€‰é¡¹Cå’ŒDæ˜¯æ­£ç¡®çš„ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1996834)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1996834)[0m [score] 2.0
[36m(TaskRunner pid=1996834)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1996834)[0m step:70 - global_seqlen/min:45036.000 - global_seqlen/max:49841.000 - global_seqlen/minmax_diff:4805.000 - global_seqlen/balanced_min:47641.000 - global_seqlen/balanced_max:47642.000 - global_seqlen/mean:47641.750 - actor/entropy_loss:46.848 - actor/pg_loss:-0.147 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.853 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.368 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.556 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.556 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.556 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.556 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.556 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.556 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.500 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.500 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:187.065 - response_length/max:659.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.203 - prompt_length/max:542.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.945 - timing_s/old_log_prob:5.203 - timing_s/adv:0.270 - timing_s/update_actor:33.613 - timing_s/testing:128.634 - timing_s/step:188.685 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:381134.000 - perf/time_per_step:188.685 - perf/throughput:252.493
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:71 - global_seqlen/min:45327.000 - global_seqlen/max:50514.000 - global_seqlen/minmax_diff:5187.000 - global_seqlen/balanced_min:47921.000 - global_seqlen/balanced_max:48098.000 - global_seqlen/mean:47943.125 - actor/entropy_loss:45.938 - actor/pg_loss:0.346 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.877 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.814 - actor/lr:0.000 - critic/score/mean:1.610 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.610 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-1.667 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-1.667 - response_length/mean:187.126 - response_length/max:1024.000 - response_length/min:61.000 - response_length/clip_ratio:0.001 - prompt_length/mean:312.281 - prompt_length/max:771.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.227 - timing_s/old_log_prob:5.285 - timing_s/adv:0.270 - timing_s/update_actor:33.679 - timing_s/step:66.484 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.189 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:383545.000 - perf/time_per_step:66.484 - perf/throughput:721.125
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:72 - global_seqlen/min:45181.000 - global_seqlen/max:52081.000 - global_seqlen/minmax_diff:6900.000 - global_seqlen/balanced_min:48264.000 - global_seqlen/balanced_max:48264.000 - global_seqlen/mean:48264.000 - actor/entropy_loss:49.137 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.764 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.920 - actor/lr:0.000 - critic/score/mean:1.596 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.596 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:192.008 - response_length/max:514.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.742 - prompt_length/max:480.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.822 - timing_s/old_log_prob:5.376 - timing_s/adv:0.272 - timing_s/update_actor:33.646 - timing_s/step:57.136 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:386112.000 - perf/time_per_step:57.136 - perf/throughput:844.726
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:73 - global_seqlen/min:44177.000 - global_seqlen/max:49128.000 - global_seqlen/minmax_diff:4951.000 - global_seqlen/balanced_min:47085.000 - global_seqlen/balanced_max:47086.000 - global_seqlen/mean:47085.375 - actor/entropy_loss:47.667 - actor/pg_loss:0.089 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.901 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.851 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.767 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.767 - critic/returns/min:-0.833 - response_length/mean:179.191 - response_length/max:649.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.281 - prompt_length/max:534.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.081 - timing_s/old_log_prob:5.255 - timing_s/adv:0.269 - timing_s/update_actor:33.318 - timing_s/step:58.945 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:376683.000 - perf/time_per_step:58.945 - perf/throughput:798.806
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 74/132 [28:34<1:06:28, 68.77s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 75/132 [29:33<1:02:27, 65.75s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [30:30<58:55, 63.13s/it]  
[36m(TaskRunner pid=1996834)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/132 [31:35<58:33, 63.88s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 78/132 [32:35<56:22, 62.63s/it]
[36m(TaskRunner pid=1996834)[0m step:74 - global_seqlen/min:45925.000 - global_seqlen/max:51192.000 - global_seqlen/minmax_diff:5267.000 - global_seqlen/balanced_min:47806.000 - global_seqlen/balanced_max:47807.000 - global_seqlen/mean:47806.125 - actor/entropy_loss:47.201 - actor/pg_loss:0.073 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.689 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.970 - actor/lr:0.000 - critic/score/mean:1.489 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.489 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:189.363 - response_length/max:490.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.617 - prompt_length/max:563.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.750 - timing_s/old_log_prob:5.311 - timing_s/adv:0.268 - timing_s/update_actor:33.854 - timing_s/step:57.203 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:382449.000 - perf/time_per_step:57.203 - perf/throughput:835.730
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:75 - global_seqlen/min:44132.000 - global_seqlen/max:50265.000 - global_seqlen/minmax_diff:6133.000 - global_seqlen/balanced_min:47620.000 - global_seqlen/balanced_max:47621.000 - global_seqlen/mean:47620.500 - actor/entropy_loss:48.812 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.886 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.863 - actor/lr:0.000 - critic/score/mean:1.576 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.576 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:183.227 - response_length/max:578.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.820 - prompt_length/max:679.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.724 - timing_s/old_log_prob:5.355 - timing_s/adv:0.288 - timing_s/update_actor:33.287 - timing_s/step:58.678 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:380964.000 - perf/time_per_step:58.678 - perf/throughput:811.560
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:76 - global_seqlen/min:45990.000 - global_seqlen/max:50531.000 - global_seqlen/minmax_diff:4541.000 - global_seqlen/balanced_min:48516.000 - global_seqlen/balanced_max:48517.000 - global_seqlen/mean:48516.500 - actor/entropy_loss:52.254 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.722 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.979 - actor/lr:0.000 - critic/score/mean:1.500 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.500 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.850 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.850 - response_length/mean:188.388 - response_length/max:435.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.992 - prompt_length/max:585.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.036 - timing_s/old_log_prob:5.555 - timing_s/adv:0.272 - timing_s/update_actor:34.102 - timing_s/step:56.987 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388132.000 - perf/time_per_step:56.987 - perf/throughput:851.367
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:77 - global_seqlen/min:46551.000 - global_seqlen/max:48927.000 - global_seqlen/minmax_diff:2376.000 - global_seqlen/balanced_min:47918.000 - global_seqlen/balanced_max:48023.000 - global_seqlen/mean:47944.250 - actor/entropy_loss:50.244 - actor/pg_loss:0.222 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.816 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.131 - perf/cpu_memory_used_gb:40.872 - actor/lr:0.000 - critic/score/mean:1.569 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.569 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:0.933 - critic/advantages/min:-1.667 - critic/returns/mean:-0.017 - critic/returns/max:0.933 - critic/returns/min:-1.667 - response_length/mean:194.021 - response_length/max:1024.000 - response_length/min:66.000 - response_length/clip_ratio:0.003 - prompt_length/mean:305.398 - prompt_length/max:532.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.222 - timing_s/old_log_prob:5.319 - timing_s/adv:0.271 - timing_s/update_actor:33.770 - timing_s/step:65.602 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.176 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:383554.000 - perf/time_per_step:65.602 - perf/throughput:730.837
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:78 - global_seqlen/min:45023.000 - global_seqlen/max:50232.000 - global_seqlen/minmax_diff:5209.000 - global_seqlen/balanced_min:47870.000 - global_seqlen/balanced_max:47871.000 - global_seqlen/mean:47870.875 - actor/entropy_loss:49.346 - actor/pg_loss:-0.152 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.852 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:41.024 - actor/lr:0.000 - critic/score/mean:1.604 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.604 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:187.319 - response_length/max:661.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.336 - prompt_length/max:546.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.515 - timing_s/old_log_prob:5.273 - timing_s/adv:0.272 - timing_s/update_actor:33.619 - timing_s/step:59.701 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:382967.000 - perf/time_per_step:59.701 - perf/throughput:801.838
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 79/132 [33:31<53:37, 60.70s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [36:42<1:26:31, 99.83s/it]
[36m(TaskRunner pid=1996834)[0m step:79 - global_seqlen/min:45486.000 - global_seqlen/max:50205.000 - global_seqlen/minmax_diff:4719.000 - global_seqlen/balanced_min:47787.000 - global_seqlen/balanced_max:47788.000 - global_seqlen/mean:47787.750 - actor/entropy_loss:49.709 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.771 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:40.999 - actor/lr:0.000 - critic/score/mean:1.574 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.574 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:188.617 - response_length/max:496.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.172 - prompt_length/max:495.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.589 - timing_s/old_log_prob:5.270 - timing_s/adv:0.271 - timing_s/update_actor:33.012 - timing_s/step:56.161 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:382302.000 - perf/time_per_step:56.161 - perf/throughput:850.903
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1996834)[0m user
[36m(TaskRunner pid=1996834)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1996834)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m assistant
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m [response] <æ€è€ƒ> è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°å…±åŒçŠ¯ç½ªçš„è®¤å®šå’ŒçŠ¯ç½ªæ•…æ„çš„é—®é¢˜ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ä½†æ˜¯é¢˜ç›®è¦æ±‚ç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1996834)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1996834)[0m [score] 2.0
[36m(TaskRunner pid=1996834)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1996834)[0m step:80 - global_seqlen/min:45258.000 - global_seqlen/max:52898.000 - global_seqlen/minmax_diff:7640.000 - global_seqlen/balanced_min:48624.000 - global_seqlen/balanced_max:48658.000 - global_seqlen/mean:48632.625 - actor/entropy_loss:51.283 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.844 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:40.918 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.557 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.557 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.557 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.557 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.557 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.557 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.572 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.572 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:189.754 - response_length/max:745.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.836 - prompt_length/max:561.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.616 - timing_s/old_log_prob:5.418 - timing_s/adv:0.273 - timing_s/update_actor:34.851 - timing_s/testing:128.932 - timing_s/step:191.112 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:389061.000 - perf/time_per_step:191.112 - perf/throughput:254.472
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 81/132 [37:41<1:14:12, 87.30s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/132 [38:39<1:05:33, 78.67s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/132 [39:36<58:51, 72.07s/it]  
[36m(TaskRunner pid=1996834)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 84/132 [40:34<54:22, 67.97s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/132 [41:32<50:54, 64.99s/it]
[36m(TaskRunner pid=1996834)[0m step:81 - global_seqlen/min:45584.000 - global_seqlen/max:51605.000 - global_seqlen/minmax_diff:6021.000 - global_seqlen/balanced_min:47881.000 - global_seqlen/balanced_max:47882.000 - global_seqlen/mean:47881.625 - actor/entropy_loss:47.377 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.639 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:40.980 - actor/lr:0.000 - critic/score/mean:1.553 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.553 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.001 - critic/advantages/max:0.817 - critic/advantages/min:-1.433 - critic/returns/mean:0.001 - critic/returns/max:0.817 - critic/returns/min:-1.433 - response_length/mean:186.579 - response_length/max:608.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.188 - prompt_length/max:566.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.887 - timing_s/old_log_prob:5.266 - timing_s/adv:0.267 - timing_s/update_actor:33.618 - timing_s/step:58.062 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:383053.000 - perf/time_per_step:58.062 - perf/throughput:824.657
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:82 - global_seqlen/min:43216.000 - global_seqlen/max:50987.000 - global_seqlen/minmax_diff:7771.000 - global_seqlen/balanced_min:47073.000 - global_seqlen/balanced_max:47074.000 - global_seqlen/mean:47073.625 - actor/entropy_loss:44.883 - actor/pg_loss:0.082 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.917 - perf/mfu/actor:0.354 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:41.072 - actor/lr:0.000 - critic/score/mean:1.548 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.548 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.917 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.917 - response_length/mean:184.342 - response_length/max:590.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.008 - prompt_length/max:505.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.841 - timing_s/old_log_prob:5.324 - timing_s/adv:0.295 - timing_s/update_actor:34.005 - timing_s/step:58.485 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:376589.000 - perf/time_per_step:58.485 - perf/throughput:804.881
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:83 - global_seqlen/min:44982.000 - global_seqlen/max:50477.000 - global_seqlen/minmax_diff:5495.000 - global_seqlen/balanced_min:47501.000 - global_seqlen/balanced_max:47502.000 - global_seqlen/mean:47501.750 - actor/entropy_loss:43.394 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.760 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:40.889 - actor/lr:0.000 - critic/score/mean:1.596 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.596 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:184.997 - response_length/max:465.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.812 - prompt_length/max:551.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.479 - timing_s/old_log_prob:5.296 - timing_s/adv:0.273 - timing_s/update_actor:33.537 - timing_s/step:56.603 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:380014.000 - perf/time_per_step:56.603 - perf/throughput:839.209
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:84 - global_seqlen/min:44962.000 - global_seqlen/max:52344.000 - global_seqlen/minmax_diff:7382.000 - global_seqlen/balanced_min:48699.000 - global_seqlen/balanced_max:48700.000 - global_seqlen/mean:48699.375 - actor/entropy_loss:43.525 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.734 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.180 - perf/cpu_memory_used_gb:40.806 - actor/lr:0.000 - critic/score/mean:1.600 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.600 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:191.855 - response_length/max:560.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.430 - prompt_length/max:502.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.762 - timing_s/old_log_prob:5.474 - timing_s/adv:0.285 - timing_s/update_actor:33.845 - timing_s/step:58.386 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:389595.000 - perf/time_per_step:58.386 - perf/throughput:834.090
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:85 - global_seqlen/min:44068.000 - global_seqlen/max:52448.000 - global_seqlen/minmax_diff:8380.000 - global_seqlen/balanced_min:48109.000 - global_seqlen/balanced_max:48110.000 - global_seqlen/mean:48109.625 - actor/entropy_loss:43.174 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.977 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.926 - actor/lr:0.000 - critic/score/mean:1.600 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.600 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.817 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.817 - critic/returns/min:-0.833 - response_length/mean:189.353 - response_length/max:493.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.789 - prompt_length/max:630.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.960 - timing_s/old_log_prob:5.402 - timing_s/adv:0.269 - timing_s/update_actor:34.388 - timing_s/step:58.038 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:384877.000 - perf/time_per_step:58.038 - perf/throughput:828.937
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 86/132 [42:30<48:05, 62.73s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 87/132 [43:27<45:56, 61.25s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [44:22<43:28, 59.28s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/132 [45:20<42:08, 58.79s/it]
[36m(TaskRunner pid=1996834)[0m step:86 - global_seqlen/min:47087.000 - global_seqlen/max:51442.000 - global_seqlen/minmax_diff:4355.000 - global_seqlen/balanced_min:49484.000 - global_seqlen/balanced_max:49485.000 - global_seqlen/mean:49484.875 - actor/entropy_loss:46.331 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.723 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.886 - actor/lr:0.000 - critic/score/mean:1.528 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.528 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:188.749 - response_length/max:539.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:326.719 - prompt_length/max:615.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.395 - timing_s/old_log_prob:5.449 - timing_s/adv:0.288 - timing_s/update_actor:33.273 - timing_s/step:57.429 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:395879.000 - perf/time_per_step:57.429 - perf/throughput:861.675
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:87 - global_seqlen/min:43799.000 - global_seqlen/max:50293.000 - global_seqlen/minmax_diff:6494.000 - global_seqlen/balanced_min:47640.000 - global_seqlen/balanced_max:47641.000 - global_seqlen/mean:47640.625 - actor/entropy_loss:43.144 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.766 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.934 - actor/lr:0.000 - critic/score/mean:1.515 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.515 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.750 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.750 - response_length/mean:178.194 - response_length/max:550.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:318.062 - prompt_length/max:522.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.210 - timing_s/old_log_prob:5.311 - timing_s/adv:0.272 - timing_s/update_actor:33.956 - timing_s/step:57.774 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:381125.000 - perf/time_per_step:57.774 - perf/throughput:824.605
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:88 - global_seqlen/min:43570.000 - global_seqlen/max:49294.000 - global_seqlen/minmax_diff:5724.000 - global_seqlen/balanced_min:46229.000 - global_seqlen/balanced_max:46230.000 - global_seqlen/mean:46229.500 - actor/entropy_loss:41.374 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.785 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.951 - actor/lr:0.000 - critic/score/mean:1.615 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.615 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:169.526 - response_length/max:433.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.031 - prompt_length/max:593.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.233 - timing_s/old_log_prob:5.200 - timing_s/adv:0.265 - timing_s/update_actor:32.960 - timing_s/step:54.678 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:369836.000 - perf/time_per_step:54.678 - perf/throughput:845.481
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:89 - global_seqlen/min:42583.000 - global_seqlen/max:50089.000 - global_seqlen/minmax_diff:7506.000 - global_seqlen/balanced_min:46303.000 - global_seqlen/balanced_max:46304.000 - global_seqlen/mean:46303.875 - actor/entropy_loss:39.918 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.782 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:41.000 - actor/lr:0.000 - critic/score/mean:1.616 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.616 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:176.355 - response_length/max:621.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:529.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.177 - timing_s/old_log_prob:5.096 - timing_s/adv:0.274 - timing_s/update_actor:33.062 - timing_s/step:57.629 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:370431.000 - perf/time_per_step:57.629 - perf/throughput:803.487
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1996834)[0m user
[36m(TaskRunner pid=1996834)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1996834)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1996834)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1996834)[0m assistant
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 90/132 [48:24<1:07:28, 96.39s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 91/132 [49:19<57:24, 84.02s/it]  
[36m(TaskRunner pid=1996834)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [50:18<50:56, 76.42s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 93/132 [51:15<45:56, 70.67s/it]
[36m(TaskRunner pid=1996834)[0m [response] <æ€è€ƒ> è¿™ä¸ªé—®é¢˜æ¶‰åŠåˆ°å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚ç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠåˆ°å›½å®¶ç§˜å¯†çš„è·å–ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºç›®æ ‡ç›¸åŒï¼Œå¯ä»¥åœ¨å…±åŒçŠ¯ç½ªçš„èŒƒå›´å†…è®¤å®šä¸ºå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥æ­£ç¡®ç­”æ¡ˆæ˜¯Bã€Cã€Dã€‚ä½†æ˜¯é¢˜ç›®è¦æ±‚ç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œæ‰€ä»¥ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1996834)[0m 
[36m(TaskRunner pid=1996834)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1996834)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1996834)[0m [score] 2.0
[36m(TaskRunner pid=1996834)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1996834)[0m step:90 - global_seqlen/min:43193.000 - global_seqlen/max:49206.000 - global_seqlen/minmax_diff:6013.000 - global_seqlen/balanced_min:45878.000 - global_seqlen/balanced_max:45879.000 - global_seqlen/mean:45878.750 - actor/entropy_loss:36.283 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.613 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.989 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.563 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.563 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.563 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.563 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.563 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.563 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:160.513 - response_length/max:524.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.391 - prompt_length/max:647.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.408 - timing_s/old_log_prob:5.124 - timing_s/adv:0.272 - timing_s/update_actor:32.722 - timing_s/testing:128.559 - timing_s/step:184.105 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:367030.000 - perf/time_per_step:184.105 - perf/throughput:249.199
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:91 - global_seqlen/min:40638.000 - global_seqlen/max:48593.000 - global_seqlen/minmax_diff:7955.000 - global_seqlen/balanced_min:44598.000 - global_seqlen/balanced_max:44599.000 - global_seqlen/mean:44598.125 - actor/entropy_loss:38.369 - actor/pg_loss:0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.698 - perf/mfu/actor:0.348 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.917 - actor/lr:0.000 - critic/score/mean:1.589 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.589 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:160.548 - response_length/max:504.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:536.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.055 - timing_s/old_log_prob:4.979 - timing_s/adv:0.262 - timing_s/update_actor:32.799 - timing_s/step:55.123 - timing_per_token_ms/update_actor:0.092 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:356785.000 - perf/time_per_step:55.123 - perf/throughput:809.066
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:92 - global_seqlen/min:44411.000 - global_seqlen/max:50086.000 - global_seqlen/minmax_diff:5675.000 - global_seqlen/balanced_min:47810.000 - global_seqlen/balanced_max:47811.000 - global_seqlen/mean:47810.375 - actor/entropy_loss:40.274 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.734 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.917 - actor/lr:0.000 - critic/score/mean:1.537 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.537 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:178.025 - response_length/max:626.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.000 - prompt_length/max:798.000 - prompt_length/min:236.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.516 - timing_s/old_log_prob:5.291 - timing_s/adv:0.279 - timing_s/update_actor:33.539 - timing_s/step:58.654 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:382483.000 - perf/time_per_step:58.654 - perf/throughput:815.125
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:93 - global_seqlen/min:43493.000 - global_seqlen/max:49616.000 - global_seqlen/minmax_diff:6123.000 - global_seqlen/balanced_min:47316.000 - global_seqlen/balanced_max:47317.000 - global_seqlen/mean:47316.625 - actor/entropy_loss:42.282 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.887 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:41.029 - actor/lr:0.000 - critic/score/mean:1.535 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.535 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:175.522 - response_length/max:542.000 - response_length/min:50.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.359 - prompt_length/max:522.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.126 - timing_s/old_log_prob:5.372 - timing_s/adv:0.274 - timing_s/update_actor:33.435 - timing_s/step:57.232 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:378533.000 - perf/time_per_step:57.232 - perf/throughput:826.744
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 94/132 [52:09<41:36, 65.70s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/132 [53:06<38:54, 63.10s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 96/132 [54:01<36:22, 60.62s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 97/132 [54:58<34:43, 59.52s/it]
[36m(TaskRunner pid=1996834)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 98/132 [55:56<33:31, 59.17s/it]
[36m(TaskRunner pid=1996834)[0m step:94 - global_seqlen/min:43304.000 - global_seqlen/max:48808.000 - global_seqlen/minmax_diff:5504.000 - global_seqlen/balanced_min:45821.000 - global_seqlen/balanced_max:45822.000 - global_seqlen/mean:45821.750 - actor/entropy_loss:39.761 - actor/pg_loss:0.080 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.565 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.922 - actor/lr:0.000 - critic/score/mean:1.590 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.590 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:162.451 - response_length/max:426.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.859 - prompt_length/max:798.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:15.926 - timing_s/old_log_prob:5.127 - timing_s/adv:0.271 - timing_s/update_actor:32.739 - timing_s/step:54.092 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:366574.000 - perf/time_per_step:54.092 - perf/throughput:847.115
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:95 - global_seqlen/min:41365.000 - global_seqlen/max:50756.000 - global_seqlen/minmax_diff:9391.000 - global_seqlen/balanced_min:46488.000 - global_seqlen/balanced_max:46489.000 - global_seqlen/mean:46488.375 - actor/entropy_loss:41.395 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.478 - perf/mfu/actor:0.360 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.988 - actor/lr:0.000 - critic/score/mean:1.574 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.574 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.800 - critic/advantages/min:-0.750 - critic/returns/mean:0.004 - critic/returns/max:0.800 - critic/returns/min:-0.750 - response_length/mean:176.660 - response_length/max:576.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.594 - prompt_length/max:507.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.511 - timing_s/old_log_prob:5.158 - timing_s/adv:0.267 - timing_s/update_actor:33.044 - timing_s/step:57.001 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:371907.000 - perf/time_per_step:57.001 - perf/throughput:815.577
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:96 - global_seqlen/min:43506.000 - global_seqlen/max:48333.000 - global_seqlen/minmax_diff:4827.000 - global_seqlen/balanced_min:45929.000 - global_seqlen/balanced_max:45930.000 - global_seqlen/mean:45929.625 - actor/entropy_loss:39.432 - actor/pg_loss:0.076 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.781 - perf/mfu/actor:0.355 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.871 - actor/lr:0.000 - critic/score/mean:1.539 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.539 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.783 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.783 - critic/returns/min:-0.833 - response_length/mean:165.363 - response_length/max:440.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.070 - prompt_length/max:583.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.273 - timing_s/old_log_prob:5.201 - timing_s/adv:0.267 - timing_s/update_actor:33.076 - timing_s/step:54.836 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:367437.000 - perf/time_per_step:54.836 - perf/throughput:837.577
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:97 - global_seqlen/min:46209.000 - global_seqlen/max:48864.000 - global_seqlen/minmax_diff:2655.000 - global_seqlen/balanced_min:47087.000 - global_seqlen/balanced_max:47088.000 - global_seqlen/mean:47087.875 - actor/entropy_loss:39.193 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.884 - perf/mfu/actor:0.354 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.925 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:171.288 - response_length/max:512.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.211 - prompt_length/max:820.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.326 - timing_s/old_log_prob:5.238 - timing_s/adv:0.269 - timing_s/update_actor:34.080 - timing_s/step:56.933 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:376703.000 - perf/time_per_step:56.933 - perf/throughput:827.071
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m step:98 - global_seqlen/min:45490.000 - global_seqlen/max:53059.000 - global_seqlen/minmax_diff:7569.000 - global_seqlen/balanced_min:48583.000 - global_seqlen/balanced_max:48584.000 - global_seqlen/mean:48583.375 - actor/entropy_loss:42.903 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.695 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.893 - actor/lr:0.000 - critic/score/mean:1.585 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.585 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:192.132 - response_length/max:534.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.945 - prompt_length/max:552.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.326 - timing_s/old_log_prob:5.452 - timing_s/adv:0.292 - timing_s/update_actor:34.224 - timing_s/step:58.314 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388667.000 - perf/time_per_step:58.314 - perf/throughput:833.134
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 99/132 [56:53<32:12, 58.55s/it]
[36m(TaskRunner pid=1996834)[0m step:99 - global_seqlen/min:43159.000 - global_seqlen/max:51124.000 - global_seqlen/minmax_diff:7965.000 - global_seqlen/balanced_min:46893.000 - global_seqlen/balanced_max:46894.000 - global_seqlen/mean:46893.250 - actor/entropy_loss:40.233 - actor/pg_loss:0.036 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.653 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:46.323 - perf/max_memory_reserved_gb:60.234 - perf/cpu_memory_used_gb:40.872 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:178.760 - response_length/max:510.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.711 - prompt_length/max:590.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.976 - timing_s/old_log_prob:5.383 - timing_s/adv:0.271 - timing_s/update_actor:33.418 - timing_s/step:57.067 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:375146.000 - perf/time_per_step:57.067 - perf/throughput:821.716
[36m(TaskRunner pid=1996834)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1996834)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1996834)[0m validation generation end
[36m(TaskRunner pid=1996834)[0m [prompt] system
[36m(TaskRunner pid=1996834)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è