2025-04-24 07:01:36,991	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=2024902)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=2024902)[0m                                                              'optimizer',
[36m(TaskRunner pid=2024902)[0m                                                              'extra']},
[36m(TaskRunner pid=2024902)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=2024902)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=2024902)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=2024902)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=2024902)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=2024902)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2024902)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=2024902)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=2024902)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2024902)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=2024902)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=2024902)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=2024902)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=2024902)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=2024902)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=2024902)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2024902)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=2024902)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=2024902)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=2024902)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=2024902)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=2024902)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2024902)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m                                  'ppo_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=2024902)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2024902)[0m                                  'shuffle': False,
[36m(TaskRunner pid=2024902)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=2024902)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2024902)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=2024902)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=2024902)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=2024902)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=2024902)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2024902)[0m                                  'external_lib': None,
[36m(TaskRunner pid=2024902)[0m                                  'override_config': {},
[36m(TaskRunner pid=2024902)[0m                                  'path': '/home/wangyc/verl/Qwen/Qwen2___5-7B-Instruct',
[36m(TaskRunner pid=2024902)[0m                                  'use_liger': False,
[36m(TaskRunner pid=2024902)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=2024902)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=2024902)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2024902)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2024902)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=2024902)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2024902)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=2024902)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=2024902)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=2024902)[0m                                    'do_sample': True,
[36m(TaskRunner pid=2024902)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=2024902)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=2024902)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=2024902)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=2024902)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=2024902)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=2024902)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=2024902)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=2024902)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=2024902)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=2024902)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=2024902)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=2024902)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=2024902)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=2024902)[0m                                    'n': 6,
[36m(TaskRunner pid=2024902)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=2024902)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=2024902)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=2024902)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=2024902)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=2024902)[0m                                    'top_k': -1,
[36m(TaskRunner pid=2024902)[0m                                    'top_p': 1,
[36m(TaskRunner pid=2024902)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=2024902)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=2024902)[0m                                                   'n': 1,
[36m(TaskRunner pid=2024902)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=2024902)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=2024902)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=2024902)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=2024902)[0m                'gamma': 1.0,
[36m(TaskRunner pid=2024902)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=2024902)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=2024902)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=2024902)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=2024902)[0m WARNING:2025-04-24 07:01:47,720:Waiting for register center actor B9DyLO_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=2033806)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=2033806)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=2033808)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 64.02it/s]
[36m(WorkerDict pid=2033806)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 64.40it/s]
[36m(TaskRunner pid=2024902)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=2024902)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=2024902)[0m                'lam': 1.0,
[36m(TaskRunner pid=2024902)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=2024902)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=2024902)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=2024902)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=2024902)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2024902)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2024902)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=2024902)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=2024902)[0m                       'external_lib': None,
[36m(TaskRunner pid=2024902)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2024902)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=2024902)[0m                                       'param_offload': False,
[36m(TaskRunner pid=2024902)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2024902)[0m                       'override_config': {},
[36m(TaskRunner pid=2024902)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=2024902)[0m                       'tokenizer_path': '/home/wangyc/verl/Qwen/Qwen2___5-7B-Instruct',
[36m(TaskRunner pid=2024902)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=2024902)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=2024902)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=2024902)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=2024902)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=2024902)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=2024902)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=2024902)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=2024902)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2024902)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2024902)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=2024902)[0m             'rollout_n': 6,
[36m(TaskRunner pid=2024902)[0m             'shuffle': False,
[36m(TaskRunner pid=2024902)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=2024902)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2024902)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=2024902)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=2024902)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=2024902)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=2024902)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=2024902)[0m           'image_key': 'images',
[36m(TaskRunner pid=2024902)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=2024902)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=2024902)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=2024902)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=2024902)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=2024902)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=2024902)[0m           'shuffle': True,
[36m(TaskRunner pid=2024902)[0m           'tokenizer': None,
[36m(TaskRunner pid=2024902)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=2024902)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=2024902)[0m           'truncation': 'error',
[36m(TaskRunner pid=2024902)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=2024902)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=2024902)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=2024902)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=2024902)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=2024902)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=2024902)[0m                   'max_length': None,
[36m(TaskRunner pid=2024902)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=2024902)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=2024902)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=2024902)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=2024902)[0m                                             'param_offload': False,
[36m(TaskRunner pid=2024902)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=2024902)[0m                             'input_tokenizer': '/home/wangyc/verl/Qwen/Qwen2___5-7B-Instruct',
[36m(TaskRunner pid=2024902)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=2024902)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=2024902)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=2024902)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=2024902)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=2024902)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=2024902)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=2024902)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=2024902)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=2024902)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=2024902)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=2024902)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=2024902)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=2024902)[0m              'logger': ['console'],
[36m(TaskRunner pid=2024902)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=2024902)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=2024902)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=2024902)[0m              'nnodes': 1,
[36m(TaskRunner pid=2024902)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=2024902)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=2024902)[0m              'resume_from_path': None,
[36m(TaskRunner pid=2024902)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=2024902)[0m              'save_freq': 50,
[36m(TaskRunner pid=2024902)[0m              'test_freq': 10,
[36m(TaskRunner pid=2024902)[0m              'total_epochs': 2,
[36m(TaskRunner pid=2024902)[0m              'total_training_steps': None,
[36m(TaskRunner pid=2024902)[0m              'val_before_train': True}}
[36m(TaskRunner pid=2024902)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=2024902)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=2024902)[0m dataset len: 8448
[36m(TaskRunner pid=2024902)[0m dataset len: 2113
[36m(TaskRunner pid=2024902)[0m Size of train dataloader: 66
[36m(TaskRunner pid=2024902)[0m Total training steps: 132
[36m(WorkerDict pid=2033806)[0m [rank6]:[W424 07:02:02.397318931 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 6]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=2027883)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=2033804)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=2033805)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 65.91it/s][32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 46.88it/s][32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=2033804)[0m [rank4]:[W424 07:02:03.700108208 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 4]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:09,  3.26s/it]
[36m(WorkerDict pid=2033805)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033805)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.16s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.10s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.13s/it]
[36m(WorkerDict pid=2033804)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=2033804)[0m   warnings.warn(
[36m(WorkerDict pid=2033803)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.50s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033803)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.37s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.42s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033806)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2027883)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2027883)[0m   "architectures": [
[36m(WorkerDict pid=2027883)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2027883)[0m   ],
[36m(WorkerDict pid=2027883)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2027883)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2027883)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2027883)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=2027883)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2027883)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=2027883)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2027883)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=2027883)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2027883)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=2027883)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=2027883)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=2027883)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2027883)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2027883)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2027883)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2027883)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=2027883)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=2027883)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2027883)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=2027883)[0m   "use_cache": true,
[36m(WorkerDict pid=2027883)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2027883)[0m   "vocab_size": 152064
[36m(WorkerDict pid=2027883)[0m }
[36m(WorkerDict pid=2027883)[0m 
[36m(WorkerDict pid=2027883)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2027883)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=2027883)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f76d5bf5990>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f76d5bf5870>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=2033801)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2033804)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=2027883)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=2027883)[0m   "architectures": [
[36m(WorkerDict pid=2027883)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=2027883)[0m   ],
[36m(WorkerDict pid=2027883)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=2027883)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=2027883)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=2027883)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=2027883)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=2027883)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=2027883)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=2027883)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=2027883)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=2027883)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=2027883)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=2027883)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=2027883)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=2027883)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=2027883)[0m   "rope_scaling": null,
[36m(WorkerDict pid=2027883)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=2027883)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=2027883)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=2027883)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=2027883)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=2027883)[0m   "use_cache": true,
[36m(WorkerDict pid=2027883)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=2027883)[0m   "vocab_size": 152064
[36m(WorkerDict pid=2027883)[0m }
[36m(WorkerDict pid=2027883)[0m 
[36m(WorkerDict pid=2033801)[0m wrap_policy: functools.partial(<function _or_policy at 0x7efb499fd990>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7efb499fd870>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033804)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2033801)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=2027883)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=2033806)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=2033801)[0m wrap_policy: functools.partial(<function _or_policy at 0x7efb499fd990>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7efb499fd870>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=2033806)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2033803)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2033800)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=2027883)[0m Before building vllm rollout, memory allocated (GB): 3.5471720695495605, memory reserved (GB): 19.66015625
[36m(WorkerDict pid=2033804)[0m WARNING 04-24 07:02:35 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=2027883)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2027883)[0m Actor use_remove_padding=True[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=2033804)[0m WARNING 04-24 07:02:36 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f692c326a40>
[36m(WorkerDict pid=2033806)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=2033804)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=2027883)[0m WARNING 04-24 07:02:36 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2027883)[0m WARNING 04-24 07:02:37 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f75dc42b760>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=2024902)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=2024902)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=2024902)[0m Training from scratch
[36m(WorkerDict pid=2027883)[0m After building vllm rollout, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(WorkerDict pid=2027883)[0m After building sharding manager, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(TaskRunner pid=2024902)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=2033803)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033803)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2024902)[0m Training Progress:   1%|          | 1/132 [01:19<2:53:14, 79.35s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   2%|â–         | 2/132 [02:35<2:47:16, 77.20s/it]
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=2033803)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æœ¬é¢˜è€ƒæŸ¥å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†éƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¹™çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚å› æ­¤ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> é€‰é¡¹Bã€Cã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚{BCD}
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 1.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 0.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m ("Initial validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2024902)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(0.9557501114040994), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': "
[36m(TaskRunner pid=2024902)[0m  "np.float64(0.9557501183151916), 'val-aux/jec-qa-1-multi-choice/score/std@1': "
[36m(TaskRunner pid=2024902)[0m  "np.float64(0.0), 'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(0.9557501183151917), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(9.470785621802389e-17), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(0.9557501183151917), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(9.470785621802389e-17), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(TaskRunner pid=2024902)[0m step:0 - val-core/jec-qa-1-multi-choice/reward/mean@1:0.956 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:0.956 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.956 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.956 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:1 - global_seqlen/min:57077.000 - global_seqlen/max:61927.000 - global_seqlen/minmax_diff:4850.000 - global_seqlen/balanced_min:59187.000 - global_seqlen/balanced_max:59188.000 - global_seqlen/mean:59187.375 - actor/entropy_loss:1.193 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.048 - perf/mfu/actor:0.408 - perf/max_memory_allocated_gb:42.564 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:44.783 - actor/lr:0.000 - critic/score/mean:0.861 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.861 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:312.270 - response_length/max:834.000 - response_length/min:103.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.593 - timing_s/old_log_prob:6.602 - timing_s/ref:10.140 - timing_s/adv:0.329 - timing_s/update_actor:37.269 - timing_s/step:78.953 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.021 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:473499.000 - perf/time_per_step:78.953 - perf/throughput:749.657
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:   2%|â–         | 3/132 [03:52<2:46:11, 77.30s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   3%|â–         | 4/132 [05:08<2:43:56, 76.85s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   4%|â–         | 5/132 [06:28<2:44:43, 77.82s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   5%|â–         | 6/132 [07:42<2:40:58, 76.66s/it]
[36m(TaskRunner pid=2024902)[0m step:2 - global_seqlen/min:57249.000 - global_seqlen/max:63404.000 - global_seqlen/minmax_diff:6155.000 - global_seqlen/balanced_min:59924.000 - global_seqlen/balanced_max:59924.000 - global_seqlen/mean:59924.000 - actor/entropy_loss:1.211 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.785 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:44.920 - actor/lr:0.000 - critic/score/mean:0.872 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.872 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:319.029 - response_length/max:721.000 - response_length/min:119.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.759 - timing_s/old_log_prob:6.403 - timing_s/ref:6.574 - timing_s/adv:0.342 - timing_s/update_actor:38.538 - timing_s/step:75.640 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:479392.000 - perf/time_per_step:75.640 - perf/throughput:792.231
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:3 - global_seqlen/min:57478.000 - global_seqlen/max:60779.000 - global_seqlen/minmax_diff:3301.000 - global_seqlen/balanced_min:59102.000 - global_seqlen/balanced_max:59103.000 - global_seqlen/mean:59102.250 - actor/entropy_loss:1.145 - actor/kl_loss:0.005 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.886 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.582 - perf/cpu_memory_used_gb:45.003 - actor/lr:0.000 - critic/score/mean:1.135 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.135 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.019 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:313.234 - response_length/max:858.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.502 - timing_s/old_log_prob:6.405 - timing_s/ref:6.491 - timing_s/adv:0.318 - timing_s/update_actor:38.657 - timing_s/step:77.395 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:472818.000 - perf/time_per_step:77.395 - perf/throughput:763.648
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:4 - global_seqlen/min:55738.000 - global_seqlen/max:60942.000 - global_seqlen/minmax_diff:5204.000 - global_seqlen/balanced_min:58382.000 - global_seqlen/balanced_max:58383.000 - global_seqlen/mean:58382.875 - actor/entropy_loss:1.172 - actor/kl_loss:0.009 - actor/kl_coef:0.001 - actor/pg_loss:-0.046 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.002 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.582 - perf/cpu_memory_used_gb:45.202 - actor/lr:0.000 - critic/score/mean:1.301 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.301 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:302.522 - response_length/max:762.000 - response_length/min:108.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.633 - prompt_length/max:513.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.957 - timing_s/old_log_prob:6.471 - timing_s/ref:6.592 - timing_s/adv:0.316 - timing_s/update_actor:38.792 - timing_s/step:76.146 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:467063.000 - perf/time_per_step:76.146 - perf/throughput:766.720
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:5 - global_seqlen/min:55531.000 - global_seqlen/max:62688.000 - global_seqlen/minmax_diff:7157.000 - global_seqlen/balanced_min:59342.000 - global_seqlen/balanced_max:59346.000 - global_seqlen/mean:59343.000 - actor/entropy_loss:1.093 - actor/kl_loss:0.012 - actor/kl_coef:0.001 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.735 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.596 - perf/cpu_memory_used_gb:45.124 - actor/lr:0.000 - critic/score/mean:1.350 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.350 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:309.992 - response_length/max:1024.000 - response_length/min:113.000 - response_length/clip_ratio:0.001 - prompt_length/mean:308.164 - prompt_length/max:499.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.273 - timing_s/old_log_prob:6.512 - timing_s/ref:6.636 - timing_s/adv:0.327 - timing_s/update_actor:37.753 - timing_s/step:79.523 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:474744.000 - perf/time_per_step:79.523 - perf/throughput:746.237
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:6 - global_seqlen/min:56755.000 - global_seqlen/max:60494.000 - global_seqlen/minmax_diff:3739.000 - global_seqlen/balanced_min:58566.000 - global_seqlen/balanced_max:58567.000 - global_seqlen/mean:58566.625 - actor/entropy_loss:1.090 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:0.060 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.687 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.596 - perf/cpu_memory_used_gb:45.088 - actor/lr:0.000 - critic/score/mean:1.387 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.387 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:297.757 - response_length/max:685.000 - response_length/min:102.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.312 - prompt_length/max:547.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.536 - timing_s/old_log_prob:6.463 - timing_s/ref:6.580 - timing_s/adv:0.318 - timing_s/update_actor:38.462 - timing_s/step:74.384 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:468533.000 - perf/time_per_step:74.384 - perf/throughput:787.355
[36m(TaskRunner pid=2024902)[0m Training Progress:   5%|â–Œ         | 7/132 [08:56<2:38:06, 75.89s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   6%|â–Œ         | 8/132 [10:07<2:33:06, 74.08s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   7%|â–‹         | 9/132 [11:19<2:30:34, 73.45s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:7 - global_seqlen/min:54935.000 - global_seqlen/max:61177.000 - global_seqlen/minmax_diff:6242.000 - global_seqlen/balanced_min:57917.000 - global_seqlen/balanced_max:57918.000 - global_seqlen/mean:57917.500 - actor/entropy_loss:1.071 - actor/kl_loss:0.010 - actor/kl_coef:0.001 - actor/pg_loss:-0.067 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.726 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.596 - perf/cpu_memory_used_gb:45.230 - actor/lr:0.000 - critic/score/mean:1.393 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.393 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:293.339 - response_length/max:724.000 - response_length/min:118.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.969 - prompt_length/max:505.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.039 - timing_s/old_log_prob:6.337 - timing_s/ref:6.475 - timing_s/adv:0.317 - timing_s/update_actor:38.094 - timing_s/step:74.292 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:463340.000 - perf/time_per_step:74.292 - perf/throughput:779.589
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:8 - global_seqlen/min:55009.000 - global_seqlen/max:58550.000 - global_seqlen/minmax_diff:3541.000 - global_seqlen/balanced_min:56113.000 - global_seqlen/balanced_max:56113.000 - global_seqlen/mean:56113.000 - actor/entropy_loss:1.043 - actor/kl_loss:0.014 - actor/kl_coef:0.001 - actor/pg_loss:0.030 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.688 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.214 - actor/lr:0.000 - critic/score/mean:1.392 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.392 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.017 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.870 - response_length/max:597.000 - response_length/min:99.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:446.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.789 - timing_s/old_log_prob:6.146 - timing_s/ref:6.317 - timing_s/adv:0.296 - timing_s/update_actor:36.625 - timing_s/step:70.196 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:448904.000 - perf/time_per_step:70.196 - perf/throughput:799.378
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:9 - global_seqlen/min:52489.000 - global_seqlen/max:59770.000 - global_seqlen/minmax_diff:7281.000 - global_seqlen/balanced_min:57147.000 - global_seqlen/balanced_max:57148.000 - global_seqlen/mean:57147.875 - actor/entropy_loss:1.007 - actor/kl_loss:0.018 - actor/kl_coef:0.001 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.679 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.249 - actor/lr:0.000 - critic/score/mean:1.417 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.417 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:279.939 - response_length/max:698.000 - response_length/min:95.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.352 - prompt_length/max:514.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.910 - timing_s/old_log_prob:6.263 - timing_s/ref:6.429 - timing_s/adv:0.311 - timing_s/update_actor:37.100 - timing_s/step:72.031 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:457183.000 - perf/time_per_step:72.031 - perf/throughput:793.375
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ˜¯ä¸ºäº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ã€‚å› æ­¤ï¼Œä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚åŒæ—¶ï¼Œç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™ç¬¦åˆç‰¹å®šç½ªåçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤å¯¹ç”²åº”ä»¥ç‰¹å®šç½ªåè®ºå¤„ã€‚ä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œè¿™ä¹Ÿç¬¦åˆç‰¹å®šç½ªåçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤å¯¹ä¹™åº”ä»¥ç‰¹å®šç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚é€‰é¡¹Aæ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºç”²ä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m Training Progress:   8%|â–Š         | 10/132 [14:47<3:54:17, 115.22s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   8%|â–Š         | 11/132 [15:59<3:25:20, 101.82s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:   9%|â–‰         | 12/132 [17:11<3:05:28, 92.74s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  10%|â–‰         | 13/132 [18:21<2:50:07, 85.77s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  11%|â–ˆ         | 14/132 [19:30<2:39:16, 80.99s/it]
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:10 - global_seqlen/min:55353.000 - global_seqlen/max:63100.000 - global_seqlen/minmax_diff:7747.000 - global_seqlen/balanced_min:57822.000 - global_seqlen/balanced_max:57822.000 - global_seqlen/mean:57822.000 - actor/entropy_loss:1.016 - actor/kl_loss:0.027 - actor/kl_coef:0.001 - actor/pg_loss:0.054 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.755 - perf/mfu/actor:0.403 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.368 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.442 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.442 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.442 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.442 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.442 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.442 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.346 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.346 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:282.672 - response_length/max:566.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.641 - prompt_length/max:640.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.930 - timing_s/old_log_prob:6.251 - timing_s/ref:6.424 - timing_s/adv:0.323 - timing_s/update_actor:36.865 - timing_s/testing:137.591 - timing_s/step:208.714 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:462576.000 - perf/time_per_step:208.714 - perf/throughput:277.039
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:11 - global_seqlen/min:54001.000 - global_seqlen/max:62369.000 - global_seqlen/minmax_diff:8368.000 - global_seqlen/balanced_min:57480.000 - global_seqlen/balanced_max:57480.000 - global_seqlen/mean:57480.000 - actor/entropy_loss:0.979 - actor/kl_loss:0.027 - actor/kl_coef:0.001 - actor/pg_loss:0.083 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.713 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.477 - actor/lr:0.000 - critic/score/mean:1.461 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.461 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:285.016 - response_length/max:589.000 - response_length/min:88.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.734 - prompt_length/max:613.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.504 - timing_s/old_log_prob:6.190 - timing_s/ref:6.368 - timing_s/adv:0.309 - timing_s/update_actor:38.037 - timing_s/step:71.431 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:459840.000 - perf/time_per_step:71.431 - perf/throughput:804.696
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:12 - global_seqlen/min:53680.000 - global_seqlen/max:61703.000 - global_seqlen/minmax_diff:8023.000 - global_seqlen/balanced_min:58049.000 - global_seqlen/balanced_max:58050.000 - global_seqlen/mean:58049.750 - actor/entropy_loss:0.929 - actor/kl_loss:0.030 - actor/kl_coef:0.001 - actor/pg_loss:-0.119 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.665 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.352 - actor/lr:0.000 - critic/score/mean:1.396 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.396 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:284.880 - response_length/max:552.000 - response_length/min:112.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.805 - prompt_length/max:647.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.532 - timing_s/old_log_prob:6.303 - timing_s/ref:6.495 - timing_s/adv:0.319 - timing_s/update_actor:38.272 - timing_s/step:71.940 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:464398.000 - perf/time_per_step:71.940 - perf/throughput:806.915
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:13 - global_seqlen/min:54348.000 - global_seqlen/max:61624.000 - global_seqlen/minmax_diff:7276.000 - global_seqlen/balanced_min:56460.000 - global_seqlen/balanced_max:56461.000 - global_seqlen/mean:56460.250 - actor/entropy_loss:0.894 - actor/kl_loss:0.042 - actor/kl_coef:0.001 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.002 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.898 - perf/mfu/actor:0.399 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.374 - actor/lr:0.000 - critic/score/mean:1.407 - critic/score/max:2.000 - critic/score/min:0.300 - critic/rewards/mean:1.407 - critic/rewards/max:2.000 - critic/rewards/min:0.300 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:278.081 - response_length/max:570.000 - response_length/min:99.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.047 - prompt_length/max:509.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.553 - timing_s/old_log_prob:6.127 - timing_s/ref:6.382 - timing_s/adv:0.303 - timing_s/update_actor:36.341 - timing_s/step:69.729 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:451682.000 - perf/time_per_step:69.729 - perf/throughput:809.706
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  11%|â–ˆâ–        | 15/132 [20:49<2:36:41, 80.36s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  12%|â–ˆâ–        | 16/132 [22:09<2:34:51, 80.10s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  13%|â–ˆâ–        | 17/132 [23:21<2:29:05, 77.79s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  14%|â–ˆâ–        | 18/132 [24:32<2:23:34, 75.57s/it]
[36m(TaskRunner pid=2024902)[0m step:14 - global_seqlen/min:52188.000 - global_seqlen/max:59191.000 - global_seqlen/minmax_diff:7003.000 - global_seqlen/balanced_min:55802.000 - global_seqlen/balanced_max:55803.000 - global_seqlen/mean:55802.500 - actor/entropy_loss:0.851 - actor/kl_loss:0.052 - actor/kl_coef:0.001 - actor/pg_loss:0.085 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.863 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.459 - actor/lr:0.000 - critic/score/mean:1.421 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.421 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.674 - response_length/max:606.000 - response_length/min:96.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.602 - prompt_length/max:614.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.805 - timing_s/old_log_prob:6.104 - timing_s/ref:6.336 - timing_s/adv:0.308 - timing_s/update_actor:36.344 - timing_s/step:69.916 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:446420.000 - perf/time_per_step:69.916 - perf/throughput:798.139
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:15 - global_seqlen/min:54684.000 - global_seqlen/max:61876.000 - global_seqlen/minmax_diff:7192.000 - global_seqlen/balanced_min:57504.000 - global_seqlen/balanced_max:57640.000 - global_seqlen/mean:57543.500 - actor/entropy_loss:0.861 - actor/kl_loss:0.055 - actor/kl_coef:0.001 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.770 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.525 - actor/lr:0.000 - critic/score/mean:1.421 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.421 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:287.490 - response_length/max:1024.000 - response_length/min:114.000 - response_length/clip_ratio:0.003 - prompt_length/mean:311.922 - prompt_length/max:562.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.116 - timing_s/old_log_prob:6.336 - timing_s/ref:6.491 - timing_s/adv:0.323 - timing_s/update_actor:37.573 - timing_s/step:78.867 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:460348.000 - perf/time_per_step:78.867 - perf/throughput:729.625
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:16 - global_seqlen/min:53949.000 - global_seqlen/max:60291.000 - global_seqlen/minmax_diff:6342.000 - global_seqlen/balanced_min:57302.000 - global_seqlen/balanced_max:57303.000 - global_seqlen/mean:57302.500 - actor/entropy_loss:0.849 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:0.060 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.779 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.454 - actor/lr:0.000 - critic/score/mean:1.424 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.424 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.017 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:285.190 - response_length/max:738.000 - response_length/min:100.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.711 - prompt_length/max:820.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.530 - timing_s/old_log_prob:6.386 - timing_s/ref:6.673 - timing_s/adv:0.338 - timing_s/update_actor:38.538 - timing_s/step:79.488 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:458420.000 - perf/time_per_step:79.488 - perf/throughput:720.897
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:17 - global_seqlen/min:53238.000 - global_seqlen/max:60310.000 - global_seqlen/minmax_diff:7072.000 - global_seqlen/balanced_min:56475.000 - global_seqlen/balanced_max:56476.000 - global_seqlen/mean:56475.375 - actor/entropy_loss:0.801 - actor/kl_loss:0.083 - actor/kl_coef:0.001 - actor/pg_loss:0.032 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.773 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.432 - actor/lr:0.000 - critic/score/mean:1.462 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.462 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.613 - response_length/max:637.000 - response_length/min:97.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:798.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.347 - timing_s/old_log_prob:6.128 - timing_s/ref:6.371 - timing_s/adv:0.327 - timing_s/update_actor:38.184 - timing_s/step:72.381 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:451803.000 - perf/time_per_step:72.381 - perf/throughput:780.246
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:18 - global_seqlen/min:54691.000 - global_seqlen/max:58864.000 - global_seqlen/minmax_diff:4173.000 - global_seqlen/balanced_min:56562.000 - global_seqlen/balanced_max:56563.000 - global_seqlen/mean:56562.250 - actor/entropy_loss:0.787 - actor/kl_loss:0.076 - actor/kl_coef:0.001 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.809 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.513 - actor/lr:0.000 - critic/score/mean:1.434 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.434 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.651 - response_length/max:550.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.539 - prompt_length/max:574.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.225 - timing_s/old_log_prob:6.193 - timing_s/ref:6.382 - timing_s/adv:0.319 - timing_s/update_actor:37.210 - timing_s/step:70.354 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:452498.000 - perf/time_per_step:70.354 - perf/throughput:803.970
[36m(TaskRunner pid=2024902)[0m Training Progress:  14%|â–ˆâ–        | 19/132 [25:46<2:21:32, 75.16s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  15%|â–ˆâ–Œ        | 20/132 [29:20<3:37:53, 116.73s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  16%|â–ˆâ–Œ        | 21/132 [30:30<3:10:09, 102.79s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:19 - global_seqlen/min:53866.000 - global_seqlen/max:61124.000 - global_seqlen/minmax_diff:7258.000 - global_seqlen/balanced_min:56735.000 - global_seqlen/balanced_max:56736.000 - global_seqlen/mean:56735.625 - actor/entropy_loss:0.769 - actor/kl_loss:0.079 - actor/kl_coef:0.001 - actor/pg_loss:0.090 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.678 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.541 - actor/lr:0.000 - critic/score/mean:1.443 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.443 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:282.777 - response_length/max:805.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.219 - prompt_length/max:638.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.249 - timing_s/old_log_prob:6.189 - timing_s/ref:6.452 - timing_s/adv:0.321 - timing_s/update_actor:36.954 - timing_s/step:74.188 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:453885.000 - perf/time_per_step:74.188 - perf/throughput:764.754
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æŒ‡å‘çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ã€‚å› æ­¤ï¼Œä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æ˜¯ä¸€è‡´çš„ã€‚å› æ­¤ï¼Œé€‰é¡¹Bæ˜¯æ­£ç¡®çš„ã€‚é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æ˜¯ä¸€è‡´çš„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Cå’ŒDåˆ†åˆ«é’ˆå¯¹ç”²ä¹™ä¸¤äººï¼Œä½†æ²¡æœ‰è€ƒè™‘åˆ°ä»–ä»¬çš„å…±åŒçŠ¯ç½ªè¡Œä¸ºï¼Œå› æ­¤ä¸å®Œå…¨æ­£ç¡®ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {B} </å›ç­”> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 1.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 0.0}
[36m(TaskRunner pid=2024902)[0m step:20 - global_seqlen/min:53339.000 - global_seqlen/max:58782.000 - global_seqlen/minmax_diff:5443.000 - global_seqlen/balanced_min:56200.000 - global_seqlen/balanced_max:56323.000 - global_seqlen/mean:56216.000 - actor/entropy_loss:0.756 - actor/kl_loss:0.096 - actor/kl_coef:0.001 - actor/pg_loss:0.178 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.905 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.367 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.469 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.469 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.469 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.469 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.469 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.469 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.434 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.434 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.024 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.024 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.052 - response_length/max:812.000 - response_length/min:111.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.531 - prompt_length/max:516.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.301 - timing_s/old_log_prob:6.028 - timing_s/ref:6.219 - timing_s/adv:0.315 - timing_s/update_actor:36.975 - timing_s/testing:136.739 - timing_s/step:213.597 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:449728.000 - perf/time_per_step:213.597 - perf/throughput:263.187
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  17%|â–ˆâ–‹        | 22/132 [31:40<2:50:22, 92.93s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  17%|â–ˆâ–‹        | 23/132 [32:49<2:35:56, 85.84s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  18%|â–ˆâ–Š        | 24/132 [33:59<2:26:03, 81.14s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  19%|â–ˆâ–‰        | 25/132 [35:10<2:19:10, 78.04s/it]
[36m(TaskRunner pid=2024902)[0m step:21 - global_seqlen/min:53188.000 - global_seqlen/max:57267.000 - global_seqlen/minmax_diff:4079.000 - global_seqlen/balanced_min:55577.000 - global_seqlen/balanced_max:55577.000 - global_seqlen/mean:55577.000 - actor/entropy_loss:0.773 - actor/kl_loss:0.103 - actor/kl_coef:0.001 - actor/pg_loss:-0.068 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.822 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.428 - actor/lr:0.000 - critic/score/mean:1.467 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.467 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.091 - response_length/max:546.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.836 - prompt_length/max:555.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.408 - timing_s/old_log_prob:5.956 - timing_s/ref:6.204 - timing_s/adv:0.305 - timing_s/update_actor:36.379 - timing_s/step:70.281 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:444616.000 - perf/time_per_step:70.281 - perf/throughput:790.786
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:22 - global_seqlen/min:53148.000 - global_seqlen/max:58014.000 - global_seqlen/minmax_diff:4866.000 - global_seqlen/balanced_min:55237.000 - global_seqlen/balanced_max:55238.000 - global_seqlen/mean:55237.125 - actor/entropy_loss:0.773 - actor/kl_loss:0.080 - actor/kl_coef:0.001 - actor/pg_loss:0.181 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.816 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.577 - actor/lr:0.000 - critic/score/mean:1.447 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.447 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.355 - response_length/max:593.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.031 - prompt_length/max:480.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.532 - timing_s/old_log_prob:6.020 - timing_s/ref:6.309 - timing_s/adv:0.304 - timing_s/update_actor:36.717 - timing_s/step:69.903 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:441897.000 - perf/time_per_step:69.903 - perf/throughput:790.198
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:23 - global_seqlen/min:52257.000 - global_seqlen/max:61944.000 - global_seqlen/minmax_diff:9687.000 - global_seqlen/balanced_min:56518.000 - global_seqlen/balanced_max:56519.000 - global_seqlen/mean:56518.625 - actor/entropy_loss:0.789 - actor/kl_loss:0.091 - actor/kl_coef:0.001 - actor/pg_loss:0.107 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.711 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.434 - actor/lr:0.000 - critic/score/mean:1.450 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.450 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.454 - response_length/max:503.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.281 - prompt_length/max:511.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.238 - timing_s/old_log_prob:6.143 - timing_s/ref:6.375 - timing_s/adv:0.313 - timing_s/update_actor:37.181 - timing_s/step:69.273 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:452149.000 - perf/time_per_step:69.273 - perf/throughput:815.881
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:24 - global_seqlen/min:51877.000 - global_seqlen/max:58248.000 - global_seqlen/minmax_diff:6371.000 - global_seqlen/balanced_min:55094.000 - global_seqlen/balanced_max:55094.000 - global_seqlen/mean:55094.000 - actor/entropy_loss:0.717 - actor/kl_loss:0.095 - actor/kl_coef:0.001 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.714 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.384 - actor/lr:0.000 - critic/score/mean:1.436 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.436 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:261.661 - response_length/max:563.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.234 - prompt_length/max:798.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.909 - timing_s/old_log_prob:6.172 - timing_s/ref:6.414 - timing_s/adv:0.314 - timing_s/update_actor:37.332 - timing_s/step:70.162 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:440752.000 - perf/time_per_step:70.162 - perf/throughput:785.236
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:25 - global_seqlen/min:53887.000 - global_seqlen/max:61107.000 - global_seqlen/minmax_diff:7220.000 - global_seqlen/balanced_min:57314.000 - global_seqlen/balanced_max:57314.000 - global_seqlen/mean:57314.000 - actor/entropy_loss:0.747 - actor/kl_loss:0.096 - actor/kl_coef:0.001 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.724 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.448 - actor/lr:0.000 - critic/score/mean:1.399 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.399 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.411 - response_length/max:556.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:321.609 - prompt_length/max:561.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.154 - timing_s/old_log_prob:6.306 - timing_s/ref:6.522 - timing_s/adv:0.325 - timing_s/update_actor:37.461 - timing_s/step:70.788 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:458512.000 - perf/time_per_step:70.788 - perf/throughput:809.652
[36m(TaskRunner pid=2024902)[0m Training Progress:  20%|â–ˆâ–‰        | 26/132 [36:20<2:13:39, 75.66s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  20%|â–ˆâ–ˆ        | 27/132 [37:37<2:12:52, 75.93s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  21%|â–ˆâ–ˆ        | 28/132 [38:45<2:07:27, 73.54s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 29/132 [39:53<2:03:30, 71.95s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:26 - global_seqlen/min:52856.000 - global_seqlen/max:63240.000 - global_seqlen/minmax_diff:10384.000 - global_seqlen/balanced_min:56289.000 - global_seqlen/balanced_max:56290.000 - global_seqlen/mean:56289.750 - actor/entropy_loss:0.688 - actor/kl_loss:0.100 - actor/kl_coef:0.001 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.778 - perf/mfu/actor:0.393 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.439 - actor/lr:0.000 - critic/score/mean:1.453 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.453 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:258.266 - response_length/max:610.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:328.086 - prompt_length/max:765.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.322 - timing_s/old_log_prob:6.159 - timing_s/ref:6.417 - timing_s/adv:0.313 - timing_s/update_actor:36.813 - timing_s/step:70.048 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:450318.000 - perf/time_per_step:70.048 - perf/throughput:803.593
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:27 - global_seqlen/min:50669.000 - global_seqlen/max:58132.000 - global_seqlen/minmax_diff:7463.000 - global_seqlen/balanced_min:54312.000 - global_seqlen/balanced_max:54441.000 - global_seqlen/mean:54328.375 - actor/entropy_loss:0.673 - actor/kl_loss:0.115 - actor/kl_coef:0.001 - actor/pg_loss:-0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.715 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.314 - actor/lr:0.000 - critic/score/mean:1.461 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.461 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.999 - response_length/max:1024.000 - response_length/min:79.000 - response_length/clip_ratio:0.001 - prompt_length/mean:308.922 - prompt_length/max:551.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.806 - timing_s/old_log_prob:6.031 - timing_s/ref:6.304 - timing_s/adv:0.299 - timing_s/update_actor:37.084 - timing_s/step:76.543 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:434627.000 - perf/time_per_step:76.543 - perf/throughput:709.775
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:28 - global_seqlen/min:48299.000 - global_seqlen/max:55688.000 - global_seqlen/minmax_diff:7389.000 - global_seqlen/balanced_min:52107.000 - global_seqlen/balanced_max:52107.000 - global_seqlen/mean:52107.000 - actor/entropy_loss:0.679 - actor/kl_loss:0.100 - actor/kl_coef:0.001 - actor/pg_loss:-0.074 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.676 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.466 - actor/lr:0.000 - critic/score/mean:1.470 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.470 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:245.344 - response_length/max:584.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:297.438 - prompt_length/max:536.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.923 - timing_s/old_log_prob:5.727 - timing_s/ref:6.017 - timing_s/adv:0.297 - timing_s/update_actor:35.956 - timing_s/step:67.939 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:416856.000 - perf/time_per_step:67.939 - perf/throughput:766.963
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:29 - global_seqlen/min:49692.000 - global_seqlen/max:57962.000 - global_seqlen/minmax_diff:8270.000 - global_seqlen/balanced_min:54724.000 - global_seqlen/balanced_max:54725.000 - global_seqlen/mean:54724.750 - actor/entropy_loss:0.647 - actor/kl_loss:0.121 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.713 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.416 - actor/lr:0.000 - critic/score/mean:1.420 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.420 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:259.331 - response_length/max:519.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.719 - prompt_length/max:548.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.330 - timing_s/old_log_prob:5.930 - timing_s/ref:6.224 - timing_s/adv:0.302 - timing_s/update_actor:36.411 - timing_s/step:68.220 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:437798.000 - perf/time_per_step:68.220 - perf/throughput:802.180
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 30/132 [43:26<3:14:15, 114.27s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 31/132 [44:35<2:49:22, 100.62s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 32/132 [45:45<2:32:24, 91.45s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 33/132 [46:54<2:19:55, 84.80s/it]
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ ¹æ®åˆ‘æ³•çš„è§„å®šï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œé€‰é¡¹Bã€Cã€Dæ˜¯æ­£ç¡®çš„ï¼Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:30 - global_seqlen/min:50896.000 - global_seqlen/max:57787.000 - global_seqlen/minmax_diff:6891.000 - global_seqlen/balanced_min:53686.000 - global_seqlen/balanced_max:53748.000 - global_seqlen/mean:53694.375 - actor/entropy_loss:0.618 - actor/kl_loss:0.087 - actor/kl_coef:0.001 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.782 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:46.591 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.484 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.484 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.484 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.484 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.484 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.484 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.441 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.441 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.730 - response_length/max:1024.000 - response_length/min:96.000 - response_length/clip_ratio:0.001 - prompt_length/mean:301.586 - prompt_length/max:567.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.852 - timing_s/old_log_prob:6.001 - timing_s/ref:6.197 - timing_s/adv:0.299 - timing_s/update_actor:36.269 - timing_s/testing:137.336 - timing_s/step:212.988 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:429555.000 - perf/time_per_step:212.988 - perf/throughput:252.100
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:31 - global_seqlen/min:51807.000 - global_seqlen/max:59499.000 - global_seqlen/minmax_diff:7692.000 - global_seqlen/balanced_min:54095.000 - global_seqlen/balanced_max:54096.000 - global_seqlen/mean:54095.625 - actor/entropy_loss:0.635 - actor/kl_loss:0.106 - actor/kl_coef:0.001 - actor/pg_loss:0.088 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.761 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.543 - actor/lr:0.000 - critic/score/mean:1.480 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.480 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.410 - response_length/max:593.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.086 - prompt_length/max:513.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.978 - timing_s/old_log_prob:5.813 - timing_s/ref:6.116 - timing_s/adv:0.301 - timing_s/update_actor:36.502 - timing_s/step:68.735 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:432765.000 - perf/time_per_step:68.735 - perf/throughput:787.021
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:32 - global_seqlen/min:53896.000 - global_seqlen/max:56504.000 - global_seqlen/minmax_diff:2608.000 - global_seqlen/balanced_min:55448.000 - global_seqlen/balanced_max:55448.000 - global_seqlen/mean:55448.000 - actor/entropy_loss:0.634 - actor/kl_loss:0.107 - actor/kl_coef:0.001 - actor/pg_loss:-0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.651 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:47.893 - actor/lr:0.000 - critic/score/mean:1.472 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.472 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:265.529 - response_length/max:597.000 - response_length/min:96.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.055 - prompt_length/max:522.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.760 - timing_s/old_log_prob:6.076 - timing_s/ref:6.326 - timing_s/adv:0.306 - timing_s/update_actor:36.544 - timing_s/step:70.034 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:443584.000 - perf/time_per_step:70.034 - perf/throughput:791.728
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 34/132 [48:10<2:14:24, 82.29s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 35/132 [49:22<2:07:37, 78.94s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 36/132 [50:34<2:03:05, 76.94s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 37/132 [51:47<2:00:01, 75.80s/it]
[36m(TaskRunner pid=2024902)[0m step:33 - global_seqlen/min:52048.000 - global_seqlen/max:56856.000 - global_seqlen/minmax_diff:4808.000 - global_seqlen/balanced_min:54530.000 - global_seqlen/balanced_max:54531.000 - global_seqlen/mean:54530.250 - actor/entropy_loss:0.644 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:-0.095 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.637 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.834 - actor/lr:0.000 - critic/score/mean:1.560 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.560 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.484 - response_length/max:529.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.539 - prompt_length/max:521.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.390 - timing_s/old_log_prob:6.013 - timing_s/ref:6.330 - timing_s/adv:0.305 - timing_s/update_actor:37.220 - timing_s/step:69.277 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:436242.000 - perf/time_per_step:69.277 - perf/throughput:787.130
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:34 - global_seqlen/min:53154.000 - global_seqlen/max:60158.000 - global_seqlen/minmax_diff:7004.000 - global_seqlen/balanced_min:56428.000 - global_seqlen/balanced_max:56532.000 - global_seqlen/mean:56441.000 - actor/entropy_loss:0.600 - actor/kl_loss:0.096 - actor/kl_coef:0.001 - actor/pg_loss:-0.187 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.583 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.728 - actor/lr:0.000 - critic/score/mean:1.474 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.474 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:273.990 - response_length/max:1024.000 - response_length/min:83.000 - response_length/clip_ratio:0.001 - prompt_length/mean:313.938 - prompt_length/max:558.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.056 - timing_s/old_log_prob:6.132 - timing_s/ref:6.285 - timing_s/adv:0.307 - timing_s/update_actor:36.545 - timing_s/step:76.344 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:451528.000 - perf/time_per_step:76.344 - perf/throughput:739.295
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:35 - global_seqlen/min:53249.000 - global_seqlen/max:59431.000 - global_seqlen/minmax_diff:6182.000 - global_seqlen/balanced_min:56450.000 - global_seqlen/balanced_max:56451.000 - global_seqlen/mean:56450.375 - actor/entropy_loss:0.637 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.655 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.621 - actor/lr:0.000 - critic/score/mean:1.500 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.500 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:273.884 - response_length/max:620.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.141 - prompt_length/max:544.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.157 - timing_s/old_log_prob:6.121 - timing_s/ref:6.330 - timing_s/adv:0.300 - timing_s/update_actor:37.188 - timing_s/step:71.116 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:451603.000 - perf/time_per_step:71.116 - perf/throughput:793.775
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:36 - global_seqlen/min:56701.000 - global_seqlen/max:61917.000 - global_seqlen/minmax_diff:5216.000 - global_seqlen/balanced_min:58399.000 - global_seqlen/balanced_max:58399.000 - global_seqlen/mean:58399.000 - actor/entropy_loss:0.589 - actor/kl_loss:0.106 - actor/kl_coef:0.001 - actor/pg_loss:0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.577 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.718 - actor/lr:0.000 - critic/score/mean:1.489 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.489 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:288.190 - response_length/max:604.000 - response_length/min:98.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.133 - prompt_length/max:567.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.132 - timing_s/old_log_prob:6.360 - timing_s/ref:6.471 - timing_s/adv:0.318 - timing_s/update_actor:37.929 - timing_s/step:72.232 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:467192.000 - perf/time_per_step:72.232 - perf/throughput:808.490
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:37 - global_seqlen/min:54206.000 - global_seqlen/max:59610.000 - global_seqlen/minmax_diff:5404.000 - global_seqlen/balanced_min:57706.000 - global_seqlen/balanced_max:57707.000 - global_seqlen/mean:57706.250 - actor/entropy_loss:0.589 - actor/kl_loss:0.095 - actor/kl_coef:0.001 - actor/pg_loss:0.108 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.676 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.698 - actor/lr:0.000 - critic/score/mean:1.515 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.515 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:286.005 - response_length/max:667.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.102 - prompt_length/max:462.000 - prompt_length/min:229.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.819 - timing_s/old_log_prob:6.274 - timing_s/ref:6.471 - timing_s/adv:0.309 - timing_s/update_actor:38.236 - timing_s/step:73.132 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:461650.000 - perf/time_per_step:73.132 - perf/throughput:789.073
[36m(TaskRunner pid=2024902)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 38/132 [52:59<1:56:49, 74.57s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  30%|â–ˆâ–ˆâ–‰       | 39/132 [54:13<1:55:16, 74.37s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [57:42<2:55:57, 114.76s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:38 - global_seqlen/min:54598.000 - global_seqlen/max:60057.000 - global_seqlen/minmax_diff:5459.000 - global_seqlen/balanced_min:57920.000 - global_seqlen/balanced_max:57921.000 - global_seqlen/mean:57920.500 - actor/entropy_loss:0.576 - actor/kl_loss:0.115 - actor/kl_coef:0.001 - actor/pg_loss:0.195 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.644 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.760 - perf/cpu_memory_used_gb:45.633 - actor/lr:0.000 - critic/score/mean:1.527 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.527 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:287.784 - response_length/max:617.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.555 - prompt_length/max:504.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.349 - timing_s/old_log_prob:6.367 - timing_s/ref:6.514 - timing_s/adv:0.310 - timing_s/update_actor:37.125 - timing_s/step:71.688 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:463364.000 - perf/time_per_step:71.688 - perf/throughput:807.948
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:39 - global_seqlen/min:51652.000 - global_seqlen/max:64159.000 - global_seqlen/minmax_diff:12507.000 - global_seqlen/balanced_min:58084.000 - global_seqlen/balanced_max:58085.000 - global_seqlen/mean:58084.125 - actor/entropy_loss:0.552 - actor/kl_loss:0.111 - actor/kl_coef:0.001 - actor/pg_loss:-0.086 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.601 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.807 - perf/cpu_memory_used_gb:45.751 - actor/lr:0.000 - critic/score/mean:1.488 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.488 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:285.754 - response_length/max:702.000 - response_length/min:77.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.289 - prompt_length/max:789.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.369 - timing_s/old_log_prob:6.433 - timing_s/ref:6.614 - timing_s/adv:0.329 - timing_s/update_actor:38.114 - timing_s/step:73.878 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:464673.000 - perf/time_per_step:73.878 - perf/throughput:786.213
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚åœ¨æœ¬æ¡ˆä¸­ï¼Œç”²æŸå’Œä¹™æŸå…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå°½ç®¡ä»–ä»¬çš„ä¸»è§‚æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨å®¢è§‚ä¸Šæ„æˆäº†å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸ä»¥å„å…±çŠ¯äººçš„æ•…æ„å†…å®¹å®Œå…¨ç›¸åŒä¸ºå¿…è¦ï¼Œåªè¦å„å…±çŠ¯äººå¯¹å…±åŒçŠ¯ç½ªè¡Œä¸ºå…·æœ‰å…±åŒçš„è®¤è¯†å’Œå…±åŒçš„æ•…æ„å³å¯ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹äºç”²æŸï¼Œç”±äºå…¶è¡Œä¸ºå…·æœ‰ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ€§è´¨ï¼Œåº”å½“ä»¥è¯¥ç½ªåè®ºå¤„ã€‚å¯¹äºä¹™æŸï¼Œç”±äºå…¶è¡Œä¸ºä»…æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œåº”å½“ä»¥è¯¥ç½ªåè®ºå¤„ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 41/132 [58:53<2:34:27, 101.84s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 42/132 [1:00:09<2:21:02, 94.03s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 43/132 [1:01:22<2:09:59, 87.63s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 44/132 [1:02:33<2:01:15, 82.67s/it]
[36m(TaskRunner pid=2024902)[0m step:40 - global_seqlen/min:51488.000 - global_seqlen/max:62251.000 - global_seqlen/minmax_diff:10763.000 - global_seqlen/balanced_min:57119.000 - global_seqlen/balanced_max:57120.000 - global_seqlen/mean:57119.125 - actor/entropy_loss:0.525 - actor/kl_loss:0.118 - actor/kl_coef:0.001 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.585 - perf/mfu/actor:0.391 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.807 - perf/cpu_memory_used_gb:45.741 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.508 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.508 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.508 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.508 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.508 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.508 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.521 - critic/score/max:2.000 - critic/score/min:0.300 - critic/rewards/mean:1.521 - critic/rewards/max:2.000 - critic/rewards/min:0.300 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:283.217 - response_length/max:575.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.773 - prompt_length/max:595.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.749 - timing_s/old_log_prob:6.261 - timing_s/ref:6.397 - timing_s/adv:0.314 - timing_s/update_actor:37.504 - timing_s/testing:137.731 - timing_s/step:208.982 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:456953.000 - perf/time_per_step:208.982 - perf/throughput:273.321
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:41 - global_seqlen/min:55372.000 - global_seqlen/max:58558.000 - global_seqlen/minmax_diff:3186.000 - global_seqlen/balanced_min:56740.000 - global_seqlen/balanced_max:56741.000 - global_seqlen/mean:56740.625 - actor/entropy_loss:0.512 - actor/kl_loss:0.121 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.552 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.194 - perf/max_memory_reserved_gb:56.807 - perf/cpu_memory_used_gb:45.715 - actor/lr:0.000 - critic/score/mean:1.539 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.539 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:282.579 - response_length/max:707.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.469 - prompt_length/max:583.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.710 - timing_s/old_log_prob:6.066 - timing_s/ref:6.243 - timing_s/adv:0.306 - timing_s/update_actor:37.322 - timing_s/step:71.672 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:453925.000 - perf/time_per_step:71.672 - perf/throughput:791.668
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:42 - global_seqlen/min:55649.000 - global_seqlen/max:61679.000 - global_seqlen/minmax_diff:6030.000 - global_seqlen/balanced_min:57740.000 - global_seqlen/balanced_max:57741.000 - global_seqlen/mean:57740.125 - actor/entropy_loss:0.506 - actor/kl_loss:0.121 - actor/kl_coef:0.001 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.612 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.826 - actor/lr:0.000 - critic/score/mean:1.542 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.542 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:282.217 - response_length/max:767.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.242 - prompt_length/max:628.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.992 - timing_s/old_log_prob:6.371 - timing_s/ref:6.548 - timing_s/adv:0.315 - timing_s/update_actor:38.490 - timing_s/step:75.737 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:461921.000 - perf/time_per_step:75.737 - perf/throughput:762.380
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:43 - global_seqlen/min:54480.000 - global_seqlen/max:59491.000 - global_seqlen/minmax_diff:5011.000 - global_seqlen/balanced_min:57674.000 - global_seqlen/balanced_max:57675.000 - global_seqlen/mean:57674.375 - actor/entropy_loss:0.487 - actor/kl_loss:0.109 - actor/kl_coef:0.001 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.647 - perf/mfu/actor:0.392 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.781 - actor/lr:0.000 - critic/score/mean:1.487 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.487 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:287.353 - response_length/max:629.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.422 - prompt_length/max:535.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.767 - timing_s/old_log_prob:6.316 - timing_s/ref:6.504 - timing_s/adv:0.311 - timing_s/update_actor:37.776 - timing_s/step:72.702 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:461395.000 - perf/time_per_step:72.702 - perf/throughput:793.301
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 45/132 [1:03:46<1:55:42, 79.80s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–      | 46/132 [1:04:55<1:49:34, 76.44s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 47/132 [1:06:03<1:44:47, 73.97s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [1:07:15<1:42:46, 73.41s/it]
[36m(TaskRunner pid=2024902)[0m step:44 - global_seqlen/min:54625.000 - global_seqlen/max:62262.000 - global_seqlen/minmax_diff:7637.000 - global_seqlen/balanced_min:57253.000 - global_seqlen/balanced_max:57254.000 - global_seqlen/mean:57253.750 - actor/entropy_loss:0.489 - actor/kl_loss:0.134 - actor/kl_coef:0.001 - actor/pg_loss:0.192 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.604 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.728 - actor/lr:0.000 - critic/score/mean:1.537 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.537 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.022 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.022 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:284.721 - response_length/max:597.000 - response_length/min:85.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:808.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.073 - timing_s/old_log_prob:6.184 - timing_s/ref:6.401 - timing_s/adv:0.311 - timing_s/update_actor:37.075 - timing_s/step:71.067 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:458030.000 - perf/time_per_step:71.067 - perf/throughput:805.632
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:45 - global_seqlen/min:52622.000 - global_seqlen/max:61630.000 - global_seqlen/minmax_diff:9008.000 - global_seqlen/balanced_min:56053.000 - global_seqlen/balanced_max:56054.000 - global_seqlen/mean:56053.875 - actor/entropy_loss:0.453 - actor/kl_loss:0.132 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.615 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.747 - actor/lr:0.000 - critic/score/mean:1.546 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.546 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:272.504 - response_length/max:683.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.391 - prompt_length/max:611.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.657 - timing_s/old_log_prob:6.135 - timing_s/ref:6.378 - timing_s/adv:0.311 - timing_s/update_actor:37.584 - timing_s/step:73.087 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:448431.000 - perf/time_per_step:73.087 - perf/throughput:766.946
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:46 - global_seqlen/min:50646.000 - global_seqlen/max:57300.000 - global_seqlen/minmax_diff:6654.000 - global_seqlen/balanced_min:55243.000 - global_seqlen/balanced_max:55244.000 - global_seqlen/mean:55243.500 - actor/entropy_loss:0.429 - actor/kl_loss:0.118 - actor/kl_coef:0.001 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.003 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.578 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.793 - actor/lr:0.000 - critic/score/mean:1.522 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.522 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.019 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:271.266 - response_length/max:589.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.188 - prompt_length/max:485.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.127 - timing_s/old_log_prob:5.996 - timing_s/ref:6.204 - timing_s/adv:0.313 - timing_s/update_actor:35.923 - timing_s/step:68.583 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:441948.000 - perf/time_per_step:68.583 - perf/throughput:805.499
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:47 - global_seqlen/min:49610.000 - global_seqlen/max:58255.000 - global_seqlen/minmax_diff:8645.000 - global_seqlen/balanced_min:54093.000 - global_seqlen/balanced_max:54094.000 - global_seqlen/mean:54093.750 - actor/entropy_loss:0.429 - actor/kl_loss:0.157 - actor/kl_coef:0.001 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.585 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.787 - actor/lr:0.000 - critic/score/mean:1.512 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.512 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:261.258 - response_length/max:542.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.219 - prompt_length/max:455.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.316 - timing_s/old_log_prob:5.864 - timing_s/ref:6.263 - timing_s/adv:0.303 - timing_s/update_actor:36.414 - timing_s/step:68.179 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:432750.000 - perf/time_per_step:68.179 - perf/throughput:793.406
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:48 - global_seqlen/min:52063.000 - global_seqlen/max:58950.000 - global_seqlen/minmax_diff:6887.000 - global_seqlen/balanced_min:54256.000 - global_seqlen/balanced_max:54257.000 - global_seqlen/mean:54256.125 - actor/entropy_loss:0.434 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.615 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.758 - actor/lr:0.000 - critic/score/mean:1.529 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.529 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:259.191 - response_length/max:560.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:485.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.660 - timing_s/old_log_prob:6.007 - timing_s/ref:6.389 - timing_s/adv:0.304 - timing_s/update_actor:36.703 - timing_s/step:72.086 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:434049.000 - perf/time_per_step:72.086 - perf/throughput:752.660
[36m(TaskRunner pid=2024902)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/132 [1:08:24<1:39:56, 72.25s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [1:12:14<2:43:20, 119.52s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:49 - global_seqlen/min:51747.000 - global_seqlen/max:57013.000 - global_seqlen/minmax_diff:5266.000 - global_seqlen/balanced_min:54372.000 - global_seqlen/balanced_max:54373.000 - global_seqlen/mean:54372.125 - actor/entropy_loss:0.437 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:0.084 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.618 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.816 - actor/lr:0.000 - critic/score/mean:1.524 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.524 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.220 - response_length/max:564.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.156 - prompt_length/max:503.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.105 - timing_s/old_log_prob:6.010 - timing_s/ref:6.247 - timing_s/adv:0.305 - timing_s/update_actor:36.821 - timing_s/step:69.512 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:434977.000 - perf/time_per_step:69.512 - perf/throughput:782.200
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æˆ‘ä»¬éœ€è¦åˆ†æç”²ä¹™äºŒäººçš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªï¼Œä»¥åŠå„è‡ªçš„ç½ªåè®¤å®šã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é¦–å…ˆï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ˜¯ä¸ºäº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™åœ¨å®¢è§‚è¡Œä¸ºä¸Šæ˜¯ä¸€è‡´çš„ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºå¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å…¶æ¬¡ï¼Œç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…ï¼Œä»–ä»¬çš„è¡Œä¸ºå¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Bæ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m æœ€åï¼Œå¯¹äºç”²æŸï¼Œç”±äºå…¶æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œåº”ä»¥ç›¸åº”çš„ç½ªåè®ºå¤„ã€‚å¯¹äºä¹™æŸï¼Œç”±äºå…¶æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œé€‰é¡¹Cå’ŒDä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2024902)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [1:13:25<2:21:35, 104.88s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [1:14:34<2:05:40, 94.25s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 53/132 [1:15:45<1:54:43, 87.13s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 54/132 [1:16:54<1:46:15, 81.74s/it]
[36m(TaskRunner pid=2024902)[0m step:50 - global_seqlen/min:53017.000 - global_seqlen/max:57033.000 - global_seqlen/minmax_diff:4016.000 - global_seqlen/balanced_min:54881.000 - global_seqlen/balanced_max:54881.000 - global_seqlen/mean:54881.000 - actor/entropy_loss:0.431 - actor/kl_loss:0.138 - actor/kl_coef:0.001 - actor/pg_loss:0.192 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.591 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:45.688 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.540 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.540 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.540 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.540 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.540 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.540 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.502 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.502 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.022 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:251.669 - response_length/max:766.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.008 - prompt_length/max:771.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.540 - timing_s/old_log_prob:6.144 - timing_s/ref:6.479 - timing_s/adv:0.299 - timing_s/update_actor:37.712 - timing_s/testing:135.593 - timing_s/save_checkpoint:20.965 - timing_s/step:229.756 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:439048.000 - perf/time_per_step:229.756 - perf/throughput:238.867
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:51 - global_seqlen/min:49203.000 - global_seqlen/max:56466.000 - global_seqlen/minmax_diff:7263.000 - global_seqlen/balanced_min:52952.000 - global_seqlen/balanced_max:52953.000 - global_seqlen/mean:52952.875 - actor/entropy_loss:0.422 - actor/kl_loss:0.166 - actor/kl_coef:0.001 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.623 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.776 - actor/lr:0.000 - critic/score/mean:1.490 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.490 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.530 - response_length/max:742.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.792 - timing_s/old_log_prob:5.847 - timing_s/ref:6.195 - timing_s/adv:0.302 - timing_s/update_actor:36.525 - timing_s/step:70.689 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:423623.000 - perf/time_per_step:70.689 - perf/throughput:749.093
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:52 - global_seqlen/min:51680.000 - global_seqlen/max:58967.000 - global_seqlen/minmax_diff:7287.000 - global_seqlen/balanced_min:54811.000 - global_seqlen/balanced_max:54811.000 - global_seqlen/mean:54811.000 - actor/entropy_loss:0.415 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.647 - actor/lr:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:247.784 - response_length/max:613.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.164 - prompt_length/max:578.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.458 - timing_s/old_log_prob:6.064 - timing_s/ref:6.293 - timing_s/adv:0.302 - timing_s/update_actor:36.289 - timing_s/step:69.430 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:438488.000 - perf/time_per_step:69.430 - perf/throughput:789.438
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:53 - global_seqlen/min:50936.000 - global_seqlen/max:59994.000 - global_seqlen/minmax_diff:9058.000 - global_seqlen/balanced_min:54123.000 - global_seqlen/balanced_max:54124.000 - global_seqlen/mean:54123.875 - actor/entropy_loss:0.412 - actor/kl_loss:0.189 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.580 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:48.125 - actor/lr:0.000 - critic/score/mean:1.561 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.561 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:254.876 - response_length/max:674.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.914 - prompt_length/max:542.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.279 - timing_s/old_log_prob:5.965 - timing_s/ref:6.349 - timing_s/adv:0.307 - timing_s/update_actor:36.578 - timing_s/step:70.501 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:432991.000 - perf/time_per_step:70.501 - perf/throughput:767.703
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 55/132 [1:18:06<1:40:57, 78.67s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [1:19:13<1:35:27, 75.36s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/132 [1:20:23<1:32:04, 73.66s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 58/132 [1:21:35<1:30:10, 73.12s/it]
[36m(TaskRunner pid=2024902)[0m step:54 - global_seqlen/min:50244.000 - global_seqlen/max:58642.000 - global_seqlen/minmax_diff:8398.000 - global_seqlen/balanced_min:54412.000 - global_seqlen/balanced_max:54413.000 - global_seqlen/mean:54412.250 - actor/entropy_loss:0.420 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.620 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:47.864 - actor/lr:0.000 - critic/score/mean:1.572 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.572 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:252.935 - response_length/max:545.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.859 - prompt_length/max:563.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.871 - timing_s/old_log_prob:6.031 - timing_s/ref:6.345 - timing_s/adv:0.316 - timing_s/update_actor:36.543 - timing_s/step:69.126 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:435298.000 - perf/time_per_step:69.126 - perf/throughput:787.142
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:55 - global_seqlen/min:52110.000 - global_seqlen/max:55960.000 - global_seqlen/minmax_diff:3850.000 - global_seqlen/balanced_min:54699.000 - global_seqlen/balanced_max:54700.000 - global_seqlen/mean:54699.250 - actor/entropy_loss:0.421 - actor/kl_loss:0.143 - actor/kl_coef:0.001 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.575 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.802 - actor/lr:0.000 - critic/score/mean:1.534 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.534 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:254.120 - response_length/max:756.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.664 - prompt_length/max:615.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.470 - timing_s/old_log_prob:5.953 - timing_s/ref:6.236 - timing_s/adv:0.306 - timing_s/update_actor:36.513 - timing_s/step:71.501 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:437594.000 - perf/time_per_step:71.501 - perf/throughput:765.013
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:56 - global_seqlen/min:51480.000 - global_seqlen/max:56901.000 - global_seqlen/minmax_diff:5421.000 - global_seqlen/balanced_min:53506.000 - global_seqlen/balanced_max:53507.000 - global_seqlen/mean:53506.375 - actor/entropy_loss:0.421 - actor/kl_loss:0.156 - actor/kl_coef:0.001 - actor/pg_loss:0.068 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.528 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.843 - actor/lr:0.000 - critic/score/mean:1.481 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.481 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.038 - response_length/max:552.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.320 - prompt_length/max:679.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.429 - timing_s/old_log_prob:5.778 - timing_s/ref:6.077 - timing_s/adv:0.299 - timing_s/update_actor:35.999 - timing_s/step:67.604 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:428051.000 - perf/time_per_step:67.604 - perf/throughput:791.465
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:57 - global_seqlen/min:53236.000 - global_seqlen/max:56840.000 - global_seqlen/minmax_diff:3604.000 - global_seqlen/balanced_min:55055.000 - global_seqlen/balanced_max:55056.000 - global_seqlen/mean:55055.125 - actor/entropy_loss:0.432 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.607 - actor/lr:0.000 - critic/score/mean:1.506 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.506 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.147 - response_length/max:568.000 - response_length/min:78.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.344 - prompt_length/max:685.000 - prompt_length/min:234.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.996 - timing_s/old_log_prob:6.041 - timing_s/ref:6.273 - timing_s/adv:0.310 - timing_s/update_actor:37.036 - timing_s/step:69.678 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:440441.000 - perf/time_per_step:69.678 - perf/throughput:790.133
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:58 - global_seqlen/min:50698.000 - global_seqlen/max:58867.000 - global_seqlen/minmax_diff:8169.000 - global_seqlen/balanced_min:54994.000 - global_seqlen/balanced_max:54995.000 - global_seqlen/mean:54994.750 - actor/entropy_loss:0.453 - actor/kl_loss:0.160 - actor/kl_coef:0.001 - actor/pg_loss:-0.064 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.651 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.538 - actor/lr:0.000 - critic/score/mean:1.540 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.540 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:262.549 - response_length/max:710.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.312 - prompt_length/max:540.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.780 - timing_s/old_log_prob:6.136 - timing_s/ref:6.368 - timing_s/adv:0.310 - timing_s/update_actor:37.196 - timing_s/step:71.814 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:439958.000 - perf/time_per_step:71.814 - perf/throughput:765.794
[36m(TaskRunner pid=2024902)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 59/132 [1:22:47<1:28:36, 72.83s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [1:26:18<2:17:03, 114.22s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/132 [1:27:28<1:59:35, 101.06s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:59 - global_seqlen/min:48203.000 - global_seqlen/max:56977.000 - global_seqlen/minmax_diff:8774.000 - global_seqlen/balanced_min:52907.000 - global_seqlen/balanced_max:52908.000 - global_seqlen/mean:52907.875 - actor/entropy_loss:0.448 - actor/kl_loss:0.167 - actor/kl_coef:0.001 - actor/pg_loss:-0.042 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.606 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.547 - actor/lr:0.000 - critic/score/mean:1.547 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.547 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:245.585 - response_length/max:847.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.539 - prompt_length/max:585.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.198 - timing_s/old_log_prob:5.812 - timing_s/ref:6.134 - timing_s/adv:0.302 - timing_s/update_actor:35.657 - timing_s/step:72.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:423263.000 - perf/time_per_step:72.122 - perf/throughput:733.587
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œéœ€è¦è€ƒè™‘å…±åŒçŠ¯ç½ªäººçš„ä¸»è§‚æ•…æ„å’Œå®¢è§‚è¡Œä¸ºã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ¶‰åŠå¢ƒå¤–è¡Œä¸ºï¼Œè€Œä¹™çš„æ•…æ„ä»…æ¶‰åŠå›½å†…è¡Œä¸ºã€‚æ ¹æ®åˆ‘æ³•çš„è§„å®šï¼Œç”²æŸçš„è¡Œä¸ºå¯èƒ½æ„æˆé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºå¯èƒ½æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚è™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å­˜åœ¨å…±åŒçŠ¯ç½ªçš„æ•…æ„å’Œè¡Œä¸ºï¼Œå› æ­¤å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:60 - global_seqlen/min:51743.000 - global_seqlen/max:59251.000 - global_seqlen/minmax_diff:7508.000 - global_seqlen/balanced_min:55441.000 - global_seqlen/balanced_max:55442.000 - global_seqlen/mean:55441.875 - actor/entropy_loss:0.437 - actor/kl_loss:0.158 - actor/kl_coef:0.001 - actor/pg_loss:-0.074 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.608 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.659 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.567 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.567 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.567 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.567 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.567 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.567 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.516 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.516 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.723 - response_length/max:809.000 - response_length/min:77.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.797 - prompt_length/max:604.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.045 - timing_s/old_log_prob:6.051 - timing_s/ref:6.314 - timing_s/adv:0.316 - timing_s/update_actor:37.554 - timing_s/testing:136.488 - timing_s/step:210.790 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:443535.000 - perf/time_per_step:210.790 - perf/throughput:263.020
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 62/132 [1:28:40<1:47:36, 92.24s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 63/132 [1:29:50<1:38:25, 85.59s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [1:30:58<1:31:02, 80.33s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/132 [1:32:07<1:25:50, 76.88s/it]
[36m(TaskRunner pid=2024902)[0m step:61 - global_seqlen/min:48353.000 - global_seqlen/max:56388.000 - global_seqlen/minmax_diff:8035.000 - global_seqlen/balanced_min:53011.000 - global_seqlen/balanced_max:53012.000 - global_seqlen/mean:53011.375 - actor/entropy_loss:0.436 - actor/kl_loss:0.142 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.566 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.720 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:248.217 - response_length/max:672.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.984 - prompt_length/max:576.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.940 - timing_s/old_log_prob:5.707 - timing_s/ref:6.018 - timing_s/adv:0.304 - timing_s/update_actor:36.344 - timing_s/step:70.338 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:424091.000 - perf/time_per_step:70.338 - perf/throughput:753.668
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:62 - global_seqlen/min:50828.000 - global_seqlen/max:59002.000 - global_seqlen/minmax_diff:8174.000 - global_seqlen/balanced_min:54137.000 - global_seqlen/balanced_max:54137.000 - global_seqlen/mean:54137.000 - actor/entropy_loss:0.430 - actor/kl_loss:0.142 - actor/kl_coef:0.001 - actor/pg_loss:0.057 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.637 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.565 - actor/lr:0.000 - critic/score/mean:1.540 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.540 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:249.818 - response_length/max:706.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.109 - prompt_length/max:640.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.806 - timing_s/old_log_prob:6.075 - timing_s/ref:6.382 - timing_s/adv:0.303 - timing_s/update_actor:37.040 - timing_s/step:71.625 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:433096.000 - perf/time_per_step:71.625 - perf/throughput:755.839
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:63 - global_seqlen/min:49985.000 - global_seqlen/max:56550.000 - global_seqlen/minmax_diff:6565.000 - global_seqlen/balanced_min:53760.000 - global_seqlen/balanced_max:53761.000 - global_seqlen/mean:53760.125 - actor/entropy_loss:0.443 - actor/kl_loss:0.134 - actor/kl_coef:0.001 - actor/pg_loss:0.087 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.636 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.552 - actor/lr:0.000 - critic/score/mean:1.537 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.537 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:246.251 - response_length/max:667.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.750 - prompt_length/max:820.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.071 - timing_s/old_log_prob:5.979 - timing_s/ref:6.269 - timing_s/adv:0.314 - timing_s/update_actor:36.399 - timing_s/step:70.056 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:430081.000 - perf/time_per_step:70.056 - perf/throughput:767.387
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:64 - global_seqlen/min:49728.000 - global_seqlen/max:58410.000 - global_seqlen/minmax_diff:8682.000 - global_seqlen/balanced_min:53296.000 - global_seqlen/balanced_max:53297.000 - global_seqlen/mean:53296.250 - actor/entropy_loss:0.428 - actor/kl_loss:0.161 - actor/kl_coef:0.001 - actor/pg_loss:0.067 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.575 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.595 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.052 - response_length/max:631.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.117 - prompt_length/max:518.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.317 - timing_s/old_log_prob:5.776 - timing_s/ref:6.070 - timing_s/adv:0.302 - timing_s/update_actor:35.543 - timing_s/step:68.027 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:426370.000 - perf/time_per_step:68.027 - perf/throughput:783.452
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:65 - global_seqlen/min:49549.000 - global_seqlen/max:56687.000 - global_seqlen/minmax_diff:7138.000 - global_seqlen/balanced_min:53002.000 - global_seqlen/balanced_max:53003.000 - global_seqlen/mean:53002.375 - actor/entropy_loss:0.416 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.746 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.645 - actor/lr:0.000 - critic/score/mean:1.597 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.597 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.025 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.025 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.811 - response_length/max:637.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.297 - prompt_length/max:492.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.737 - timing_s/old_log_prob:5.838 - timing_s/ref:6.145 - timing_s/adv:0.302 - timing_s/update_actor:35.749 - timing_s/step:68.810 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:424019.000 - perf/time_per_step:68.810 - perf/throughput:770.269
[36m(TaskRunner pid=2024902)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 66/132 [1:33:14<1:21:32, 74.14s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 67/132 [1:34:23<1:18:32, 72.50s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [1:35:31<1:15:58, 71.22s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/132 [1:36:41<1:14:20, 70.80s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:66 - global_seqlen/min:49631.000 - global_seqlen/max:56479.000 - global_seqlen/minmax_diff:6848.000 - global_seqlen/balanced_min:52608.000 - global_seqlen/balanced_max:52609.000 - global_seqlen/mean:52608.625 - actor/entropy_loss:0.408 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.715 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.671 - actor/lr:0.000 - critic/score/mean:1.566 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.566 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:240.975 - response_length/max:587.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.031 - prompt_length/max:609.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.777 - timing_s/old_log_prob:5.769 - timing_s/ref:6.063 - timing_s/adv:0.299 - timing_s/update_actor:35.778 - timing_s/step:67.707 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:420869.000 - perf/time_per_step:67.707 - perf/throughput:777.002
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:67 - global_seqlen/min:48835.000 - global_seqlen/max:55533.000 - global_seqlen/minmax_diff:6698.000 - global_seqlen/balanced_min:52732.000 - global_seqlen/balanced_max:52732.000 - global_seqlen/mean:52732.000 - actor/entropy_loss:0.385 - actor/kl_loss:0.190 - actor/kl_coef:0.001 - actor/pg_loss:0.147 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.545 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.458 - actor/lr:0.000 - critic/score/mean:1.555 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.555 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:240.620 - response_length/max:549.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.672 - prompt_length/max:576.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.022 - timing_s/old_log_prob:5.903 - timing_s/ref:6.202 - timing_s/adv:0.300 - timing_s/update_actor:36.679 - timing_s/step:68.133 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:421856.000 - perf/time_per_step:68.133 - perf/throughput:773.958
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:68 - global_seqlen/min:51070.000 - global_seqlen/max:56039.000 - global_seqlen/minmax_diff:4969.000 - global_seqlen/balanced_min:53053.000 - global_seqlen/balanced_max:53054.000 - global_seqlen/mean:53053.250 - actor/entropy_loss:0.385 - actor/kl_loss:0.176 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.583 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.572 - actor/lr:0.000 - critic/score/mean:1.551 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.551 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:253.982 - response_length/max:563.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:298.656 - prompt_length/max:433.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.007 - timing_s/old_log_prob:5.798 - timing_s/ref:6.052 - timing_s/adv:0.300 - timing_s/update_actor:36.045 - timing_s/step:68.225 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:424426.000 - perf/time_per_step:68.225 - perf/throughput:777.625
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:69 - global_seqlen/min:51272.000 - global_seqlen/max:56445.000 - global_seqlen/minmax_diff:5173.000 - global_seqlen/balanced_min:53834.000 - global_seqlen/balanced_max:53835.000 - global_seqlen/mean:53834.500 - actor/entropy_loss:0.387 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.133 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.629 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.820 - perf/cpu_memory_used_gb:46.671 - actor/lr:0.000 - critic/score/mean:1.592 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.592 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:247.604 - response_length/max:702.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.172 - prompt_length/max:614.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.521 - timing_s/old_log_prob:5.895 - timing_s/ref:6.213 - timing_s/adv:0.302 - timing_s/update_actor:35.822 - timing_s/step:69.774 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:430676.000 - perf/time_per_step:69.774 - perf/throughput:771.550
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/132 [1:40:01<1:53:12, 109.56s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 71/132 [1:41:14<1:40:11, 98.55s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [1:42:25<1:30:11, 90.18s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 73/132 [1:43:38<1:23:41, 85.12s/it]
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æˆ‘ä»¬éœ€è¦åˆ†æç”²ä¹™äºŒäººçš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªï¼Œä»¥åŠå„è‡ªçš„ç½ªåè®¤å®šã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é¦–å…ˆï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œè¿™äº›è¡Œä¸ºåœ¨åˆ‘æ³•ä¸­éƒ½å±äºå±å®³å›½å®¶å®‰å…¨çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å…¶æ¬¡ï¼Œå¯¹äºç”²æŸï¼Œä»–ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºå±äºå±å®³å›½å®¶å®‰å…¨çš„è¡Œä¸ºï¼Œåº”å½“ä»¥å±å®³å›½å®¶å®‰å…¨ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å¯¹äºä¹™æŸï¼Œä»–ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œæ ¹æ®åˆ‘æ³•è§„å®šï¼Œè¿™ç§è¡Œä¸ºå±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œåº”å½“ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:70 - global_seqlen/min:49747.000 - global_seqlen/max:55680.000 - global_seqlen/minmax_diff:5933.000 - global_seqlen/balanced_min:53544.000 - global_seqlen/balanced_max:53545.000 - global_seqlen/mean:53544.375 - actor/entropy_loss:0.356 - actor/kl_loss:0.187 - actor/kl_coef:0.001 - actor/pg_loss:0.041 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.666 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.625 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.586 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.586 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.586 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.586 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.586 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.586 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:248.551 - response_length/max:681.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.203 - prompt_length/max:542.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.010 - timing_s/old_log_prob:5.945 - timing_s/ref:6.206 - timing_s/adv:0.306 - timing_s/update_actor:36.709 - timing_s/testing:129.790 - timing_s/step:199.987 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:428355.000 - perf/time_per_step:199.987 - perf/throughput:267.739
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:71 - global_seqlen/min:50476.000 - global_seqlen/max:57415.000 - global_seqlen/minmax_diff:6939.000 - global_seqlen/balanced_min:54021.000 - global_seqlen/balanced_max:54067.000 - global_seqlen/mean:54027.125 - actor/entropy_loss:0.328 - actor/kl_loss:0.148 - actor/kl_coef:0.001 - actor/pg_loss:-0.036 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.562 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.675 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:250.501 - response_length/max:889.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.281 - prompt_length/max:771.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.010 - timing_s/old_log_prob:5.844 - timing_s/ref:6.137 - timing_s/adv:0.299 - timing_s/update_actor:36.528 - timing_s/step:72.845 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:432217.000 - perf/time_per_step:72.845 - perf/throughput:741.674
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:72 - global_seqlen/min:52172.000 - global_seqlen/max:58968.000 - global_seqlen/minmax_diff:6796.000 - global_seqlen/balanced_min:54867.000 - global_seqlen/balanced_max:54868.000 - global_seqlen/mean:54867.250 - actor/entropy_loss:0.328 - actor/kl_loss:0.169 - actor/kl_coef:0.001 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.500 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.555 - actor/lr:0.000 - critic/score/mean:1.634 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.634 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.792 - response_length/max:642.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.742 - prompt_length/max:480.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.000 - timing_s/old_log_prob:6.060 - timing_s/ref:6.308 - timing_s/adv:0.301 - timing_s/update_actor:36.956 - timing_s/step:70.645 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:438938.000 - perf/time_per_step:70.645 - perf/throughput:776.658
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 74/132 [1:44:50<1:18:23, 81.09s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 75/132 [1:45:59<1:13:45, 77.64s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [1:47:10<1:10:24, 75.44s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/132 [1:48:19<1:07:27, 73.59s/it]
[36m(TaskRunner pid=2024902)[0m step:73 - global_seqlen/min:54114.000 - global_seqlen/max:58458.000 - global_seqlen/minmax_diff:4344.000 - global_seqlen/balanced_min:55614.000 - global_seqlen/balanced_max:55615.000 - global_seqlen/mean:55614.750 - actor/entropy_loss:0.341 - actor/kl_loss:0.156 - actor/kl_coef:0.001 - actor/pg_loss:0.107 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.614 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.664 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.039 - response_length/max:679.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.281 - prompt_length/max:534.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.166 - timing_s/old_log_prob:6.211 - timing_s/ref:6.426 - timing_s/adv:0.307 - timing_s/update_actor:38.140 - timing_s/step:73.271 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:444918.000 - perf/time_per_step:73.271 - perf/throughput:759.033
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:74 - global_seqlen/min:52923.000 - global_seqlen/max:60001.000 - global_seqlen/minmax_diff:7078.000 - global_seqlen/balanced_min:56068.000 - global_seqlen/balanced_max:56068.000 - global_seqlen/mean:56068.000 - actor/entropy_loss:0.321 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.131 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.543 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.636 - actor/lr:0.000 - critic/score/mean:1.533 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.533 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:275.424 - response_length/max:617.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.617 - prompt_length/max:563.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.452 - timing_s/old_log_prob:6.170 - timing_s/ref:6.368 - timing_s/adv:0.307 - timing_s/update_actor:37.351 - timing_s/step:71.670 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:448544.000 - perf/time_per_step:71.670 - perf/throughput:782.303
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:75 - global_seqlen/min:49075.000 - global_seqlen/max:59105.000 - global_seqlen/minmax_diff:10030.000 - global_seqlen/balanced_min:55039.000 - global_seqlen/balanced_max:55040.000 - global_seqlen/mean:55039.875 - actor/entropy_loss:0.331 - actor/kl_loss:0.163 - actor/kl_coef:0.001 - actor/pg_loss:-0.129 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.579 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.662 - actor/lr:0.000 - critic/score/mean:1.609 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.609 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:260.512 - response_length/max:540.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.820 - prompt_length/max:679.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.631 - timing_s/old_log_prob:6.126 - timing_s/ref:6.400 - timing_s/adv:0.299 - timing_s/update_actor:37.070 - timing_s/step:69.550 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:440319.000 - perf/time_per_step:69.550 - perf/throughput:791.376
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:76 - global_seqlen/min:52932.000 - global_seqlen/max:58237.000 - global_seqlen/minmax_diff:5305.000 - global_seqlen/balanced_min:55996.000 - global_seqlen/balanced_max:55997.000 - global_seqlen/mean:55996.375 - actor/entropy_loss:0.326 - actor/kl_loss:0.178 - actor/kl_coef:0.001 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.522 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.630 - actor/lr:0.000 - critic/score/mean:1.538 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.538 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:266.303 - response_length/max:574.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.992 - prompt_length/max:585.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.530 - timing_s/old_log_prob:6.185 - timing_s/ref:6.338 - timing_s/adv:0.308 - timing_s/update_actor:36.901 - timing_s/step:70.283 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:447971.000 - perf/time_per_step:70.283 - perf/throughput:796.729
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:77 - global_seqlen/min:50451.000 - global_seqlen/max:55740.000 - global_seqlen/minmax_diff:5289.000 - global_seqlen/balanced_min:53411.000 - global_seqlen/balanced_max:53411.000 - global_seqlen/mean:53411.000 - actor/entropy_loss:0.301 - actor/kl_loss:0.175 - actor/kl_coef:0.001 - actor/pg_loss:-0.102 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.544 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.665 - actor/lr:0.000 - critic/score/mean:1.624 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.624 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:250.966 - response_length/max:581.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.398 - prompt_length/max:532.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.223 - timing_s/old_log_prob:5.927 - timing_s/ref:6.189 - timing_s/adv:0.297 - timing_s/update_actor:36.581 - timing_s/step:69.239 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:427288.000 - perf/time_per_step:69.239 - perf/throughput:771.399
[36m(TaskRunner pid=2024902)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 78/132 [1:49:28<1:05:08, 72.39s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 79/132 [1:50:40<1:03:39, 72.07s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [1:54:07<1:37:37, 112.64s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:78 - global_seqlen/min:52045.000 - global_seqlen/max:56997.000 - global_seqlen/minmax_diff:4952.000 - global_seqlen/balanced_min:54362.000 - global_seqlen/balanced_max:54363.000 - global_seqlen/mean:54362.125 - actor/entropy_loss:0.299 - actor/kl_loss:0.202 - actor/kl_coef:0.001 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.620 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.532 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:254.936 - response_length/max:615.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.336 - prompt_length/max:546.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.583 - timing_s/old_log_prob:5.999 - timing_s/ref:6.276 - timing_s/adv:0.303 - timing_s/update_actor:36.378 - timing_s/step:69.562 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:434897.000 - perf/time_per_step:69.562 - perf/throughput:781.491
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:79 - global_seqlen/min:51366.000 - global_seqlen/max:57487.000 - global_seqlen/minmax_diff:6121.000 - global_seqlen/balanced_min:54236.000 - global_seqlen/balanced_max:54237.000 - global_seqlen/mean:54236.250 - actor/entropy_loss:0.286 - actor/kl_loss:0.157 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.733 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.690 - actor/lr:0.000 - critic/score/mean:1.629 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.629 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.789 - response_length/max:664.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.172 - prompt_length/max:495.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.531 - timing_s/old_log_prob:5.978 - timing_s/ref:6.273 - timing_s/adv:0.300 - timing_s/update_actor:37.180 - timing_s/step:71.283 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:433890.000 - perf/time_per_step:71.283 - perf/throughput:760.853
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æˆ‘ä»¬éœ€è¦åˆ†æç”²ä¹™äºŒäººçš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªï¼Œä»¥åŠå„è‡ªçš„ç½ªåè®¤å®šã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œæ˜¯æŒ‡ä¸ºå¢ƒå¤–çš„æœºæ„ã€ç»„ç»‡ã€äººå‘˜çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–è€…æƒ…æŠ¥çš„è¡Œä¸ºã€‚æ ¹æ®åˆ‘æ³•ç¬¬282æ¡ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œæ˜¯æŒ‡ä»¥çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°æ–¹æ³•ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å¯¹äºç”²æŸï¼Œè™½ç„¶ä»–çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä½†ä»–çš„è¡Œä¸ºå·²ç»æ„æˆäº†éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚å¯¹äºä¹™æŸï¼Œä»–çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 81/132 [1:55:16<1:24:35, 99.53s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/132 [1:56:27<1:15:43, 90.87s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/132 [1:57:35<1:08:45, 84.19s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 84/132 [1:58:50<1:05:08, 81.42s/it]
[36m(TaskRunner pid=2024902)[0m step:80 - global_seqlen/min:50109.000 - global_seqlen/max:57592.000 - global_seqlen/minmax_diff:7483.000 - global_seqlen/balanced_min:54006.000 - global_seqlen/balanced_max:54007.000 - global_seqlen/mean:54006.625 - actor/entropy_loss:0.293 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:-0.023 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.649 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:48.012 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.589 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.589 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.589 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.589 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.589 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.589 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:245.733 - response_length/max:804.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.836 - prompt_length/max:561.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.506 - timing_s/old_log_prob:5.881 - timing_s/ref:6.167 - timing_s/adv:0.304 - timing_s/update_actor:35.686 - timing_s/testing:135.720 - timing_s/step:207.285 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:432053.000 - perf/time_per_step:207.285 - perf/throughput:260.543
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:81 - global_seqlen/min:50573.000 - global_seqlen/max:56518.000 - global_seqlen/minmax_diff:5945.000 - global_seqlen/balanced_min:54078.000 - global_seqlen/balanced_max:54079.000 - global_seqlen/mean:54078.500 - actor/entropy_loss:0.274 - actor/kl_loss:0.216 - actor/kl_coef:0.001 - actor/pg_loss:0.080 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.539 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.721 - actor/lr:0.000 - critic/score/mean:1.621 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.621 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:251.130 - response_length/max:610.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.188 - prompt_length/max:566.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.028 - timing_s/old_log_prob:5.799 - timing_s/ref:6.077 - timing_s/adv:0.308 - timing_s/update_actor:36.684 - timing_s/step:68.920 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:432628.000 - perf/time_per_step:68.920 - perf/throughput:784.653
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:82 - global_seqlen/min:47669.000 - global_seqlen/max:57220.000 - global_seqlen/minmax_diff:9551.000 - global_seqlen/balanced_min:52954.000 - global_seqlen/balanced_max:52955.000 - global_seqlen/mean:52954.375 - actor/entropy_loss:0.275 - actor/kl_loss:0.205 - actor/kl_coef:0.001 - actor/pg_loss:0.138 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.597 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.912 - actor/lr:0.000 - critic/score/mean:1.584 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.584 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:245.600 - response_length/max:670.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.008 - prompt_length/max:505.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.145 - timing_s/old_log_prob:5.916 - timing_s/ref:6.262 - timing_s/adv:0.302 - timing_s/update_actor:36.988 - timing_s/step:70.634 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:423635.000 - perf/time_per_step:70.634 - perf/throughput:749.701
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:83 - global_seqlen/min:50729.000 - global_seqlen/max:55039.000 - global_seqlen/minmax_diff:4310.000 - global_seqlen/balanced_min:52793.000 - global_seqlen/balanced_max:52794.000 - global_seqlen/mean:52793.875 - actor/entropy_loss:0.254 - actor/kl_loss:0.216 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.563 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.755 - actor/lr:0.000 - critic/score/mean:1.632 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.632 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:240.124 - response_length/max:545.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.812 - prompt_length/max:551.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.646 - timing_s/old_log_prob:5.782 - timing_s/ref:6.120 - timing_s/adv:0.290 - timing_s/update_actor:36.710 - timing_s/step:68.570 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:422351.000 - perf/time_per_step:68.570 - perf/throughput:769.929
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/132 [2:00:00<1:00:55, 77.78s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 86/132 [2:01:17<59:28, 77.57s/it]  
[36m(TaskRunner pid=2024902)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 87/132 [2:02:33<57:51, 77.14s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [2:03:40<54:20, 74.09s/it]
[36m(TaskRunner pid=2024902)[0m step:84 - global_seqlen/min:48587.000 - global_seqlen/max:57931.000 - global_seqlen/minmax_diff:9344.000 - global_seqlen/balanced_min:53663.000 - global_seqlen/balanced_max:53664.000 - global_seqlen/mean:53663.375 - actor/entropy_loss:0.239 - actor/kl_loss:0.226 - actor/kl_coef:0.001 - actor/pg_loss:-0.054 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.660 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.959 - actor/lr:0.000 - critic/score/mean:1.657 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.657 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.564 - response_length/max:1024.000 - response_length/min:52.000 - response_length/clip_ratio:0.001 - prompt_length/mean:315.430 - prompt_length/max:502.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.048 - timing_s/old_log_prob:5.943 - timing_s/ref:6.214 - timing_s/adv:0.300 - timing_s/update_actor:36.444 - timing_s/step:74.969 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:429307.000 - perf/time_per_step:74.969 - perf/throughput:715.808
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:85 - global_seqlen/min:46805.000 - global_seqlen/max:56078.000 - global_seqlen/minmax_diff:9273.000 - global_seqlen/balanced_min:51814.000 - global_seqlen/balanced_max:51815.000 - global_seqlen/mean:51814.875 - actor/entropy_loss:0.239 - actor/kl_loss:0.194 - actor/kl_coef:0.001 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.684 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.753 - actor/lr:0.000 - critic/score/mean:1.623 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.623 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:227.949 - response_length/max:659.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.789 - prompt_length/max:630.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.595 - timing_s/old_log_prob:5.775 - timing_s/ref:6.038 - timing_s/adv:0.293 - timing_s/update_actor:36.519 - timing_s/step:69.244 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:414519.000 - perf/time_per_step:69.244 - perf/throughput:748.295
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:86 - global_seqlen/min:52795.000 - global_seqlen/max:59832.000 - global_seqlen/minmax_diff:7037.000 - global_seqlen/balanced_min:55902.000 - global_seqlen/balanced_max:56096.000 - global_seqlen/mean:55926.500 - actor/entropy_loss:0.246 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.751 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.927 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.028 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.028 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.849 - response_length/max:1024.000 - response_length/min:55.000 - response_length/clip_ratio:0.001 - prompt_length/mean:326.719 - prompt_length/max:615.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.890 - timing_s/old_log_prob:6.135 - timing_s/ref:6.341 - timing_s/adv:0.306 - timing_s/update_actor:37.356 - timing_s/step:77.049 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:447412.000 - perf/time_per_step:77.049 - perf/throughput:725.856
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:87 - global_seqlen/min:48584.000 - global_seqlen/max:56989.000 - global_seqlen/minmax_diff:8405.000 - global_seqlen/balanced_min:53765.000 - global_seqlen/balanced_max:53947.000 - global_seqlen/mean:53797.625 - actor/entropy_loss:0.247 - actor/kl_loss:0.187 - actor/kl_coef:0.001 - actor/pg_loss:0.055 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.780 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.800 - actor/lr:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.019 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:242.329 - response_length/max:1024.000 - response_length/min:55.000 - response_length/clip_ratio:0.001 - prompt_length/mean:318.062 - prompt_length/max:522.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.695 - timing_s/old_log_prob:5.982 - timing_s/ref:6.285 - timing_s/adv:0.298 - timing_s/update_actor:36.832 - timing_s/step:76.113 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:430381.000 - perf/time_per_step:76.113 - perf/throughput:706.809
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:88 - global_seqlen/min:49511.000 - global_seqlen/max:55647.000 - global_seqlen/minmax_diff:6136.000 - global_seqlen/balanced_min:52922.000 - global_seqlen/balanced_max:52923.000 - global_seqlen/mean:52922.500 - actor/entropy_loss:0.240 - actor/kl_loss:0.249 - actor/kl_coef:0.001 - actor/pg_loss:-0.027 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.926 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.866 - actor/lr:0.000 - critic/score/mean:1.639 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.639 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:239.245 - response_length/max:544.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.031 - prompt_length/max:593.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.306 - timing_s/old_log_prob:5.782 - timing_s/ref:6.037 - timing_s/adv:0.296 - timing_s/update_actor:35.523 - timing_s/step:66.966 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:423380.000 - perf/time_per_step:66.966 - perf/throughput:790.291
[36m(TaskRunner pid=2024902)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/132 [2:04:55<53:21, 74.46s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 90/132 [2:08:15<1:18:32, 112.19s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 91/132 [2:09:28<1:08:38, 100.46s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:89 - global_seqlen/min:48349.000 - global_seqlen/max:54528.000 - global_seqlen/minmax_diff:6179.000 - global_seqlen/balanced_min:52243.000 - global_seqlen/balanced_max:52351.000 - global_seqlen/mean:52283.750 - actor/entropy_loss:0.229 - actor/kl_loss:0.180 - actor/kl_coef:0.001 - actor/pg_loss:0.091 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.791 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.047 - actor/lr:0.000 - critic/score/mean:1.637 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.637 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.646 - response_length/max:1024.000 - response_length/min:56.000 - response_length/clip_ratio:0.004 - prompt_length/mean:305.977 - prompt_length/max:529.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:27.018 - timing_s/old_log_prob:5.741 - timing_s/ref:6.016 - timing_s/adv:0.294 - timing_s/update_actor:36.214 - timing_s/step:75.305 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:418270.000 - perf/time_per_step:75.305 - perf/throughput:694.295
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œéœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠåœ¨å…±åŒçŠ¯ç½ªä¸­çš„è§’è‰²ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Aä¸æ­£ç¡®ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å¯¹äºç”²æŸçš„è¡Œä¸ºï¼Œç”±äºä»–çš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚å¯¹äºä¹™æŸçš„è¡Œä¸ºï¼Œç”±äºä»–çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚å› æ­¤ï¼Œé€‰é¡¹Cå’ŒDéƒ½æ­£ç¡®ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:90 - global_seqlen/min:47754.000 - global_seqlen/max:54650.000 - global_seqlen/minmax_diff:6896.000 - global_seqlen/balanced_min:51328.000 - global_seqlen/balanced_max:51328.000 - global_seqlen/mean:51328.000 - actor/entropy_loss:0.213 - actor/kl_loss:0.256 - actor/kl_coef:0.001 - actor/pg_loss:-0.021 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.898 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.609 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.609 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.609 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.609 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.609 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.609 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.624 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.624 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:217.276 - response_length/max:578.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.391 - prompt_length/max:647.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.302 - timing_s/old_log_prob:5.626 - timing_s/ref:6.032 - timing_s/adv:0.295 - timing_s/update_actor:35.439 - timing_s/testing:133.494 - timing_s/step:200.207 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:410624.000 - perf/time_per_step:200.207 - perf/throughput:256.375
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [2:10:37<1:00:36, 90.91s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 93/132 [2:11:43<54:15, 83.47s/it]  
[36m(TaskRunner pid=2024902)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 94/132 [2:12:48<49:21, 77.94s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/132 [2:14:00<46:51, 76.00s/it]
[36m(TaskRunner pid=2024902)[0m step:91 - global_seqlen/min:44169.000 - global_seqlen/max:54319.000 - global_seqlen/minmax_diff:10150.000 - global_seqlen/balanced_min:49536.000 - global_seqlen/balanced_max:49653.000 - global_seqlen/mean:49565.750 - actor/entropy_loss:0.229 - actor/kl_loss:0.236 - actor/kl_coef:0.001 - actor/pg_loss:0.074 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.593 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.840 - actor/lr:0.000 - critic/score/mean:1.606 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.606 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.023 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:212.294 - response_length/max:1024.000 - response_length/min:64.000 - response_length/clip_ratio:0.003 - prompt_length/mean:304.016 - prompt_length/max:536.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.134 - timing_s/old_log_prob:5.386 - timing_s/ref:5.794 - timing_s/adv:0.285 - timing_s/update_actor:35.420 - timing_s/step:73.050 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:396526.000 - perf/time_per_step:73.050 - perf/throughput:678.520
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:92 - global_seqlen/min:48889.000 - global_seqlen/max:55724.000 - global_seqlen/minmax_diff:6835.000 - global_seqlen/balanced_min:51967.000 - global_seqlen/balanced_max:51968.000 - global_seqlen/mean:51967.750 - actor/entropy_loss:0.211 - actor/kl_loss:0.195 - actor/kl_coef:0.001 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.637 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.842 - actor/lr:0.000 - critic/score/mean:1.589 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.589 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:221.331 - response_length/max:627.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.000 - prompt_length/max:798.000 - prompt_length/min:236.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.723 - timing_s/old_log_prob:5.964 - timing_s/ref:6.280 - timing_s/adv:0.298 - timing_s/update_actor:36.298 - timing_s/step:68.596 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:415742.000 - perf/time_per_step:68.596 - perf/throughput:757.590
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:93 - global_seqlen/min:46668.000 - global_seqlen/max:53772.000 - global_seqlen/minmax_diff:7104.000 - global_seqlen/balanced_min:50665.000 - global_seqlen/balanced_max:50666.000 - global_seqlen/mean:50665.500 - actor/entropy_loss:0.218 - actor/kl_loss:0.179 - actor/kl_coef:0.001 - actor/pg_loss:-0.064 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.648 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.811 - actor/lr:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.017 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.017 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:210.406 - response_length/max:551.000 - response_length/min:50.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.359 - prompt_length/max:522.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.819 - timing_s/old_log_prob:5.620 - timing_s/ref:5.948 - timing_s/adv:0.290 - timing_s/update_actor:35.384 - timing_s/step:66.083 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:405324.000 - perf/time_per_step:66.083 - perf/throughput:766.692
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:94 - global_seqlen/min:45675.000 - global_seqlen/max:51772.000 - global_seqlen/minmax_diff:6097.000 - global_seqlen/balanced_min:48879.000 - global_seqlen/balanced_max:48880.000 - global_seqlen/mean:48879.375 - actor/entropy_loss:0.239 - actor/kl_loss:0.249 - actor/kl_coef:0.001 - actor/pg_loss:-0.052 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.631 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.758 - actor/lr:0.000 - critic/score/mean:1.623 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.623 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:194.301 - response_length/max:559.000 - response_length/min:54.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.859 - prompt_length/max:798.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.521 - timing_s/old_log_prob:5.417 - timing_s/ref:5.833 - timing_s/adv:0.283 - timing_s/update_actor:34.927 - timing_s/step:65.006 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:391035.000 - perf/time_per_step:65.006 - perf/throughput:751.922
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:95 - global_seqlen/min:45935.000 - global_seqlen/max:53129.000 - global_seqlen/minmax_diff:7194.000 - global_seqlen/balanced_min:48909.000 - global_seqlen/balanced_max:49103.000 - global_seqlen/mean:48933.500 - actor/entropy_loss:0.227 - actor/kl_loss:0.228 - actor/kl_coef:0.001 - actor/pg_loss:0.071 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.538 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.786 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:202.130 - response_length/max:1024.000 - response_length/min:40.000 - response_length/clip_ratio:0.001 - prompt_length/mean:307.594 - prompt_length/max:507.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.508 - timing_s/old_log_prob:5.462 - timing_s/ref:5.847 - timing_s/adv:0.284 - timing_s/update_actor:34.329 - timing_s/step:71.452 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.164 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:391468.000 - perf/time_per_step:71.452 - perf/throughput:684.841
[36m(TaskRunner pid=2024902)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 96/132 [2:15:07<43:58, 73.29s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 97/132 [2:16:13<41:35, 71.31s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 98/132 [2:17:26<40:36, 71.68s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 99/132 [2:18:32<38:27, 69.92s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:96 - global_seqlen/min:45644.000 - global_seqlen/max:52251.000 - global_seqlen/minmax_diff:6607.000 - global_seqlen/balanced_min:48368.000 - global_seqlen/balanced_max:48369.000 - global_seqlen/mean:48368.500 - actor/entropy_loss:0.229 - actor/kl_loss:0.240 - actor/kl_coef:0.001 - actor/pg_loss:-0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.693 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.850 - actor/lr:0.000 - critic/score/mean:1.597 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.597 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:190.768 - response_length/max:684.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.070 - prompt_length/max:583.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.590 - timing_s/old_log_prob:5.519 - timing_s/ref:5.983 - timing_s/adv:0.289 - timing_s/update_actor:34.560 - timing_s/step:66.962 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:386948.000 - perf/time_per_step:66.962 - perf/throughput:722.331
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:97 - global_seqlen/min:46432.000 - global_seqlen/max:52858.000 - global_seqlen/minmax_diff:6426.000 - global_seqlen/balanced_min:49161.000 - global_seqlen/balanced_max:49171.000 - global_seqlen/mean:49162.500 - actor/entropy_loss:0.232 - actor/kl_loss:0.222 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.706 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.905 - actor/lr:0.000 - critic/score/mean:1.627 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.627 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:192.898 - response_length/max:673.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.211 - prompt_length/max:820.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.615 - timing_s/old_log_prob:5.456 - timing_s/ref:5.845 - timing_s/adv:0.284 - timing_s/update_actor:34.449 - timing_s/step:66.668 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:393300.000 - perf/time_per_step:66.668 - perf/throughput:737.426
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:98 - global_seqlen/min:45891.000 - global_seqlen/max:53206.000 - global_seqlen/minmax_diff:7315.000 - global_seqlen/balanced_min:49570.000 - global_seqlen/balanced_max:49634.000 - global_seqlen/mean:49578.125 - actor/entropy_loss:0.223 - actor/kl_loss:0.275 - actor/kl_coef:0.001 - actor/pg_loss:0.115 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.539 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.874 - actor/lr:0.000 - critic/score/mean:1.598 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.598 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.024 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.024 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:202.493 - response_length/max:1024.000 - response_length/min:53.000 - response_length/clip_ratio:0.001 - prompt_length/mean:313.945 - prompt_length/max:552.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.962 - timing_s/old_log_prob:5.426 - timing_s/ref:5.875 - timing_s/adv:0.286 - timing_s/update_actor:34.924 - timing_s/step:72.509 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.167 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:396625.000 - perf/time_per_step:72.509 - perf/throughput:683.753
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:99 - global_seqlen/min:44603.000 - global_seqlen/max:51768.000 - global_seqlen/minmax_diff:7165.000 - global_seqlen/balanced_min:48404.000 - global_seqlen/balanced_max:48405.000 - global_seqlen/mean:48404.125 - actor/entropy_loss:0.221 - actor/kl_loss:0.236 - actor/kl_coef:0.001 - actor/pg_loss:-0.046 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.707 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.019 - actor/lr:0.000 - critic/score/mean:1.623 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.623 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:194.499 - response_length/max:637.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.711 - prompt_length/max:590.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.562 - timing_s/old_log_prob:5.411 - timing_s/ref:5.886 - timing_s/adv:0.286 - timing_s/update_actor:34.603 - timing_s/step:65.769 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:387233.000 - perf/time_per_step:65.769 - perf/throughput:735.967
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m Training Progress:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [2:22:21<1:02:44, 117.63s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 101/132 [2:23:25<52:35, 101.79s/it]  
[36m(TaskRunner pid=2024902)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 102/132 [2:24:38<46:27, 92.92s/it] 
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œéœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠåœ¨å…±åŒçŠ¯ç½ªä¸­çš„è§’è‰²ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨å…±åŒçŠ¯ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m å¯¹äºç”²æŸï¼Œè™½ç„¶ä»–çš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä½†åœ¨å…±åŒçŠ¯ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»ç„¶åº”å½“ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚å¯¹äºä¹™æŸï¼Œä»–çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤åº”å½“ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2024902)[0m step:100 - global_seqlen/min:45728.000 - global_seqlen/max:55174.000 - global_seqlen/minmax_diff:9446.000 - global_seqlen/balanced_min:49044.000 - global_seqlen/balanced_max:49246.000 - global_seqlen/mean:49069.875 - actor/entropy_loss:0.226 - actor/kl_loss:0.279 - actor/kl_coef:0.001 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.619 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:46.980 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.604 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.604 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.604 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.604 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.639 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.639 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:196.152 - response_length/max:1024.000 - response_length/min:69.000 - response_length/clip_ratio:0.001 - prompt_length/mean:314.992 - prompt_length/max:628.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.115 - timing_s/old_log_prob:5.371 - timing_s/ref:5.806 - timing_s/adv:0.275 - timing_s/update_actor:34.054 - timing_s/testing:133.305 - timing_s/save_checkpoint:23.971 - timing_s/step:228.921 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.173 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:392559.000 - perf/time_per_step:228.921 - perf/throughput:214.353
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:101 - global_seqlen/min:42824.000 - global_seqlen/max:52620.000 - global_seqlen/minmax_diff:9796.000 - global_seqlen/balanced_min:47467.000 - global_seqlen/balanced_max:47468.000 - global_seqlen/mean:47467.750 - actor/entropy_loss:0.219 - actor/kl_loss:0.196 - actor/kl_coef:0.001 - actor/pg_loss:0.026 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.587 - perf/mfu/actor:0.353 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.532 - actor/lr:0.000 - critic/score/mean:1.628 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.628 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:194.245 - response_length/max:599.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.211 - prompt_length/max:503.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.177 - timing_s/old_log_prob:5.177 - timing_s/ref:5.664 - timing_s/adv:0.275 - timing_s/update_actor:34.463 - timing_s/step:64.787 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/update_actor:0.091 - perf/total_num_tokens:379742.000 - perf/time_per_step:64.787 - perf/throughput:732.670
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 103/132 [2:25:43<40:53, 84.59s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [2:26:49<36:53, 79.04s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/132 [2:27:58<34:12, 76.03s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 106/132 [2:29:05<31:44, 73.25s/it]
[36m(TaskRunner pid=2024902)[0m step:102 - global_seqlen/min:45444.000 - global_seqlen/max:52676.000 - global_seqlen/minmax_diff:7232.000 - global_seqlen/balanced_min:48844.000 - global_seqlen/balanced_max:48968.000 - global_seqlen/mean:48859.500 - actor/entropy_loss:0.216 - actor/kl_loss:0.242 - actor/kl_coef:0.001 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.594 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.245 - actor/lr:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:197.578 - response_length/max:1024.000 - response_length/min:58.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.375 - prompt_length/max:514.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.376 - timing_s/old_log_prob:5.384 - timing_s/ref:5.801 - timing_s/adv:0.289 - timing_s/update_actor:34.327 - timing_s/step:72.202 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.174 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:390876.000 - perf/time_per_step:72.202 - perf/throughput:676.706
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:103 - global_seqlen/min:45994.000 - global_seqlen/max:50863.000 - global_seqlen/minmax_diff:4869.000 - global_seqlen/balanced_min:48393.000 - global_seqlen/balanced_max:48394.000 - global_seqlen/mean:48393.750 - actor/entropy_loss:0.211 - actor/kl_loss:0.215 - actor/kl_coef:0.001 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.652 - perf/mfu/actor:0.355 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.201 - actor/lr:0.000 - critic/score/mean:1.665 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.665 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:199.578 - response_length/max:558.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.523 - prompt_length/max:565.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.625 - timing_s/old_log_prob:5.405 - timing_s/ref:5.857 - timing_s/adv:0.281 - timing_s/update_actor:34.941 - timing_s/step:65.129 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.090 - perf/total_num_tokens:387150.000 - perf/time_per_step:65.129 - perf/throughput:743.047
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:104 - global_seqlen/min:46395.000 - global_seqlen/max:54349.000 - global_seqlen/minmax_diff:7954.000 - global_seqlen/balanced_min:49716.000 - global_seqlen/balanced_max:49717.000 - global_seqlen/mean:49716.125 - actor/entropy_loss:0.204 - actor/kl_loss:0.241 - actor/kl_coef:0.001 - actor/pg_loss:0.130 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.591 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.202 - actor/lr:0.000 - critic/score/mean:1.668 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.668 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.032 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.032 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:217.236 - response_length/max:529.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:581.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.647 - timing_s/old_log_prob:5.661 - timing_s/ref:5.963 - timing_s/adv:0.283 - timing_s/update_actor:35.503 - timing_s/step:66.083 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:397729.000 - perf/time_per_step:66.083 - perf/throughput:752.328
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:105 - global_seqlen/min:43793.000 - global_seqlen/max:55400.000 - global_seqlen/minmax_diff:11607.000 - global_seqlen/balanced_min:50047.000 - global_seqlen/balanced_max:50129.000 - global_seqlen/mean:50057.625 - actor/entropy_loss:0.219 - actor/kl_loss:0.224 - actor/kl_coef:0.001 - actor/pg_loss:0.051 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.588 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.170 - actor/lr:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:206.113 - response_length/max:786.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.320 - prompt_length/max:613.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.173 - timing_s/old_log_prob:5.545 - timing_s/ref:5.949 - timing_s/adv:0.288 - timing_s/update_actor:35.006 - timing_s/step:68.987 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.140 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:400461.000 - perf/time_per_step:68.987 - perf/throughput:725.612
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:106 - global_seqlen/min:46567.000 - global_seqlen/max:55739.000 - global_seqlen/minmax_diff:9172.000 - global_seqlen/balanced_min:50476.000 - global_seqlen/balanced_max:50477.000 - global_seqlen/mean:50476.500 - actor/entropy_loss:0.208 - actor/kl_loss:0.255 - actor/kl_coef:0.001 - actor/pg_loss:0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.594 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.206 - actor/lr:0.000 - critic/score/mean:1.605 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.605 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.172 - response_length/max:564.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.625 - prompt_length/max:820.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.199 - timing_s/old_log_prob:5.628 - timing_s/ref:5.959 - timing_s/adv:0.291 - timing_s/update_actor:35.633 - timing_s/step:66.732 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:403812.000 - perf/time_per_step:66.732 - perf/throughput:756.411
[36m(TaskRunner pid=2024902)[0m Training Progress:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 107/132 [2:30:12<29:50, 71.63s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/132 [2:31:18<27:52, 69.67s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/132 [2:32:24<26:20, 68.71s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:107 - global_seqlen/min:44437.000 - global_seqlen/max:53592.000 - global_seqlen/minmax_diff:9155.000 - global_seqlen/balanced_min:49133.000 - global_seqlen/balanced_max:49134.000 - global_seqlen/mean:49133.500 - actor/entropy_loss:0.205 - actor/kl_loss:0.229 - actor/kl_coef:0.001 - actor/pg_loss:0.005 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.474 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.175 - actor/lr:0.000 - critic/score/mean:1.605 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.605 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:205.112 - response_length/max:705.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.695 - prompt_length/max:539.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.363 - timing_s/old_log_prob:5.507 - timing_s/ref:5.867 - timing_s/adv:0.285 - timing_s/update_actor:34.742 - timing_s/step:67.788 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:393068.000 - perf/time_per_step:67.788 - perf/throughput:724.807
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:108 - global_seqlen/min:44126.000 - global_seqlen/max:51514.000 - global_seqlen/minmax_diff:7388.000 - global_seqlen/balanced_min:48771.000 - global_seqlen/balanced_max:48771.000 - global_seqlen/mean:48771.000 - actor/entropy_loss:0.193 - actor/kl_loss:0.248 - actor/kl_coef:0.001 - actor/pg_loss:-0.062 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.676 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.168 - actor/lr:0.000 - critic/score/mean:1.678 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.678 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:202.359 - response_length/max:625.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.672 - prompt_length/max:531.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.916 - timing_s/old_log_prob:5.392 - timing_s/ref:5.785 - timing_s/adv:0.280 - timing_s/update_actor:33.695 - timing_s/step:65.088 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:390168.000 - perf/time_per_step:65.088 - perf/throughput:749.307
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:109 - global_seqlen/min:47017.000 - global_seqlen/max:52513.000 - global_seqlen/minmax_diff:5496.000 - global_seqlen/balanced_min:50612.000 - global_seqlen/balanced_max:50613.000 - global_seqlen/mean:50612.500 - actor/entropy_loss:0.192 - actor/kl_loss:0.227 - actor/kl_coef:0.001 - actor/pg_loss:0.083 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.563 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.091 - actor/lr:0.000 - critic/score/mean:1.629 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.629 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:218.206 - response_length/max:584.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.008 - prompt_length/max:685.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.490 - timing_s/old_log_prob:5.688 - timing_s/ref:6.053 - timing_s/adv:0.297 - timing_s/update_actor:34.905 - timing_s/step:66.454 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:404900.000 - perf/time_per_step:66.454 - perf/throughput:761.615
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šåˆ‘æ³•ã€‹çš„è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œéœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠåœ¨å…±åŒçŠ¯ç½ªä¸­çš„è§’è‰²ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Aé€‰é¡¹ï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Bé€‰é¡¹ï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 110/132 [2:35:53<40:34, 110.66s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 111/132 [2:37:06<34:47, 99.39s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 112/132 [2:38:12<29:52, 89.60s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 113/132 [2:39:26<26:52, 84.88s/it]
[36m(TaskRunner pid=2024902)[0m Cé€‰é¡¹ï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œåº”è¯¥ä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Dé€‰é¡¹ï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œåº”è¯¥ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:110 - global_seqlen/min:45481.000 - global_seqlen/max:54510.000 - global_seqlen/minmax_diff:9029.000 - global_seqlen/balanced_min:51021.000 - global_seqlen/balanced_max:51172.000 - global_seqlen/mean:51040.000 - actor/entropy_loss:0.198 - actor/kl_loss:0.247 - actor/kl_coef:0.001 - actor/pg_loss:0.158 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.532 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.170 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.606 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.606 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.606 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.606 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.606 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.606 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.617 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.617 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:216.815 - response_length/max:1024.000 - response_length/min:72.000 - response_length/clip_ratio:0.001 - prompt_length/mean:314.852 - prompt_length/max:545.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.534 - timing_s/old_log_prob:5.733 - timing_s/ref:6.116 - timing_s/adv:0.290 - timing_s/update_actor:36.043 - timing_s/testing:133.772 - timing_s/step:208.511 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.159 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:408320.000 - perf/time_per_step:208.511 - perf/throughput:244.783
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:111 - global_seqlen/min:47095.000 - global_seqlen/max:55037.000 - global_seqlen/minmax_diff:7942.000 - global_seqlen/balanced_min:50819.000 - global_seqlen/balanced_max:51054.000 - global_seqlen/mean:50848.500 - actor/entropy_loss:0.194 - actor/kl_loss:0.305 - actor/kl_coef:0.001 - actor/pg_loss:0.079 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.624 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.225 - actor/lr:0.000 - critic/score/mean:1.557 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.557 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.021 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.021 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:221.695 - response_length/max:1024.000 - response_length/min:57.000 - response_length/clip_ratio:0.001 - prompt_length/mean:307.977 - prompt_length/max:640.000 - prompt_length/min:232.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.100 - timing_s/old_log_prob:5.480 - timing_s/ref:5.919 - timing_s/adv:0.296 - timing_s/update_actor:35.242 - timing_s/step:73.069 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:406788.000 - perf/time_per_step:73.069 - perf/throughput:695.895
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:112 - global_seqlen/min:45180.000 - global_seqlen/max:55708.000 - global_seqlen/minmax_diff:10528.000 - global_seqlen/balanced_min:50410.000 - global_seqlen/balanced_max:50411.000 - global_seqlen/mean:50410.125 - actor/entropy_loss:0.196 - actor/kl_loss:0.289 - actor/kl_coef:0.001 - actor/pg_loss:0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.603 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.265 - actor/lr:0.000 - critic/score/mean:1.630 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.630 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.019 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:216.684 - response_length/max:575.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.422 - prompt_length/max:574.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.765 - timing_s/old_log_prob:5.603 - timing_s/ref:6.007 - timing_s/adv:0.289 - timing_s/update_actor:35.049 - timing_s/step:66.739 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:403281.000 - perf/time_per_step:66.739 - perf/throughput:755.335
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 114/132 [2:40:32<23:44, 79.16s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 115/132 [2:41:39<21:22, 75.47s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [2:42:46<19:27, 72.95s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/132 [2:43:54<17:50, 71.36s/it]
[36m(TaskRunner pid=2024902)[0m step:113 - global_seqlen/min:47442.000 - global_seqlen/max:52787.000 - global_seqlen/minmax_diff:5345.000 - global_seqlen/balanced_min:49785.000 - global_seqlen/balanced_max:50001.000 - global_seqlen/mean:49833.125 - actor/entropy_loss:0.203 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.495 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.267 - actor/lr:0.000 - critic/score/mean:1.623 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.623 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:213.111 - response_length/max:1024.000 - response_length/min:57.000 - response_length/clip_ratio:0.003 - prompt_length/mean:305.984 - prompt_length/max:487.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.534 - timing_s/old_log_prob:5.527 - timing_s/ref:5.936 - timing_s/adv:0.290 - timing_s/update_actor:35.547 - timing_s/step:73.854 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.162 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:398665.000 - perf/time_per_step:73.854 - perf/throughput:674.753
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:114 - global_seqlen/min:45088.000 - global_seqlen/max:54411.000 - global_seqlen/minmax_diff:9323.000 - global_seqlen/balanced_min:49893.000 - global_seqlen/balanced_max:49894.000 - global_seqlen/mean:49893.250 - actor/entropy_loss:0.202 - actor/kl_loss:0.243 - actor/kl_coef:0.001 - actor/pg_loss:0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.611 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.086 - actor/lr:0.000 - critic/score/mean:1.629 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.629 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.706 - response_length/max:610.000 - response_length/min:47.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:512.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.371 - timing_s/old_log_prob:5.471 - timing_s/ref:5.922 - timing_s/adv:0.298 - timing_s/update_actor:34.678 - timing_s/step:65.766 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:399146.000 - perf/time_per_step:65.766 - perf/throughput:758.654
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:115 - global_seqlen/min:46752.000 - global_seqlen/max:56111.000 - global_seqlen/minmax_diff:9359.000 - global_seqlen/balanced_min:49663.000 - global_seqlen/balanced_max:49664.000 - global_seqlen/mean:49663.250 - actor/entropy_loss:0.203 - actor/kl_loss:0.288 - actor/kl_coef:0.001 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.629 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.072 - actor/lr:0.000 - critic/score/mean:1.635 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.635 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:212.115 - response_length/max:600.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.211 - prompt_length/max:516.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.730 - timing_s/old_log_prob:5.603 - timing_s/ref:5.967 - timing_s/adv:0.291 - timing_s/update_actor:35.195 - timing_s/step:66.807 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:397306.000 - perf/time_per_step:66.807 - perf/throughput:743.384
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:116 - global_seqlen/min:48010.000 - global_seqlen/max:56607.000 - global_seqlen/minmax_diff:8597.000 - global_seqlen/balanced_min:51132.000 - global_seqlen/balanced_max:51133.000 - global_seqlen/mean:51132.500 - actor/entropy_loss:0.199 - actor/kl_loss:0.196 - actor/kl_coef:0.001 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.528 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.073 - actor/lr:0.000 - critic/score/mean:1.654 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.654 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:223.138 - response_length/max:628.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.492 - prompt_length/max:808.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.113 - timing_s/old_log_prob:5.653 - timing_s/ref:5.962 - timing_s/adv:0.288 - timing_s/update_actor:35.002 - timing_s/step:67.044 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:409060.000 - perf/time_per_step:67.044 - perf/throughput:762.666
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:117 - global_seqlen/min:46585.000 - global_seqlen/max:59612.000 - global_seqlen/minmax_diff:13027.000 - global_seqlen/balanced_min:53640.000 - global_seqlen/balanced_max:53640.000 - global_seqlen/mean:53640.000 - actor/entropy_loss:0.194 - actor/kl_loss:0.183 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.121 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.111 - actor/lr:0.000 - critic/score/mean:1.652 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.652 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.375 - response_length/max:561.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.375 - prompt_length/max:609.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.636 - timing_s/old_log_prob:5.864 - timing_s/ref:6.126 - timing_s/adv:0.300 - timing_s/update_actor:35.684 - timing_s/step:67.631 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:429120.000 - perf/time_per_step:67.631 - perf/throughput:793.124
[36m(TaskRunner pid=2024902)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 118/132 [2:45:02<16:28, 70.58s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 119/132 [2:46:13<15:15, 70.43s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [2:49:43<22:30, 112.53s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:118 - global_seqlen/min:49391.000 - global_seqlen/max:55467.000 - global_seqlen/minmax_diff:6076.000 - global_seqlen/balanced_min:52020.000 - global_seqlen/balanced_max:52021.000 - global_seqlen/mean:52020.750 - actor/entropy_loss:0.186 - actor/kl_loss:0.229 - actor/kl_coef:0.001 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.548 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.204 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.016 - response_length/max:606.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.867 - prompt_length/max:512.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.808 - timing_s/old_log_prob:5.847 - timing_s/ref:6.180 - timing_s/adv:0.292 - timing_s/update_actor:36.578 - timing_s/step:68.729 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:416166.000 - perf/time_per_step:68.729 - perf/throughput:756.896
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:119 - global_seqlen/min:48684.000 - global_seqlen/max:54819.000 - global_seqlen/minmax_diff:6135.000 - global_seqlen/balanced_min:52894.000 - global_seqlen/balanced_max:52895.000 - global_seqlen/mean:52894.375 - actor/entropy_loss:0.196 - actor/kl_loss:0.212 - actor/kl_coef:0.001 - actor/pg_loss:-0.045 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.608 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.164 - actor/lr:0.000 - critic/score/mean:1.692 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.692 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:232.405 - response_length/max:659.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:318.578 - prompt_length/max:611.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.576 - timing_s/old_log_prob:5.914 - timing_s/ref:6.239 - timing_s/adv:0.305 - timing_s/update_actor:36.993 - timing_s/step:70.049 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:423155.000 - perf/time_per_step:70.049 - perf/throughput:755.101
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šåˆ‘æ³•ã€‹çš„è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œæˆ‘ä»¬éœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠä»–ä»¬çš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Aé€‰é¡¹ï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Bé€‰é¡¹ï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºå±äºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Cé€‰é¡¹ï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œåº”è¯¥ä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Dé€‰é¡¹ï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œåº”è¯¥ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/132 [2:50:52<18:12, 99.30s/it] 
[36m(TaskRunner pid=2024902)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 122/132 [2:52:02<15:05, 90.50s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 123/132 [2:53:14<12:46, 85.17s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [2:54:23<10:42, 80.33s/it]
[36m(TaskRunner pid=2024902)[0m step:120 - global_seqlen/min:48979.000 - global_seqlen/max:55969.000 - global_seqlen/minmax_diff:6990.000 - global_seqlen/balanced_min:52863.000 - global_seqlen/balanced_max:52864.000 - global_seqlen/mean:52863.375 - actor/entropy_loss:0.184 - actor/kl_loss:0.202 - actor/kl_coef:0.001 - actor/pg_loss:-0.077 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.600 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.222 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.605 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.605 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.605 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.605 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.605 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.605 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.704 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.704 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:241.176 - response_length/max:1024.000 - response_length/min:56.000 - response_length/clip_ratio:0.001 - prompt_length/mean:309.484 - prompt_length/max:550.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.217 - timing_s/old_log_prob:5.869 - timing_s/ref:6.127 - timing_s/adv:0.297 - timing_s/update_actor:36.466 - timing_s/testing:135.760 - timing_s/step:210.761 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:422907.000 - perf/time_per_step:210.761 - perf/throughput:250.821
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:121 - global_seqlen/min:50366.000 - global_seqlen/max:57105.000 - global_seqlen/minmax_diff:6739.000 - global_seqlen/balanced_min:54095.000 - global_seqlen/balanced_max:54096.000 - global_seqlen/mean:54095.625 - actor/entropy_loss:0.178 - actor/kl_loss:0.216 - actor/kl_coef:0.001 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.559 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.174 - actor/lr:0.000 - critic/score/mean:1.673 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.673 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:252.637 - response_length/max:546.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.859 - prompt_length/max:443.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.030 - timing_s/old_log_prob:5.915 - timing_s/ref:6.276 - timing_s/adv:0.309 - timing_s/update_actor:36.855 - timing_s/step:68.413 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:432765.000 - perf/time_per_step:68.413 - perf/throughput:790.725
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:122 - global_seqlen/min:49933.000 - global_seqlen/max:57602.000 - global_seqlen/minmax_diff:7669.000 - global_seqlen/balanced_min:53948.000 - global_seqlen/balanced_max:53949.000 - global_seqlen/mean:53948.875 - actor/entropy_loss:0.185 - actor/kl_loss:0.204 - actor/kl_coef:0.001 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.499 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.147 - actor/lr:0.000 - critic/score/mean:1.621 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.621 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:247.803 - response_length/max:637.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.164 - prompt_length/max:640.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.595 - timing_s/old_log_prob:6.085 - timing_s/ref:6.332 - timing_s/adv:0.300 - timing_s/update_actor:36.618 - timing_s/step:69.956 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:431591.000 - perf/time_per_step:69.956 - perf/throughput:771.188
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:123 - global_seqlen/min:52253.000 - global_seqlen/max:58457.000 - global_seqlen/minmax_diff:6204.000 - global_seqlen/balanced_min:55699.000 - global_seqlen/balanced_max:55700.000 - global_seqlen/mean:55699.625 - actor/entropy_loss:0.184 - actor/kl_loss:0.177 - actor/kl_coef:0.001 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.456 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.202 - actor/lr:0.000 - critic/score/mean:1.671 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.671 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.016 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.016 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:256.439 - response_length/max:738.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.766 - prompt_length/max:541.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.323 - timing_s/old_log_prob:6.166 - timing_s/ref:6.421 - timing_s/adv:0.305 - timing_s/update_actor:37.449 - timing_s/step:72.684 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:445597.000 - perf/time_per_step:72.684 - perf/throughput:766.323
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 125/132 [2:55:32<08:56, 76.68s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 126/132 [2:56:42<07:28, 74.69s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 127/132 [2:57:50<06:04, 72.86s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [2:59:02<04:49, 72.41s/it]
[36m(TaskRunner pid=2024902)[0m step:124 - global_seqlen/min:49239.000 - global_seqlen/max:56092.000 - global_seqlen/minmax_diff:6853.000 - global_seqlen/balanced_min:52958.000 - global_seqlen/balanced_max:52959.000 - global_seqlen/mean:52958.875 - actor/entropy_loss:0.189 - actor/kl_loss:0.173 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.547 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.114 - actor/lr:0.000 - critic/score/mean:1.661 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.661 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.026 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.026 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:247.835 - response_length/max:602.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.820 - prompt_length/max:555.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.406 - timing_s/old_log_prob:5.920 - timing_s/ref:6.221 - timing_s/adv:0.293 - timing_s/update_actor:36.168 - timing_s/step:69.028 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:423671.000 - perf/time_per_step:69.028 - perf/throughput:767.207
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:125 - global_seqlen/min:47832.000 - global_seqlen/max:59920.000 - global_seqlen/minmax_diff:12088.000 - global_seqlen/balanced_min:52499.000 - global_seqlen/balanced_max:52500.000 - global_seqlen/mean:52499.625 - actor/entropy_loss:0.187 - actor/kl_loss:0.179 - actor/kl_coef:0.001 - actor/pg_loss:-0.026 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.407 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.131 - actor/lr:0.000 - critic/score/mean:1.691 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.691 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:242.121 - response_length/max:596.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.750 - prompt_length/max:583.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.182 - timing_s/old_log_prob:5.747 - timing_s/ref:6.059 - timing_s/adv:0.293 - timing_s/update_actor:35.845 - timing_s/step:68.145 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:419997.000 - perf/time_per_step:68.145 - perf/throughput:770.412
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:126 - global_seqlen/min:48614.000 - global_seqlen/max:58698.000 - global_seqlen/minmax_diff:10084.000 - global_seqlen/balanced_min:53728.000 - global_seqlen/balanced_max:53729.000 - global_seqlen/mean:53728.875 - actor/entropy_loss:0.180 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:0.068 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.586 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.406 - actor/lr:0.000 - critic/score/mean:1.604 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.604 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:247.613 - response_length/max:582.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.062 - prompt_length/max:567.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.033 - timing_s/old_log_prob:6.079 - timing_s/ref:6.249 - timing_s/adv:0.298 - timing_s/update_actor:37.347 - timing_s/step:70.027 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:429831.000 - perf/time_per_step:70.027 - perf/throughput:767.254
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:127 - global_seqlen/min:50366.000 - global_seqlen/max:55606.000 - global_seqlen/minmax_diff:5240.000 - global_seqlen/balanced_min:52490.000 - global_seqlen/balanced_max:52491.000 - global_seqlen/mean:52490.625 - actor/entropy_loss:0.192 - actor/kl_loss:0.214 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.563 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.226 - actor/lr:0.000 - critic/score/mean:1.635 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.635 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.270 - response_length/max:612.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.508 - prompt_length/max:604.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.343 - timing_s/old_log_prob:5.759 - timing_s/ref:6.144 - timing_s/adv:0.292 - timing_s/update_actor:36.016 - timing_s/step:68.581 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:419925.000 - perf/time_per_step:68.581 - perf/throughput:765.381
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:128 - global_seqlen/min:48736.000 - global_seqlen/max:58496.000 - global_seqlen/minmax_diff:9760.000 - global_seqlen/balanced_min:53562.000 - global_seqlen/balanced_max:53563.000 - global_seqlen/mean:53562.500 - actor/entropy_loss:0.181 - actor/kl_loss:0.196 - actor/kl_coef:0.001 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.479 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.353 - actor/lr:0.000 - critic/score/mean:1.649 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.649 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:244.857 - response_length/max:689.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.086 - prompt_length/max:789.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.851 - timing_s/old_log_prob:5.922 - timing_s/ref:6.286 - timing_s/adv:0.309 - timing_s/update_actor:36.937 - timing_s/step:71.324 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:428500.000 - perf/time_per_step:71.324 - perf/throughput:750.973
[36m(TaskRunner pid=2024902)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 129/132 [3:00:17<03:39, 73.18s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 130/132 [3:03:44<03:47, 113.58s/it]
[36m(TaskRunner pid=2024902)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [3:05:01<01:42, 102.56s/it]
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:129 - global_seqlen/min:49329.000 - global_seqlen/max:54383.000 - global_seqlen/minmax_diff:5054.000 - global_seqlen/balanced_min:52420.000 - global_seqlen/balanced_max:52553.000 - global_seqlen/mean:52437.500 - actor/entropy_loss:0.186 - actor/kl_loss:0.200 - actor/kl_coef:0.001 - actor/pg_loss:0.101 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.519 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.242 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:241.419 - response_length/max:1024.000 - response_length/min:60.000 - response_length/clip_ratio:0.001 - prompt_length/mean:304.805 - prompt_length/max:441.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.667 - timing_s/old_log_prob:5.766 - timing_s/ref:6.138 - timing_s/adv:0.294 - timing_s/update_actor:36.073 - timing_s/step:74.962 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:419500.000 - perf/time_per_step:74.962 - perf/throughput:699.525
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šåˆ‘æ³•ã€‹çš„è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œæˆ‘ä»¬éœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠä»–ä»¬çš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Aé€‰é¡¹ï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Bé€‰é¡¹ï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºå±äºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´ï¼Œå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä»ç„¶å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Cé€‰é¡¹ï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Dé€‰é¡¹ï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m step:130 - global_seqlen/min:52321.000 - global_seqlen/max:57020.000 - global_seqlen/minmax_diff:4699.000 - global_seqlen/balanced_min:54642.000 - global_seqlen/balanced_max:54642.000 - global_seqlen/mean:54642.000 - actor/entropy_loss:0.185 - actor/kl_loss:0.174 - actor/kl_coef:0.001 - actor/pg_loss:-0.017 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.796 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.297 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.617 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.617 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.617 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.617 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.639 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.639 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:254.023 - response_length/max:701.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.164 - prompt_length/max:765.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.319 - timing_s/old_log_prob:6.019 - timing_s/ref:6.287 - timing_s/adv:0.314 - timing_s/update_actor:36.767 - timing_s/testing:137.111 - timing_s/step:207.839 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:437136.000 - perf/time_per_step:207.839 - perf/throughput:262.906
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m step:131 - global_seqlen/min:53375.000 - global_seqlen/max:60202.000 - global_seqlen/minmax_diff:6827.000 - global_seqlen/balanced_min:55822.000 - global_seqlen/balanced_max:55865.000 - global_seqlen/mean:55827.500 - actor/entropy_loss:0.174 - actor/kl_loss:0.197 - actor/kl_coef:0.001 - actor/pg_loss:0.076 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.428 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.369 - actor/lr:0.000 - critic/score/mean:1.622 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.622 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.017 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.017 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:267.263 - response_length/max:1024.000 - response_length/min:60.000 - response_length/clip_ratio:0.001 - prompt_length/mean:314.273 - prompt_length/max:445.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.408 - timing_s/old_log_prob:6.049 - timing_s/ref:6.342 - timing_s/adv:0.302 - timing_s/update_actor:37.680 - timing_s/step:76.813 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:446620.000 - perf/time_per_step:76.813 - perf/throughput:726.795
[36m(TaskRunner pid=2024902)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=2024902)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=2024902)[0m validation generation end
[36m(TaskRunner pid=2024902)[0m [prompt] system
[36m(TaskRunner pid=2024902)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=2024902)[0m user
[36m(TaskRunner pid=2024902)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=2024902)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=2024902)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=2024902)[0m assistant
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šåˆ‘æ³•ã€‹çš„è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚å¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œæˆ‘ä»¬éœ€è¦åˆ†æä»–ä»¬çš„æ•…æ„æ˜¯å¦ç›¸åŒï¼Œä»¥åŠä»–ä»¬çš„è¡Œä¸ºæ˜¯å¦æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Aé€‰é¡¹ï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬ä»ç„¶å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Bé€‰é¡¹ï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºå±äºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´ï¼Œå³ä½¿ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä»ç„¶å¯ä»¥æ„æˆå…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Cé€‰é¡¹ï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m Dé€‰é¡¹ï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ã€‚
[36m(TaskRunner pid=2024902)[0m 
[36m(TaskRunner pid=2024902)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=2024902)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”> </æ€è€ƒ> </å›ç­”>
[36m(TaskRunner pid=2024902)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=2024902)[0m [score] 2.0
[36m(TaskRunner pid=2024902)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=2024902)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=2027883)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=2024902)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [3:08:59<01:26, 86.56s/it] 
[36m(TaskRunner pid=2024902)[0m step:132 - global_seqlen/min:51807.000 - global_seqlen/max:58675.000 - global_seqlen/minmax_diff:6868.000 - global_seqlen/balanced_min:54794.000 - global_seqlen/balanced_max:54902.000 - global_seqlen/mean:54808.000 - actor/entropy_loss:0.183 - actor/kl_loss:0.178 - actor/kl_coef:0.001 - actor/pg_loss:0.068 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.506 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:44.509 - perf/max_memory_reserved_gb:56.836 - perf/cpu_memory_used_gb:47.405 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.619 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.619 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.619 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.619 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.619 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.619 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.584 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.584 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.018 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.018 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.135 - response_length/max:1015.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.781 - prompt_length/max:498.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.898 - timing_s/old_log_prob:5.940 - timing_s/ref:6.191 - timing_s/adv:0.300 - timing_s/update_actor:36.403 - timing_s/testing:138.246 - timing_s/save_checkpoint:24.077 - timing_s/step:238.080 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:438464.000 - perf/time_per_step:238.080 - perf/throughput:230.209
[36m(TaskRunner pid=2024902)[0m ("Final validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(1.6189777476495326), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(1.6189777476495326), '
[36m(TaskRunner pid=2024902)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(1.6189777476495326), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': np.float64(1.618977756743966), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(1.6189777567439663), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(8.469850997140333e-17), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(1.6189777567439663), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=2024902)[0m  'np.float64(8.469850997140333e-17), '
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=2024902)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=2033801)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffffdf3bff644caa8e227e5f9e3d01000000 Worker ID: 2b2f2740191d616149d25d6cbba7819b303f1181bfc9da490f8b0397 Node ID: 93550c80dd57c1ed09f436aff10ca54c43bb8eb84b3cb1450e24d1b3 Worker IP address: 222.29.51.203 Worker port: 37605 Worker PID: 2033803 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly by a signal. SystemExit is raised (sys.exit is called). Exit code: 1. The process receives a SIGTERM.
