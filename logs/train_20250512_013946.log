2025-05-12 01:39:53,018	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=1060512)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=1060512)[0m                                                              'optimizer',
[36m(TaskRunner pid=1060512)[0m                                                              'extra']},
[36m(TaskRunner pid=1060512)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=1060512)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=1060512)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=1060512)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=1060512)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=1060512)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1060512)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=1060512)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=1060512)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1060512)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=1060512)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=1060512)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=1060512)[0m                                  'loss_agg_mode': 'seq-mean-token-sum-norm',
[36m(TaskRunner pid=1060512)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=1060512)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=1060512)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1060512)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=1060512)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=1060512)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=1060512)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=1060512)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=1060512)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1060512)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m                                  'ppo_micro_batch_size_per_gpu': 4,
[36m(TaskRunner pid=1060512)[0m                                  'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=1060512)[0m                                  'shuffle': False,
[36m(TaskRunner pid=1060512)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=1060512)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1060512)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=1060512)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=1060512)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=1060512)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=1060512)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1060512)[0m                                  'external_lib': None,
[36m(TaskRunner pid=1060512)[0m                                  'override_config': {},
[36m(TaskRunner pid=1060512)[0m                                  'path': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=1060512)[0m                                  'use_liger': False,
[36m(TaskRunner pid=1060512)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=1060512)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=1060512)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1060512)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1060512)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m                                'log_prob_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=1060512)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1060512)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=1060512)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=1060512)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=1060512)[0m                                    'do_sample': True,
[36m(TaskRunner pid=1060512)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=1060512)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=1060512)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=1060512)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=1060512)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=1060512)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=1060512)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=1060512)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=1060512)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1060512)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m                                    'log_prob_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=1060512)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1060512)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=1060512)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=1060512)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=1060512)[0m                                    'n': 6,
[36m(TaskRunner pid=1060512)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=1060512)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=1060512)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=1060512)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=1060512)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=1060512)[0m                                    'top_k': -1,
[36m(TaskRunner pid=1060512)[0m                                    'top_p': 1,
[36m(TaskRunner pid=1060512)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=1060512)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=1060512)[0m                                                   'n': 1,
[36m(TaskRunner pid=1060512)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=1060512)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=1060512)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=1060512)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=1060512)[0m                'gamma': 1.0,
[36m(TaskRunner pid=1060512)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=1060512)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=1060512)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=1060512)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1060512)[0m WARNING:2025-05-12 01:40:04,247:Waiting for register center actor 9PL1RO_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=1069726)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=1069726)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 53.04it/s]
[36m(TaskRunner pid=1060512)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=1060512)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=1060512)[0m                'lam': 1.0,
[36m(TaskRunner pid=1060512)[0m                'norm_adv_by_std_in_grpo': False,
[36m(TaskRunner pid=1060512)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=1060512)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=1060512)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=1060512)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1060512)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1060512)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=1060512)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1060512)[0m                       'external_lib': None,
[36m(TaskRunner pid=1060512)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1060512)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=1060512)[0m                                       'param_offload': False,
[36m(TaskRunner pid=1060512)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1060512)[0m                       'override_config': {},
[36m(TaskRunner pid=1060512)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=1060512)[0m                       'tokenizer_path': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=1060512)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=1060512)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=1060512)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1060512)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=1060512)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=1060512)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=1060512)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=1060512)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=1060512)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1060512)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1060512)[0m             'ppo_mini_batch_size': 16,
[36m(TaskRunner pid=1060512)[0m             'rollout_n': 6,
[36m(TaskRunner pid=1060512)[0m             'shuffle': False,
[36m(TaskRunner pid=1060512)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=1060512)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1060512)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=1060512)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=1060512)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=1060512)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=1060512)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=1060512)[0m           'image_key': 'images',
[36m(TaskRunner pid=1060512)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=1060512)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=1060512)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=1060512)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=1060512)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=1060512)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=1060512)[0m           'shuffle': True,
[36m(TaskRunner pid=1060512)[0m           'tokenizer': None,
[36m(TaskRunner pid=1060512)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=1060512)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=1060512)[0m           'truncation': 'error',
[36m(TaskRunner pid=1060512)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=1060512)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=1060512)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=1060512)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=1060512)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=1060512)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1060512)[0m                   'max_length': None,
[36m(TaskRunner pid=1060512)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=1060512)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1060512)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=1060512)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1060512)[0m                                             'param_offload': False,
[36m(TaskRunner pid=1060512)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1060512)[0m                             'input_tokenizer': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=1060512)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=1060512)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=1060512)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=1060512)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=1060512)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1060512)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=1060512)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=1060512)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=1060512)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=1060512)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=1060512)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=1060512)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=1060512)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=1060512)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=1060512)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=1060512)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=1060512)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=1060512)[0m              'nnodes': 1,
[36m(TaskRunner pid=1060512)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=1060512)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=1060512)[0m              'resume_from_path': None,
[36m(TaskRunner pid=1060512)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=1060512)[0m              'save_freq': 50,
[36m(TaskRunner pid=1060512)[0m              'test_freq': 10,
[36m(TaskRunner pid=1060512)[0m              'total_epochs': 2,
[36m(TaskRunner pid=1060512)[0m              'total_training_steps': None,
[36m(TaskRunner pid=1060512)[0m              'val_before_train': True}}
[36m(TaskRunner pid=1060512)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=1060512)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=1060512)[0m dataset len: 8448
[36m(TaskRunner pid=1060512)[0m dataset len: 2113
[36m(TaskRunner pid=1060512)[0m Size of train dataloader: 66
[36m(TaskRunner pid=1060512)[0m Total training steps: 132
[36m(WorkerDict pid=1069725)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(WorkerDict pid=1069725)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 53.43it/s]
[36m(WorkerDict pid=1069726)[0m [rank3]:[W512 01:40:20.990789205 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=1063595)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=1069727)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069727)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 56.13it/s][32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=1063595)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=1069724)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 56.19it/s][32m [repeated 4x across cluster][0m
[36m(WorkerDict pid=1069729)[0m [rank6]:[W512 01:40:20.379086462 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 6]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1063595)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:04<00:13,  4.42s/it]
[36m(WorkerDict pid=1069729)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069724)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069728)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:12<00:04,  4.23s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=1069728)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  2.96s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.49s/it]
[36m(WorkerDict pid=1069729)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=1069729)[0m   warnings.warn(
[36m(WorkerDict pid=1069724)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.29s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069724)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.02s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.55s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1060512)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(TaskRunner pid=1060512)[0m wandb: Currently logged in as: eang333cms (eang333cms-peking-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=1060512)[0m wandb: Tracking run with wandb version 0.19.9
[36m(TaskRunner pid=1060512)[0m wandb: Run data is saved locally in /home/wangyc/verl/wandb/run-20250512_014108-glqjcart
[36m(TaskRunner pid=1060512)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=1060512)[0m wandb: Syncing run qwen2.5-7b-grpo-mcq
[36m(TaskRunner pid=1060512)[0m wandb: â­ï¸ View project at https://wandb.ai/eang333cms-peking-university/Lawyer-Zero
[36m(TaskRunner pid=1060512)[0m wandb: ğŸš€ View run at https://wandb.ai/eang333cms-peking-university/Lawyer-Zero/runs/glqjcart
[36m(WorkerDict pid=1069726)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1063595)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=1063595)[0m   "architectures": [
[36m(WorkerDict pid=1063595)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1063595)[0m   ],
[36m(WorkerDict pid=1063595)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1063595)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1063595)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1063595)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1063595)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1063595)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1063595)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1063595)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1063595)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1063595)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1063595)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1063595)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1063595)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1063595)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1063595)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1063595)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1063595)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1063595)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1063595)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1063595)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1063595)[0m   "use_cache": false,
[36m(WorkerDict pid=1063595)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1063595)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1063595)[0m }
[36m(WorkerDict pid=1063595)[0m 
[36m(WorkerDict pid=1063595)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1063595)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1063595)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f09c2c06d40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f09c2c06c20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=1063595)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1069724)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=1063595)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=1063595)[0m   "architectures": [
[36m(WorkerDict pid=1063595)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1063595)[0m   ],
[36m(WorkerDict pid=1063595)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1063595)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1063595)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1063595)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1063595)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1063595)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1063595)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1063595)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1063595)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1063595)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1063595)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1063595)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1063595)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1063595)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1063595)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1063595)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1063595)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1063595)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1063595)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1063595)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1063595)[0m   "use_cache": false,
[36m(WorkerDict pid=1063595)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1063595)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1063595)[0m }
[36m(WorkerDict pid=1063595)[0m 
[36m(WorkerDict pid=1069729)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fa13960ad40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fa13960ac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069729)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069725)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1069730)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1063595)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1063595)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f09c2c06d40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f09c2c06c20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=1069725)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=1069725)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1069724)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=1069729)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fa13960ad40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fa13960ac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069726)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1063595)[0m Before building vllm rollout, memory allocated (GB): 3.5471720695495605, memory reserved (GB): 19.66015625
[36m(WorkerDict pid=1069726)[0m WARNING 05-12 01:40:53 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=1063595)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1063595)[0m Actor use_remove_padding=True[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=1069725)[0m WARNING 05-12 01:40:54 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f098d844130>
[36m(WorkerDict pid=1069725)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1069729)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=1063595)[0m WARNING 05-12 01:40:55 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1063595)[0m WARNING 05-12 01:40:55 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f0820928ac0>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069729)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=1063595)[0m After building vllm rollout, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(WorkerDict pid=1063595)[0m After building sharding manager, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(TaskRunner pid=1060512)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=1060512)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=1060512)[0m Training from scratch
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=1069726)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¢˜ç›®æ˜¯å…³äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œæ¶‰åŠç”²å’Œä¹™ä¸¤äººå…±è°‹çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æƒ…å†µã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†åˆ†ææ¯ä¸ªé€‰é¡¹çš„æ­£ç¡®æ€§ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆï¼Œé—®é¢˜ä¸­çš„ç”²å’Œä¹™æœ‰ä¸åŒçš„æ•…æ„å†…å®¹ã€‚ç”²ä»¥ä¸ºè‡ªå·±æ˜¯åœ¨ä¸ºå¢ƒå¤–åŠ¿åŠ›çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ã€‚è¿™é‡Œçš„å…³é”®æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹æ˜¯å¦éœ€è¦ç›¸åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œä»¥åŠä¸åŒæ•…æ„ä¸‹æ˜¯å¦å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m æ ¹æ®ä¸­å›½åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªè¦æ±‚å„å…±åŒçŠ¯ç½ªäººå¿…é¡»æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚å…±åŒæ•…æ„é€šå¸¸æŒ‡çš„æ˜¯å„è¡Œä¸ºäººå¯¹æ‰€å®æ–½çš„çŠ¯ç½ªè¡Œä¸ºåŠå…¶å¯èƒ½äº§ç”Ÿçš„å±å®³ç»“æœæœ‰å…±åŒçš„è®¤è¯†ã€‚å¦‚æœç”²å’Œä¹™çš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºç›®æ ‡ç›¸åŒï¼Œæ˜¯å¦å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªå‘¢ï¼Ÿ
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m æ¯”å¦‚ï¼Œç”²å¯èƒ½æ„æˆé—´è°ç½ªï¼Œè€Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å¦‚æœä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼Œå³çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œé‚£ä¹ˆä»–ä»¬æ˜¯å¦åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Ÿå› ä¸ºä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œè€Œç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–åŠ¿åŠ›è·å–ï¼Œä½†è¡Œä¸ºæœ¬èº«å¯èƒ½é‡åˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç”²å¯èƒ½æ„æˆé—´è°ç½ªï¼Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œä½†ä¸¤äººåœ¨éæ³•è·å–çš„èŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œå› æ­¤å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç°åœ¨çœ‹é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºè™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†è¡Œä¸ºç›®æ ‡ç›¸åŒï¼Œå¯èƒ½åœ¨éæ³•è·å–çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Aé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè¯´è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼Œè™½ç„¶åŠ¨æœºä¸åŒï¼Œä½†è¡Œä¸ºæ„æˆè¦ä»¶ç›¸åŒï¼Œå¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥é—´è°ç½ªè®ºå¤„ã€‚å¦‚æœç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–åŠ¿åŠ›æœåŠ¡ï¼Œé‚£ä¹ˆæ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œé—´è°ç½ªç¡®å®å¯èƒ½æˆç«‹ã€‚æ‰€ä»¥Cæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè¯´å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚ä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œæ‰€ä»¥Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m å› æ­¤ï¼Œæ­£ç¡®çš„é€‰é¡¹åº”è¯¥æ˜¯Bã€Cã€Dã€‚ä½†éœ€è¦å†ä»”ç»†æ ¸å¯¹ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ä¾‹å¦‚ï¼Œç”²çš„è¡Œä¸ºæ˜¯å¦åŒæ—¶æ„æˆé—´è°ç½ªå’Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Ÿæ ¹æ®åˆ‘æ³•è§„å®šï¼Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–è€…æƒ…æŠ¥çš„ï¼Œä»¥é—´è°ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œç”²çš„è¡Œä¸ºåº”å®šé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºå®šéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ä¸¤äººåœ¨éæ³•è·å–çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Œæ‰€ä»¥Bæ­£ç¡®ã€‚Cå’ŒDä¹Ÿæ­£ç¡®ã€‚å› æ­¤ï¼Œæ­£ç¡®é€‰é¡¹æ˜¯BCDã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m **é€‰é¡¹åˆ†æï¼š**
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m - **A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª**  
[36m(TaskRunner pid=1060512)[0m   å…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚å„è¡Œä¸ºäººå…·æœ‰å®Œå…¨ç›¸åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œåªè¦åœ¨å…·ä½“çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„å³å¯ã€‚ç”²çš„æ•…æ„æ˜¯â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€ï¼Œä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œä½†ä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼ˆçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼‰ï¼Œä¸”è¯¥è¡Œä¸ºåœ¨â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€çš„æ„æˆè¦ä»¶èŒƒå›´å†…å…·æœ‰å…±åŒæ€§ã€‚å› æ­¤ï¼Œç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚**Aé”™è¯¯**ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m - **B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª**  
[36m(TaskRunner pid=1060512)[0m   ç”²çš„æ•…æ„åŒ…å«â€œä¸ºå¢ƒå¤–â€è¿™ä¸€ç‰¹æ®Šç›®çš„ï¼Œä½†å…¶è¡Œä¸ºï¼ˆçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼‰ä¸ä¹™çš„â€œéæ³•è·å–â€è¡Œä¸ºåœ¨å®¢è§‚è¡Œä¸ºå’Œæ„æˆè¦ä»¶èŒƒå›´å†…ä¸€è‡´ã€‚æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–æƒ…æŠ¥çš„è¡Œä¸ºï¼Œä»¥é—´è°ç½ªè®ºå¤„ã€‚ä½†è‹¥è¡Œä¸ºæœªæ¶‰åŠâ€œä¸ºå¢ƒå¤–â€ç›®çš„ï¼Œä»…æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„å’Œå…±åŒè¡Œä¸ºï¼Œæˆç«‹å…±åŒçŠ¯ç½ªã€‚**Bæ­£ç¡®**ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m - **C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„**  
[36m(TaskRunner pid=1060512)[0m   æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œç”²çš„è¡Œä¸ºç¬¦åˆâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–æƒ…æŠ¥â€çš„æ„æˆè¦ä»¶ï¼Œåº”è®¤å®šä¸ºé—´è°ç½ªã€‚**Cæ­£ç¡®**ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m - **D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„**  
[36m(TaskRunner pid=1060512)[0m   ä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œå…¶è¡Œä¸ºç¬¦åˆåˆ‘æ³•ç¬¬282æ¡éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚**Dæ­£ç¡®**ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m **ç»“è®ºï¼š**  
[36m(TaskRunner pid=1060512)[0m ç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=1069726)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069726)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 0.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 0.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 0.0
[36m(TaskRunner pid=1060512)[0m [acc] 0.0
[36m(TaskRunner pid=1060512)[0m [precision] 0.0
[36m(TaskRunner pid=1060512)[0m [recall] 0.0
[36m(TaskRunner pid=1060512)[0m [f1] 0.0
[36m(TaskRunner pid=1060512)[0m ("Initial validation metrics: {'val-aux/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=1060512)[0m  "0.7482252721249408, 'val-aux/jec-qa-1-multi-choice/reward/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/reward/best@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/reward/best@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': 0.7482252721249408, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/mean@1': 0.4794131566493138, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean': "
[36m(TaskRunner pid=1060512)[0m  '0.4794131566493138, '
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/best@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean': "
[36m(TaskRunner pid=1060512)[0m  '0.4794131566493138, '
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/mean@1': 0.26881211547562706, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean': "
[36m(TaskRunner pid=1060512)[0m  '0.26881211547562706, '
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean': "
[36m(TaskRunner pid=1060512)[0m  '0.26881211547562706, '
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-core/jec-qa-1-multi-choice/acc/mean@1': 0.26881211547562706, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/acc/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-core/jec-qa-1-multi-choice/acc/best@1/mean': 0.26881211547562706, "
[36m(TaskRunner pid=1060512)[0m  "'val-core/jec-qa-1-multi-choice/acc/best@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/acc/worst@1/mean': 0.26881211547562706, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/acc/worst@1/std': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/mean@1': 0.3720224010096229, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/best@1/mean': 0.3720224010096229, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/best@1/std': 3.257634998900128e-18, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/worst@1/mean': 0.3720224010096229, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/precision/worst@1/std': "
[36m(TaskRunner pid=1060512)[0m  "3.257634998900128e-18, 'val-aux/jec-qa-1-multi-choice/recall/mean@1': "
[36m(TaskRunner pid=1060512)[0m  "0.38712730714623755, 'val-aux/jec-qa-1-multi-choice/recall/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/recall/best@1/mean': 0.38712730714623755, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/recall/best@1/std': 3.231363748908998e-18, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/recall/worst@1/mean': 0.38712730714623755, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/recall/worst@1/std': 3.231363748908998e-18, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/mean@1': 0.3699659702972528, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/std@1': 0.0, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/best@1/mean': 0.3699659702972528, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/best@1/std': 1.0981382496292367e-17, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/worst@1/mean': 0.3699659702972528, "
[36m(TaskRunner pid=1060512)[0m  "'val-aux/jec-qa-1-multi-choice/f1/worst@1/std': 1.0981382496292367e-17}")
[36m(TaskRunner pid=1060512)[0m Training Progress:   1%|          | 1/132 [03:10<6:56:54, 190.95s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   2%|â–         | 2/132 [06:19<6:50:53, 189.65s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   2%|â–         | 3/132 [09:27<6:45:48, 188.75s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   3%|â–         | 4/132 [12:32<6:39:18, 187.18s/it]
[36m(TaskRunner pid=1060512)[0m step:0 - val-aux/jec-qa-1-multi-choice/reward/mean@1:0.748 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.748 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.269 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.269 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.372 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.372 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.372 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.387 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.387 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.387 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.370 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.370 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.370 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:1 - global_seqlen/min:117947.000 - global_seqlen/max:125362.000 - global_seqlen/minmax_diff:7415.000 - global_seqlen/balanced_min:121252.000 - global_seqlen/balanced_max:121253.000 - global_seqlen/mean:121252.250 - actor/entropy_loss:587.693 - actor/kl_loss:0.003 - actor/kl_coef:0.001 - actor/pg_loss:-0.066 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.513 - perf/mfu/actor:0.268 - perf/max_memory_allocated_gb:36.700 - perf/max_memory_reserved_gb:56.602 - perf/cpu_memory_used_gb:45.919 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.038 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.038 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:958.779 - response_length/max:1024.000 - response_length/min:455.000 - response_length/clip_ratio:0.665 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:41.048 - timing_s/old_log_prob:13.079 - timing_s/ref:17.868 - timing_s/adv:0.497 - timing_s/update_actor:117.937 - timing_s/step:190.450 - timing_per_token_ms/update_actor:0.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.056 - timing_per_token_ms/ref:0.018 - perf/total_num_tokens:970018.000 - perf/time_per_step:190.450 - perf/throughput:636.664
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:2 - global_seqlen/min:119429.000 - global_seqlen/max:126108.000 - global_seqlen/minmax_diff:6679.000 - global_seqlen/balanced_min:122377.000 - global_seqlen/balanced_max:122378.000 - global_seqlen/mean:122377.750 - actor/entropy_loss:602.288 - actor/kl_loss:0.003 - actor/kl_coef:0.001 - actor/pg_loss:0.194 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.844 - perf/mfu/actor:0.270 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:45.985 - actor/lr:0.000 - critic/score/mean:0.509 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.509 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.032 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:969.589 - response_length/max:1024.000 - response_length/min:559.000 - response_length/clip_ratio:0.689 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:43.470 - timing_s/old_log_prob:13.171 - timing_s/ref:13.235 - timing_s/adv:0.527 - timing_s/update_actor:118.251 - timing_s/step:188.675 - timing_per_token_ms/update_actor:0.121 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:979022.000 - perf/time_per_step:188.675 - perf/throughput:648.617
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:3 - global_seqlen/min:117760.000 - global_seqlen/max:124763.000 - global_seqlen/minmax_diff:7003.000 - global_seqlen/balanced_min:121014.000 - global_seqlen/balanced_max:121015.000 - global_seqlen/mean:121014.750 - actor/entropy_loss:566.226 - actor/kl_loss:0.005 - actor/kl_coef:0.001 - actor/pg_loss:0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.623 - perf/mfu/actor:0.267 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.041 - actor/lr:0.000 - critic/score/mean:0.656 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.656 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.041 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.041 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:958.156 - response_length/max:1024.000 - response_length/min:538.000 - response_length/clip_ratio:0.620 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:42.882 - timing_s/old_log_prob:12.999 - timing_s/ref:13.179 - timing_s/adv:0.503 - timing_s/update_actor:118.059 - timing_s/step:187.645 - timing_per_token_ms/update_actor:0.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.058 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:968118.000 - perf/time_per_step:187.645 - perf/throughput:644.913
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:   4%|â–         | 5/132 [15:35<6:33:11, 185.76s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   5%|â–         | 6/132 [18:34<6:25:39, 183.64s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   5%|â–Œ         | 7/132 [21:32<6:18:32, 181.70s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   6%|â–Œ         | 8/132 [24:26<6:10:17, 179.18s/it]
[36m(TaskRunner pid=1060512)[0m step:4 - global_seqlen/min:112159.000 - global_seqlen/max:119326.000 - global_seqlen/minmax_diff:7167.000 - global_seqlen/balanced_min:117024.000 - global_seqlen/balanced_max:117025.000 - global_seqlen/mean:117024.875 - actor/entropy_loss:530.272 - actor/kl_loss:0.010 - actor/kl_coef:0.001 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.587 - perf/mfu/actor:0.260 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.166 - actor/lr:0.000 - critic/score/mean:0.829 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.829 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.043 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.043 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:913.376 - response_length/max:1024.000 - response_length/min:297.000 - response_length/clip_ratio:0.488 - prompt_length/mean:305.633 - prompt_length/max:513.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:41.130 - timing_s/old_log_prob:12.838 - timing_s/ref:12.914 - timing_s/adv:0.494 - timing_s/update_actor:117.341 - timing_s/step:184.742 - timing_per_token_ms/update_actor:0.125 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.059 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:936199.000 - perf/time_per_step:184.742 - perf/throughput:633.449
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:5 - global_seqlen/min:107448.000 - global_seqlen/max:118981.000 - global_seqlen/minmax_diff:11533.000 - global_seqlen/balanced_min:114581.000 - global_seqlen/balanced_max:114582.000 - global_seqlen/mean:114581.500 - actor/entropy_loss:487.456 - actor/kl_loss:0.020 - actor/kl_coef:0.001 - actor/pg_loss:0.154 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.100 - perf/mfu/actor:0.256 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.090 - actor/lr:0.000 - critic/score/mean:0.974 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.974 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.042 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.042 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:885.393 - response_length/max:1024.000 - response_length/min:304.000 - response_length/clip_ratio:0.380 - prompt_length/mean:308.164 - prompt_length/max:499.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:41.143 - timing_s/old_log_prob:12.374 - timing_s/ref:12.695 - timing_s/adv:0.484 - timing_s/update_actor:116.499 - timing_s/step:183.217 - timing_per_token_ms/update_actor:0.127 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.061 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:916652.000 - perf/time_per_step:183.217 - perf/throughput:625.387
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:6 - global_seqlen/min:105122.000 - global_seqlen/max:113096.000 - global_seqlen/minmax_diff:7974.000 - global_seqlen/balanced_min:109338.000 - global_seqlen/balanced_max:109339.000 - global_seqlen/mean:109338.625 - actor/entropy_loss:431.720 - actor/kl_loss:0.026 - actor/kl_coef:0.001 - actor/pg_loss:-0.071 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.546 - perf/mfu/actor:0.246 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.050 - actor/lr:0.000 - critic/score/mean:1.193 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.193 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.046 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.046 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:826.632 - response_length/max:1024.000 - response_length/min:367.000 - response_length/clip_ratio:0.254 - prompt_length/mean:312.312 - prompt_length/max:547.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:38.949 - timing_s/old_log_prob:12.055 - timing_s/ref:12.449 - timing_s/adv:0.471 - timing_s/update_actor:115.558 - timing_s/step:179.504 - timing_per_token_ms/update_actor:0.132 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.061 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:874709.000 - perf/time_per_step:179.504 - perf/throughput:609.114
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:7 - global_seqlen/min:104384.000 - global_seqlen/max:111745.000 - global_seqlen/minmax_diff:7361.000 - global_seqlen/balanced_min:106510.000 - global_seqlen/balanced_max:106511.000 - global_seqlen/mean:106510.875 - actor/entropy_loss:402.720 - actor/kl_loss:0.031 - actor/kl_coef:0.001 - actor/pg_loss:0.376 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.301 - perf/mfu/actor:0.241 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.124 - actor/lr:0.000 - critic/score/mean:1.243 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.243 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.033 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.033 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:799.520 - response_length/max:1024.000 - response_length/min:421.000 - response_length/clip_ratio:0.161 - prompt_length/mean:309.969 - prompt_length/max:505.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:38.204 - timing_s/old_log_prob:11.779 - timing_s/ref:12.286 - timing_s/adv:0.461 - timing_s/update_actor:114.923 - timing_s/step:177.687 - timing_per_token_ms/update_actor:0.135 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.062 - timing_per_token_ms/ref:0.014 - perf/total_num_tokens:852087.000 - perf/time_per_step:177.687 - perf/throughput:599.428
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:   7%|â–‹         | 9/132 [27:20<6:04:21, 177.73s/it]
[36m(TaskRunner pid=1060512)[0m step:8 - global_seqlen/min:98988.000 - global_seqlen/max:102525.000 - global_seqlen/minmax_diff:3537.000 - global_seqlen/balanced_min:101067.000 - global_seqlen/balanced_max:101068.000 - global_seqlen/mean:101067.375 - actor/entropy_loss:375.542 - actor/kl_loss:0.053 - actor/kl_coef:0.001 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.233 - perf/mfu/actor:0.231 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:45.997 - actor/lr:0.000 - critic/score/mean:1.326 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.326 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.025 - critic/advantages/max:1.500 - critic/advantages/min:-1.667 - critic/returns/mean:-0.025 - critic/returns/max:1.500 - critic/returns/min:-1.667 - response_length/mean:752.145 - response_length/max:1024.000 - response_length/min:407.000 - response_length/clip_ratio:0.094 - prompt_length/mean:300.641 - prompt_length/max:446.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.881 - timing_s/old_log_prob:11.126 - timing_s/ref:11.862 - timing_s/adv:0.466 - timing_s/update_actor:113.375 - timing_s/step:173.735 - timing_per_token_ms/update_actor:0.140 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.064 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:808539.000 - perf/time_per_step:173.735 - perf/throughput:581.732
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:9 - global_seqlen/min:92798.000 - global_seqlen/max:105151.000 - global_seqlen/minmax_diff:12353.000 - global_seqlen/balanced_min:101367.000 - global_seqlen/balanced_max:101368.000 - global_seqlen/mean:101367.375 - actor/entropy_loss:362.882 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:0.124 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.531 - perf/mfu/actor:0.231 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.026 - actor/lr:0.000 - critic/score/mean:1.382 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.382 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.020 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:740.559 - response_length/max:1024.000 - response_length/min:353.000 - response_length/clip_ratio:0.078 - prompt_length/mean:315.352 - prompt_length/max:514.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.956 - timing_s/old_log_prob:11.253 - timing_s/ref:11.967 - timing_s/adv:0.431 - timing_s/update_actor:113.890 - timing_s/step:174.520 - timing_per_token_ms/update_actor:0.140 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.065 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:810939.000 - perf/time_per_step:174.520 - perf/throughput:580.836
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¢˜ç›®æ˜¯å…³äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œæ¶‰åŠç”²å’Œä¹™ä¸¤äººå…±è°‹çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æƒ…å†µã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†åˆ†ææ¯ä¸ªé€‰é¡¹çš„æ­£ç¡®æ€§ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆçœ‹é—®é¢˜ï¼Œç”²ä»¥ä¸ºè‡ªå·±æ˜¯ä¸ºå¢ƒå¤–æœºæ„çªƒå–å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ã€‚ä¸¤äººå…±è°‹å…±åŒå®æ–½è¯¥è¡Œä¸ºã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªéœ€è¦å…±åŒæ•…æ„å’Œå…±åŒè¡Œä¸ºã€‚è¿™é‡Œçš„å…³é”®æ˜¯ä¸¤äººæ˜¯å¦åœ¨åŒä¸€ä¸ªçŠ¯ç½ªæ„æˆèŒƒå›´å†…æœ‰å…±åŒæ•…æ„ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™é‡Œéœ€è¦è€ƒè™‘å…±åŒçŠ¯ç½ªçš„æˆç«‹æ˜¯å¦è¦æ±‚å®Œå…¨ç›¸åŒçš„æ•…æ„å†…å®¹ã€‚æ ¹æ®éƒ¨åˆ†çŠ¯ç½ªå…±åŒè¯´ï¼Œå¦‚æœä¸¤äººåœ¨é‡åˆçš„çŠ¯ç½ªæ„æˆèŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œå³ä½¿åœ¨å…¶ä»–æ–¹é¢æ•…æ„ä¸åŒï¼Œä»å¯æˆç«‹å…±åŒçŠ¯ç½ªã€‚ä¾‹å¦‚ï¼Œç”²å¯èƒ½æ„æˆé—´è°ç½ªï¼ˆä¸ºå¢ƒå¤–çªƒå–ï¼‰ï¼Œè€Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œä½†ä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œæ‰€ä»¥Aé€‰é¡¹é”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè®¤ä¸ºä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ç¬¦åˆéƒ¨åˆ†çŠ¯ç½ªå…±åŒè¯´ï¼Œæ‰€ä»¥Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥é—´è°ç½ªè®ºå¤„ã€‚ä½†ç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–æœºæ„ï¼Œè€Œé—´è°ç½ªè¦æ±‚ä¸ºå¢ƒå¤–æœºæ„æˆ–ç»„ç»‡ï¼Œå¦‚æœç”²æ²¡æœ‰æ˜ç¡®çš„å¢ƒå¤–æœºæ„æ„å›¾ï¼Œå¯èƒ½æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å› æ­¤Cé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè¯´ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œè¿™ç¬¦åˆä¹™çš„æ•…æ„ï¼Œæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç»¼ä¸Šï¼Œæ­£ç¡®é€‰é¡¹æ˜¯Bã€Dã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m **è§£é‡Š**ï¼šå…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚å®Œå…¨ç›¸åŒçš„æ•…æ„å†…å®¹ï¼Œè€Œæ˜¯è¦æ±‚åœ¨é‡åˆçš„çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„ã€‚ç”²çš„æ•…æ„ä¸ºâ€œä¸ºå¢ƒå¤–çªƒå–â€ï¼Œä¹™çš„æ•…æ„ä¸ºâ€œéæ³•è·å–â€ï¼ŒäºŒè€…åœ¨â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€çš„èŒƒå›´å†…å­˜åœ¨é‡åˆï¼Œç¬¦åˆéƒ¨åˆ†çŠ¯ç½ªå…±åŒè¯´ã€‚å› æ­¤ï¼ŒAé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m Training Progress:   8%|â–Š         | 10/132 [38:11<10:58:06, 323.66s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:   8%|â–Š         | 11/132 [41:02<9:18:26, 276.92s/it] 
[36m(TaskRunner pid=1060512)[0m Training Progress:   9%|â–‰         | 12/132 [43:53<8:09:19, 244.66s/it]
[36m(TaskRunner pid=1060512)[0m **è§£é‡Š**ï¼šæ ¹æ®éƒ¨åˆ†çŠ¯ç½ªå…±åŒè¯´ï¼Œç”²çš„â€œä¸ºå¢ƒå¤–çªƒå–â€ä¸ä¹™çš„â€œéæ³•è·å–â€åœ¨â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€çš„èŒƒå›´å†…å…·æœ‰é‡åˆæ€§ï¼ŒäºŒäººåœ¨è¯¥èŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„å’Œå…±åŒè¡Œä¸ºï¼Œæˆç«‹å…±åŒçŠ¯ç½ªã€‚Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m **è§£é‡Š**ï¼šç”²çš„æ•…æ„æ˜¯â€œä¸ºå¢ƒå¤–çªƒå–â€ï¼Œä½†è‹¥æ— æ³•è¯æ˜å…¶æ˜çŸ¥å…·ä½“å¢ƒå¤–æœºæ„æˆ–ç»„ç»‡ï¼Œåˆ™å¯èƒ½å› ç¼ºä¹â€œä¸ºå¢ƒå¤–æœºæ„æˆ–ç»„ç»‡â€çš„ä¸»è§‚è¦ä»¶ï¼Œä¸æ„æˆé—´è°ç½ªã€‚æ­¤æ—¶ï¼Œç”²çš„è¡Œä¸ºåº”è®¤å®šä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚Cé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m **è§£é‡Š**ï¼šä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œå®Œå…¨ç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œåº”ç›´æ¥ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m {BD}</å›ç­”>
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 1.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 0.0
[36m(TaskRunner pid=1060512)[0m [acc] 0.0
[36m(TaskRunner pid=1060512)[0m [precision] 1.0
[36m(TaskRunner pid=1060512)[0m [recall] 0.6666666666666666
[36m(TaskRunner pid=1060512)[0m [f1] 0.8
[36m(TaskRunner pid=1060512)[0m step:10 - global_seqlen/min:96922.000 - global_seqlen/max:105518.000 - global_seqlen/minmax_diff:8596.000 - global_seqlen/balanced_min:99748.000 - global_seqlen/balanced_max:99749.000 - global_seqlen/mean:99748.625 - actor/entropy_loss:353.776 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:-0.040 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.108 - perf/mfu/actor:0.229 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.189 - actor/lr:0.000 - val-aux/jec-qa-1-multi-choice/reward/mean@1:1.373 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:1.373 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.373 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.373 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.373 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.373 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.973 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.973 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.973 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.400 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.400 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.400 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.400 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.400 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.400 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.660 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.660 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.660 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.725 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.725 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.725 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.666 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.666 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.666 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000 - critic/score/mean:1.307 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.307 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:1.333 - critic/advantages/min:-1.667 - critic/returns/mean:-0.015 - critic/returns/max:1.333 - critic/returns/min:-1.667 - response_length/mean:719.408 - response_length/max:1024.000 - response_length/min:334.000 - response_length/clip_ratio:0.052 - prompt_length/mean:319.641 - prompt_length/max:640.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.600 - timing_s/old_log_prob:10.995 - timing_s/ref:11.790 - timing_s/adv:0.436 - timing_s/update_actor:113.158 - timing_s/testing:477.377 - timing_s/step:650.380 - timing_per_token_ms/update_actor:0.142 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.066 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:797989.000 - perf/time_per_step:650.380 - perf/throughput:153.370
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:11 - global_seqlen/min:93060.000 - global_seqlen/max:101754.000 - global_seqlen/minmax_diff:8694.000 - global_seqlen/balanced_min:98041.000 - global_seqlen/balanced_max:98042.000 - global_seqlen/mean:98041.875 - actor/entropy_loss:349.797 - actor/kl_loss:0.064 - actor/kl_coef:0.001 - actor/pg_loss:0.250 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.412 - perf/mfu/actor:0.226 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.276 - actor/lr:0.000 - critic/score/mean:1.395 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.395 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.018 - critic/advantages/max:1.167 - critic/advantages/min:-1.667 - critic/returns/mean:-0.018 - critic/returns/max:1.167 - critic/returns/min:-1.667 - response_length/mean:707.535 - response_length/max:1024.000 - response_length/min:360.000 - response_length/clip_ratio:0.051 - prompt_length/mean:313.734 - prompt_length/max:613.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.548 - timing_s/old_log_prob:10.682 - timing_s/ref:11.488 - timing_s/adv:0.438 - timing_s/update_actor:112.715 - timing_s/step:170.894 - timing_per_token_ms/update_actor:0.144 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.065 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:784335.000 - perf/time_per_step:170.894 - perf/throughput:573.698
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  10%|â–‰         | 13/132 [46:42<7:20:03, 221.88s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  11%|â–ˆ         | 14/132 [49:31<6:44:47, 205.83s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  11%|â–ˆâ–        | 15/132 [52:20<6:19:40, 194.71s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  12%|â–ˆâ–        | 16/132 [55:09<6:01:38, 187.05s/it]
[36m(TaskRunner pid=1060512)[0m step:12 - global_seqlen/min:89020.000 - global_seqlen/max:100239.000 - global_seqlen/minmax_diff:11219.000 - global_seqlen/balanced_min:95833.000 - global_seqlen/balanced_max:95834.000 - global_seqlen/mean:95833.875 - actor/entropy_loss:327.356 - actor/kl_loss:0.072 - actor/kl_coef:0.001 - actor/pg_loss:0.006 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.971 - perf/mfu/actor:0.221 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.262 - actor/lr:0.000 - critic/score/mean:1.365 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.365 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:1.333 - critic/advantages/min:-1.500 - critic/returns/mean:-0.010 - critic/returns/max:1.333 - critic/returns/min:-1.500 - response_length/mean:678.465 - response_length/max:1024.000 - response_length/min:350.000 - response_length/clip_ratio:0.030 - prompt_length/mean:319.805 - prompt_length/max:647.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.840 - timing_s/old_log_prob:10.716 - timing_s/ref:11.521 - timing_s/adv:0.431 - timing_s/update_actor:112.334 - timing_s/step:170.866 - timing_per_token_ms/update_actor:0.147 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:766671.000 - perf/time_per_step:170.866 - perf/throughput:560.872
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:13 - global_seqlen/min:90525.000 - global_seqlen/max:100213.000 - global_seqlen/minmax_diff:9688.000 - global_seqlen/balanced_min:94220.000 - global_seqlen/balanced_max:94221.000 - global_seqlen/mean:94220.125 - actor/entropy_loss:316.602 - actor/kl_loss:0.063 - actor/kl_coef:0.001 - actor/pg_loss:0.096 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.305 - perf/mfu/actor:0.219 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.296 - actor/lr:0.000 - critic/score/mean:1.428 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.428 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:1.333 - critic/advantages/min:-1.667 - critic/returns/mean:-0.009 - critic/returns/max:1.333 - critic/returns/min:-1.667 - response_length/mean:671.413 - response_length/max:1024.000 - response_length/min:283.000 - response_length/clip_ratio:0.020 - prompt_length/mean:310.047 - prompt_length/max:509.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.818 - timing_s/old_log_prob:10.353 - timing_s/ref:11.263 - timing_s/adv:0.433 - timing_s/update_actor:111.535 - timing_s/step:169.423 - timing_per_token_ms/update_actor:0.148 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:753761.000 - perf/time_per_step:169.423 - perf/throughput:556.124
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:14 - global_seqlen/min:88693.000 - global_seqlen/max:97612.000 - global_seqlen/minmax_diff:8919.000 - global_seqlen/balanced_min:92710.000 - global_seqlen/balanced_max:92711.000 - global_seqlen/mean:92710.500 - actor/entropy_loss:302.242 - actor/kl_loss:0.066 - actor/kl_coef:0.001 - actor/pg_loss:-0.035 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.151 - perf/mfu/actor:0.216 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.287 - actor/lr:0.000 - critic/score/mean:1.414 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.414 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:0.833 - critic/advantages/min:-1.667 - critic/returns/mean:-0.009 - critic/returns/max:0.833 - critic/returns/min:-1.667 - response_length/mean:661.133 - response_length/max:1024.000 - response_length/min:291.000 - response_length/clip_ratio:0.021 - prompt_length/mean:304.602 - prompt_length/max:614.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.282 - timing_s/old_log_prob:10.337 - timing_s/ref:11.238 - timing_s/adv:0.409 - timing_s/update_actor:111.430 - timing_s/step:168.719 - timing_per_token_ms/update_actor:0.150 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:741684.000 - perf/time_per_step:168.719 - perf/throughput:549.497
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:15 - global_seqlen/min:88045.000 - global_seqlen/max:96985.000 - global_seqlen/minmax_diff:8940.000 - global_seqlen/balanced_min:93064.000 - global_seqlen/balanced_max:93065.000 - global_seqlen/mean:93064.500 - actor/entropy_loss:306.146 - actor/kl_loss:0.069 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.841 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.224 - actor/lr:0.000 - critic/score/mean:1.445 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.445 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.011 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:657.500 - response_length/max:1024.000 - response_length/min:356.000 - response_length/clip_ratio:0.016 - prompt_length/mean:311.922 - prompt_length/max:562.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.645 - timing_s/old_log_prob:10.270 - timing_s/ref:11.259 - timing_s/adv:0.430 - timing_s/update_actor:111.272 - timing_s/step:168.899 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:744516.000 - perf/time_per_step:168.899 - perf/throughput:551.006
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  13%|â–ˆâ–        | 17/132 [57:57<5:47:44, 181.43s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  14%|â–ˆâ–        | 18/132 [1:00:45<5:36:57, 177.35s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  14%|â–ˆâ–        | 19/132 [1:03:33<5:28:30, 174.43s/it]
[36m(TaskRunner pid=1060512)[0m step:16 - global_seqlen/min:89773.000 - global_seqlen/max:97284.000 - global_seqlen/minmax_diff:7511.000 - global_seqlen/balanced_min:93375.000 - global_seqlen/balanced_max:93376.000 - global_seqlen/mean:93375.125 - actor/entropy_loss:306.346 - actor/kl_loss:0.074 - actor/kl_coef:0.001 - actor/pg_loss:0.027 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.134 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.215 - actor/lr:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:1.167 - critic/advantages/min:-1.667 - critic/returns/mean:-0.010 - critic/returns/max:1.167 - critic/returns/min:-1.667 - response_length/mean:660.947 - response_length/max:1024.000 - response_length/min:350.000 - response_length/clip_ratio:0.018 - prompt_length/mean:311.711 - prompt_length/max:820.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.655 - timing_s/old_log_prob:10.327 - timing_s/ref:11.181 - timing_s/adv:0.408 - timing_s/update_actor:111.662 - timing_s/step:169.254 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:747001.000 - perf/time_per_step:169.254 - perf/throughput:551.687
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:17 - global_seqlen/min:89050.000 - global_seqlen/max:96905.000 - global_seqlen/minmax_diff:7855.000 - global_seqlen/balanced_min:92114.000 - global_seqlen/balanced_max:92115.000 - global_seqlen/mean:92114.500 - actor/entropy_loss:297.502 - actor/kl_loss:0.062 - actor/kl_coef:0.001 - actor/pg_loss:-0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.056 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.346 - actor/lr:0.000 - critic/score/mean:1.460 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.460 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.000 - critic/advantages/min:-1.333 - critic/returns/mean:-0.005 - critic/returns/max:1.000 - critic/returns/min:-1.333 - response_length/mean:647.854 - response_length/max:1024.000 - response_length/min:337.000 - response_length/clip_ratio:0.013 - prompt_length/mean:311.672 - prompt_length/max:798.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.383 - timing_s/old_log_prob:10.234 - timing_s/ref:11.217 - timing_s/adv:0.414 - timing_s/update_actor:111.036 - timing_s/step:168.303 - timing_per_token_ms/update_actor:0.151 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:736916.000 - perf/time_per_step:168.303 - perf/throughput:547.314
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:18 - global_seqlen/min:89287.000 - global_seqlen/max:95900.000 - global_seqlen/minmax_diff:6613.000 - global_seqlen/balanced_min:91368.000 - global_seqlen/balanced_max:91369.000 - global_seqlen/mean:91368.250 - actor/entropy_loss:289.026 - actor/kl_loss:0.094 - actor/kl_coef:0.001 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.989 - perf/mfu/actor:0.213 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.305 - actor/lr:0.000 - critic/score/mean:1.427 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.427 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-1.333 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-1.333 - response_length/mean:639.214 - response_length/max:1024.000 - response_length/min:301.000 - response_length/clip_ratio:0.005 - prompt_length/mean:312.539 - prompt_length/max:574.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.844 - timing_s/old_log_prob:10.180 - timing_s/ref:11.103 - timing_s/adv:0.420 - timing_s/update_actor:111.246 - timing_s/step:167.816 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:730946.000 - perf/time_per_step:167.816 - perf/throughput:544.455
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:19 - global_seqlen/min:86218.000 - global_seqlen/max:97480.000 - global_seqlen/minmax_diff:11262.000 - global_seqlen/balanced_min:91086.000 - global_seqlen/balanced_max:91086.000 - global_seqlen/mean:91086.000 - actor/entropy_loss:284.861 - actor/kl_loss:0.065 - actor/kl_coef:0.001 - actor/pg_loss:-0.051 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.152 - perf/mfu/actor:0.212 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.350 - actor/lr:0.000 - critic/score/mean:1.453 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.453 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:640.594 - response_length/max:1024.000 - response_length/min:345.000 - response_length/clip_ratio:0.009 - prompt_length/mean:308.219 - prompt_length/max:638.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.944 - timing_s/old_log_prob:10.120 - timing_s/ref:11.064 - timing_s/adv:0.426 - timing_s/update_actor:111.026 - timing_s/step:167.601 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:728688.000 - perf/time_per_step:167.601 - perf/throughput:543.470
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m Training Progress:  15%|â–ˆâ–Œ        | 20/132 [1:14:16<9:48:11, 315.10s/it]
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¢˜ç›®æ˜¯å…³äºç”²å’Œä¹™å…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œæ¶‰åŠæ•…æ„çš„ä¸åŒä»¥åŠç½ªåçš„åŒºåˆ†ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†åˆ†ææ¯ä¸ªé€‰é¡¹ï¼Œç»“åˆç›¸å…³æ³•å¾‹æ¡æ–‡å’Œç†è®ºæ¥åˆ¤æ–­æ­£ç¡®æ€§ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆï¼Œé¢˜ç›®æè¿°çš„æ˜¯ç”²ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚é—®é¢˜åœ¨äºå¦‚ä½•è®¤å®šä»–ä»¬çš„è¡Œä¸ºï¼Œç‰¹åˆ«æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹ä»¥åŠå„è‡ªçš„ç½ªåã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™é‡Œéœ€è¦è€ƒè™‘å…±åŒçŠ¯ç½ªçš„æˆç«‹æ¡ä»¶ã€‚æ ¹æ®ä¸­å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªè¦æ±‚å…±åŒæ•…æ„å’Œå…±åŒè¡Œä¸ºã€‚è™½ç„¶ç”²å’Œä¹™çš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ˜¯çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå±äºåŒä¸€çŠ¯ç½ªè¡Œä¸ºã€‚å› æ­¤ï¼Œå³ä½¿æ•…æ„ä¸åŒï¼Œåªè¦åœ¨å…·ä½“çŠ¯ç½ªèŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œå°±å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Aé€‰é¡¹å¯èƒ½ä¸æ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè®¤ä¸ºä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› ä¸ºä»–ä»¬çš„è¡Œä¸ºå±äºéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œè™½ç„¶ç”²æœ‰æ›´è¿›ä¸€æ­¥çš„å¢ƒå¤–æ„å›¾ï¼Œä½†å…±åŒçŠ¯ç½ªå¯ä»¥åŸºäºæ›´åŸºç¡€çš„çŠ¯ç½ªæ„æˆã€‚å› æ­¤Bé€‰é¡¹å¯èƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥å¢ƒå¤–çªƒå–ç­‰ç½ªè®ºå¤„ã€‚ä½†ç”²çš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–ï¼Œè€Œå®é™…å¯èƒ½æ²¡æœ‰å¢ƒå¤–æ„å›¾ï¼Œå› æ­¤å¯èƒ½æ„æˆæ•…æ„çš„è®¤è¯†é”™è¯¯ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå¦‚æœè¡Œä¸ºäººæœ‰éæ³•è·å–çš„æ•…æ„ï¼Œä½†è¯¯è®¤ä¸ºå¯¹è±¡æ˜¯å¢ƒå¤–ï¼Œå¯èƒ½ä»æ„æˆå¢ƒå¤–çªƒå–ç­‰ç½ªã€‚å› æ­¤Cé€‰é¡¹æ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè®¤ä¸ºä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚ä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç»¼ä¸Šï¼Œæ­£ç¡®é€‰é¡¹åº”ä¸ºBã€Cã€Dã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m å…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚æ•…æ„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œåªéœ€åœ¨å…·ä½“çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„ã€‚ç”²çš„æ•…æ„åŒ…å«ä¹™çš„éæ³•è·å–è¡Œä¸ºï¼Œä¹™çš„æ•…æ„ä¹ŸåŒ…å«ç”²çš„å¢ƒå¤–æ„å›¾ï¼ˆå› å¢ƒå¤–è¡Œä¸ºå±äºéæ³•è·å–çš„èŒƒç•´ï¼‰ã€‚å› æ­¤ï¼Œä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼ŒAé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m ç”²çš„å¢ƒå¤–æ„å›¾è¶…å‡ºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä½†ä¹™çš„æ•…æ„å®Œå…¨ç¬¦åˆè¯¥ç½ªã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªå¯åŸºäºæ›´åŸºç¡€çš„çŠ¯ç½ªæ„æˆæˆç«‹ã€‚å› æ­¤ï¼Œä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼ŒBæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ç”²è™½è¯¯è®¤ä¸ºå¯¹è±¡æ˜¯å¢ƒå¤–ï¼Œä½†å…¶è¡Œä¸ºå®¢è§‚ä¸Šç¬¦åˆå¢ƒå¤–çªƒå–ç­‰ç½ªçš„æ„æˆè¦ä»¶ã€‚æ ¹æ®ä¸»å®¢è§‚ç›¸ç»Ÿä¸€åŸåˆ™ï¼Œç”²çš„æ•…æ„å†…å®¹ä¸å½±å“ç½ªåè®¤å®šï¼ŒCæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ä¹™çš„æ•…æ„å®Œå…¨ç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œæ— éœ€è¿›ä¸€æ­¥è¯„ä»·ä¸ºå¢ƒå¤–çŠ¯ç½ªï¼ŒDæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m {BCD}</å›ç­”>
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 2.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [acc] 1.0
[36m(TaskRunner pid=1060512)[0m [precision] 1.0
[36m(TaskRunner pid=1060512)[0m [recall] 1.0
[36m(TaskRunner pid=1060512)[0m [f1] 1.0
[36m(TaskRunner pid=1060512)[0m Training Progress:  16%|â–ˆâ–Œ        | 21/132 [1:17:05<8:21:36, 271.14s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  17%|â–ˆâ–‹        | 22/132 [1:19:53<7:20:50, 240.46s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  17%|â–ˆâ–‹        | 23/132 [1:22:45<6:39:28, 219.89s/it]
[36m(TaskRunner pid=1060512)[0m step:20 - global_seqlen/min:87331.000 - global_seqlen/max:94109.000 - global_seqlen/minmax_diff:6778.000 - global_seqlen/balanced_min:90822.000 - global_seqlen/balanced_max:90822.000 - global_seqlen/mean:90822.000 - actor/entropy_loss:277.958 - actor/kl_loss:0.087 - actor/kl_coef:0.001 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.054 - perf/mfu/actor:0.212 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.310 - actor/lr:0.000 - val-aux/jec-qa-1-multi-choice/reward/mean@1:1.412 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:1.412 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.412 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.412 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.412 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.412 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.426 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.426 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.426 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.426 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.426 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.426 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.672 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.672 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.672 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.734 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.734 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.734 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.678 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.678 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.678 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000 - critic/score/mean:1.414 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.414 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:1.000 - critic/advantages/min:-1.333 - critic/returns/mean:-0.004 - critic/returns/max:1.000 - critic/returns/min:-1.333 - response_length/mean:635.531 - response_length/max:1024.000 - response_length/min:289.000 - response_length/clip_ratio:0.008 - prompt_length/mean:310.531 - prompt_length/max:516.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.866 - timing_s/old_log_prob:10.009 - timing_s/ref:10.957 - timing_s/adv:0.411 - timing_s/update_actor:110.682 - timing_s/testing:475.988 - timing_s/step:642.934 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:726576.000 - perf/time_per_step:642.934 - perf/throughput:141.262
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:21 - global_seqlen/min:87974.000 - global_seqlen/max:95114.000 - global_seqlen/minmax_diff:7140.000 - global_seqlen/balanced_min:92528.000 - global_seqlen/balanced_max:92529.000 - global_seqlen/mean:92528.125 - actor/entropy_loss:286.584 - actor/kl_loss:0.095 - actor/kl_coef:0.001 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.652 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.542 - actor/lr:0.000 - critic/score/mean:1.428 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.428 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.010 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.010 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:649.999 - response_length/max:1024.000 - response_length/min:311.000 - response_length/clip_ratio:0.009 - prompt_length/mean:313.836 - prompt_length/max:555.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.482 - timing_s/old_log_prob:10.195 - timing_s/ref:11.172 - timing_s/adv:0.405 - timing_s/update_actor:111.343 - timing_s/step:168.621 - timing_per_token_ms/update_actor:0.150 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:740225.000 - perf/time_per_step:168.621 - perf/throughput:548.734
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:22 - global_seqlen/min:87173.000 - global_seqlen/max:95590.000 - global_seqlen/minmax_diff:8417.000 - global_seqlen/balanced_min:90999.000 - global_seqlen/balanced_max:91000.000 - global_seqlen/mean:90999.625 - actor/entropy_loss:277.206 - actor/kl_loss:0.065 - actor/kl_coef:0.001 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.940 - perf/mfu/actor:0.213 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.319 - actor/lr:0.000 - critic/score/mean:1.451 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.451 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-1.167 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-1.167 - response_length/mean:639.882 - response_length/max:1024.000 - response_length/min:359.000 - response_length/clip_ratio:0.005 - prompt_length/mean:308.031 - prompt_length/max:480.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.545 - timing_s/old_log_prob:10.064 - timing_s/ref:11.076 - timing_s/adv:0.405 - timing_s/update_actor:110.789 - timing_s/step:168.901 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.074 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:727997.000 - perf/time_per_step:168.901 - perf/throughput:538.774
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  18%|â–ˆâ–Š        | 24/132 [1:25:35<6:08:54, 204.95s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  19%|â–ˆâ–‰        | 25/132 [1:28:23<5:45:24, 193.69s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  20%|â–ˆâ–‰        | 26/132 [1:31:12<5:29:01, 186.24s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  20%|â–ˆâ–ˆ        | 27/132 [1:33:57<5:14:59, 179.99s/it]
[36m(TaskRunner pid=1060512)[0m step:23 - global_seqlen/min:89057.000 - global_seqlen/max:99539.000 - global_seqlen/minmax_diff:10482.000 - global_seqlen/balanced_min:93593.000 - global_seqlen/balanced_max:93594.000 - global_seqlen/mean:93593.875 - actor/entropy_loss:289.521 - actor/kl_loss:0.078 - actor/kl_coef:0.001 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.029 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.603 - actor/lr:0.000 - critic/score/mean:1.401 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.401 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:651.655 - response_length/max:1024.000 - response_length/min:263.000 - response_length/clip_ratio:0.007 - prompt_length/mean:323.281 - prompt_length/max:511.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:37.588 - timing_s/old_log_prob:10.547 - timing_s/ref:11.447 - timing_s/adv:0.418 - timing_s/update_actor:111.876 - timing_s/step:171.896 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:748751.000 - perf/time_per_step:171.896 - perf/throughput:544.481
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:24 - global_seqlen/min:88074.000 - global_seqlen/max:96397.000 - global_seqlen/minmax_diff:8323.000 - global_seqlen/balanced_min:91411.000 - global_seqlen/balanced_max:91412.000 - global_seqlen/mean:91411.875 - actor/entropy_loss:273.369 - actor/kl_loss:0.126 - actor/kl_coef:0.001 - actor/pg_loss:-0.057 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.980 - perf/mfu/actor:0.213 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.611 - actor/lr:0.000 - critic/score/mean:1.428 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.428 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.008 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:639.973 - response_length/max:1024.000 - response_length/min:308.000 - response_length/clip_ratio:0.012 - prompt_length/mean:312.234 - prompt_length/max:798.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.999 - timing_s/old_log_prob:10.230 - timing_s/ref:11.173 - timing_s/adv:0.422 - timing_s/update_actor:111.222 - timing_s/step:170.064 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.075 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:731295.000 - perf/time_per_step:170.064 - perf/throughput:537.513
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:25 - global_seqlen/min:89429.000 - global_seqlen/max:96850.000 - global_seqlen/minmax_diff:7421.000 - global_seqlen/balanced_min:92205.000 - global_seqlen/balanced_max:92206.000 - global_seqlen/mean:92205.375 - actor/entropy_loss:283.615 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:-0.115 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.769 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.557 - actor/lr:0.000 - critic/score/mean:1.395 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.395 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:1.000 - critic/advantages/min:-1.167 - critic/returns/mean:-0.004 - critic/returns/max:1.000 - critic/returns/min:-1.167 - response_length/mean:638.863 - response_length/max:1024.000 - response_length/min:374.000 - response_length/clip_ratio:0.004 - prompt_length/mean:321.609 - prompt_length/max:561.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.393 - timing_s/old_log_prob:10.173 - timing_s/ref:11.117 - timing_s/adv:0.402 - timing_s/update_actor:111.260 - timing_s/step:167.365 - timing_per_token_ms/update_actor:0.151 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:737643.000 - perf/time_per_step:167.365 - perf/throughput:550.922
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:26 - global_seqlen/min:89159.000 - global_seqlen/max:101396.000 - global_seqlen/minmax_diff:12237.000 - global_seqlen/balanced_min:93583.000 - global_seqlen/balanced_max:93584.000 - global_seqlen/mean:93583.625 - actor/entropy_loss:281.091 - actor/kl_loss:0.103 - actor/kl_coef:0.001 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.891 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.587 - actor/lr:0.000 - critic/score/mean:1.439 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.439 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-1.500 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-1.500 - response_length/mean:646.743 - response_length/max:1024.000 - response_length/min:372.000 - response_length/clip_ratio:0.001 - prompt_length/mean:328.086 - prompt_length/max:765.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.323 - timing_s/old_log_prob:10.305 - timing_s/ref:11.160 - timing_s/adv:0.417 - timing_s/update_actor:111.599 - timing_s/step:168.826 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:748669.000 - perf/time_per_step:168.826 - perf/throughput:554.320
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  21%|â–ˆâ–ˆ        | 28/132 [1:36:42<5:04:01, 175.40s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 29/132 [1:39:30<4:57:12, 173.13s/it]
[36m(TaskRunner pid=1060512)[0m step:27 - global_seqlen/min:86290.000 - global_seqlen/max:94380.000 - global_seqlen/minmax_diff:8090.000 - global_seqlen/balanced_min:89576.000 - global_seqlen/balanced_max:89576.000 - global_seqlen/mean:89576.000 - actor/entropy_loss:267.135 - actor/kl_loss:0.103 - actor/kl_coef:0.001 - actor/pg_loss:-0.049 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.864 - perf/mfu/actor:0.210 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.414 - actor/lr:0.000 - critic/score/mean:1.507 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.507 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.167 - critic/advantages/min:-1.500 - critic/returns/mean:-0.005 - critic/returns/max:1.167 - critic/returns/min:-1.500 - response_length/mean:624.161 - response_length/max:1024.000 - response_length/min:362.000 - response_length/clip_ratio:0.007 - prompt_length/mean:308.922 - prompt_length/max:551.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.029 - timing_s/old_log_prob:9.827 - timing_s/ref:10.793 - timing_s/adv:0.420 - timing_s/update_actor:110.307 - timing_s/step:165.395 - timing_per_token_ms/update_actor:0.154 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:716608.000 - perf/time_per_step:165.395 - perf/throughput:541.588
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:28 - global_seqlen/min:83646.000 - global_seqlen/max:93475.000 - global_seqlen/minmax_diff:9829.000 - global_seqlen/balanced_min:87805.000 - global_seqlen/balanced_max:87806.000 - global_seqlen/mean:87805.750 - actor/entropy_loss:268.490 - actor/kl_loss:0.104 - actor/kl_coef:0.001 - actor/pg_loss:-0.132 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.730 - perf/mfu/actor:0.206 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.609 - actor/lr:0.000 - critic/score/mean:1.461 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.461 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:617.206 - response_length/max:985.000 - response_length/min:275.000 - response_length/clip_ratio:0.000 - prompt_length/mean:297.438 - prompt_length/max:536.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:33.466 - timing_s/old_log_prob:9.779 - timing_s/ref:10.848 - timing_s/adv:0.404 - timing_s/update_actor:110.133 - timing_s/step:164.650 - timing_per_token_ms/update_actor:0.157 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:702446.000 - perf/time_per_step:164.650 - perf/throughput:533.289
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:29 - global_seqlen/min:87370.000 - global_seqlen/max:98174.000 - global_seqlen/minmax_diff:10804.000 - global_seqlen/balanced_min:91960.000 - global_seqlen/balanced_max:91961.000 - global_seqlen/mean:91960.250 - actor/entropy_loss:274.178 - actor/kl_loss:0.130 - actor/kl_coef:0.001 - actor/pg_loss:-0.009 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.076 - perf/mfu/actor:0.214 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.493 - actor/lr:0.000 - critic/score/mean:1.353 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.353 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-1.333 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-1.333 - response_length/mean:647.201 - response_length/max:1024.000 - response_length/min:313.000 - response_length/clip_ratio:0.005 - prompt_length/mean:310.719 - prompt_length/max:548.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.901 - timing_s/old_log_prob:10.196 - timing_s/ref:11.167 - timing_s/adv:0.421 - timing_s/update_actor:111.120 - timing_s/step:167.827 - timing_per_token_ms/update_actor:0.151 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:735682.000 - perf/time_per_step:167.827 - perf/throughput:547.948
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†é˜…è¯»é¢˜ç›®ï¼Œç†è§£æ¯ä¸ªé€‰é¡¹çš„å«ä¹‰ï¼Œç„¶åç»“åˆç›¸å…³çš„æ³•å¾‹çŸ¥è¯†è¿›è¡Œåˆ†æã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¢˜ç›®æ˜¯è¯´ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚é—®é¢˜åœ¨äºå¦‚ä½•è®¤å®šç”²å’Œä¹™çš„è¡Œä¸ºï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯å“ªäº›ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆï¼Œæˆ‘éœ€è¦å›å¿†ç›¸å…³çš„åˆ‘æ³•æ¡æ–‡ã€‚æ ¹æ®ä¸­å›½åˆ‘æ³•ï¼Œå±å®³å›½å®¶å®‰å…¨çš„çŠ¯ç½ªé€šå¸¸ç”±ç‰¹åˆ«æ³•æ¡ä¼˜å…ˆé€‚ç”¨ã€‚ä¾‹å¦‚ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªå±äºåˆ‘æ³•åˆ†åˆ™ç¬¬ä¸‰ç« ç¬¬ä¸€èŠ‚çš„å±å®³å›½å®¶å®‰å…¨ç½ªä¸­çš„éæ³•è·å–å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œè€Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–æƒ…æŠ¥ç½ªåˆ™å±äºè¯¥èŠ‚çš„ç‰¹åˆ«è§„å®šï¼Œå±äºæ›´ä¸¥é‡çš„çŠ¯ç½ªã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m æ¥ä¸‹æ¥åˆ†æå„ä¸ªé€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 30/132 [1:50:16<8:55:31, 315.01s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 31/132 [1:53:02<7:35:10, 270.40s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 32/132 [1:55:50<6:39:28, 239.68s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 33/132 [1:58:38<5:59:58, 218.17s/it]
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™é‡Œçš„å…³é”®æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹æ˜¯å¦éœ€è¦æ•…æ„å†…å®¹ä¸€è‡´ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªè¦æ±‚å…±åŒæ•…æ„ï¼Œä½†æ•…æ„çš„å†…å®¹å¯ä»¥ä¸åŒï¼Œåªè¦åœ¨çŠ¯ç½ªæ„æˆèŒƒå›´å†…æœ‰é‡åˆã€‚ç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œä½†ä¸¤è€…çš„å…±åŒè¡Œä¸ºæ˜¯çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå±äºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„è¡Œä¸ºã€‚å› æ­¤ï¼Œè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†è¡Œä¸ºåœ¨å…±åŒçŠ¯ç½ªèŒƒå›´å†…é‡åˆï¼Œæ‰€ä»¥Aé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè®¤ä¸ºä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› ä¸ºä»–ä»¬çš„å…±åŒè¡Œä¸ºç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œæ‰€ä»¥Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥å¢ƒå¤–çªƒå–ç­‰ç½ªè®ºå¤„ã€‚ä½†ç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–ï¼Œè€Œæ ¹æ®ç‰¹åˆ«æ³•ä¼˜äºä¸€èˆ¬æ³•çš„åŸåˆ™ï¼Œåº”é€‚ç”¨ç‰¹åˆ«æ³•æ¡ï¼Œå³ä¸ºå¢ƒå¤–çªƒå–ç­‰ç½ªï¼Œæ‰€ä»¥Cæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè¯´å¯¹ä¹™ä»¥éæ³•è·å–è®ºå¤„ã€‚ä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œç¬¦åˆè¯¥ç½ªï¼Œæ‰€ä»¥Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç»¼ä¸Šï¼Œæ­£ç¡®é€‰é¡¹åº”ä¸ºBCDã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m å…±åŒçŠ¯ç½ªçš„æˆç«‹è¦æ±‚å…±åŒæ•…æ„ï¼Œä½†æ•…æ„å†…å®¹å¯å­˜åœ¨å·®å¼‚ã€‚ç”²çš„æ•…æ„ä¸ºâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€ï¼Œä¹™çš„æ•…æ„ä¸ºâ€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼ŒäºŒè€…åœ¨â€œçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€çš„è¡Œä¸ºå±‚é¢å­˜åœ¨é‡åˆã€‚æ ¹æ®â€œç‰¹åˆ«æ³•ä¼˜äºä¸€èˆ¬æ³•â€åŸåˆ™ï¼Œç”²çš„è¡Œä¸ºåº”é€‚ç”¨ã€Šåˆ‘æ³•ã€‹ç¬¬111æ¡â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€ï¼Œä¹™çš„è¡Œä¸ºé€‚ç”¨ã€Šåˆ‘æ³•ã€‹ç¬¬282æ¡â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€ã€‚äºŒè€…åœ¨å…·ä½“çŠ¯ç½ªæ„æˆèŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„ï¼Œæˆç«‹å…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼ŒAé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m ç”²ã€ä¹™å…±è°‹å®æ–½â€œçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€çš„è¡Œä¸ºï¼Œå®Œå…¨ç¬¦åˆã€Šåˆ‘æ³•ã€‹ç¬¬282æ¡â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€çš„å®¢è§‚è¦ä»¶ã€‚è™½ç„¶æ•…æ„å†…å®¹ä¸åŒï¼ˆç”²ä¸ºå¢ƒå¤–ï¼Œä¹™ä¸ºéæ³•ï¼‰ï¼Œä½†å…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚æ•…æ„å†…å®¹å®Œå…¨ä¸€è‡´ï¼Œä»…éœ€åœ¨å…·ä½“çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨é‡åˆå³å¯ã€‚å› æ­¤ï¼ŒBæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ç”²çš„æ•…æ„ä¸ºâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€ï¼Œç¬¦åˆã€Šåˆ‘æ³•ã€‹ç¬¬111æ¡â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€çš„æ„æˆè¦ä»¶ã€‚æ ¹æ®ç‰¹åˆ«æ³•ä¼˜äºä¸€èˆ¬æ³•çš„åŸåˆ™ï¼Œåº”ä¼˜å…ˆé€‚ç”¨è¯¥ç½ªåã€‚å› æ­¤ï¼ŒCæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ä¹™çš„æ•…æ„ä¸ºâ€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œå®Œå…¨ç¬¦åˆã€Šåˆ‘æ³•ã€‹ç¬¬282æ¡â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€çš„æ„æˆè¦ä»¶ã€‚å› æ­¤ï¼ŒDæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m {BCD}</å›ç­”>
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 2.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [acc] 1.0
[36m(TaskRunner pid=1060512)[0m [precision] 1.0
[36m(TaskRunner pid=1060512)[0m [recall] 1.0
[36m(TaskRunner pid=1060512)[0m [f1] 1.0
[36m(TaskRunner pid=1060512)[0m step:30 - global_seqlen/min:86532.000 - global_seqlen/max:93588.000 - global_seqlen/minmax_diff:7056.000 - global_seqlen/balanced_min:90630.000 - global_seqlen/balanced_max:90631.000 - global_seqlen/mean:90630.125 - actor/entropy_loss:268.698 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:0.091 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.803 - perf/mfu/actor:0.212 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.598 - actor/lr:0.000 - val-aux/jec-qa-1-multi-choice/reward/mean@1:1.429 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.429 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.429 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.443 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.443 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.443 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.443 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.443 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.443 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.688 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.688 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.688 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.722 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.722 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.722 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.681 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.681 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.681 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000 - critic/score/mean:1.393 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.393 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-1.500 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-1.500 - response_length/mean:642.478 - response_length/max:1024.000 - response_length/min:263.000 - response_length/clip_ratio:0.004 - prompt_length/mean:301.586 - prompt_length/max:567.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.670 - timing_s/old_log_prob:9.994 - timing_s/ref:11.039 - timing_s/adv:0.414 - timing_s/update_actor:110.653 - timing_s/testing:478.250 - timing_s/step:646.041 - timing_per_token_ms/update_actor:0.153 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.072 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:725041.000 - perf/time_per_step:646.041 - perf/throughput:140.285
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:31 - global_seqlen/min:88759.000 - global_seqlen/max:96154.000 - global_seqlen/minmax_diff:7395.000 - global_seqlen/balanced_min:90807.000 - global_seqlen/balanced_max:90808.000 - global_seqlen/mean:90807.875 - actor/entropy_loss:270.504 - actor/kl_loss:0.100 - actor/kl_coef:0.001 - actor/pg_loss:0.145 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.885 - perf/mfu/actor:0.213 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.598 - actor/lr:0.000 - critic/score/mean:1.470 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.470 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.003 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:642.829 - response_length/max:1024.000 - response_length/min:360.000 - response_length/clip_ratio:0.009 - prompt_length/mean:303.086 - prompt_length/max:513.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.605 - timing_s/old_log_prob:9.779 - timing_s/ref:10.879 - timing_s/adv:0.412 - timing_s/update_actor:110.592 - timing_s/step:166.296 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:726463.000 - perf/time_per_step:166.296 - perf/throughput:546.062
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:32 - global_seqlen/min:88958.000 - global_seqlen/max:93587.000 - global_seqlen/minmax_diff:4629.000 - global_seqlen/balanced_min:92144.000 - global_seqlen/balanced_max:92144.000 - global_seqlen/mean:92144.000 - actor/entropy_loss:272.865 - actor/kl_loss:0.094 - actor/kl_coef:0.001 - actor/pg_loss:-0.047 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.894 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.494 - actor/lr:0.000 - critic/score/mean:1.445 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.445 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:1.000 - critic/advantages/min:-1.333 - critic/returns/mean:-0.002 - critic/returns/max:1.000 - critic/returns/min:-1.333 - response_length/mean:647.779 - response_length/max:1024.000 - response_length/min:330.000 - response_length/clip_ratio:0.005 - prompt_length/mean:312.055 - prompt_length/max:522.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.102 - timing_s/old_log_prob:10.219 - timing_s/ref:11.145 - timing_s/adv:0.416 - timing_s/update_actor:111.065 - timing_s/step:167.971 - timing_per_token_ms/update_actor:0.151 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:737152.000 - perf/time_per_step:167.971 - perf/throughput:548.572
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 34/132 [2:01:27<5:32:02, 203.29s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 35/132 [2:04:16<5:12:14, 193.14s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 36/132 [2:07:06<4:58:00, 186.26s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 37/132 [2:09:57<4:47:23, 181.51s/it]
[36m(TaskRunner pid=1060512)[0m step:33 - global_seqlen/min:88392.000 - global_seqlen/max:97663.000 - global_seqlen/minmax_diff:9271.000 - global_seqlen/balanced_min:91465.000 - global_seqlen/balanced_max:91466.000 - global_seqlen/mean:91465.625 - actor/entropy_loss:272.963 - actor/kl_loss:0.102 - actor/kl_coef:0.001 - actor/pg_loss:0.139 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.885 - perf/mfu/actor:0.213 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.465 - actor/lr:0.000 - critic/score/mean:1.496 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.496 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.005 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:651.228 - response_length/max:1024.000 - response_length/min:401.000 - response_length/clip_ratio:0.010 - prompt_length/mean:301.539 - prompt_length/max:521.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.351 - timing_s/old_log_prob:10.116 - timing_s/ref:11.059 - timing_s/adv:0.402 - timing_s/update_actor:110.963 - timing_s/step:167.912 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:731725.000 - perf/time_per_step:167.912 - perf/throughput:544.725
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:34 - global_seqlen/min:91639.000 - global_seqlen/max:97370.000 - global_seqlen/minmax_diff:5731.000 - global_seqlen/balanced_min:93586.000 - global_seqlen/balanced_max:93587.000 - global_seqlen/mean:93586.500 - actor/entropy_loss:269.377 - actor/kl_loss:0.096 - actor/kl_coef:0.001 - actor/pg_loss:-0.110 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.835 - perf/mfu/actor:0.218 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.568 - actor/lr:0.000 - critic/score/mean:1.432 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.432 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.003 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:660.922 - response_length/max:1024.000 - response_length/min:378.000 - response_length/clip_ratio:0.007 - prompt_length/mean:313.938 - prompt_length/max:558.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.334 - timing_s/old_log_prob:10.343 - timing_s/ref:11.248 - timing_s/adv:0.410 - timing_s/update_actor:111.183 - timing_s/step:168.545 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:748692.000 - perf/time_per_step:168.545 - perf/throughput:555.260
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:35 - global_seqlen/min:92004.000 - global_seqlen/max:99923.000 - global_seqlen/minmax_diff:7919.000 - global_seqlen/balanced_min:95130.000 - global_seqlen/balanced_max:95131.000 - global_seqlen/mean:95130.250 - actor/entropy_loss:278.002 - actor/kl_loss:0.104 - actor/kl_coef:0.001 - actor/pg_loss:0.040 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.825 - perf/mfu/actor:0.221 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.524 - actor/lr:0.000 - critic/score/mean:1.449 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.449 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.500 - critic/advantages/min:-1.500 - critic/returns/mean:-0.003 - critic/returns/max:1.500 - critic/returns/min:-1.500 - response_length/mean:676.799 - response_length/max:1024.000 - response_length/min:405.000 - response_length/clip_ratio:0.008 - prompt_length/mean:314.141 - prompt_length/max:544.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.853 - timing_s/old_log_prob:10.408 - timing_s/ref:11.271 - timing_s/adv:0.425 - timing_s/update_actor:111.432 - timing_s/step:169.408 - timing_per_token_ms/update_actor:0.146 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:761042.000 - perf/time_per_step:169.408 - perf/throughput:561.544
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:36 - global_seqlen/min:93818.000 - global_seqlen/max:99471.000 - global_seqlen/minmax_diff:5653.000 - global_seqlen/balanced_min:96181.000 - global_seqlen/balanced_max:96182.000 - global_seqlen/mean:96181.500 - actor/entropy_loss:267.388 - actor/kl_loss:0.098 - actor/kl_coef:0.001 - actor/pg_loss:0.051 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.991 - perf/mfu/actor:0.222 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.120 - actor/lr:0.000 - critic/score/mean:1.447 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.447 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:681.758 - response_length/max:1024.000 - response_length/min:407.000 - response_length/clip_ratio:0.017 - prompt_length/mean:320.133 - prompt_length/max:567.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.517 - timing_s/old_log_prob:10.642 - timing_s/ref:11.423 - timing_s/adv:0.428 - timing_s/update_actor:112.153 - timing_s/step:170.187 - timing_per_token_ms/update_actor:0.146 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.068 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:769452.000 - perf/time_per_step:170.187 - perf/throughput:565.151
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 38/132 [2:12:48<4:39:43, 178.55s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  30%|â–ˆâ–ˆâ–‰       | 39/132 [2:15:38<4:32:40, 175.92s/it]
[36m(TaskRunner pid=1060512)[0m step:37 - global_seqlen/min:92471.000 - global_seqlen/max:99174.000 - global_seqlen/minmax_diff:6703.000 - global_seqlen/balanced_min:96514.000 - global_seqlen/balanced_max:96515.000 - global_seqlen/mean:96514.250 - actor/entropy_loss:272.028 - actor/kl_loss:0.102 - actor/kl_coef:0.001 - actor/pg_loss:0.149 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.751 - perf/mfu/actor:0.223 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:46.447 - actor/lr:0.000 - critic/score/mean:1.514 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.514 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.333 - critic/advantages/min:-1.167 - critic/returns/mean:-0.005 - critic/returns/max:1.333 - critic/returns/min:-1.167 - response_length/mean:690.255 - response_length/max:1024.000 - response_length/min:395.000 - response_length/clip_ratio:0.012 - prompt_length/mean:315.102 - prompt_length/max:462.000 - prompt_length/min:229.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.169 - timing_s/old_log_prob:10.489 - timing_s/ref:11.300 - timing_s/adv:0.428 - timing_s/update_actor:111.977 - timing_s/step:170.391 - timing_per_token_ms/update_actor:0.145 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.068 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:772114.000 - perf/time_per_step:170.391 - perf/throughput:566.428
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:38 - global_seqlen/min:93214.000 - global_seqlen/max:101170.000 - global_seqlen/minmax_diff:7956.000 - global_seqlen/balanced_min:97419.000 - global_seqlen/balanced_max:97420.000 - global_seqlen/mean:97419.125 - actor/entropy_loss:268.937 - actor/kl_loss:0.115 - actor/kl_coef:0.001 - actor/pg_loss:0.009 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.065 - perf/mfu/actor:0.224 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.818 - actor/lr:0.000 - critic/score/mean:1.438 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.438 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.011 - critic/advantages/max:1.167 - critic/advantages/min:-1.500 - critic/returns/mean:-0.011 - critic/returns/max:1.167 - critic/returns/min:-1.500 - response_length/mean:699.228 - response_length/max:1024.000 - response_length/min:419.000 - response_length/clip_ratio:0.020 - prompt_length/mean:315.555 - prompt_length/max:504.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.409 - timing_s/old_log_prob:10.717 - timing_s/ref:11.482 - timing_s/adv:0.421 - timing_s/update_actor:112.559 - timing_s/step:171.611 - timing_per_token_ms/update_actor:0.144 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.068 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:779353.000 - perf/time_per_step:171.611 - perf/throughput:567.673
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:39 - global_seqlen/min:89245.000 - global_seqlen/max:101778.000 - global_seqlen/minmax_diff:12533.000 - global_seqlen/balanced_min:95026.000 - global_seqlen/balanced_max:95027.000 - global_seqlen/mean:95026.125 - actor/entropy_loss:261.074 - actor/kl_loss:0.139 - actor/kl_coef:0.001 - actor/pg_loss:-0.072 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.824 - perf/mfu/actor:0.221 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.788 - actor/lr:0.000 - critic/score/mean:1.400 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.400 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:670.566 - response_length/max:1024.000 - response_length/min:382.000 - response_length/clip_ratio:0.007 - prompt_length/mean:319.289 - prompt_length/max:789.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.179 - timing_s/old_log_prob:10.453 - timing_s/ref:11.323 - timing_s/adv:0.414 - timing_s/update_actor:111.378 - timing_s/step:169.768 - timing_per_token_ms/update_actor:0.147 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:760209.000 - perf/time_per_step:169.768 - perf/throughput:559.740
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å¥½çš„ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†é˜…è¯»é¢˜ç›®ï¼Œç†è§£æ¯ä¸ªé€‰é¡¹çš„å†…å®¹ï¼Œç„¶åé€ä¸€åˆ†æã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¢˜ç›®æ˜¯å…³äºç”²å’Œä¹™å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚ç”²ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ã€‚ä»–ä»¬å…±è°‹å…±åŒå®æ–½è¿™äº›è¡Œä¸ºã€‚é—®é¢˜åœ¨äºå¦‚ä½•è®¤å®šä»–ä»¬çš„è¡Œä¸ºï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯å“ªäº›ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆï¼Œæˆ‘éœ€è¦å›é¡¾å…±åŒçŠ¯ç½ªçš„ç›¸å…³æ³•å¾‹çŸ¥è¯†ã€‚æ ¹æ®ä¸­å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªéœ€è¦å…·å¤‡å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚å…±åŒæ•…æ„æ„å‘³ç€å„å…±çŠ¯äººå¯¹çŠ¯ç½ªæœ‰å…±åŒçš„è®¤è¯†ï¼ŒåŒ…æ‹¬çŠ¯ç½ªçš„ç›®çš„ã€æ‰‹æ®µç­‰ã€‚è€ŒçŠ¯ç½ªæ•…æ„çš„ä¸åŒå¯èƒ½å½±å“å®šç½ªï¼Œä½†å…±åŒçŠ¯ç½ªçš„æˆç«‹å¹¶ä¸å®Œå…¨ä¾èµ–äºç›¸åŒçš„æ•…æ„å†…å®¹ï¼Œåªè¦åœ¨åŸºæœ¬çŠ¯ç½ªæ„æˆèŒƒå›´å†…æœ‰å…±åŒæ•…æ„å³å¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [2:26:29<8:08:26, 318.55s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 41/132 [2:29:17<6:54:36, 273.37s/it]
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºè™½ç„¶ä»–ä»¬çš„å…·ä½“æ•…æ„ä¸åŒï¼ˆç”²æ˜¯ä¸ºå¢ƒå¤–ï¼Œä¹™æ˜¯éæ³•è·å–ï¼‰ï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒç•´ï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Aé€‰é¡¹é”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè®¤ä¸ºè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ç¬¦åˆå…±åŒçŠ¯ç½ªçš„æ¡ä»¶ï¼Œå› æ­¤Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥å¢ƒå¤–çªƒå–ç­‰ç½ªè®ºå¤„ã€‚ä½†ç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå¦‚æœå…±åŒçŠ¯ç½ªä¸­éƒ¨åˆ†å…±çŠ¯æœ‰æ›´é‡çš„çŠ¯ç½ªæ•…æ„ï¼Œåº”æŒ‰ç…§å…¶ä¸­ä¸€äººçŠ¯ç½ªçš„æ•…æ„æ¥å®šç½ªã€‚å› æ­¤ï¼Œç”²çš„è¡Œä¸ºåº”é€‚ç”¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œè€Œä¸æ˜¯æ›´é‡çš„ä¸ºå¢ƒå¤–çªƒå–ç­‰ç½ªã€‚æ‰€ä»¥Cé”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè¯´å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚ä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç»¼ä¸Šï¼Œæ­£ç¡®é€‰é¡¹åº”ä¸ºBå’ŒDã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m å…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚å…±çŠ¯äººå…·æœ‰å®Œå…¨ç›¸åŒçš„çŠ¯ç½ªæ•…æ„å†…å®¹ï¼Œåªéœ€åœ¨åŸºæœ¬çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„å³å¯ã€‚ç”²çš„"ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°"ä¸ä¹™çš„"éæ³•è·å–"å‡å±äº"éæ³•è·å–å›½å®¶ç§˜å¯†"çš„èŒƒç•´ï¼ŒäºŒè€…åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„ï¼Œå› æ­¤æˆç«‹å…±åŒçŠ¯ç½ªã€‚Aé”™è¯¯ã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m ç”²çš„æ•…æ„ä¸º"ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°"ï¼Œä¹™çš„æ•…æ„ä¸º"éæ³•è·å–"ï¼ŒäºŒè€…åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„åŸºæœ¬æ„æˆè¦ä»¶èŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„ï¼Œç¬¦åˆå…±åŒçŠ¯ç½ªçš„æ„æˆè¦ä»¶ã€‚Bæ­£ç¡®ã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªä¸­éƒ¨åˆ†å…±çŠ¯å…·æœ‰æ›´é‡çŠ¯ç½ªæ•…æ„çš„ï¼Œåº”æŒ‰ç…§å…¶ä¸­ä¸€äººçŠ¯ç½ªçš„æ•…æ„å®šç½ªã€‚ç”²çš„æ•…æ„ä¸º"ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°"ï¼Œä½†ä¹™çš„æ•…æ„ä¸º"éæ³•è·å–"ï¼ŒäºŒè€…åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªèŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„ï¼Œå› æ­¤ç”²çš„è¡Œä¸ºåº”é€‚ç”¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚Cé”™è¯¯ã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ä¹™çš„æ•…æ„ä¸º"éæ³•è·å–å›½å®¶ç§˜å¯†"ï¼Œå®Œå…¨ç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œåº”ä»¥æ­¤ç½ªåå®šç½ªã€‚Dæ­£ç¡®ã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m {BD}</å›ç­”>
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 1.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 0.0
[36m(TaskRunner pid=1060512)[0m [acc] 0.0
[36m(TaskRunner pid=1060512)[0m [precision] 1.0
[36m(TaskRunner pid=1060512)[0m [recall] 0.6666666666666666
[36m(TaskRunner pid=1060512)[0m [f1] 0.8
[36m(TaskRunner pid=1060512)[0m step:40 - global_seqlen/min:85903.000 - global_seqlen/max:99290.000 - global_seqlen/minmax_diff:13387.000 - global_seqlen/balanced_min:94334.000 - global_seqlen/balanced_max:94335.000 - global_seqlen/mean:94334.250 - actor/entropy_loss:257.707 - actor/kl_loss:0.125 - actor/kl_coef:0.001 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.889 - perf/mfu/actor:0.219 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.689 - actor/lr:0.000 - val-aux/jec-qa-1-multi-choice/reward/mean@1:1.441 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:1.441 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.441 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.441 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.441 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.441 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.986 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.455 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.455 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.455 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.455 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.455 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.455 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.693 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.693 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.693 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.729 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.729 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.729 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.688 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.688 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.688 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000 - critic/score/mean:1.471 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.471 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-1.333 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-1.333 - response_length/mean:670.875 - response_length/max:1024.000 - response_length/min:362.000 - response_length/clip_ratio:0.009 - prompt_length/mean:311.773 - prompt_length/max:595.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.239 - timing_s/old_log_prob:10.454 - timing_s/ref:11.269 - timing_s/adv:0.429 - timing_s/update_actor:111.380 - timing_s/testing:481.539 - timing_s/step:651.332 - timing_per_token_ms/update_actor:0.148 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:754674.000 - perf/time_per_step:651.332 - perf/throughput:144.833
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 42/132 [2:32:07<6:03:15, 242.17s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 43/132 [2:34:56<5:26:55, 220.39s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 44/132 [2:37:44<4:59:54, 204.48s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 45/132 [2:40:32<4:40:35, 193.52s/it]
[36m(TaskRunner pid=1060512)[0m step:41 - global_seqlen/min:91860.000 - global_seqlen/max:95081.000 - global_seqlen/minmax_diff:3221.000 - global_seqlen/balanced_min:93471.000 - global_seqlen/balanced_max:93472.000 - global_seqlen/mean:93471.750 - actor/entropy_loss:250.717 - actor/kl_loss:0.177 - actor/kl_coef:0.001 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.401 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.667 - actor/lr:0.000 - critic/score/mean:1.474 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.474 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.333 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.333 - response_length/mean:665.195 - response_length/max:1024.000 - response_length/min:303.000 - response_length/clip_ratio:0.010 - prompt_length/mean:308.469 - prompt_length/max:583.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.779 - timing_s/old_log_prob:10.167 - timing_s/ref:11.140 - timing_s/adv:0.412 - timing_s/update_actor:111.375 - timing_s/step:167.907 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.068 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:747774.000 - perf/time_per_step:167.907 - perf/throughput:556.688
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:42 - global_seqlen/min:91871.000 - global_seqlen/max:97277.000 - global_seqlen/minmax_diff:5406.000 - global_seqlen/balanced_min:94732.000 - global_seqlen/balanced_max:94733.000 - global_seqlen/mean:94732.125 - actor/entropy_loss:251.258 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.930 - perf/mfu/actor:0.220 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.706 - actor/lr:0.000 - critic/score/mean:1.456 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.456 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.167 - critic/advantages/min:-1.000 - critic/returns/mean:-0.006 - critic/returns/max:1.167 - critic/returns/min:-1.000 - response_length/mean:667.551 - response_length/max:1024.000 - response_length/min:310.000 - response_length/clip_ratio:0.009 - prompt_length/mean:319.242 - prompt_length/max:628.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.488 - timing_s/old_log_prob:10.414 - timing_s/ref:11.307 - timing_s/adv:0.423 - timing_s/update_actor:111.691 - timing_s/step:169.343 - timing_per_token_ms/update_actor:0.147 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:757857.000 - perf/time_per_step:169.343 - perf/throughput:559.409
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:43 - global_seqlen/min:88895.000 - global_seqlen/max:98165.000 - global_seqlen/minmax_diff:9270.000 - global_seqlen/balanced_min:94140.000 - global_seqlen/balanced_max:94141.000 - global_seqlen/mean:94140.625 - actor/entropy_loss:241.341 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:0.212 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.777 - perf/mfu/actor:0.219 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.777 - actor/lr:0.000 - critic/score/mean:1.430 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.430 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:1.000 - critic/advantages/min:-1.000 - critic/returns/mean:-0.006 - critic/returns/max:1.000 - critic/returns/min:-1.000 - response_length/mean:667.210 - response_length/max:1024.000 - response_length/min:384.000 - response_length/clip_ratio:0.007 - prompt_length/mean:313.422 - prompt_length/max:535.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.080 - timing_s/old_log_prob:10.428 - timing_s/ref:11.272 - timing_s/adv:0.417 - timing_s/update_actor:111.333 - timing_s/step:169.556 - timing_per_token_ms/update_actor:0.148 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:753125.000 - perf/time_per_step:169.556 - perf/throughput:555.219
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:44 - global_seqlen/min:87608.000 - global_seqlen/max:98512.000 - global_seqlen/minmax_diff:10904.000 - global_seqlen/balanced_min:91781.000 - global_seqlen/balanced_max:91782.000 - global_seqlen/mean:91781.500 - actor/entropy_loss:239.536 - actor/kl_loss:0.126 - actor/kl_coef:0.001 - actor/pg_loss:0.078 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.873 - perf/mfu/actor:0.214 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.761 - actor/lr:0.000 - critic/score/mean:1.480 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.480 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:644.385 - response_length/max:1024.000 - response_length/min:402.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.672 - prompt_length/max:808.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.862 - timing_s/old_log_prob:10.085 - timing_s/ref:11.063 - timing_s/adv:0.407 - timing_s/update_actor:110.866 - timing_s/step:167.308 - timing_per_token_ms/update_actor:0.151 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:734252.000 - perf/time_per_step:167.308 - perf/throughput:548.579
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–      | 46/132 [2:43:19<4:26:18, 185.79s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 47/132 [2:46:07<4:15:24, 180.29s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [2:48:57<4:08:06, 177.22s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/132 [2:51:48<4:02:30, 175.31s/it]
[36m(TaskRunner pid=1060512)[0m step:45 - global_seqlen/min:89671.000 - global_seqlen/max:95710.000 - global_seqlen/minmax_diff:6039.000 - global_seqlen/balanced_min:92389.000 - global_seqlen/balanced_max:92390.000 - global_seqlen/mean:92389.875 - actor/entropy_loss:241.172 - actor/kl_loss:0.126 - actor/kl_coef:0.001 - actor/pg_loss:-0.085 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.025 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.930 - actor/lr:0.000 - critic/score/mean:1.479 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.479 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.000 - critic/advantages/min:-1.333 - critic/returns/mean:-0.003 - critic/returns/max:1.000 - critic/returns/min:-1.333 - response_length/mean:651.004 - response_length/max:1024.000 - response_length/min:381.000 - response_length/clip_ratio:0.005 - prompt_length/mean:311.391 - prompt_length/max:611.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.981 - timing_s/old_log_prob:10.222 - timing_s/ref:11.120 - timing_s/adv:0.416 - timing_s/update_actor:111.133 - timing_s/step:167.899 - timing_per_token_ms/update_actor:0.150 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:739119.000 - perf/time_per_step:167.899 - perf/throughput:550.270
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:46 - global_seqlen/min:84120.000 - global_seqlen/max:96241.000 - global_seqlen/minmax_diff:12121.000 - global_seqlen/balanced_min:91154.000 - global_seqlen/balanced_max:91155.000 - global_seqlen/mean:91154.875 - actor/entropy_loss:236.940 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:0.044 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.992 - perf/mfu/actor:0.212 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.873 - actor/lr:0.000 - critic/score/mean:1.471 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.471 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:645.342 - response_length/max:1024.000 - response_length/min:328.000 - response_length/clip_ratio:0.005 - prompt_length/mean:304.188 - prompt_length/max:485.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.962 - timing_s/old_log_prob:10.019 - timing_s/ref:11.044 - timing_s/adv:0.407 - timing_s/update_actor:111.294 - timing_s/step:167.753 - timing_per_token_ms/update_actor:0.153 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.071 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:729239.000 - perf/time_per_step:167.753 - perf/throughput:543.388
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:47 - global_seqlen/min:87471.000 - global_seqlen/max:95467.000 - global_seqlen/minmax_diff:7996.000 - global_seqlen/balanced_min:91228.000 - global_seqlen/balanced_max:91229.000 - global_seqlen/mean:91228.375 - actor/entropy_loss:239.124 - actor/kl_loss:0.159 - actor/kl_coef:0.001 - actor/pg_loss:0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.775 - perf/mfu/actor:0.212 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.763 - actor/lr:0.000 - critic/score/mean:1.495 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.495 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:648.077 - response_length/max:983.000 - response_length/min:351.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.219 - prompt_length/max:455.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:34.613 - timing_s/old_log_prob:10.105 - timing_s/ref:11.079 - timing_s/adv:0.413 - timing_s/update_actor:111.195 - timing_s/step:167.430 - timing_per_token_ms/update_actor:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.070 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:729827.000 - perf/time_per_step:167.430 - perf/throughput:544.876
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:48 - global_seqlen/min:88817.000 - global_seqlen/max:97507.000 - global_seqlen/minmax_diff:8690.000 - global_seqlen/balanced_min:92467.000 - global_seqlen/balanced_max:92468.000 - global_seqlen/mean:92467.375 - actor/entropy_loss:237.475 - actor/kl_loss:0.117 - actor/kl_coef:0.001 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.874 - perf/mfu/actor:0.215 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.581 - actor/lr:0.000 - critic/score/mean:1.535 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.535 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:657.225 - response_length/max:1024.000 - response_length/min:335.000 - response_length/clip_ratio:0.007 - prompt_length/mean:305.977 - prompt_length/max:485.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.948 - timing_s/old_log_prob:10.183 - timing_s/ref:11.191 - timing_s/adv:0.428 - timing_s/update_actor:111.247 - timing_s/step:170.018 - timing_per_token_ms/update_actor:0.150 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:739739.000 - perf/time_per_step:170.018 - perf/throughput:543.868
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:49 - global_seqlen/min:89683.000 - global_seqlen/max:97360.000 - global_seqlen/minmax_diff:7677.000 - global_seqlen/balanced_min:93680.000 - global_seqlen/balanced_max:93681.000 - global_seqlen/mean:93680.750 - actor/entropy_loss:250.189 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:0.064 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.993 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.742 - actor/lr:0.000 - critic/score/mean:1.486 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.486 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-1.500 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-1.500 - response_length/mean:665.685 - response_length/max:1024.000 - response_length/min:389.000 - response_length/clip_ratio:0.007 - prompt_length/mean:310.156 - prompt_length/max:503.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.991 - timing_s/old_log_prob:10.358 - timing_s/ref:11.220 - timing_s/adv:0.424 - timing_s/update_actor:111.782 - timing_s/step:170.802 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.072 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:749446.000 - perf/time_per_step:170.802 - perf/throughput:548.475
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1060512)[0m validation generation end
[36m(TaskRunner pid=1060512)[0m [prompt] system
[36m(TaskRunner pid=1060512)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1060512)[0m user
[36m(TaskRunner pid=1060512)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1060512)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1060512)[0m assistant
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=1060512)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†é˜…è¯»é¢˜ç›®ï¼Œç†è§£æ¯ä¸ªé€‰é¡¹çš„å†…å®¹ï¼Œç„¶åç»“åˆç›¸å…³çš„æ³•å¾‹çŸ¥è¯†è¿›è¡Œåˆ†æã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¢˜ç›®æ˜¯å…³äºç”²å’Œä¹™å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚ç”²ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚é—®é¢˜æ˜¯è¦åˆ¤æ–­å››ä¸ªé€‰é¡¹ä¸­å“ªäº›æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é¦–å…ˆï¼Œæˆ‘éœ€è¦å›å¿†ä¸­å›½åˆ‘æ³•ä¸­å…³äºå…±åŒçŠ¯ç½ªçš„ç›¸å…³è§„å®šã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªéœ€è¦å…·å¤‡å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚å…±åŒæ•…æ„æŒ‡çš„æ˜¯å„å…±åŒçŠ¯ç½ªäººå¿…é¡»æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå³å¯¹çŠ¯ç½ªè¡Œä¸ºåŠå…¶å¯èƒ½äº§ç”Ÿçš„å±å®³ç»“æœæœ‰å…±åŒçš„è®¤è¯†ï¼Œå¹¶ä¸”å„è‡ªçš„è¡Œä¸ºç›¸äº’è”ç³»ï¼Œå…±åŒä½œç”¨ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç°åœ¨åˆ†æé€‰é¡¹ï¼š
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™é‡Œçš„å…³é”®æ˜¯ç”²å’Œä¹™çš„æ•…æ„æ˜¯å¦å±äºåŒä¸€çŠ¯ç½ªæ„æˆã€‚ç”²çš„æ•…æ„æ˜¯â€œä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ã€‚æ ¹æ®åˆ‘æ³•ï¼Œè¿™ä¸¤ä¸ªè¡Œä¸ºåœ¨æ„æˆè¦ä»¶ä¸Šæ˜¯ä¸åŒçš„ã€‚ç”²çš„è¡Œä¸ºå¯èƒ½æ„æˆé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºå¯èƒ½æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å› æ­¤ï¼Œä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œå¯èƒ½å±äºä¸åŒçš„çŠ¯ç½ªæ„æˆï¼Œå› æ­¤ä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aå¯èƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Bè®¤ä¸ºè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºç”²çš„è¡Œä¸ºå¯èƒ½æ„æˆæ›´ä¸¥é‡çš„é—´è°ç½ªï¼Œè€Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å¦‚æœä¸¤äººåœ¨ä¸åŒçš„çŠ¯ç½ªæ„æˆèŒƒå›´å†…ï¼Œå¯èƒ½æ— æ³•æˆç«‹å…±åŒçŠ¯ç½ªï¼Œå› æ­¤é€‰é¡¹Bå¯èƒ½é”™è¯¯ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥é—´è°ç½ªè®ºå¤„ã€‚æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œé—´è°ç½ªæ˜¯æŒ‡ä¸ºå¢ƒå¤–çš„æœºæ„ã€ç»„ç»‡ã€äººå‘˜çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–è€…æƒ…æŠ¥çš„è¡Œä¸ºã€‚ç”²çš„è¡Œä¸ºç¬¦åˆè¿™ä¸€ç½ªåï¼Œå› æ­¤é€‰é¡¹Cæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m é€‰é¡¹Dè¯´å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ ¹æ®åˆ‘æ³•ç¬¬282æ¡ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªæ˜¯æŒ‡ä»¥çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°æ–¹æ³•éæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚ä¹™çš„è¡Œä¸ºç¬¦åˆè¿™ä¸€ç½ªåï¼Œå› æ­¤é€‰é¡¹Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m ç»¼ä¸Šï¼Œæ­£ç¡®çš„é€‰é¡¹åº”è¯¥æ˜¯Cå’ŒDï¼Œå³é€‰é¡¹Cå’ŒDæ­£ç¡®ã€‚
[36m(TaskRunner pid=1060512)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m ç”²çš„æ•…æ„æ˜¯"ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†"ï¼Œç¬¦åˆé—´è°ç½ªï¼ˆã€Šåˆ‘æ³•ã€‹ç¬¬111æ¡ï¼‰çš„æ„æˆè¦ä»¶ï¼›ä¹™çš„æ•…æ„æ˜¯"éæ³•è·å–å›½å®¶ç§˜å¯†"ï¼Œç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼ˆã€Šåˆ‘æ³•ã€‹ç¬¬282æ¡ï¼‰çš„æ„æˆè¦ä»¶ã€‚ç”±äºä¸¤ç½ªåœ¨çŠ¯ç½ªæ„æˆä¸Šå­˜åœ¨æœ¬è´¨åŒºåˆ«ï¼Œä¸”æ— è¯æ®è¡¨æ˜ä¹™æ˜çŸ¥ç”²çš„å¢ƒå¤–ç›®çš„ï¼ŒäºŒäººç¼ºä¹å…±åŒçŠ¯ç½ªæ•…æ„ï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª  
[36m(TaskRunner pid=1060512)[0m å…±åŒçŠ¯ç½ªè¦æ±‚å…±åŒæ•…æ„æŒ‡å‘åŒä¸€çŠ¯ç½ªæ„æˆã€‚ç”²çš„è¡Œä¸ºæ„æˆæ›´é‡çš„é—´è°ç½ªï¼Œä¹™ä»…æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼ŒäºŒè€…åœ¨çŠ¯ç½ªæ„æˆä¸Šä¸å…·æœ‰åŒä¸€æ€§ï¼Œå› æ­¤ä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m ç”²çš„è¡Œä¸ºç¬¦åˆé—´è°ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¸»è§‚ä¸Šæ˜çŸ¥æˆ–åº”çŸ¥è¡Œä¸ºå±å®³å›½å®¶å®‰å…¨ï¼Œå®¢è§‚ä¸Šå®æ–½äº†ä¸ºå¢ƒå¤–æœºæ„æä¾›å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œåº”ç›´æ¥ä»¥é—´è°ç½ªå®šç½ªå¤„ç½šã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„  
[36m(TaskRunner pid=1060512)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [3:03:07<7:26:05, 326.41s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [3:05:56<6:17:00, 279.27s/it]
[36m(TaskRunner pid=1060512)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [3:08:47<5:28:57, 246.71s/it]
[36m(TaskRunner pid=1060512)[0m ä¹™çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œå…¶ä¸»è§‚ä¸Šå…·æœ‰éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå®¢è§‚ä¸Šé€šè¿‡çªƒå–ã€åˆºæ¢æ‰‹æ®µå®æ–½äº†è¯¥è¡Œä¸ºï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªå®šç½ªå¤„ç½šã€‚  
[36m(TaskRunner pid=1060512)[0m 
[36m(TaskRunner pid=1060512)[0m {CD}</å›ç­”>
[36m(TaskRunner pid=1060512)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1060512)[0m [score] 1.0
[36m(TaskRunner pid=1060512)[0m [format_reward] 1.0
[36m(TaskRunner pid=1060512)[0m [answer_reward] 0.0
[36m(TaskRunner pid=1060512)[0m [acc] 0.0
[36m(TaskRunner pid=1060512)[0m [precision] 1.0
[36m(TaskRunner pid=1060512)[0m [recall] 0.6666666666666666
[36m(TaskRunner pid=1060512)[0m [f1] 0.8
[36m(TaskRunner pid=1060512)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=1063595)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1063595)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1063595)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=1060512)[0m step:50 - global_seqlen/min:90352.000 - global_seqlen/max:97449.000 - global_seqlen/minmax_diff:7097.000 - global_seqlen/balanced_min:93498.000 - global_seqlen/balanced_max:93499.000 - global_seqlen/mean:93498.625 - actor/entropy_loss:239.273 - actor/kl_loss:0.154 - actor/kl_coef:0.001 - actor/pg_loss:0.127 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.972 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:48.753 - actor/lr:0.000 - val-aux/jec-qa-1-multi-choice/reward/mean@1:1.458 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:1.458 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.458 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.458 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.458 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.458 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.989 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.989 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.989 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.469 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.469 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.469 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.469 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.469 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.469 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.701 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.701 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.701 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.727 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.727 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.727 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.692 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.692 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.692 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000 - critic/score/mean:1.462 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.462 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.000 - critic/advantages/min:-1.500 - critic/returns/mean:-0.003 - critic/returns/max:1.000 - critic/returns/min:-1.500 - response_length/mean:653.936 - response_length/max:1024.000 - response_length/min:314.000 - response_length/clip_ratio:0.007 - prompt_length/mean:320.008 - prompt_length/max:771.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:36.715 - timing_s/old_log_prob:10.302 - timing_s/ref:11.153 - timing_s/adv:0.417 - timing_s/update_actor:111.757 - timing_s/testing:485.594 - timing_s/save_checkpoint:22.967 - timing_s/step:678.929 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.073 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:747989.000 - perf/time_per_step:678.929 - perf/throughput:137.715
[36m(WorkerDict pid=1069729)[0m [rank-6]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069729)[0m [rank-6]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1069729)[0m [rank-6]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=1060512)[0m step:51 - global_seqlen/min:90433.000 - global_seqlen/max:96885.000 - global_seqlen/minmax_diff:6452.000 - global_seqlen/balanced_min:93818.000 - global_seqlen/balanced_max:93819.000 - global_seqlen/mean:93818.750 - actor/entropy_loss:247.104 - actor/kl_loss:0.207 - actor/kl_coef:0.001 - actor/pg_loss:-0.117 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.908 - perf/mfu/actor:0.217 - perf/max_memory_allocated_gb:36.880 - perf/max_memory_reserved_gb:56.803 - perf/cpu_memory_used_gb:49.200 - actor/lr:0.000 - critic/score/mean:1.423 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.423 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-1.167 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-1.167 - response_length/mean:669.216 - response_length/max:1024.000 - response_length/min:381.000 - response_length/clip_ratio:0.004 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:35.661 - timing_s/old_log_prob:10.045 - timing_s/ref:11.030 - timing_s/adv:0.418 - timing_s/update_actor:112.054 - timing_s/step:169.241 - timing_per_token_ms/update_actor:0.149 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/gen:0.069 - timing_per_token_ms/ref:0.015 - perf/total_num_tokens:750550.000 - perf/time_per_step:169.241 - perf/throughput:554.351
[36m(TaskRunner pid=1060512)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
