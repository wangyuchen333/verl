2025-05-11 19:44:08,931	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=3878235)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=3878235)[0m                                                              'optimizer',
[36m(TaskRunner pid=3878235)[0m                                                              'extra']},
[36m(TaskRunner pid=3878235)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=3878235)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=3878235)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=3878235)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=3878235)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=3878235)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3878235)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=3878235)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=3878235)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3878235)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=3878235)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=3878235)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=3878235)[0m                                  'loss_agg_mode': 'seq-mean-token-sum-norm',
[36m(TaskRunner pid=3878235)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=3878235)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=3878235)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3878235)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=3878235)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=3878235)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=3878235)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=3878235)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=3878235)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3878235)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m                                  'ppo_micro_batch_size_per_gpu': 8,
[36m(TaskRunner pid=3878235)[0m                                  'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3878235)[0m                                  'shuffle': False,
[36m(TaskRunner pid=3878235)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=3878235)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3878235)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=3878235)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=3878235)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=3878235)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=3878235)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3878235)[0m                                  'external_lib': None,
[36m(TaskRunner pid=3878235)[0m                                  'override_config': {},
[36m(TaskRunner pid=3878235)[0m                                  'path': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=3878235)[0m                                  'use_liger': False,
[36m(TaskRunner pid=3878235)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=3878235)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=3878235)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3878235)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3878235)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=3878235)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3878235)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=3878235)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=3878235)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=3878235)[0m                                    'do_sample': True,
[36m(TaskRunner pid=3878235)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=3878235)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=3878235)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=3878235)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=3878235)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=3878235)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=3878235)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=3878235)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=3878235)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=3878235)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=3878235)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=3878235)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=3878235)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=3878235)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=3878235)[0m                                    'n': 6,
[36m(TaskRunner pid=3878235)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=3878235)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=3878235)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=3878235)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=3878235)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=3878235)[0m                                    'top_k': -1,
[36m(TaskRunner pid=3878235)[0m                                    'top_p': 1,
[36m(TaskRunner pid=3878235)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=3878235)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=3878235)[0m                                                   'n': 1,
[36m(TaskRunner pid=3878235)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=3878235)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=3878235)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=3878235)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=3878235)[0m                'gamma': 1.0,
[36m(TaskRunner pid=3878235)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=3878235)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=3878235)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=3878235)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=3878235)[0m WARNING:2025-05-11 19:44:20,044:Waiting for register center actor cypwLC_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=3887338)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=3887338)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(TaskRunner pid=3878235)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=3878235)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=3878235)[0m                'lam': 1.0,
[36m(TaskRunner pid=3878235)[0m                'norm_adv_by_std_in_grpo': False,
[36m(TaskRunner pid=3878235)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=3878235)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=3878235)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=3878235)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3878235)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3878235)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=3878235)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=3878235)[0m                       'external_lib': None,
[36m(TaskRunner pid=3878235)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3878235)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=3878235)[0m                                       'param_offload': False,
[36m(TaskRunner pid=3878235)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3878235)[0m                       'override_config': {},
[36m(TaskRunner pid=3878235)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=3878235)[0m                       'tokenizer_path': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=3878235)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=3878235)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=3878235)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=3878235)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=3878235)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=3878235)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=3878235)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=3878235)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=3878235)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3878235)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3878235)[0m             'ppo_mini_batch_size': 32,
[36m(TaskRunner pid=3878235)[0m             'rollout_n': 6,
[36m(TaskRunner pid=3878235)[0m             'shuffle': False,
[36m(TaskRunner pid=3878235)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=3878235)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3878235)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=3878235)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=3878235)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=3878235)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=3878235)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=3878235)[0m           'image_key': 'images',
[36m(TaskRunner pid=3878235)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=3878235)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=3878235)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=3878235)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=3878235)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=3878235)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=3878235)[0m           'shuffle': True,
[36m(TaskRunner pid=3878235)[0m           'tokenizer': None,
[36m(TaskRunner pid=3878235)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=3878235)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=3878235)[0m           'truncation': 'error',
[36m(TaskRunner pid=3878235)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=3878235)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=3878235)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=3878235)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=3878235)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=3878235)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=3878235)[0m                   'max_length': None,
[36m(TaskRunner pid=3878235)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=3878235)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=3878235)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=3878235)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=3878235)[0m                                             'param_offload': False,
[36m(TaskRunner pid=3878235)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=3878235)[0m                             'input_tokenizer': '/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176',
[36m(TaskRunner pid=3878235)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=3878235)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=3878235)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=3878235)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=3878235)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=3878235)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=3878235)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=3878235)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=3878235)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=3878235)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=3878235)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=3878235)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=3878235)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=3878235)[0m              'logger': ['console', 'wandb'],
[36m(TaskRunner pid=3878235)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=3878235)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=3878235)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=3878235)[0m              'nnodes': 1,
[36m(TaskRunner pid=3878235)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=3878235)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=3878235)[0m              'resume_from_path': None,
[36m(TaskRunner pid=3878235)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=3878235)[0m              'save_freq': 50,
[36m(TaskRunner pid=3878235)[0m              'test_freq': 10,
[36m(TaskRunner pid=3878235)[0m              'total_epochs': 2,
[36m(TaskRunner pid=3878235)[0m              'total_training_steps': None,
[36m(TaskRunner pid=3878235)[0m              'val_before_train': True}}
[36m(TaskRunner pid=3878235)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=3878235)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=3878235)[0m dataset len: 8448
[36m(TaskRunner pid=3878235)[0m dataset len: 2113
[36m(TaskRunner pid=3878235)[0m Size of train dataloader: 66
[36m(TaskRunner pid=3878235)[0m Total training steps: 132
[36m(WorkerDict pid=3887340)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 53.80it/s]
[36m(WorkerDict pid=3881037)[0m [rank0]:[W511 19:44:36.287610822 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=3887339)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 51.81it/s]
[36m(WorkerDict pid=3887343)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=3887339)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887343)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3881037)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 45.68it/s][32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3887339)[0m [rank3]:[W511 19:44:36.356419812 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887343)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:11,  3.97s/it]
[36m(WorkerDict pid=3887342)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887339)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887338)[0m Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:08<00:08,  4.44s/it][32m [repeated 11x across cluster][0m
[36m(WorkerDict pid=3887343)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.68s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.13s/it]
[36m(WorkerDict pid=3887336)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:13<00:04,  4.54s/it][32m [repeated 12x across cluster][0m
[36m(WorkerDict pid=3887343)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=3887343)[0m   warnings.warn(
[36m(WorkerDict pid=3887336)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.13s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.71s/it][32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3878235)[0m wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
[36m(TaskRunner pid=3878235)[0m wandb: Currently logged in as: eang333cms (eang333cms-peking-university) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
[36m(TaskRunner pid=3878235)[0m wandb: Tracking run with wandb version 0.19.9
[36m(TaskRunner pid=3878235)[0m wandb: Run data is saved locally in /home/wangyc/verl/wandb/run-20250511_194526-fwyflez2
[36m(TaskRunner pid=3878235)[0m wandb: Run `wandb offline` to turn off syncing.
[36m(TaskRunner pid=3878235)[0m wandb: Syncing run qwen2.5-7b-grpo-mcq
[36m(TaskRunner pid=3878235)[0m wandb: â­ï¸ View project at https://wandb.ai/eang333cms-peking-university/Lawyer-Zero
[36m(TaskRunner pid=3878235)[0m wandb: ğŸš€ View run at https://wandb.ai/eang333cms-peking-university/Lawyer-Zero/runs/fwyflez2
[36m(WorkerDict pid=3887340)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3881037)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3881037)[0m   "architectures": [
[36m(WorkerDict pid=3881037)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3881037)[0m   ],
[36m(WorkerDict pid=3881037)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3881037)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3881037)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3881037)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3881037)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3881037)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3881037)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=3881037)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3881037)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3881037)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3881037)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3881037)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3881037)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3881037)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3881037)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3881037)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=3881037)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=3881037)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3881037)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3881037)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=3881037)[0m   "use_cache": false,
[36m(WorkerDict pid=3881037)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3881037)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3881037)[0m }
[36m(WorkerDict pid=3881037)[0m 
[36m(WorkerDict pid=3881037)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3881037)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3881037)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fb7754ead40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fb7754eac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3881037)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3887339)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=3881037)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=3881037)[0m   "architectures": [
[36m(WorkerDict pid=3881037)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=3881037)[0m   ],
[36m(WorkerDict pid=3881037)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=3881037)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=3881037)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=3881037)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=3881037)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=3881037)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=3881037)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=3881037)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=3881037)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=3881037)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=3881037)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=3881037)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=3881037)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=3881037)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=3881037)[0m   "rope_scaling": null,
[36m(WorkerDict pid=3881037)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=3881037)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=3881037)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=3881037)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=3881037)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=3881037)[0m   "use_cache": false,
[36m(WorkerDict pid=3881037)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=3881037)[0m   "vocab_size": 152064
[36m(WorkerDict pid=3881037)[0m }
[36m(WorkerDict pid=3881037)[0m 
[36m(WorkerDict pid=3887342)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fb89cb2ad40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fb89cb2ac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887342)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887343)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3881037)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=3881037)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=3881037)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fb7754ead40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fb7754eac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=3887341)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=3887341)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3887336)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3887342)[0m wrap_policy: functools.partial(<function _or_policy at 0x7fb89cb2ad40>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7fb89cb2ac20>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887340)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=3881037)[0m Before building vllm rollout, memory allocated (GB): 3.5471720695495605, memory reserved (GB): 19.66015625
[36m(WorkerDict pid=3887339)[0m WARNING 05-11 19:45:11 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=3881037)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3881037)[0m Actor use_remove_padding=True[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=3887339)[0m WARNING 05-11 19:45:12 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f301d9f0130>
[36m(WorkerDict pid=3887340)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=3887343)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=3881037)[0m WARNING 05-11 19:45:13 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3881037)[0m WARNING 05-11 19:45:13 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fb5c91ccbb0>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887342)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(WorkerDict pid=3881037)[0m After building vllm rollout, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(WorkerDict pid=3881037)[0m After building sharding manager, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(TaskRunner pid=3878235)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=3878235)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=3878235)[0m Training from scratch
[36m(TaskRunner pid=3878235)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=3887338)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3878235)[0m validation generation end
[36m(TaskRunner pid=3878235)[0m [prompt] system
[36m(TaskRunner pid=3878235)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=3878235)[0m user
[36m(TaskRunner pid=3878235)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=3878235)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=3878235)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=3878235)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=3878235)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=3878235)[0m assistant
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m [response] <æ€è€ƒ>
[36m(TaskRunner pid=3878235)[0m å—¯ï¼Œæˆ‘ç°åœ¨è¦è§£å†³è¿™ä¸ªå¸æ³•è€ƒè¯•çš„é€‰æ‹©é¢˜ã€‚é¢˜ç›®æ˜¯å…³äºå…±åŒçŠ¯ç½ªçš„è®¤å®šï¼Œæ¶‰åŠç”²å’Œä¹™ä¸¤äººå…±è°‹çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æƒ…å†µã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦ä»”ç»†åˆ†ææ¯ä¸ªé€‰é¡¹çš„æ­£ç¡®æ€§ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é¦–å…ˆï¼Œé—®é¢˜ä¸­çš„ç”²å’Œä¹™æœ‰ä¸åŒçš„æ•…æ„å†…å®¹ã€‚ç”²ä»¥ä¸ºè‡ªå·±æ˜¯åœ¨ä¸ºå¢ƒå¤–åŠ¿åŠ›çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™åˆ™æ˜¯ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ã€‚è¿™é‡Œçš„å…³é”®æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹æ˜¯å¦éœ€è¦ç›¸åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œä»¥åŠä¸åŒæ•…æ„ä¸‹æ˜¯å¦å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m æ ¹æ®ä¸­å›½åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªè¦æ±‚å„å…±åŒçŠ¯ç½ªäººå¿…é¡»æœ‰å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚å…±åŒæ•…æ„é€šå¸¸æŒ‡çš„æ˜¯å„è¡Œä¸ºäººå¯¹æ‰€å®æ–½çš„çŠ¯ç½ªè¡Œä¸ºåŠå…¶å¯èƒ½äº§ç”Ÿçš„å±å®³ç»“æœæœ‰å…±åŒçš„è®¤è¯†ã€‚å¦‚æœç”²å’Œä¹™çš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºç›®æ ‡ç›¸åŒï¼Œæ˜¯å¦å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªå‘¢ï¼Ÿ
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m æ¯”å¦‚ï¼Œç”²å¯èƒ½æ„æˆé—´è°ç½ªï¼Œè€Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å¦‚æœä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼Œå³çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œé‚£ä¹ˆä»–ä»¬æ˜¯å¦åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Ÿå› ä¸ºä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œè€Œç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–åŠ¿åŠ›è·å–ï¼Œä½†è¡Œä¸ºæœ¬èº«å¯èƒ½é‡åˆã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç”²å¯èƒ½æ„æˆé—´è°ç½ªï¼Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œä½†ä¸¤äººåœ¨éæ³•è·å–çš„èŒƒå›´å†…æœ‰å…±åŒæ•…æ„ï¼Œå› æ­¤å¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m ç°åœ¨çœ‹é€‰é¡¹ï¼š
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é€‰é¡¹Aè¯´ç”²å’Œä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½ä¸æ­£ç¡®ï¼Œå› ä¸ºè™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†è¡Œä¸ºç›®æ ‡ç›¸åŒï¼Œå¯èƒ½åœ¨éæ³•è·å–çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Aé”™è¯¯ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é€‰é¡¹Bè¯´è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™å¯èƒ½æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼Œè™½ç„¶åŠ¨æœºä¸åŒï¼Œä½†è¡Œä¸ºæ„æˆè¦ä»¶ç›¸åŒï¼Œå¯èƒ½æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥Bæ­£ç¡®ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é€‰é¡¹Cè¯´å¯¹ç”²åº”ä»¥é—´è°ç½ªè®ºå¤„ã€‚å¦‚æœç”²çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–åŠ¿åŠ›æœåŠ¡ï¼Œé‚£ä¹ˆæ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œé—´è°ç½ªç¡®å®å¯èƒ½æˆç«‹ã€‚æ‰€ä»¥Cæ­£ç¡®ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m é€‰é¡¹Dè¯´å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚ä¹™çš„æ•…æ„æ˜¯éæ³•è·å–ï¼Œç¬¦åˆè¯¥ç½ªçš„æ„æˆè¦ä»¶ï¼Œæ‰€ä»¥Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m å› æ­¤ï¼Œæ­£ç¡®çš„é€‰é¡¹åº”è¯¥æ˜¯Bã€Cã€Dã€‚ä½†éœ€è¦å†ä»”ç»†æ ¸å¯¹ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m ä¾‹å¦‚ï¼Œç”²çš„è¡Œä¸ºæ˜¯å¦åŒæ—¶æ„æˆé—´è°ç½ªå’Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Ÿæ ¹æ®åˆ‘æ³•è§„å®šï¼Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–è€…æƒ…æŠ¥çš„ï¼Œä»¥é—´è°ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œç”²çš„è¡Œä¸ºåº”å®šé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºå®šéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ä¸¤äººåœ¨éæ³•è·å–çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Œæ‰€ä»¥Bæ­£ç¡®ã€‚Cå’ŒDä¹Ÿæ­£ç¡®ã€‚å› æ­¤ï¼Œæ­£ç¡®é€‰é¡¹æ˜¯BCDã€‚
[36m(TaskRunner pid=3878235)[0m </æ€è€ƒ><å›ç­”>
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m **é€‰é¡¹åˆ†æï¼š**
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m - **A. ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª**  
[36m(TaskRunner pid=3878235)[0m   å…±åŒçŠ¯ç½ªçš„æˆç«‹ä¸è¦æ±‚å„è¡Œä¸ºäººå…·æœ‰å®Œå…¨ç›¸åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œåªè¦åœ¨å…·ä½“çŠ¯ç½ªæ„æˆèŒƒå›´å†…å­˜åœ¨å…±åŒæ•…æ„å³å¯ã€‚ç”²çš„æ•…æ„æ˜¯â€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†â€ï¼Œä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œä½†ä¸¤äººå…±è°‹å®æ–½åŒä¸€è¡Œä¸ºï¼ˆçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼‰ï¼Œä¸”è¯¥è¡Œä¸ºåœ¨â€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€çš„æ„æˆè¦ä»¶èŒƒå›´å†…å…·æœ‰å…±åŒæ€§ã€‚å› æ­¤ï¼Œç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚**Aé”™è¯¯**ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m - **B. ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª**  
[36m(TaskRunner pid=3878235)[0m   ç”²çš„æ•…æ„åŒ…å«â€œä¸ºå¢ƒå¤–â€è¿™ä¸€ç‰¹æ®Šç›®çš„ï¼Œä½†å…¶è¡Œä¸ºï¼ˆçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼‰ä¸ä¹™çš„â€œéæ³•è·å–â€è¡Œä¸ºåœ¨å®¢è§‚è¡Œä¸ºå’Œæ„æˆè¦ä»¶èŒƒå›´å†…ä¸€è‡´ã€‚æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–æƒ…æŠ¥çš„è¡Œä¸ºï¼Œä»¥é—´è°ç½ªè®ºå¤„ã€‚ä½†è‹¥è¡Œä¸ºæœªæ¶‰åŠâ€œä¸ºå¢ƒå¤–â€ç›®çš„ï¼Œä»…æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…å…·æœ‰å…±åŒæ•…æ„å’Œå…±åŒè¡Œä¸ºï¼Œæˆç«‹å…±åŒçŠ¯ç½ªã€‚**Bæ­£ç¡®**ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m - **C. å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„**  
[36m(TaskRunner pid=3878235)[0m   æ ¹æ®åˆ‘æ³•ç¬¬111æ¡ï¼Œç”²çš„è¡Œä¸ºç¬¦åˆâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†æˆ–æƒ…æŠ¥â€çš„æ„æˆè¦ä»¶ï¼Œåº”è®¤å®šä¸ºé—´è°ç½ªã€‚**Cæ­£ç¡®**ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m - **D. å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„**  
[36m(TaskRunner pid=3878235)[0m   ä¹™çš„æ•…æ„æ˜¯â€œéæ³•è·å–å›½å®¶ç§˜å¯†â€ï¼Œå…¶è¡Œä¸ºç¬¦åˆåˆ‘æ³•ç¬¬282æ¡éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚**Dæ­£ç¡®**ã€‚
[36m(TaskRunner pid=3878235)[0m 
[36m(TaskRunner pid=3878235)[0m **ç»“è®ºï¼š**  
[36m(TaskRunner pid=3878235)[0m ç”²ä¸ä¹™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=3878235)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=3878235)[0m [score] 0.0
[36m(TaskRunner pid=3878235)[0m [format_reward] 0.0
[36m(TaskRunner pid=3878235)[0m [answer_reward] 0.0
[36m(TaskRunner pid=3878235)[0m [acc] 0.0
[36m(TaskRunner pid=3878235)[0m [precision] 0.0
[36m(TaskRunner pid=3878235)[0m [recall] 0.0
[36m(TaskRunner pid=3878235)[0m [f1] 0.0
[36m(TaskRunner pid=3878235)[0m ("Initial validation metrics: {'val-aux/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=3878235)[0m  "0.7482252721249408, 'val-aux/jec-qa-1-multi-choice/reward/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/reward/best@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/reward/best@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': 0.7482252721249408, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': 0.7482252721249408, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/mean@1': 0.4794131566493138, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean': "
[36m(TaskRunner pid=3878235)[0m  '0.4794131566493138, '
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/best@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean': "
[36m(TaskRunner pid=3878235)[0m  '0.4794131566493138, '
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/mean@1': 0.26881211547562706, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean': "
[36m(TaskRunner pid=3878235)[0m  '0.26881211547562706, '
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean': "
[36m(TaskRunner pid=3878235)[0m  '0.26881211547562706, '
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-core/jec-qa-1-multi-choice/acc/mean@1': 0.26881211547562706, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/acc/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-core/jec-qa-1-multi-choice/acc/best@1/mean': 0.26881211547562706, "
[36m(TaskRunner pid=3878235)[0m  "'val-core/jec-qa-1-multi-choice/acc/best@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/acc/worst@1/mean': 0.26881211547562706, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/acc/worst@1/std': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/mean@1': 0.3720224010096229, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/best@1/mean': 0.3720224010096229, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/best@1/std': 3.257634998900128e-18, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/worst@1/mean': 0.3720224010096229, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/precision/worst@1/std': "
[36m(TaskRunner pid=3878235)[0m  "3.257634998900128e-18, 'val-aux/jec-qa-1-multi-choice/recall/mean@1': "
[36m(TaskRunner pid=3878235)[0m  "0.38712730714623755, 'val-aux/jec-qa-1-multi-choice/recall/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/recall/best@1/mean': 0.38712730714623755, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/recall/best@1/std': 3.231363748908998e-18, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/recall/worst@1/mean': 0.38712730714623755, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/recall/worst@1/std': 3.231363748908998e-18, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/mean@1': 0.3699659702972528, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/std@1': 0.0, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/best@1/mean': 0.3699659702972528, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/best@1/std': 1.0981382496292367e-17, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/worst@1/mean': 0.3699659702972528, "
[36m(TaskRunner pid=3878235)[0m  "'val-aux/jec-qa-1-multi-choice/f1/worst@1/std': 1.0981382496292367e-17}")
[36m(TaskRunner pid=3878235)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=3887336)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=3887336)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=3878235)[0m Training Progress:   1%|          | 1/132 [02:27<5:21:33, 147.28s/it]
[36m(TaskRunner pid=3878235)[0m Training Progress:   2%|â–         | 2/132 [04:52<5:16:07, 145.91s/it]
[36m(TaskRunner pid=3878235)[0m Training Progress:   2%|â–         | 3/132 [07:17<5:13:23, 145.76s/it]
[36m(TaskRunner pid=3878235)[0m wandb: uploading output.log; uploading wandb-summary.json; uploading config.yaml
[36m(TaskRunner pid=3878235)[0m wandb: uploading history steps 3-3, summary
[36m(TaskRunner pid=3878235)[0m wandb:                                                                                
[36m(TaskRunner pid=3878235)[0m wandb: 
[36m(TaskRunner pid=3878235)[0m wandb: Run history:
[36m(TaskRunner pid=3878235)[0m wandb:                                       actor/entropy_loss â–„â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                          actor/grad_norm â–â–ˆâ–†
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/kl_coef â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/kl_loss â–„â–â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                                 actor/lr â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                        actor/pg_clipfrac â–ˆâ–„â–
[36m(TaskRunner pid=3878235)[0m wandb:                                  actor/pg_clipfrac_lower â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/pg_loss â–â–‡â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                             actor/ppo_kl â–â–†â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                    critic/advantages/max â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                   critic/advantages/mean â–â–ˆâ–…
[36m(TaskRunner pid=3878235)[0m wandb:                                    critic/advantages/min â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/returns/max â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                      critic/returns/mean â–â–ˆâ–…
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/returns/min â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/rewards/max â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                      critic/rewards/mean â–†â–â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/rewards/min â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                         critic/score/max â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                        critic/score/mean â–†â–â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                         critic/score/min â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                               global_seqlen/balanced_max â–â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                               global_seqlen/balanced_min â–â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                        global_seqlen/max â–â–ˆâ–„
[36m(TaskRunner pid=3878235)[0m wandb:                                       global_seqlen/mean â–â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                        global_seqlen/min â–‚â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                global_seqlen/minmax_diff â–…â–â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                  perf/cpu_memory_used_gb â–â–‚â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                             perf/max_memory_allocated_gb â–â–â–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                              perf/max_memory_reserved_gb â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                           perf/mfu/actor â–â–ˆâ–‚
[36m(TaskRunner pid=3878235)[0m wandb:                                          perf/throughput â–â–ˆâ–„
[36m(TaskRunner pid=3878235)[0m wandb:                                       perf/time_per_step â–ˆâ–â–ƒ
[36m(TaskRunner pid=3878235)[0m wandb:                                    perf/total_num_tokens â–â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                 prompt_length/clip_ratio â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                        prompt_length/max â–â–ˆâ–„
[36m(TaskRunner pid=3878235)[0m wandb:                                       prompt_length/mean â–†â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                        prompt_length/min â–…â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                               response_length/clip_ratio â–‚â–ˆâ–
[36m(TaskRunner pid=3878235)[0m wandb:                                      response_length/max â–â–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                     response_length/mean â–â–ˆâ–‚
[36m(TaskRunner pid=3878235)[0m wandb:                                      response_length/min â–â–ˆâ–„
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/adv â–â–ˆâ–ƒ
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/gen â–â–ˆâ–†
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/ref â–ˆâ–â–
[36m(TaskRunner pid=3878235)[0m wandb:                         timing_per_token_ms/update_actor â–ˆâ–â–‡
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/adv â–â–ˆâ–‚
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/gen â–â–ˆâ–…
[36m(TaskRunner pid=3878235)[0m wandb:                                    timing_s/old_log_prob â–â–ƒâ–ˆ
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/ref â–ˆâ–â–
[36m(TaskRunner pid=3878235)[0m wandb:                                            timing_s/step â–ˆâ–â–ƒ
[36m(TaskRunner pid=3878235)[0m wandb:                                    timing_s/update_actor â–ˆâ–â–†
[36m(TaskRunner pid=3878235)[0m wandb:                  val-aux/jec-qa-1-multi-choice/acc/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/acc/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/acc/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:   val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/answer_reward/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/answer_reward/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb: val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:             val-aux/jec-qa-1-multi-choice/f1/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/f1/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:                  val-aux/jec-qa-1-multi-choice/f1/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:                   val-aux/jec-qa-1-multi-choice/f1/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/f1/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:             val-aux/jec-qa-1-multi-choice/f1/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:   val-aux/jec-qa-1-multi-choice/format_reward/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/format_reward/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/format_reward/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb: val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:      val-aux/jec-qa-1-multi-choice/precision/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/precision/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/precision/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/precision/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:     val-aux/jec-qa-1-multi-choice/precision/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:      val-aux/jec-qa-1-multi-choice/precision/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/recall/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/recall/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/recall/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/recall/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/recall/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/recall/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/reward/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/reward/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/reward/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/reward/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/reward/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/reward/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/score/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/score/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/score/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:                val-aux/jec-qa-1-multi-choice/score/std@1 â–
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/score/worst@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/score/worst@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:           val-core/jec-qa-1-multi-choice/acc/best@1/mean â–
[36m(TaskRunner pid=3878235)[0m wandb:            val-core/jec-qa-1-multi-choice/acc/best@1/std â–
[36m(TaskRunner pid=3878235)[0m wandb:                val-core/jec-qa-1-multi-choice/acc/mean@1 â–
[36m(TaskRunner pid=3878235)[0m wandb: 
[36m(TaskRunner pid=3878235)[0m wandb: Run summary:
[36m(TaskRunner pid=3878235)[0m wandb:                                       actor/entropy_loss 573.37561
[36m(TaskRunner pid=3878235)[0m wandb:                                          actor/grad_norm 2.60762
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/kl_coef 0.001
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/kl_loss 0.00692
[36m(TaskRunner pid=3878235)[0m wandb:                                                 actor/lr 0.0
[36m(TaskRunner pid=3878235)[0m wandb:                                        actor/pg_clipfrac 0.00065
[36m(TaskRunner pid=3878235)[0m wandb:                                  actor/pg_clipfrac_lower 0
[36m(TaskRunner pid=3878235)[0m wandb:                                            actor/pg_loss 0.46032
[36m(TaskRunner pid=3878235)[0m wandb:                                             actor/ppo_kl 2e-05
[36m(TaskRunner pid=3878235)[0m wandb:                                    critic/advantages/max 1.66667
[36m(TaskRunner pid=3878235)[0m wandb:                                   critic/advantages/mean -0.0349
[36m(TaskRunner pid=3878235)[0m wandb:                                    critic/advantages/min -1.66667
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/returns/max 1.66667
[36m(TaskRunner pid=3878235)[0m wandb:                                      critic/returns/mean -0.0349
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/returns/min -1.66667
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/rewards/max 2
[36m(TaskRunner pid=3878235)[0m wandb:                                      critic/rewards/mean 0.58724
[36m(TaskRunner pid=3878235)[0m wandb:                                       critic/rewards/min 0
[36m(TaskRunner pid=3878235)[0m wandb:                                         critic/score/max 2
[36m(TaskRunner pid=3878235)[0m wandb:                                        critic/score/mean 0.58724
[36m(TaskRunner pid=3878235)[0m wandb:                                         critic/score/min 0
[36m(TaskRunner pid=3878235)[0m wandb:                               global_seqlen/balanced_max 121247
[36m(TaskRunner pid=3878235)[0m wandb:                               global_seqlen/balanced_min 121246
[36m(TaskRunner pid=3878235)[0m wandb:                                        global_seqlen/max 125689
[36m(TaskRunner pid=3878235)[0m wandb:                                       global_seqlen/mean 121246.625
[36m(TaskRunner pid=3878235)[0m wandb:                                        global_seqlen/min 117549
[36m(TaskRunner pid=3878235)[0m wandb:                                global_seqlen/minmax_diff 8140
[36m(TaskRunner pid=3878235)[0m wandb:                                  perf/cpu_memory_used_gb 43.89302
[36m(TaskRunner pid=3878235)[0m wandb:                             perf/max_memory_allocated_gb 43.77346
[36m(TaskRunner pid=3878235)[0m wandb:                              perf/max_memory_reserved_gb 56.7832
[36m(TaskRunner pid=3878235)[0m wandb:                                           perf/mfu/actor 0.41796
[36m(TaskRunner pid=3878235)[0m wandb:                                          perf/throughput 833.05487
[36m(TaskRunner pid=3878235)[0m wandb:                                       perf/time_per_step 145.54458
[36m(TaskRunner pid=3878235)[0m wandb:                                    perf/total_num_tokens 969973
[36m(TaskRunner pid=3878235)[0m wandb:                                 prompt_length/clip_ratio 0
[36m(TaskRunner pid=3878235)[0m wandb:                                        prompt_length/max 491
[36m(TaskRunner pid=3878235)[0m wandb:                                       prompt_length/mean 302.41406
[36m(TaskRunner pid=3878235)[0m wandb:                                        prompt_length/min 208
[36m(TaskRunner pid=3878235)[0m wandb:                               response_length/clip_ratio 0.66276
[36m(TaskRunner pid=3878235)[0m wandb:                                      response_length/max 1024
[36m(TaskRunner pid=3878235)[0m wandb:                                     response_length/mean 960.57159
[36m(TaskRunner pid=3878235)[0m wandb:                                      response_length/min 500
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/adv 0.00053
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/gen 0.05769
[36m(TaskRunner pid=3878235)[0m wandb:                                  timing_per_token_ms/ref 0.01306
[36m(TaskRunner pid=3878235)[0m wandb:                         timing_per_token_ms/update_actor 0.07807
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/adv 0.51292
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/gen 42.56106
[36m(TaskRunner pid=3878235)[0m wandb:                                    timing_s/old_log_prob 14.05451
[36m(TaskRunner pid=3878235)[0m wandb:                                             timing_s/ref 12.66843
[36m(TaskRunner pid=3878235)[0m wandb:                                            timing_s/step 145.54458
[36m(TaskRunner pid=3878235)[0m wandb:                                    timing_s/update_actor 75.72405
[36m(TaskRunner pid=3878235)[0m wandb:                  val-aux/jec-qa-1-multi-choice/acc/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/acc/worst@1/mean 0.26881
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/acc/worst@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean 0.26881
[36m(TaskRunner pid=3878235)[0m wandb:   val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/answer_reward/mean@1 0.26881
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/answer_reward/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb: val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean 0.26881
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:             val-aux/jec-qa-1-multi-choice/f1/best@1/mean 0.36997
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/f1/best@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:                  val-aux/jec-qa-1-multi-choice/f1/mean@1 0.36997
[36m(TaskRunner pid=3878235)[0m wandb:                   val-aux/jec-qa-1-multi-choice/f1/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/f1/worst@1/mean 0.36997
[36m(TaskRunner pid=3878235)[0m wandb:             val-aux/jec-qa-1-multi-choice/f1/worst@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean 0.47941
[36m(TaskRunner pid=3878235)[0m wandb:   val-aux/jec-qa-1-multi-choice/format_reward/best@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/format_reward/mean@1 0.47941
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/format_reward/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb: val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean 0.47941
[36m(TaskRunner pid=3878235)[0m wandb:  val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:      val-aux/jec-qa-1-multi-choice/precision/best@1/mean 0.37202
[36m(TaskRunner pid=3878235)[0m wandb:       val-aux/jec-qa-1-multi-choice/precision/best@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/precision/mean@1 0.37202
[36m(TaskRunner pid=3878235)[0m wandb:            val-aux/jec-qa-1-multi-choice/precision/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:     val-aux/jec-qa-1-multi-choice/precision/worst@1/mean 0.37202
[36m(TaskRunner pid=3878235)[0m wandb:      val-aux/jec-qa-1-multi-choice/precision/worst@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/recall/best@1/mean 0.38713
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/recall/best@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/recall/mean@1 0.38713
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/recall/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/recall/worst@1/mean 0.38713
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/recall/worst@1/std 0.0
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/reward/best@1/mean 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/reward/best@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:              val-aux/jec-qa-1-multi-choice/reward/mean@1 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/reward/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:        val-aux/jec-qa-1-multi-choice/reward/worst@1/mean 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/reward/worst@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/score/best@1/mean 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:           val-aux/jec-qa-1-multi-choice/score/best@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:               val-aux/jec-qa-1-multi-choice/score/mean@1 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:                val-aux/jec-qa-1-multi-choice/score/std@1 0
[36m(TaskRunner pid=3878235)[0m wandb:         val-aux/jec-qa-1-multi-choice/score/worst@1/mean 0.74823
[36m(TaskRunner pid=3878235)[0m wandb:          val-aux/jec-qa-1-multi-choice/score/worst@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:           val-core/jec-qa-1-multi-choice/acc/best@1/mean 0.26881
[36m(TaskRunner pid=3878235)[0m wandb:            val-core/jec-qa-1-multi-choice/acc/best@1/std 0
[36m(TaskRunner pid=3878235)[0m wandb:                val-core/jec-qa-1-multi-choice/acc/mean@1 0.26881
[36m(TaskRunner pid=3878235)[0m wandb: 
[36m(TaskRunner pid=3878235)[0m wandb: ğŸš€ View run qwen2.5-7b-grpo-mcq at: https://wandb.ai/eang333cms-peking-university/Lawyer-Zero/runs/fwyflez2
[36m(TaskRunner pid=3878235)[0m wandb: â­ï¸ View project at: https://wandb.ai/eang333cms-peking-university/Lawyer-Zero
[36m(TaskRunner pid=3878235)[0m wandb: Synced 5 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
[36m(TaskRunner pid=3878235)[0m wandb: Find logs at: ./wandb/run-20250511_194526-fwyflez2/logs
[36m(TaskRunner pid=3878235)[0m Training Progress:   2%|â–         | 3/132 [08:09<5:50:47, 163.16s/it]
[36m(TaskRunner pid=3878235)[0m step:0 - val-aux/jec-qa-1-multi-choice/reward/mean@1:0.748 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/reward/best@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.748 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.748 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/mean@1:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/mean:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/mean:0.479 - val-aux/jec-qa-1-multi-choice/format_reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/mean@1:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/std@1:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/answer_reward/worst@1/std:0.000 - val-core/jec-qa-1-multi-choice/acc/mean@1:0.269 - val-aux/jec-qa-1-multi-choice/acc/std@1:0.000 - val-core/jec-qa-1-multi-choice/acc/best@1/mean:0.269 - val-core/jec-qa-1-multi-choice/acc/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/acc/worst@1/mean:0.269 - val-aux/jec-qa-1-multi-choice/acc/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/mean@1:0.372 - val-aux/jec-qa-1-multi-choice/precision/std@1:0.000 - val-aux/jec-qa-1-multi-choice/precision/best@1/mean:0.372 - val-aux/jec-qa-1-multi-choice/precision/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/precision/worst@1/mean:0.372 - val-aux/jec-qa-1-multi-choice/precision/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/mean@1:0.387 - val-aux/jec-qa-1-multi-choice/recall/std@1:0.000 - val-aux/jec-qa-1-multi-choice/recall/best@1/mean:0.387 - val-aux/jec-qa-1-multi-choice/recall/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/recall/worst@1/mean:0.387 - val-aux/jec-qa-1-multi-choice/recall/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/mean@1:0.370 - val-aux/jec-qa-1-multi-choice/f1/std@1:0.000 - val-aux/jec-qa-1-multi-choice/f1/best@1/mean:0.370 - val-aux/jec-qa-1-multi-choice/f1/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/f1/worst@1/mean:0.370 - val-aux/jec-qa-1-multi-choice/f1/worst@1/std:0.000
[36m(TaskRunner pid=3878235)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=3878235)[0m step:1 - global_seqlen/min:117947.000 - global_seqlen/max:125362.000 - global_seqlen/minmax_diff:7415.000 - global_seqlen/balanced_min:121252.000 - global_seqlen/balanced_max:121253.000 - global_seqlen/mean:121252.250 - actor/entropy_loss:587.693 - actor/kl_loss:0.006 - actor/kl_coef:0.001 - actor/pg_loss:-0.132 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.466 - perf/mfu/actor:0.416 - perf/max_memory_allocated_gb:43.701 - perf/max_memory_reserved_gb:56.783 - perf/cpu_memory_used_gb:43.726 - actor/lr:0.000 - critic/score/mean:0.562 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.562 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.038 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.038 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:958.779 - response_length/max:1024.000 - response_length/min:455.000 - response_length/clip_ratio:0.665 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:41.109 - timing_s/old_log_prob:12.771 - timing_s/ref:16.349 - timing_s/adv:0.509 - timing_s/update_actor:76.029 - timing_s/step:146.801 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - timing_per_token_ms/gen:0.056 - timing_per_token_ms/ref:0.017 - perf/total_num_tokens:970018.000 - perf/time_per_step:146.801 - perf/throughput:825.964
[36m(TaskRunner pid=3878235)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=3878235)[0m step:2 - global_seqlen/min:119429.000 - global_seqlen/max:126108.000 - global_seqlen/minmax_diff:6679.000 - global_seqlen/balanced_min:122377.000 - global_seqlen/balanced_max:122378.000 - global_seqlen/mean:122377.750 - actor/entropy_loss:602.288 - actor/kl_loss:0.005 - actor/kl_coef:0.001 - actor/pg_loss:0.389 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.656 - perf/mfu/actor:0.428 - perf/max_memory_allocated_gb:43.701 - perf/max_memory_reserved_gb:56.783 - perf/cpu_memory_used_gb:43.757 - actor/lr:0.000 - critic/score/mean:0.509 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.509 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.032 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.032 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:969.589 - response_length/max:1024.000 - response_length/min:559.000 - response_length/clip_ratio:0.689 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:43.726 - timing_s/old_log_prob:13.194 - timing_s/ref:12.729 - timing_s/adv:0.533 - timing_s/update_actor:74.688 - timing_s/step:144.893 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.076 - timing_per_token_ms/gen:0.059 - timing_per_token_ms/ref:0.013 - perf/total_num_tokens:979022.000 - perf/time_per_step:144.893 - perf/throughput:844.608
[36m(TaskRunner pid=3878235)[0m list(reward_extra_infos_dict.keys())=['score', 'format_reward', 'answer_reward', 'acc', 'precision', 'recall', 'f1']
[36m(TaskRunner pid=3878235)[0m step:3 - global_seqlen/min:117549.000 - global_seqlen/max:125689.000 - global_seqlen/minmax_diff:8140.000 - global_seqlen/balanced_min:121246.000 - global_seqlen/balanced_max:121247.000 - global_seqlen/mean:121246.625 - actor/entropy_loss:573.376 - actor/kl_loss:0.007 - actor/kl_coef:0.001 - actor/pg_loss:0.460 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.608 - perf/mfu/actor:0.418 - perf/max_memory_allocated_gb:43.773 - perf/max_memory_reserved_gb:56.783 - perf/cpu_memory_used_gb:43.893 - actor/lr:0.000 - critic/score/mean:0.587 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.587 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.035 - critic/advantages/max:1.667 - critic/advantages/min:-1.667 - critic/returns/mean:-0.035 - critic/returns/max:1.667 - critic/returns/min:-1.667 - response_length/mean:960.572 - response_length/max:1024.000 - response_length/min:500.000 - response_length/clip_ratio:0.663 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:42.561 - timing_s/old_log_prob:14.055 - timing_s/ref:12.668 - timing_s/adv:0.513 - timing_s/update_actor:75.724 - timing_s/step:145.545 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - timing_per_token_ms/gen:0.058 - timing_per_token_ms/ref:0.013 - perf/total_num_tokens:969973.000 - perf/time_per_step:145.545 - perf/throughput:833.055
Error executing job with overrides: ['algorithm.adv_estimator=grpo', 'data.train_files=/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet', 'data.val_files=/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet', 'data.train_batch_size=128', 'data.val_batch_size=1312', 'data.max_prompt_length=1024', 'data.max_response_length=1024', 'actor_rollout_ref.model.path=/home/wangyc/verl/checkpoints/law-sft-qwen-2.5-7b-instruct/checkpoint-176', 'actor_rollout_ref.actor.optim.lr=1e-6', 'actor_rollout_ref.model.use_remove_padding=True', 'actor_rollout_ref.actor.ppo_mini_batch_size=32', 'actor_rollout_ref.actor.ppo_micro_batch_size_per_gpu=8', 'actor_rollout_ref.actor.loss_agg_mode=seq-mean-token-sum-norm', 'actor_rollout_ref.actor.use_kl_loss=True', 'actor_rollout_ref.actor.kl_loss_coef=0.001', 'actor_rollout_ref.actor.kl_loss_type=low_var_kl', 'actor_rollout_ref.actor.entropy_coeff=0', 'actor_rollout_ref.model.enable_gradient_checkpointing=True', 'actor_rollout_ref.actor.fsdp_config.param_offload=False', 'actor_rollout_ref.actor.fsdp_config.optimizer_offload=False', 'actor_rollout_ref.rollout.log_prob_micro_batch_size_per_gpu=32', 'actor_rollout_ref.rollout.tensor_model_parallel_size=2', 'actor_rollout_ref.rollout.name=vllm', 'actor_rollout_ref.rollout.gpu_memory_utilization=0.6', 'actor_rollout_ref.rollout.n=6', 'actor_rollout_ref.ref.log_prob_micro_batch_size_per_gpu=32', 'actor_rollout_ref.ref.fsdp_config.param_offload=True', 'algorithm.use_kl_in_reward=False', 'algorithm.norm_adv_by_std_in_grpo=False', 'trainer.critic_warmup=0', "trainer.logger=['console','wandb']", 'trainer.project_name=Lawyer-Zero', 'trainer.experiment_name=qwen2.5-7b-grpo-mcq', 'trainer.n_gpus_per_node=8', 'trainer.nnodes=1', 'trainer.default_local_dir=checkpoints/qwen2.5-7b-grpo-hard-mcq', 'trainer.save_freq=50', 'trainer.test_freq=10', 'trainer.total_epochs=2']
Traceback (most recent call last):
  File "/home/wangyc/verl/verl/trainer/main_ppo.py", line 63, in main
    run_ppo(config)
  File "/home/wangyc/verl/verl/trainer/main_ppo.py", line 80, in run_ppo
    ray.get(runner.run.remote(config))
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/auto_init_hook.py", line 21, in auto_init_wrapper
    return fn(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/client_mode_hook.py", line 103, in wrapper
    return func(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/worker.py", line 2771, in get
    values, debugger_breakpoint = worker.get_objects(object_refs, timeout=timeout)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/ray/_private/worker.py", line 919, in get_objects
    raise value.as_instanceof_cause()
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::TaskRunner.run()[39m (pid=3878235, ip=222.29.51.203, actor_id=9166491da275508665f3cfe301000000, repr=<main_ppo.TaskRunner object at 0x7f34e4284bb0>)
  File "/home/wangyc/verl/verl/trainer/main_ppo.py", line 208, in run
    trainer.fit()
  File "/home/wangyc/verl/verl/trainer/ppo/ray_trainer.py", line 965, in fit
    old_log_prob = self.actor_rollout_wg.compute_log_prob(batch)
  File "/home/wangyc/verl/verl/single_controller/ray/base.py", line 43, in func
    output = ray.get(output)
ray.exceptions.RayTaskError(OutOfMemoryError): [36mray::WorkerDict.actor_rollout_compute_log_prob()[39m (pid=3887343, ip=222.29.51.203, actor_id=70696980d9145568e9b604c301000000, repr=<verl.single_controller.ray.base.WorkerDict object at 0x7f5b6946de10>)
  File "/home/wangyc/verl/verl/single_controller/ray/base.py", line 440, in func
    return getattr(self.worker_dict[key], name)(*args, **kwargs)
  File "/home/wangyc/verl/verl/single_controller/base/decorator.py", line 413, in inner
    return func(*args, **kwargs)
  File "/home/wangyc/verl/verl/workers/fsdp_workers.py", line 593, in compute_log_prob
    output, entropys = self.actor.compute_log_prob(data=data, calculate_entropy=True)
  File "/home/wangyc/verl/verl/utils/debug/performance.py", line 61, in f
    return self.log(decorated_function, *args, **kwargs)
  File "/home/wangyc/verl/verl/utils/debug/performance.py", line 70, in log
    output = func(*args, **kwargs)
  File "/home/wangyc/verl/verl/workers/actor/dp_actor.py", line 246, in compute_log_prob
    entropy, log_probs = self._forward_micro_batch(
  File "/home/wangyc/verl/verl/workers/actor/dp_actor.py", line 119, in _forward_micro_batch
    output = self.actor_module(
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py", line 864, in forward
    output = self._fsdp_wrapped_module(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/transformers/utils/generic.py", line 965, in wrapper
    output = func(self, *args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/transformers/utils/deprecation.py", line 172, in wrapped_func
    return func(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/transformers/models/qwen2/modeling_qwen2.py", line 839, in forward
    logits = self.lm_head(hidden_states[:, slice_indices, :])
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 11.72 GiB. GPU 0 has a total capacity of 44.53 GiB of which 8.91 GiB is free. Including non-PyTorch memory, this process has 35.58 GiB memory in use. Of the allocated memory 26.18 GiB is allocated by PyTorch, with 150.66 MiB allocated in private pools (e.g., CUDA Graphs), and 21.76 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)

Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.
