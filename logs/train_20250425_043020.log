2025-04-25 04:30:27,759	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=1923599)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=1923599)[0m                                                              'optimizer',
[36m(TaskRunner pid=1923599)[0m                                                              'extra']},
[36m(TaskRunner pid=1923599)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=1923599)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=1923599)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=1923599)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=1923599)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=1923599)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1923599)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=1923599)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=1923599)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1923599)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=1923599)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=1923599)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=1923599)[0m                                  'loss_agg_mode': 'token-mean',
[36m(TaskRunner pid=1923599)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=1923599)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=1923599)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1923599)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=1923599)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=1923599)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=1923599)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=1923599)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=1923599)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1923599)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m                                  'ppo_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=1923599)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1923599)[0m                                  'shuffle': False,
[36m(TaskRunner pid=1923599)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=1923599)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1923599)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=1923599)[0m                                  'use_kl_loss': True,
[36m(TaskRunner pid=1923599)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=1923599)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=1923599)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1923599)[0m                                  'external_lib': None,
[36m(TaskRunner pid=1923599)[0m                                  'override_config': {},
[36m(TaskRunner pid=1923599)[0m                                  'path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1923599)[0m                                  'use_liger': False,
[36m(TaskRunner pid=1923599)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=1923599)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=1923599)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1923599)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1923599)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1923599)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1923599)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=1923599)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=1923599)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=1923599)[0m                                    'do_sample': True,
[36m(TaskRunner pid=1923599)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=1923599)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=1923599)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=1923599)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=1923599)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=1923599)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=1923599)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=1923599)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=1923599)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1923599)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1923599)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1923599)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=1923599)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=1923599)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=1923599)[0m                                    'n': 6,
[36m(TaskRunner pid=1923599)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=1923599)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=1923599)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=1923599)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=1923599)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=1923599)[0m                                    'top_k': -1,
[36m(TaskRunner pid=1923599)[0m                                    'top_p': 1,
[36m(TaskRunner pid=1923599)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=1923599)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=1923599)[0m                                                   'n': 1,
[36m(TaskRunner pid=1923599)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=1923599)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=1923599)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=1923599)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=1923599)[0m                'gamma': 1.0,
[36m(TaskRunner pid=1923599)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=1923599)[0m                            'kl_coef': 0.001,
[36m(TaskRunner pid=1923599)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=1923599)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1923599)[0m WARNING:2025-04-25 04:30:38,455:Waiting for register center actor Z942py_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=1932615)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=1932615)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(TaskRunner pid=1923599)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=1923599)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=1923599)[0m                'lam': 1.0,
[36m(TaskRunner pid=1923599)[0m                'norm_adv_by_std_in_grpo': True,
[36m(TaskRunner pid=1923599)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=1923599)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=1923599)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=1923599)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1923599)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1923599)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=1923599)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1923599)[0m                       'external_lib': None,
[36m(TaskRunner pid=1923599)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1923599)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=1923599)[0m                                       'param_offload': False,
[36m(TaskRunner pid=1923599)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1923599)[0m                       'override_config': {},
[36m(TaskRunner pid=1923599)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=1923599)[0m                       'tokenizer_path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1923599)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=1923599)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=1923599)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1923599)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=1923599)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=1923599)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=1923599)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=1923599)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=1923599)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1923599)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1923599)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1923599)[0m             'rollout_n': 6,
[36m(TaskRunner pid=1923599)[0m             'shuffle': False,
[36m(TaskRunner pid=1923599)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=1923599)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1923599)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=1923599)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=1923599)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=1923599)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=1923599)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=1923599)[0m           'image_key': 'images',
[36m(TaskRunner pid=1923599)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=1923599)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=1923599)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=1923599)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=1923599)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=1923599)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=1923599)[0m           'shuffle': True,
[36m(TaskRunner pid=1923599)[0m           'tokenizer': None,
[36m(TaskRunner pid=1923599)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=1923599)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=1923599)[0m           'truncation': 'error',
[36m(TaskRunner pid=1923599)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=1923599)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=1923599)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=1923599)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=1923599)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=1923599)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1923599)[0m                   'max_length': None,
[36m(TaskRunner pid=1923599)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=1923599)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1923599)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=1923599)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1923599)[0m                                             'param_offload': False,
[36m(TaskRunner pid=1923599)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1923599)[0m                             'input_tokenizer': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1923599)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=1923599)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=1923599)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=1923599)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=1923599)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1923599)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=1923599)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=1923599)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=1923599)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=1923599)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=1923599)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=1923599)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=1923599)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=1923599)[0m              'logger': ['console'],
[36m(TaskRunner pid=1923599)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=1923599)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=1923599)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=1923599)[0m              'nnodes': 1,
[36m(TaskRunner pid=1923599)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=1923599)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=1923599)[0m              'resume_from_path': None,
[36m(TaskRunner pid=1923599)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=1923599)[0m              'save_freq': 50,
[36m(TaskRunner pid=1923599)[0m              'test_freq': 10,
[36m(TaskRunner pid=1923599)[0m              'total_epochs': 2,
[36m(TaskRunner pid=1923599)[0m              'total_training_steps': None,
[36m(TaskRunner pid=1923599)[0m              'val_before_train': True}}
[36m(TaskRunner pid=1923599)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=1923599)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=1923599)[0m dataset len: 8448
[36m(TaskRunner pid=1923599)[0m dataset len: 2113
[36m(TaskRunner pid=1923599)[0m Size of train dataloader: 66
[36m(TaskRunner pid=1923599)[0m Total training steps: 132
[36m(WorkerDict pid=1932615)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 63.64it/s]
[36m(WorkerDict pid=1932619)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 64.74it/s]
[36m(WorkerDict pid=1932615)[0m [rank1]:[W425 04:30:53.112826667 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 1]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=1926909)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=1932623)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932623)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=1932623)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 64.05it/s][32m [repeated 5x across cluster][0m
[36m(WorkerDict pid=1932621)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:00<00:00, 65.49it/s]
[36m(WorkerDict pid=1932623)[0m [rank7]:[W425 04:30:54.697769565 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 7]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932619)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:09,  3.33s/it]
[36m(WorkerDict pid=1932623)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932615)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 8x across cluster][0m
[36m(WorkerDict pid=1932619)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.26s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=1932619)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.18s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.21s/it]
[36m(WorkerDict pid=1926909)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.71s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932619)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=1932619)[0m   warnings.warn(
[36m(WorkerDict pid=1926909)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.69s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:14<00:00,  3.70s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932615)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1926909)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=1926909)[0m   "architectures": [
[36m(WorkerDict pid=1926909)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1926909)[0m   ],
[36m(WorkerDict pid=1926909)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1926909)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1926909)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1926909)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1926909)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1926909)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1926909)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1926909)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1926909)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1926909)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1926909)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1926909)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1926909)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1926909)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1926909)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1926909)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1926909)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1926909)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1926909)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1926909)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1926909)[0m   "use_cache": true,
[36m(WorkerDict pid=1926909)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1926909)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1926909)[0m }
[36m(WorkerDict pid=1926909)[0m 
[36m(WorkerDict pid=1926909)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1926909)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1926909)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f2776b068c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f2776b067a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=1932619)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1932623)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=1932618)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ecf43f068c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ecf43f067a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1926909)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=1926909)[0m   "architectures": [
[36m(WorkerDict pid=1926909)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1926909)[0m   ],
[36m(WorkerDict pid=1926909)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1926909)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1926909)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1926909)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1926909)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1926909)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1926909)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1926909)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1926909)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1926909)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1926909)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1926909)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1926909)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1926909)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1926909)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1926909)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1926909)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1926909)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1926909)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1926909)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1926909)[0m   "use_cache": true,
[36m(WorkerDict pid=1926909)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1926909)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1926909)[0m }
[36m(WorkerDict pid=1926909)[0m 
[36m(WorkerDict pid=1932623)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932619)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1932620)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1926909)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1926909)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f2776b068c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f2776b067a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=1932623)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=1932623)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1926909)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=1932618)[0m wrap_policy: functools.partial(<function _or_policy at 0x7ecf43f068c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7ecf43f067a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932620)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1926909)[0m Before building vllm rollout, memory allocated (GB): 3.5471720695495605, memory reserved (GB): 19.66015625
[36m(WorkerDict pid=1932623)[0m WARNING 04-25 04:31:28 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=1926909)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1926909)[0m Actor use_remove_padding=True[32m [repeated 6x across cluster][0m
[36m(WorkerDict pid=1932623)[0m WARNING 04-25 04:31:29 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7fbbbc10f520>
[36m(WorkerDict pid=1932620)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1932619)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=1926909)[0m WARNING 04-25 04:31:30 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1926909)[0m WARNING 04-25 04:31:30 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f2674527970>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932618)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=1923599)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=1923599)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=1923599)[0m Training from scratch
[36m(TaskRunner pid=1923599)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=1932615)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932615)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1923599)[0m Training Progress:   1%|          | 1/132 [01:19<2:52:59, 79.23s/it]
[36m(WorkerDict pid=1926909)[0m After building vllm rollout, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(WorkerDict pid=1926909)[0m After building sharding manager, memory allocated (GB): 16.592182159423828, memory reserved (GB): 20.4765625
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=1932615)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æœ¬é¢˜è€ƒæŸ¥å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†éƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¹™çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚å› æ­¤ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> é€‰é¡¹Bã€Cã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚{BCD}
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 1.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 0.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m ("Initial validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1923599)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': np.float64(0.899432087079981), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(0.899432087079981), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(4.12852693610609e-17), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(0.899432087079981), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(4.12852693610609e-17), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(TaskRunner pid=1923599)[0m step:0 - val-core/jec-qa-1-multi-choice/reward/mean@1:0.899 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:0.899 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.899 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:1 - global_seqlen/min:57077.000 - global_seqlen/max:61927.000 - global_seqlen/minmax_diff:4850.000 - global_seqlen/balanced_min:59187.000 - global_seqlen/balanced_max:59188.000 - global_seqlen/mean:59187.375 - actor/entropy_loss:1.193 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:0.076 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.040 - perf/mfu/actor:0.408 - perf/max_memory_allocated_gb:42.564 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:46.356 - actor/lr:0.000 - critic/score/mean:0.811 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.811 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:312.270 - response_length/max:834.000 - response_length/min:103.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.286 - timing_s/old_log_prob:6.519 - timing_s/ref:10.369 - timing_s/adv:0.319 - timing_s/update_actor:37.309 - timing_s/step:78.827 - timing_per_token_ms/ref:0.022 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:473499.000 - perf/time_per_step:78.827 - perf/throughput:750.852
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:   2%|â–         | 2/132 [02:34<2:46:45, 76.97s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   2%|â–         | 3/132 [03:51<2:44:57, 76.72s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   3%|â–         | 4/132 [05:07<2:43:37, 76.70s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   4%|â–         | 5/132 [06:21<2:39:59, 75.58s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   5%|â–         | 6/132 [07:35<2:37:49, 75.15s/it]
[36m(TaskRunner pid=1923599)[0m step:2 - global_seqlen/min:57249.000 - global_seqlen/max:63404.000 - global_seqlen/minmax_diff:6155.000 - global_seqlen/balanced_min:59924.000 - global_seqlen/balanced_max:59924.000 - global_seqlen/mean:59924.000 - actor/entropy_loss:1.211 - actor/kl_loss:0.001 - actor/kl_coef:0.001 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.758 - perf/mfu/actor:0.403 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:46.415 - actor/lr:0.000 - critic/score/mean:0.810 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.810 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:319.029 - response_length/max:721.000 - response_length/min:119.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.782 - timing_s/old_log_prob:6.413 - timing_s/ref:6.559 - timing_s/adv:0.327 - timing_s/update_actor:38.235 - timing_s/step:75.341 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:479392.000 - perf/time_per_step:75.341 - perf/throughput:795.368
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:3 - global_seqlen/min:57429.000 - global_seqlen/max:59902.000 - global_seqlen/minmax_diff:2473.000 - global_seqlen/balanced_min:58784.000 - global_seqlen/balanced_max:58785.000 - global_seqlen/mean:58784.375 - actor/entropy_loss:1.150 - actor/kl_loss:0.012 - actor/kl_coef:0.001 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.853 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:43.386 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:46.583 - actor/lr:0.000 - critic/score/mean:1.025 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.025 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:309.923 - response_length/max:850.000 - response_length/min:111.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.451 - timing_s/old_log_prob:6.436 - timing_s/ref:6.573 - timing_s/adv:0.317 - timing_s/update_actor:37.610 - timing_s/step:76.405 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:470275.000 - perf/time_per_step:76.405 - perf/throughput:769.382
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:4 - global_seqlen/min:54256.000 - global_seqlen/max:61179.000 - global_seqlen/minmax_diff:6923.000 - global_seqlen/balanced_min:58497.000 - global_seqlen/balanced_max:58498.000 - global_seqlen/mean:58497.375 - actor/entropy_loss:1.181 - actor/kl_loss:0.010 - actor/kl_coef:0.001 - actor/pg_loss:0.047 - actor/pg_clipfrac:0.004 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.769 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.434 - actor/lr:0.000 - critic/score/mean:1.240 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.240 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.022 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.022 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:303.715 - response_length/max:795.000 - response_length/min:97.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.633 - prompt_length/max:513.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.218 - timing_s/old_log_prob:6.393 - timing_s/ref:6.519 - timing_s/adv:0.324 - timing_s/update_actor:39.162 - timing_s/step:76.634 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:467979.000 - perf/time_per_step:76.634 - perf/throughput:763.339
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:5 - global_seqlen/min:55293.000 - global_seqlen/max:62979.000 - global_seqlen/minmax_diff:7686.000 - global_seqlen/balanced_min:58336.000 - global_seqlen/balanced_max:58337.000 - global_seqlen/mean:58336.875 - actor/entropy_loss:1.081 - actor/kl_loss:0.010 - actor/kl_coef:0.001 - actor/pg_loss:0.194 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.688 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.145 - actor/lr:0.000 - critic/score/mean:1.302 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.302 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:299.512 - response_length/max:680.000 - response_length/min:113.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.164 - prompt_length/max:499.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.841 - timing_s/old_log_prob:6.459 - timing_s/ref:6.563 - timing_s/adv:0.328 - timing_s/update_actor:37.374 - timing_s/step:73.586 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:466695.000 - perf/time_per_step:73.586 - perf/throughput:792.767
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:6 - global_seqlen/min:57210.000 - global_seqlen/max:60559.000 - global_seqlen/minmax_diff:3349.000 - global_seqlen/balanced_min:59078.000 - global_seqlen/balanced_max:59079.000 - global_seqlen/mean:59078.750 - actor/entropy_loss:1.101 - actor/kl_loss:0.014 - actor/kl_coef:0.001 - actor/pg_loss:0.116 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.708 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.157 - actor/lr:0.000 - critic/score/mean:1.346 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.346 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:303.091 - response_length/max:696.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.312 - prompt_length/max:547.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.819 - timing_s/old_log_prob:6.364 - timing_s/ref:6.507 - timing_s/adv:0.318 - timing_s/update_actor:38.262 - timing_s/step:74.296 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:472630.000 - perf/time_per_step:74.296 - perf/throughput:795.176
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info'][36m(TaskRunner pid=1923599)[0m Training Progress:   5%|â–Œ         | 7/132 [08:48<2:34:45, 74.28s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   6%|â–Œ         | 8/132 [10:00<2:32:14, 73.67s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   7%|â–‹         | 9/132 [11:14<2:31:05, 73.70s/it]

[36m(TaskRunner pid=1923599)[0m step:7 - global_seqlen/min:56231.000 - global_seqlen/max:61766.000 - global_seqlen/minmax_diff:5535.000 - global_seqlen/balanced_min:58585.000 - global_seqlen/balanced_max:58586.000 - global_seqlen/mean:58585.375 - actor/entropy_loss:1.092 - actor/kl_loss:0.008 - actor/kl_coef:0.001 - actor/pg_loss:-0.044 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.642 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.233 - actor/lr:0.000 - critic/score/mean:1.345 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.345 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:300.296 - response_length/max:668.000 - response_length/min:123.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.969 - prompt_length/max:505.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.585 - timing_s/old_log_prob:6.346 - timing_s/ref:6.474 - timing_s/adv:0.312 - timing_s/update_actor:36.739 - timing_s/step:72.476 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.078 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:468683.000 - perf/time_per_step:72.476 - perf/throughput:808.338
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:8 - global_seqlen/min:55933.000 - global_seqlen/max:57980.000 - global_seqlen/minmax_diff:2047.000 - global_seqlen/balanced_min:57061.000 - global_seqlen/balanced_max:57062.000 - global_seqlen/mean:57061.375 - actor/entropy_loss:1.056 - actor/kl_loss:0.020 - actor/kl_coef:0.001 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.715 - perf/mfu/actor:0.394 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.196 - actor/lr:0.000 - critic/score/mean:1.366 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.366 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:293.749 - response_length/max:668.000 - response_length/min:103.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:446.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.299 - timing_s/old_log_prob:6.150 - timing_s/ref:6.328 - timing_s/adv:0.317 - timing_s/update_actor:37.209 - timing_s/step:72.326 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.082 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:456491.000 - perf/time_per_step:72.326 - perf/throughput:788.945
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:9 - global_seqlen/min:54346.000 - global_seqlen/max:60737.000 - global_seqlen/minmax_diff:6391.000 - global_seqlen/balanced_min:58758.000 - global_seqlen/balanced_max:58759.000 - global_seqlen/mean:58758.625 - actor/entropy_loss:1.051 - actor/kl_loss:0.025 - actor/kl_coef:0.001 - actor/pg_loss:-0.033 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.703 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.490 - perf/cpu_memory_used_gb:47.245 - actor/lr:0.000 - critic/score/mean:1.360 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.360 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:296.717 - response_length/max:683.000 - response_length/min:102.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.352 - prompt_length/max:514.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.629 - timing_s/old_log_prob:6.427 - timing_s/ref:6.610 - timing_s/adv:0.312 - timing_s/update_actor:37.759 - timing_s/step:73.761 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:470069.000 - perf/time_per_step:73.761 - perf/throughput:796.608
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> åˆ†æé¢˜ç›®ï¼Œé¦–å…ˆæ˜ç¡®ç”²ä¹™äºŒäººçš„è¡Œä¸ºæ€§è´¨ã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²çš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†ä»ç„¶å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Bæ­£ç¡®ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Cæ­£ç¡®ï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚é€‰é¡¹Dæ­£ç¡®ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m Training Progress:   8%|â–Š         | 10/132 [14:40<3:53:16, 114.73s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   8%|â–Š         | 11/132 [15:51<3:24:09, 101.23s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:   9%|â–‰         | 12/132 [17:02<3:03:57, 91.98s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  10%|â–‰         | 13/132 [18:12<2:49:17, 85.36s/it]
[36m(TaskRunner pid=1923599)[0m step:10 - global_seqlen/min:56582.000 - global_seqlen/max:64070.000 - global_seqlen/minmax_diff:7488.000 - global_seqlen/balanced_min:59441.000 - global_seqlen/balanced_max:59442.000 - global_seqlen/mean:59441.500 - actor/entropy_loss:1.063 - actor/kl_loss:0.016 - actor/kl_coef:0.001 - actor/pg_loss:0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.772 - perf/mfu/actor:0.406 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.195 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.366 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.366 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.366 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.366 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.366 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.366 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.297 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.297 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:299.542 - response_length/max:665.000 - response_length/min:97.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.641 - prompt_length/max:640.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.523 - timing_s/old_log_prob:6.510 - timing_s/ref:6.624 - timing_s/adv:0.325 - timing_s/update_actor:37.659 - timing_s/testing:132.881 - timing_s/step:206.543 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.079 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:475532.000 - perf/time_per_step:206.543 - perf/throughput:287.792
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:11 - global_seqlen/min:53307.000 - global_seqlen/max:62998.000 - global_seqlen/minmax_diff:9691.000 - global_seqlen/balanced_min:57414.000 - global_seqlen/balanced_max:57415.000 - global_seqlen/mean:57414.375 - actor/entropy_loss:1.048 - actor/kl_loss:0.032 - actor/kl_coef:0.001 - actor/pg_loss:0.062 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.712 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.312 - actor/lr:0.000 - critic/score/mean:1.382 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.382 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:284.332 - response_length/max:598.000 - response_length/min:105.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.734 - prompt_length/max:613.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.551 - timing_s/old_log_prob:6.121 - timing_s/ref:6.365 - timing_s/adv:0.313 - timing_s/update_actor:37.240 - timing_s/step:70.615 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:459315.000 - perf/time_per_step:70.615 - perf/throughput:813.061
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:12 - global_seqlen/min:51391.000 - global_seqlen/max:61530.000 - global_seqlen/minmax_diff:10139.000 - global_seqlen/balanced_min:57198.000 - global_seqlen/balanced_max:57198.000 - global_seqlen/mean:57198.000 - actor/entropy_loss:1.008 - actor/kl_loss:0.019 - actor/kl_coef:0.001 - actor/pg_loss:0.082 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.199 - actor/lr:0.000 - critic/score/mean:1.354 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.354 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:276.008 - response_length/max:557.000 - response_length/min:108.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.805 - prompt_length/max:647.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.923 - timing_s/old_log_prob:6.288 - timing_s/ref:6.471 - timing_s/adv:0.312 - timing_s/update_actor:37.777 - timing_s/step:70.790 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:457584.000 - perf/time_per_step:70.790 - perf/throughput:807.994
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:13 - global_seqlen/min:54058.000 - global_seqlen/max:59039.000 - global_seqlen/minmax_diff:4981.000 - global_seqlen/balanced_min:55774.000 - global_seqlen/balanced_max:55775.000 - global_seqlen/mean:55774.125 - actor/entropy_loss:0.966 - actor/kl_loss:0.021 - actor/kl_coef:0.001 - actor/pg_loss:0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.751 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.324 - actor/lr:0.000 - critic/score/mean:1.348 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.348 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:270.934 - response_length/max:575.000 - response_length/min:91.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.047 - prompt_length/max:509.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.341 - timing_s/old_log_prob:6.189 - timing_s/ref:6.374 - timing_s/adv:0.309 - timing_s/update_actor:36.878 - timing_s/step:70.109 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:446193.000 - perf/time_per_step:70.109 - perf/throughput:795.537
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  11%|â–ˆ         | 14/132 [19:20<2:37:33, 80.12s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  11%|â–ˆâ–        | 15/132 [20:28<2:29:14, 76.54s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  12%|â–ˆâ–        | 16/132 [21:44<2:27:24, 76.24s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  13%|â–ˆâ–        | 17/132 [22:51<2:20:49, 73.48s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  14%|â–ˆâ–        | 18/132 [24:00<2:16:55, 72.06s/it]
[36m(TaskRunner pid=1923599)[0m step:14 - global_seqlen/min:50438.000 - global_seqlen/max:58514.000 - global_seqlen/minmax_diff:8076.000 - global_seqlen/balanced_min:55002.000 - global_seqlen/balanced_max:55003.000 - global_seqlen/mean:55002.875 - actor/entropy_loss:0.915 - actor/kl_loss:0.020 - actor/kl_coef:0.001 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.662 - perf/mfu/actor:0.400 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.228 - actor/lr:0.000 - critic/score/mean:1.355 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.355 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.019 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.019 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:268.345 - response_length/max:543.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.602 - prompt_length/max:614.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.265 - timing_s/old_log_prob:5.928 - timing_s/ref:6.175 - timing_s/adv:0.314 - timing_s/update_actor:35.285 - timing_s/step:67.987 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.080 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:440023.000 - perf/time_per_step:67.987 - perf/throughput:809.019
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:15 - global_seqlen/min:52851.000 - global_seqlen/max:57481.000 - global_seqlen/minmax_diff:4630.000 - global_seqlen/balanced_min:55247.000 - global_seqlen/balanced_max:55248.000 - global_seqlen/mean:55247.250 - actor/entropy_loss:0.960 - actor/kl_loss:0.033 - actor/kl_coef:0.001 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.675 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.627 - perf/cpu_memory_used_gb:47.290 - actor/lr:0.000 - critic/score/mean:1.376 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.376 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:263.570 - response_length/max:556.000 - response_length/min:116.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.922 - prompt_length/max:562.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.834 - timing_s/old_log_prob:5.995 - timing_s/ref:6.222 - timing_s/adv:0.307 - timing_s/update_actor:35.835 - timing_s/step:68.214 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/update_actor:0.081 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:441978.000 - perf/time_per_step:68.214 - perf/throughput:809.912
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:16 - global_seqlen/min:51595.000 - global_seqlen/max:57692.000 - global_seqlen/minmax_diff:6097.000 - global_seqlen/balanced_min:54653.000 - global_seqlen/balanced_max:54656.000 - global_seqlen/mean:54654.500 - actor/entropy_loss:0.917 - actor/kl_loss:0.025 - actor/kl_coef:0.001 - actor/pg_loss:-0.060 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.712 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:47.428 - actor/lr:0.000 - critic/score/mean:1.360 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.360 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:257.607 - response_length/max:1024.000 - response_length/min:104.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.711 - prompt_length/max:820.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.676 - timing_s/old_log_prob:5.948 - timing_s/ref:6.210 - timing_s/adv:0.319 - timing_s/update_actor:36.375 - timing_s/step:75.546 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:437236.000 - perf/time_per_step:75.546 - perf/throughput:723.456
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:17 - global_seqlen/min:50579.000 - global_seqlen/max:58052.000 - global_seqlen/minmax_diff:7473.000 - global_seqlen/balanced_min:54129.000 - global_seqlen/balanced_max:54129.000 - global_seqlen/mean:54129.000 - actor/entropy_loss:0.879 - actor/kl_loss:0.030 - actor/kl_coef:0.001 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.665 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:47.472 - actor/lr:0.000 - critic/score/mean:1.398 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.398 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:252.172 - response_length/max:507.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:798.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.562 - timing_s/old_log_prob:5.979 - timing_s/ref:6.223 - timing_s/adv:0.305 - timing_s/update_actor:35.925 - timing_s/step:67.019 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:433032.000 - perf/time_per_step:67.019 - perf/throughput:807.664
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:18 - global_seqlen/min:52673.000 - global_seqlen/max:56929.000 - global_seqlen/minmax_diff:4256.000 - global_seqlen/balanced_min:54139.000 - global_seqlen/balanced_max:54140.000 - global_seqlen/mean:54139.250 - actor/entropy_loss:0.875 - actor/kl_loss:0.031 - actor/kl_coef:0.001 - actor/pg_loss:0.025 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.685 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:47.313 - actor/lr:0.000 - critic/score/mean:1.384 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.384 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:251.411 - response_length/max:530.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.539 - prompt_length/max:574.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.260 - timing_s/old_log_prob:6.017 - timing_s/ref:6.282 - timing_s/adv:0.305 - timing_s/update_actor:36.833 - timing_s/step:68.722 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:433114.000 - perf/time_per_step:68.722 - perf/throughput:787.806
[36m(TaskRunner pid=1923599)[0m Training Progress:  14%|â–ˆâ–        | 19/132 [25:09<2:14:07, 71.22s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  15%|â–ˆâ–Œ        | 20/132 [28:29<3:25:09, 109.91s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:19 - global_seqlen/min:52495.000 - global_seqlen/max:58368.000 - global_seqlen/minmax_diff:5873.000 - global_seqlen/balanced_min:54149.000 - global_seqlen/balanced_max:54150.000 - global_seqlen/mean:54149.250 - actor/entropy_loss:0.843 - actor/kl_loss:0.032 - actor/kl_coef:0.001 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.662 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:47.331 - actor/lr:0.000 - critic/score/mean:1.387 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.387 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:255.836 - response_length/max:533.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.219 - prompt_length/max:638.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.690 - timing_s/old_log_prob:6.000 - timing_s/ref:6.258 - timing_s/adv:0.302 - timing_s/update_actor:36.950 - timing_s/step:69.218 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:433194.000 - perf/time_per_step:69.218 - perf/throughput:782.295
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> åˆ†æé¢˜ç›®ä¸­çš„æƒ…å†µï¼Œç”²æŸå’Œä¹™æŸå…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œä½†ä»–ä»¬çš„ä¸»è§‚æ•…æ„ä¸åŒã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„ï¼Œå³å…±åŒçš„çŠ¯ç½ªç›®çš„å’ŒçŠ¯ç½ªåŠ¨æœºã€‚ç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´ï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Bæ˜¯æ­£ç¡®çš„ã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤é€‰é¡¹Cä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚ä¹™æŸçš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œå› æ­¤é€‰é¡¹Dä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚é€‰é¡¹Aè®¤ä¸ºç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªï¼Œè¿™æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:20 - global_seqlen/min:51354.000 - global_seqlen/max:56142.000 - global_seqlen/minmax_diff:4788.000 - global_seqlen/balanced_min:53886.000 - global_seqlen/balanced_max:53887.000 - global_seqlen/mean:53886.125 - actor/entropy_loss:0.820 - actor/kl_loss:0.030 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:47.411 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.407 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.407 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.407 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.407 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.407 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.407 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.407 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.407 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:250.783 - response_length/max:550.000 - response_length/min:90.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.531 - prompt_length/max:516.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.380 - timing_s/old_log_prob:5.938 - timing_s/ref:6.186 - timing_s/adv:0.314 - timing_s/update_actor:36.027 - timing_s/testing:132.192 - timing_s/step:200.064 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:431089.000 - perf/time_per_step:200.064 - perf/throughput:269.345
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  16%|â–ˆâ–Œ        | 21/132 [29:36<2:59:37, 97.09s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  17%|â–ˆâ–‹        | 22/132 [30:43<2:41:35, 88.15s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  17%|â–ˆâ–‹        | 23/132 [31:51<2:28:58, 82.01s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  18%|â–ˆâ–Š        | 24/132 [32:57<2:19:04, 77.27s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  19%|â–ˆâ–‰        | 25/132 [34:04<2:12:02, 74.04s/it]
[36m(TaskRunner pid=1923599)[0m step:21 - global_seqlen/min:52423.000 - global_seqlen/max:55549.000 - global_seqlen/minmax_diff:3126.000 - global_seqlen/balanced_min:54110.000 - global_seqlen/balanced_max:54111.000 - global_seqlen/mean:54110.250 - actor/entropy_loss:0.815 - actor/kl_loss:0.024 - actor/kl_coef:0.001 - actor/pg_loss:0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.699 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:49.163 - actor/lr:0.000 - critic/score/mean:1.393 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.393 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:249.812 - response_length/max:485.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.836 - prompt_length/max:555.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.926 - timing_s/old_log_prob:5.816 - timing_s/ref:6.125 - timing_s/adv:0.310 - timing_s/update_actor:36.989 - timing_s/step:67.197 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:432882.000 - perf/time_per_step:67.197 - perf/throughput:805.244
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:22 - global_seqlen/min:51811.000 - global_seqlen/max:56478.000 - global_seqlen/minmax_diff:4667.000 - global_seqlen/balanced_min:53197.000 - global_seqlen/balanced_max:53198.000 - global_seqlen/mean:53197.625 - actor/entropy_loss:0.800 - actor/kl_loss:0.036 - actor/kl_coef:0.001 - actor/pg_loss:0.046 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.687 - perf/mfu/actor:0.383 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.689 - perf/cpu_memory_used_gb:49.137 - actor/lr:0.000 - critic/score/mean:1.405 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.405 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:246.111 - response_length/max:585.000 - response_length/min:84.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.031 - prompt_length/max:480.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.557 - timing_s/old_log_prob:5.767 - timing_s/ref:6.013 - timing_s/adv:0.308 - timing_s/update_actor:35.593 - timing_s/step:67.262 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:425581.000 - perf/time_per_step:67.262 - perf/throughput:790.901
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:23 - global_seqlen/min:50776.000 - global_seqlen/max:59189.000 - global_seqlen/minmax_diff:8413.000 - global_seqlen/balanced_min:54430.000 - global_seqlen/balanced_max:54431.000 - global_seqlen/mean:54430.500 - actor/entropy_loss:0.803 - actor/kl_loss:0.040 - actor/kl_coef:0.001 - actor/pg_loss:-0.125 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.704 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.748 - perf/cpu_memory_used_gb:49.164 - actor/lr:0.000 - critic/score/mean:1.405 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.405 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.703 - response_length/max:508.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.281 - prompt_length/max:511.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.075 - timing_s/old_log_prob:6.000 - timing_s/ref:6.223 - timing_s/adv:0.305 - timing_s/update_actor:36.035 - timing_s/step:67.664 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:435444.000 - perf/time_per_step:67.664 - perf/throughput:804.423
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:24 - global_seqlen/min:49288.000 - global_seqlen/max:55384.000 - global_seqlen/minmax_diff:6096.000 - global_seqlen/balanced_min:52049.000 - global_seqlen/balanced_max:52050.000 - global_seqlen/mean:52049.750 - actor/entropy_loss:0.763 - actor/kl_loss:0.035 - actor/kl_coef:0.001 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.757 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.149 - actor/lr:0.000 - critic/score/mean:1.395 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.395 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:229.951 - response_length/max:454.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.234 - prompt_length/max:798.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.011 - timing_s/old_log_prob:5.803 - timing_s/ref:6.127 - timing_s/adv:0.307 - timing_s/update_actor:35.921 - timing_s/step:66.199 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:416398.000 - perf/time_per_step:66.199 - perf/throughput:786.259
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:25 - global_seqlen/min:50603.000 - global_seqlen/max:57264.000 - global_seqlen/minmax_diff:6661.000 - global_seqlen/balanced_min:53372.000 - global_seqlen/balanced_max:53373.000 - global_seqlen/mean:53372.625 - actor/entropy_loss:0.808 - actor/kl_loss:0.052 - actor/kl_coef:0.001 - actor/pg_loss:-0.079 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.715 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.063 - actor/lr:0.000 - critic/score/mean:1.345 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.345 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:234.355 - response_length/max:514.000 - response_length/min:97.000 - response_length/clip_ratio:0.000 - prompt_length/mean:321.609 - prompt_length/max:561.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.409 - timing_s/old_log_prob:5.813 - timing_s/ref:6.105 - timing_s/adv:0.301 - timing_s/update_actor:35.836 - timing_s/step:66.486 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:426981.000 - perf/time_per_step:66.486 - perf/throughput:802.767
[36m(TaskRunner pid=1923599)[0m Training Progress:  20%|â–ˆâ–‰        | 26/132 [35:09<2:06:22, 71.54s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  20%|â–ˆâ–ˆ        | 27/132 [36:14<2:01:22, 69.36s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  21%|â–ˆâ–ˆ        | 28/132 [37:17<1:57:13, 67.63s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 29/132 [38:22<1:54:30, 66.70s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:26 - global_seqlen/min:49745.000 - global_seqlen/max:59576.000 - global_seqlen/minmax_diff:9831.000 - global_seqlen/balanced_min:53001.000 - global_seqlen/balanced_max:53002.000 - global_seqlen/mean:53001.375 - actor/entropy_loss:0.757 - actor/kl_loss:0.046 - actor/kl_coef:0.001 - actor/pg_loss:-0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.782 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.152 - actor/lr:0.000 - critic/score/mean:1.408 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.408 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:224.012 - response_length/max:452.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:328.086 - prompt_length/max:765.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.482 - timing_s/old_log_prob:5.920 - timing_s/ref:6.219 - timing_s/adv:0.299 - timing_s/update_actor:35.708 - timing_s/step:65.650 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:424011.000 - perf/time_per_step:65.650 - perf/throughput:807.338
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:27 - global_seqlen/min:47703.000 - global_seqlen/max:53901.000 - global_seqlen/minmax_diff:6198.000 - global_seqlen/balanced_min:50268.000 - global_seqlen/balanced_max:50269.000 - global_seqlen/mean:50268.750 - actor/entropy_loss:0.747 - actor/kl_loss:0.049 - actor/kl_coef:0.001 - actor/pg_loss:0.029 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.743 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.464 - actor/lr:0.000 - critic/score/mean:1.401 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.401 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:214.711 - response_length/max:482.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.922 - prompt_length/max:551.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.769 - timing_s/old_log_prob:5.539 - timing_s/ref:5.911 - timing_s/adv:0.317 - timing_s/update_actor:34.666 - timing_s/step:64.224 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:402150.000 - perf/time_per_step:64.224 - perf/throughput:782.710
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:28 - global_seqlen/min:46022.000 - global_seqlen/max:51318.000 - global_seqlen/minmax_diff:5296.000 - global_seqlen/balanced_min:48180.000 - global_seqlen/balanced_max:48181.000 - global_seqlen/mean:48180.750 - actor/entropy_loss:0.771 - actor/kl_loss:0.062 - actor/kl_coef:0.001 - actor/pg_loss:-0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.804 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.488 - actor/lr:0.000 - critic/score/mean:1.452 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.452 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:204.445 - response_length/max:484.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:297.438 - prompt_length/max:536.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.544 - timing_s/old_log_prob:5.379 - timing_s/ref:5.819 - timing_s/adv:0.322 - timing_s/update_actor:34.502 - timing_s/step:63.590 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:385446.000 - perf/time_per_step:63.590 - perf/throughput:757.679
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:29 - global_seqlen/min:46266.000 - global_seqlen/max:52832.000 - global_seqlen/minmax_diff:6566.000 - global_seqlen/balanced_min:50512.000 - global_seqlen/balanced_max:50513.000 - global_seqlen/mean:50512.250 - actor/entropy_loss:0.740 - actor/kl_loss:0.069 - actor/kl_coef:0.001 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.794 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.346 - actor/lr:0.000 - critic/score/mean:1.371 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.371 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.451 - response_length/max:485.000 - response_length/min:37.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.719 - prompt_length/max:548.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.078 - timing_s/old_log_prob:5.621 - timing_s/ref:5.912 - timing_s/adv:0.297 - timing_s/update_actor:34.582 - timing_s/step:64.510 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:404098.000 - perf/time_per_step:64.510 - perf/throughput:783.009
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 30/132 [41:34<2:57:35, 104.46s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 31/132 [42:42<2:37:13, 93.40s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 32/132 [43:45<2:20:41, 84.41s/it]
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹ç¬¬282æ¡çš„è§„å®šï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªæ˜¯æŒ‡ä»¥çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°æ–¹æ³•ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚åŒæ—¶ï¼Œæ ¹æ®å…±åŒçŠ¯ç½ªçš„åŸåˆ™ï¼Œå¯¹ç”²åº”ä»¥ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:30 - global_seqlen/min:46197.000 - global_seqlen/max:53107.000 - global_seqlen/minmax_diff:6910.000 - global_seqlen/balanced_min:49401.000 - global_seqlen/balanced_max:49402.000 - global_seqlen/mean:49401.750 - actor/entropy_loss:0.738 - actor/kl_loss:0.059 - actor/kl_coef:0.001 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.772 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.441 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.444 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.444 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.444 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.444 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.444 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.444 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.358 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.358 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:213.016 - response_length/max:466.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.586 - prompt_length/max:567.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.647 - timing_s/old_log_prob:5.535 - timing_s/ref:5.864 - timing_s/adv:0.298 - timing_s/update_actor:34.177 - timing_s/testing:129.010 - timing_s/step:192.553 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:395214.000 - perf/time_per_step:192.553 - perf/throughput:256.562
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:31 - global_seqlen/min:48717.000 - global_seqlen/max:54545.000 - global_seqlen/minmax_diff:5828.000 - global_seqlen/balanced_min:50159.000 - global_seqlen/balanced_max:50224.000 - global_seqlen/mean:50167.125 - actor/entropy_loss:0.745 - actor/kl_loss:0.077 - actor/kl_coef:0.001 - actor/pg_loss:-0.152 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.765 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.432 - actor/lr:0.000 - critic/score/mean:1.439 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.439 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:219.488 - response_length/max:753.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.086 - prompt_length/max:513.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.535 - timing_s/old_log_prob:5.448 - timing_s/ref:5.829 - timing_s/adv:0.295 - timing_s/update_actor:34.436 - timing_s/step:67.568 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:401337.000 - perf/time_per_step:67.568 - perf/throughput:742.466
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:32 - global_seqlen/min:48688.000 - global_seqlen/max:51347.000 - global_seqlen/minmax_diff:2659.000 - global_seqlen/balanced_min:50460.000 - global_seqlen/balanced_max:50461.000 - global_seqlen/mean:50460.375 - actor/entropy_loss:0.777 - actor/kl_loss:0.041 - actor/kl_coef:0.001 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.722 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.493 - actor/lr:0.000 - critic/score/mean:1.414 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.414 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:213.574 - response_length/max:484.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.055 - prompt_length/max:522.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.715 - timing_s/old_log_prob:5.492 - timing_s/ref:5.858 - timing_s/adv:0.298 - timing_s/update_actor:34.047 - timing_s/step:63.433 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:403683.000 - perf/time_per_step:63.433 - perf/throughput:795.496
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 33/132 [44:49<2:09:07, 78.26s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 34/132 [45:53<2:00:36, 73.84s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 35/132 [46:57<1:54:25, 70.78s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 36/132 [48:00<1:49:52, 68.67s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 37/132 [49:04<1:46:08, 67.04s/it]
[36m(TaskRunner pid=1923599)[0m step:33 - global_seqlen/min:46180.000 - global_seqlen/max:51213.000 - global_seqlen/minmax_diff:5033.000 - global_seqlen/balanced_min:48988.000 - global_seqlen/balanced_max:48989.000 - global_seqlen/mean:48988.375 - actor/entropy_loss:0.768 - actor/kl_loss:0.067 - actor/kl_coef:0.001 - actor/pg_loss:-0.071 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.752 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.598 - actor/lr:0.000 - critic/score/mean:1.470 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.470 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.757 - response_length/max:522.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.539 - prompt_length/max:521.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.126 - timing_s/old_log_prob:5.428 - timing_s/ref:5.856 - timing_s/adv:0.286 - timing_s/update_actor:34.137 - timing_s/step:63.857 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:391907.000 - perf/time_per_step:63.857 - perf/throughput:767.162
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:34 - global_seqlen/min:46620.000 - global_seqlen/max:51948.000 - global_seqlen/minmax_diff:5328.000 - global_seqlen/balanced_min:49640.000 - global_seqlen/balanced_max:49641.000 - global_seqlen/mean:49640.500 - actor/entropy_loss:0.768 - actor/kl_loss:0.068 - actor/kl_coef:0.001 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.738 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.482 - actor/lr:0.000 - critic/score/mean:1.407 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.407 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:203.151 - response_length/max:458.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.938 - prompt_length/max:558.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.624 - timing_s/old_log_prob:5.439 - timing_s/ref:5.864 - timing_s/adv:0.304 - timing_s/update_actor:34.255 - timing_s/step:63.506 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:397124.000 - perf/time_per_step:63.506 - perf/throughput:781.661
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:35 - global_seqlen/min:46366.000 - global_seqlen/max:51701.000 - global_seqlen/minmax_diff:5335.000 - global_seqlen/balanced_min:48614.000 - global_seqlen/balanced_max:48615.000 - global_seqlen/mean:48614.625 - actor/entropy_loss:0.799 - actor/kl_loss:0.088 - actor/kl_coef:0.001 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.827 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.431 - actor/lr:0.000 - critic/score/mean:1.437 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.437 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:192.262 - response_length/max:503.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.141 - prompt_length/max:544.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.669 - timing_s/old_log_prob:5.465 - timing_s/ref:5.810 - timing_s/adv:0.285 - timing_s/update_actor:34.339 - timing_s/step:63.593 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388917.000 - perf/time_per_step:63.593 - perf/throughput:764.469
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:36 - global_seqlen/min:47725.000 - global_seqlen/max:53486.000 - global_seqlen/minmax_diff:5761.000 - global_seqlen/balanced_min:49836.000 - global_seqlen/balanced_max:49837.000 - global_seqlen/mean:49836.625 - actor/entropy_loss:0.764 - actor/kl_loss:0.067 - actor/kl_coef:0.001 - actor/pg_loss:0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.770 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.497 - actor/lr:0.000 - critic/score/mean:1.425 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.425 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:198.999 - response_length/max:450.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.133 - prompt_length/max:567.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.090 - timing_s/old_log_prob:5.504 - timing_s/ref:5.863 - timing_s/adv:0.296 - timing_s/update_actor:34.961 - timing_s/step:63.737 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:398693.000 - perf/time_per_step:63.737 - perf/throughput:781.913
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:37 - global_seqlen/min:46250.000 - global_seqlen/max:49989.000 - global_seqlen/minmax_diff:3739.000 - global_seqlen/balanced_min:48448.000 - global_seqlen/balanced_max:48449.000 - global_seqlen/mean:48448.750 - actor/entropy_loss:0.752 - actor/kl_loss:0.074 - actor/kl_coef:0.001 - actor/pg_loss:-0.070 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.791 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.834 - actor/lr:0.000 - critic/score/mean:1.462 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.462 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:189.573 - response_length/max:516.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.102 - prompt_length/max:462.000 - prompt_length/min:229.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.750 - timing_s/old_log_prob:5.320 - timing_s/ref:5.738 - timing_s/adv:0.291 - timing_s/update_actor:34.073 - timing_s/step:63.199 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:387590.000 - perf/time_per_step:63.199 - perf/throughput:766.607
[36m(TaskRunner pid=1923599)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 38/132 [50:05<1:42:18, 65.31s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  30%|â–ˆâ–ˆâ–‰       | 39/132 [51:08<1:40:18, 64.72s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:38 - global_seqlen/min:45081.000 - global_seqlen/max:50612.000 - global_seqlen/minmax_diff:5531.000 - global_seqlen/balanced_min:48350.000 - global_seqlen/balanced_max:48351.000 - global_seqlen/mean:48350.375 - actor/entropy_loss:0.737 - actor/kl_loss:0.110 - actor/kl_coef:0.001 - actor/pg_loss:-0.006 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.924 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.722 - actor/lr:0.000 - critic/score/mean:1.451 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.451 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:188.095 - response_length/max:407.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.555 - prompt_length/max:504.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.248 - timing_s/old_log_prob:5.316 - timing_s/ref:5.746 - timing_s/adv:0.301 - timing_s/update_actor:33.624 - timing_s/step:61.255 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:386803.000 - perf/time_per_step:61.255 - perf/throughput:789.330
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:39 - global_seqlen/min:43535.000 - global_seqlen/max:53494.000 - global_seqlen/minmax_diff:9959.000 - global_seqlen/balanced_min:48650.000 - global_seqlen/balanced_max:48651.000 - global_seqlen/mean:48650.875 - actor/entropy_loss:0.704 - actor/kl_loss:0.092 - actor/kl_coef:0.001 - actor/pg_loss:-0.130 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.935 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:49.980 - actor/lr:0.000 - critic/score/mean:1.460 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.460 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.491 - response_length/max:500.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.289 - prompt_length/max:789.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.857 - timing_s/old_log_prob:5.315 - timing_s/ref:5.702 - timing_s/adv:0.287 - timing_s/update_actor:34.137 - timing_s/step:63.322 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:389207.000 - perf/time_per_step:63.322 - perf/throughput:768.309
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹ç¬¬282æ¡çš„è§„å®šï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªæ˜¯æŒ‡ä»¥çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°æ–¹æ³•ï¼Œéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚åŒæ—¶ï¼Œæ ¹æ®å…±åŒçŠ¯ç½ªçš„åŸåˆ™ï¼Œå¯¹ç”²åº”ä»¥ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [54:15<2:35:31, 101.43s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 41/132 [55:17<2:15:52, 89.59s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 42/132 [56:21<2:02:46, 81.86s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 43/132 [57:24<1:53:12, 76.32s/it]
[36m(TaskRunner pid=1923599)[0m step:40 - global_seqlen/min:42856.000 - global_seqlen/max:51014.000 - global_seqlen/minmax_diff:8158.000 - global_seqlen/balanced_min:47759.000 - global_seqlen/balanced_max:47759.000 - global_seqlen/mean:47759.000 - actor/entropy_loss:0.683 - actor/kl_loss:0.083 - actor/kl_coef:0.001 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.877 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.094 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.470 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.470 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.470 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.470 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.470 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.470 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.435 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.435 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:185.716 - response_length/max:381.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.773 - prompt_length/max:595.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:15.876 - timing_s/old_log_prob:5.240 - timing_s/ref:5.679 - timing_s/adv:0.286 - timing_s/update_actor:33.524 - timing_s/testing:126.458 - timing_s/step:187.087 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:382072.000 - perf/time_per_step:187.087 - perf/throughput:255.277
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:41 - global_seqlen/min:46072.000 - global_seqlen/max:48923.000 - global_seqlen/minmax_diff:2851.000 - global_seqlen/balanced_min:47211.000 - global_seqlen/balanced_max:47212.000 - global_seqlen/mean:47211.625 - actor/entropy_loss:0.683 - actor/kl_loss:0.101 - actor/kl_coef:0.001 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.877 - perf/mfu/actor:0.357 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.059 - actor/lr:0.000 - critic/score/mean:1.465 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.465 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:183.319 - response_length/max:487.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.469 - prompt_length/max:583.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.955 - timing_s/old_log_prob:5.144 - timing_s/ref:5.591 - timing_s/adv:0.326 - timing_s/update_actor:33.887 - timing_s/step:61.933 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:377693.000 - perf/time_per_step:61.933 - perf/throughput:762.298
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:42 - global_seqlen/min:46771.000 - global_seqlen/max:52072.000 - global_seqlen/minmax_diff:5301.000 - global_seqlen/balanced_min:48876.000 - global_seqlen/balanced_max:48877.000 - global_seqlen/mean:48876.750 - actor/entropy_loss:0.676 - actor/kl_loss:0.098 - actor/kl_coef:0.001 - actor/pg_loss:-0.165 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.890 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.191 - actor/lr:0.000 - critic/score/mean:1.460 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.460 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:189.891 - response_length/max:500.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.242 - prompt_length/max:628.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.003 - timing_s/old_log_prob:5.409 - timing_s/ref:5.821 - timing_s/adv:0.291 - timing_s/update_actor:34.227 - timing_s/step:63.774 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:391014.000 - perf/time_per_step:63.774 - perf/throughput:766.407
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:43 - global_seqlen/min:46740.000 - global_seqlen/max:50570.000 - global_seqlen/minmax_diff:3830.000 - global_seqlen/balanced_min:49259.000 - global_seqlen/balanced_max:49260.000 - global_seqlen/mean:49259.250 - actor/entropy_loss:0.686 - actor/kl_loss:0.075 - actor/kl_coef:0.001 - actor/pg_loss:0.095 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.836 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.294 - actor/lr:0.000 - critic/score/mean:1.414 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.414 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.014 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.014 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:199.695 - response_length/max:505.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.422 - prompt_length/max:535.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.793 - timing_s/old_log_prob:5.427 - timing_s/ref:5.811 - timing_s/adv:0.309 - timing_s/update_actor:34.009 - timing_s/step:63.371 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:394074.000 - perf/time_per_step:63.371 - perf/throughput:777.311
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 44/132 [58:28<1:46:31, 72.63s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 45/132 [59:29<1:40:09, 69.07s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–      | 46/132 [1:00:31<1:35:43, 66.78s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 47/132 [1:01:34<1:33:05, 65.72s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [1:02:36<1:30:29, 64.64s/it]
[36m(TaskRunner pid=1923599)[0m step:44 - global_seqlen/min:46577.000 - global_seqlen/max:53884.000 - global_seqlen/minmax_diff:7307.000 - global_seqlen/balanced_min:49100.000 - global_seqlen/balanced_max:49101.000 - global_seqlen/mean:49100.625 - actor/entropy_loss:0.692 - actor/kl_loss:0.103 - actor/kl_coef:0.001 - actor/pg_loss:-0.077 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.836 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.135 - actor/lr:0.000 - critic/score/mean:1.485 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.485 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:199.793 - response_length/max:487.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:808.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.601 - timing_s/old_log_prob:5.506 - timing_s/ref:5.890 - timing_s/adv:0.300 - timing_s/update_actor:34.681 - timing_s/step:64.003 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:392805.000 - perf/time_per_step:64.003 - perf/throughput:767.161
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:45 - global_seqlen/min:46518.000 - global_seqlen/max:51258.000 - global_seqlen/minmax_diff:4740.000 - global_seqlen/balanced_min:48095.000 - global_seqlen/balanced_max:48096.000 - global_seqlen/mean:48095.500 - actor/entropy_loss:0.655 - actor/kl_loss:0.102 - actor/kl_coef:0.001 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.806 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.155 - actor/lr:0.000 - critic/score/mean:1.490 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.490 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:189.604 - response_length/max:388.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.391 - prompt_length/max:611.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:15.840 - timing_s/old_log_prob:5.279 - timing_s/ref:5.726 - timing_s/adv:0.287 - timing_s/update_actor:33.595 - timing_s/step:60.754 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:384764.000 - perf/time_per_step:60.754 - perf/throughput:791.647
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:46 - global_seqlen/min:43661.000 - global_seqlen/max:49268.000 - global_seqlen/minmax_diff:5607.000 - global_seqlen/balanced_min:47155.000 - global_seqlen/balanced_max:47156.000 - global_seqlen/mean:47155.375 - actor/entropy_loss:0.636 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:0.052 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.789 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.104 - actor/lr:0.000 - critic/score/mean:1.446 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.446 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.014 - response_length/max:424.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.188 - prompt_length/max:485.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.412 - timing_s/old_log_prob:5.220 - timing_s/ref:5.698 - timing_s/adv:0.290 - timing_s/update_actor:33.776 - timing_s/step:61.414 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:377243.000 - perf/time_per_step:61.414 - perf/throughput:767.828
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:47 - global_seqlen/min:44300.000 - global_seqlen/max:49847.000 - global_seqlen/minmax_diff:5547.000 - global_seqlen/balanced_min:46979.000 - global_seqlen/balanced_max:46980.000 - global_seqlen/mean:46979.250 - actor/entropy_loss:0.638 - actor/kl_loss:0.093 - actor/kl_coef:0.001 - actor/pg_loss:-0.076 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.825 - perf/mfu/actor:0.353 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.192 - actor/lr:0.000 - critic/score/mean:1.476 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.476 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.148 - response_length/max:513.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.219 - prompt_length/max:455.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.046 - timing_s/old_log_prob:5.192 - timing_s/ref:5.641 - timing_s/adv:0.286 - timing_s/update_actor:34.031 - timing_s/step:63.222 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/update_actor:0.091 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:375834.000 - perf/time_per_step:63.222 - perf/throughput:743.090
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:48 - global_seqlen/min:45406.000 - global_seqlen/max:52301.000 - global_seqlen/minmax_diff:6895.000 - global_seqlen/balanced_min:47663.000 - global_seqlen/balanced_max:47664.000 - global_seqlen/mean:47663.500 - actor/entropy_loss:0.638 - actor/kl_loss:0.121 - actor/kl_coef:0.001 - actor/pg_loss:0.031 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.870 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.188 - actor/lr:0.000 - critic/score/mean:1.490 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.490 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:190.518 - response_length/max:479.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:485.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.384 - timing_s/old_log_prob:5.289 - timing_s/ref:5.768 - timing_s/adv:0.290 - timing_s/update_actor:33.360 - timing_s/step:62.113 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:381308.000 - perf/time_per_step:62.113 - perf/throughput:767.369
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/132 [1:03:39<1:28:40, 64.10s/it]
[36m(TaskRunner pid=1923599)[0m step:49 - global_seqlen/min:44417.000 - global_seqlen/max:51702.000 - global_seqlen/minmax_diff:7285.000 - global_seqlen/balanced_min:48301.000 - global_seqlen/balanced_max:48302.000 - global_seqlen/mean:48301.125 - actor/entropy_loss:0.646 - actor/kl_loss:0.099 - actor/kl_coef:0.001 - actor/pg_loss:-0.054 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.782 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.134 - actor/lr:0.000 - critic/score/mean:1.484 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.484 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:192.980 - response_length/max:467.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.156 - prompt_length/max:503.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.003 - timing_s/old_log_prob:5.279 - timing_s/ref:5.732 - timing_s/adv:0.294 - timing_s/update_actor:34.463 - timing_s/step:62.800 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:386409.000 - perf/time_per_step:62.800 - perf/throughput:769.132
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚è™½ç„¶ä»–ä»¬çš„ä¸»è§‚æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆã€Šåˆ‘æ³•ã€‹ç¬¬111æ¡çš„è§„å®šï¼Œæ„æˆâ€œä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªâ€ã€‚ä¹™æŸçš„è¡Œä¸ºç¬¦åˆã€Šåˆ‘æ³•ã€‹ç¬¬282æ¡çš„è§„å®šï¼Œæ„æˆâ€œéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªâ€ã€‚å› æ­¤ï¼Œé€‰é¡¹Bå’ŒCã€Dæ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_4.pt
[36m(TaskRunner pid=1923599)[0m step:50 - global_seqlen/min:47357.000 - global_seqlen/max:52033.000 - global_seqlen/minmax_diff:4676.000 - global_seqlen/balanced_min:49211.000 - global_seqlen/balanced_max:49212.000 - global_seqlen/mean:49211.875 - actor/entropy_loss:0.636 - actor/kl_loss:0.099 - actor/kl_coef:0.001 - actor/pg_loss:-0.085 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.749 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.237 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.490 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.490 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.490 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.490 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.490 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.490 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.472 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.472 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.012 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.012 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:192.616 - response_length/max:480.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.008 - prompt_length/max:771.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.421 - timing_s/old_log_prob:5.444 - timing_s/ref:5.828 - timing_s/adv:0.299 - timing_s/update_actor:34.201 - timing_s/testing:128.671 - timing_s/save_checkpoint:25.192 - timing_s/step:217.083 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:393695.000 - perf/time_per_step:217.083 - perf/throughput:226.696
[36m(WorkerDict pid=1932622)[0m [rank-6]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932622)[0m [rank-6]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1923599)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [1:07:16<2:30:20, 110.00s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [1:08:19<2:09:25, 95.87s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [1:09:25<1:55:45, 86.82s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 53/132 [1:10:27<1:44:52, 79.65s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 54/132 [1:11:32<1:37:50, 75.27s/it]
[36m(WorkerDict pid=1932622)[0m [rank-6]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_6.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:51 - global_seqlen/min:45926.000 - global_seqlen/max:50920.000 - global_seqlen/minmax_diff:4994.000 - global_seqlen/balanced_min:48512.000 - global_seqlen/balanced_max:48513.000 - global_seqlen/mean:48512.625 - actor/entropy_loss:0.605 - actor/kl_loss:0.112 - actor/kl_coef:0.001 - actor/pg_loss:0.153 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.785 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:51.178 - actor/lr:0.000 - critic/score/mean:1.435 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.435 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:197.277 - response_length/max:472.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.188 - timing_s/old_log_prob:5.414 - timing_s/ref:5.823 - timing_s/adv:0.288 - timing_s/update_actor:34.114 - timing_s/step:62.858 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388101.000 - perf/time_per_step:62.858 - perf/throughput:771.781
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:52 - global_seqlen/min:46367.000 - global_seqlen/max:54420.000 - global_seqlen/minmax_diff:8053.000 - global_seqlen/balanced_min:50219.000 - global_seqlen/balanced_max:50220.000 - global_seqlen/mean:50219.625 - actor/entropy_loss:0.614 - actor/kl_loss:0.108 - actor/kl_coef:0.001 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.781 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.713 - actor/lr:0.000 - critic/score/mean:1.495 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.495 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:199.957 - response_length/max:576.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.164 - prompt_length/max:578.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.129 - timing_s/old_log_prob:5.500 - timing_s/ref:5.891 - timing_s/adv:0.296 - timing_s/update_actor:34.835 - timing_s/step:65.672 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:401757.000 - perf/time_per_step:65.672 - perf/throughput:764.701
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:53 - global_seqlen/min:46119.000 - global_seqlen/max:54362.000 - global_seqlen/minmax_diff:8243.000 - global_seqlen/balanced_min:49019.000 - global_seqlen/balanced_max:49020.000 - global_seqlen/mean:49019.375 - actor/entropy_loss:0.578 - actor/kl_loss:0.118 - actor/kl_coef:0.001 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.820 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.761 - actor/lr:0.000 - critic/score/mean:1.526 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.526 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:201.704 - response_length/max:473.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.914 - prompt_length/max:542.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.362 - timing_s/old_log_prob:5.374 - timing_s/ref:5.779 - timing_s/adv:0.289 - timing_s/update_actor:34.072 - timing_s/step:62.905 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:392155.000 - perf/time_per_step:62.905 - perf/throughput:779.264
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:54 - global_seqlen/min:45757.000 - global_seqlen/max:54978.000 - global_seqlen/minmax_diff:9221.000 - global_seqlen/balanced_min:50174.000 - global_seqlen/balanced_max:50174.000 - global_seqlen/mean:50174.000 - actor/entropy_loss:0.590 - actor/kl_loss:0.103 - actor/kl_coef:0.001 - actor/pg_loss:0.198 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.771 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.663 - actor/lr:0.000 - critic/score/mean:1.507 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.507 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.786 - response_length/max:492.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.859 - prompt_length/max:563.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.140 - timing_s/old_log_prob:5.568 - timing_s/ref:5.965 - timing_s/adv:0.293 - timing_s/update_actor:35.035 - timing_s/step:65.021 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:401392.000 - perf/time_per_step:65.021 - perf/throughput:771.655
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 55/132 [1:12:38<1:32:51, 72.35s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [1:13:43<1:28:39, 69.99s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/132 [1:14:49<1:26:07, 68.90s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 58/132 [1:15:53<1:23:22, 67.60s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 59/132 [1:16:58<1:20:57, 66.54s/it]
[36m(TaskRunner pid=1923599)[0m step:55 - global_seqlen/min:48213.000 - global_seqlen/max:52009.000 - global_seqlen/minmax_diff:3796.000 - global_seqlen/balanced_min:50307.000 - global_seqlen/balanced_max:50307.000 - global_seqlen/mean:50307.000 - actor/entropy_loss:0.613 - actor/kl_loss:0.122 - actor/kl_coef:0.001 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.705 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.794 - actor/lr:0.000 - critic/score/mean:1.529 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.529 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.367 - response_length/max:521.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.664 - prompt_length/max:615.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.342 - timing_s/old_log_prob:5.562 - timing_s/ref:5.930 - timing_s/adv:0.296 - timing_s/update_actor:35.376 - timing_s/step:65.531 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:402456.000 - perf/time_per_step:65.531 - perf/throughput:767.683
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:56 - global_seqlen/min:45326.000 - global_seqlen/max:52983.000 - global_seqlen/minmax_diff:7657.000 - global_seqlen/balanced_min:49220.000 - global_seqlen/balanced_max:49221.000 - global_seqlen/mean:49220.125 - actor/entropy_loss:0.600 - actor/kl_loss:0.101 - actor/kl_coef:0.001 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.678 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.730 - actor/lr:0.000 - critic/score/mean:1.459 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.459 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:211.389 - response_length/max:511.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.320 - prompt_length/max:679.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.335 - timing_s/old_log_prob:5.505 - timing_s/ref:5.896 - timing_s/adv:0.300 - timing_s/update_actor:34.412 - timing_s/step:64.467 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:393761.000 - perf/time_per_step:64.467 - perf/throughput:763.488
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:57 - global_seqlen/min:48417.000 - global_seqlen/max:52324.000 - global_seqlen/minmax_diff:3907.000 - global_seqlen/balanced_min:50771.000 - global_seqlen/balanced_max:50772.000 - global_seqlen/mean:50771.750 - actor/entropy_loss:0.582 - actor/kl_loss:0.110 - actor/kl_coef:0.001 - actor/pg_loss:0.129 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.808 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.802 - actor/lr:0.000 - critic/score/mean:1.507 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.507 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.529 - response_length/max:581.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.344 - prompt_length/max:685.000 - prompt_length/min:234.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.173 - timing_s/old_log_prob:5.617 - timing_s/ref:5.901 - timing_s/adv:0.295 - timing_s/update_actor:35.333 - timing_s/step:66.345 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:406174.000 - perf/time_per_step:66.345 - perf/throughput:765.270
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:58 - global_seqlen/min:47974.000 - global_seqlen/max:53953.000 - global_seqlen/minmax_diff:5979.000 - global_seqlen/balanced_min:51143.000 - global_seqlen/balanced_max:51144.000 - global_seqlen/mean:51143.250 - actor/entropy_loss:0.590 - actor/kl_loss:0.112 - actor/kl_coef:0.001 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.682 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.848 - actor/lr:0.000 - critic/score/mean:1.491 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.491 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:222.430 - response_length/max:475.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.312 - prompt_length/max:540.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.897 - timing_s/old_log_prob:5.571 - timing_s/ref:5.883 - timing_s/adv:0.297 - timing_s/update_actor:34.830 - timing_s/step:64.498 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:409146.000 - perf/time_per_step:64.498 - perf/throughput:792.947
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:59 - global_seqlen/min:46444.000 - global_seqlen/max:52678.000 - global_seqlen/minmax_diff:6234.000 - global_seqlen/balanced_min:50074.000 - global_seqlen/balanced_max:50075.000 - global_seqlen/mean:50074.625 - actor/entropy_loss:0.577 - actor/kl_loss:0.104 - actor/kl_coef:0.001 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.809 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.947 - actor/lr:0.000 - critic/score/mean:1.500 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.500 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:216.072 - response_length/max:464.000 - response_length/min:54.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.539 - prompt_length/max:585.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.643 - timing_s/old_log_prob:5.483 - timing_s/ref:5.835 - timing_s/adv:0.295 - timing_s/update_actor:34.754 - timing_s/step:64.038 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:400597.000 - perf/time_per_step:64.038 - perf/throughput:781.951
[36m(TaskRunner pid=1923599)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [1:20:16<2:07:19, 106.10s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/132 [1:21:22<1:51:25, 94.16s/it] 
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®åˆ‘æ³•è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ä¸ºç›®çš„ï¼Œè€Œä¹™æŸä»¥ä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ä¸ºç›®çš„ï¼Œä¸¤äººå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„çŠ¯ç½ªæ•…æ„æ˜¯å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„çŠ¯ç½ªæ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚è™½ç„¶ä¸¤äººçš„çŠ¯ç½ªæ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯å…±åŒçš„ã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ ¹æ®åˆ‘æ³•ï¼Œå¯¹ç”²æŸåº”ä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥é€‰é¡¹Bã€Cã€Dæ˜¯æ­£ç¡®çš„ï¼Œè€Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:60 - global_seqlen/min:48763.000 - global_seqlen/max:55890.000 - global_seqlen/minmax_diff:7127.000 - global_seqlen/balanced_min:52591.000 - global_seqlen/balanced_max:52592.000 - global_seqlen/mean:52591.250 - actor/entropy_loss:0.546 - actor/kl_loss:0.094 - actor/kl_coef:0.001 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.682 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:50.745 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.523 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.523 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.523 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.466 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.466 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:231.029 - response_length/max:591.000 - response_length/min:54.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.797 - prompt_length/max:604.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.687 - timing_s/old_log_prob:5.857 - timing_s/ref:6.217 - timing_s/adv:0.302 - timing_s/update_actor:36.095 - timing_s/testing:130.215 - timing_s/step:198.399 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:420730.000 - perf/time_per_step:198.399 - perf/throughput:265.078
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:61 - global_seqlen/min:47190.000 - global_seqlen/max:52185.000 - global_seqlen/minmax_diff:4995.000 - global_seqlen/balanced_min:50410.000 - global_seqlen/balanced_max:50411.000 - global_seqlen/mean:50410.250 - actor/entropy_loss:0.542 - actor/kl_loss:0.129 - actor/kl_coef:0.001 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.663 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:51.140 - actor/lr:0.000 - critic/score/mean:1.572 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.572 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:221.122 - response_length/max:647.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.984 - prompt_length/max:576.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.216 - timing_s/old_log_prob:5.474 - timing_s/ref:5.832 - timing_s/adv:0.289 - timing_s/update_actor:34.423 - timing_s/step:66.268 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:403282.000 - perf/time_per_step:66.268 - perf/throughput:760.697
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 62/132 [1:22:29<1:40:15, 85.93s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 63/132 [1:23:36<1:32:14, 80.21s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [1:24:46<1:27:33, 77.26s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/132 [1:25:55<1:23:19, 74.62s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 66/132 [1:27:01<1:19:16, 72.07s/it]
[36m(TaskRunner pid=1923599)[0m step:62 - global_seqlen/min:48133.000 - global_seqlen/max:56450.000 - global_seqlen/minmax_diff:8317.000 - global_seqlen/balanced_min:51349.000 - global_seqlen/balanced_max:51350.000 - global_seqlen/mean:51349.125 - actor/entropy_loss:0.562 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:-0.101 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.737 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:51.219 - actor/lr:0.000 - critic/score/mean:1.517 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.517 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:220.777 - response_length/max:533.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.109 - prompt_length/max:640.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.663 - timing_s/old_log_prob:5.641 - timing_s/ref:5.932 - timing_s/adv:0.301 - timing_s/update_actor:36.151 - timing_s/step:66.708 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:410793.000 - perf/time_per_step:66.708 - perf/throughput:769.759
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:63 - global_seqlen/min:46377.000 - global_seqlen/max:54532.000 - global_seqlen/minmax_diff:8155.000 - global_seqlen/balanced_min:51705.000 - global_seqlen/balanced_max:51706.000 - global_seqlen/mean:51705.500 - actor/entropy_loss:0.558 - actor/kl_loss:0.105 - actor/kl_coef:0.001 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.780 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.766 - perf/cpu_memory_used_gb:51.544 - actor/lr:0.000 - critic/score/mean:1.507 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.507 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:224.849 - response_length/max:493.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.750 - prompt_length/max:820.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.558 - timing_s/old_log_prob:5.775 - timing_s/ref:6.072 - timing_s/adv:0.304 - timing_s/update_actor:36.105 - timing_s/step:66.838 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:413644.000 - perf/time_per_step:66.838 - perf/throughput:773.591
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:64 - global_seqlen/min:48459.000 - global_seqlen/max:57555.000 - global_seqlen/minmax_diff:9096.000 - global_seqlen/balanced_min:51705.000 - global_seqlen/balanced_max:51705.000 - global_seqlen/mean:51705.000 - actor/entropy_loss:0.562 - actor/kl_loss:0.120 - actor/kl_coef:0.001 - actor/pg_loss:-0.024 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.691 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.340 - actor/lr:0.000 - critic/score/mean:1.518 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.518 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:226.477 - response_length/max:761.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.117 - prompt_length/max:518.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.552 - timing_s/old_log_prob:5.782 - timing_s/ref:6.095 - timing_s/adv:0.304 - timing_s/update_actor:35.601 - timing_s/step:70.361 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:413640.000 - perf/time_per_step:70.361 - perf/throughput:734.848
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:65 - global_seqlen/min:48574.000 - global_seqlen/max:53980.000 - global_seqlen/minmax_diff:5406.000 - global_seqlen/balanced_min:51167.000 - global_seqlen/balanced_max:51168.000 - global_seqlen/mean:51167.375 - actor/entropy_loss:0.526 - actor/kl_loss:0.117 - actor/kl_coef:0.001 - actor/pg_loss:0.058 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.714 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.474 - actor/lr:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:224.697 - response_length/max:670.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.297 - prompt_length/max:492.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.072 - timing_s/old_log_prob:5.653 - timing_s/ref:5.975 - timing_s/adv:0.301 - timing_s/update_actor:35.434 - timing_s/step:68.456 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:409339.000 - perf/time_per_step:68.456 - perf/throughput:747.449
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:66 - global_seqlen/min:46359.000 - global_seqlen/max:53683.000 - global_seqlen/minmax_diff:7324.000 - global_seqlen/balanced_min:50666.000 - global_seqlen/balanced_max:50667.000 - global_seqlen/mean:50666.250 - actor/entropy_loss:0.522 - actor/kl_loss:0.113 - actor/kl_coef:0.001 - actor/pg_loss:-0.093 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.743 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.401 - actor/lr:0.000 - critic/score/mean:1.536 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.536 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:220.742 - response_length/max:561.000 - response_length/min:42.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.031 - prompt_length/max:609.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.946 - timing_s/old_log_prob:5.581 - timing_s/ref:5.943 - timing_s/adv:0.296 - timing_s/update_actor:35.302 - timing_s/step:66.093 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:405330.000 - perf/time_per_step:66.093 - perf/throughput:766.590
[36m(TaskRunner pid=1923599)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 67/132 [1:28:07<1:16:19, 70.45s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [1:29:19<1:15:20, 70.64s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/132 [1:30:25<1:12:46, 69.30s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:67 - global_seqlen/min:46908.000 - global_seqlen/max:53248.000 - global_seqlen/minmax_diff:6340.000 - global_seqlen/balanced_min:49950.000 - global_seqlen/balanced_max:49951.000 - global_seqlen/mean:49950.250 - actor/entropy_loss:0.498 - actor/kl_loss:0.116 - actor/kl_coef:0.001 - actor/pg_loss:0.067 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.674 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.522 - actor/lr:0.000 - critic/score/mean:1.530 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.530 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.010 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.010 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:211.643 - response_length/max:570.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.672 - prompt_length/max:576.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.217 - timing_s/old_log_prob:5.549 - timing_s/ref:5.944 - timing_s/adv:0.292 - timing_s/update_actor:35.104 - timing_s/step:66.144 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:399602.000 - perf/time_per_step:66.144 - perf/throughput:755.173
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:68 - global_seqlen/min:47481.000 - global_seqlen/max:51735.000 - global_seqlen/minmax_diff:4254.000 - global_seqlen/balanced_min:49668.000 - global_seqlen/balanced_max:49832.000 - global_seqlen/mean:49688.625 - actor/entropy_loss:0.504 - actor/kl_loss:0.124 - actor/kl_coef:0.001 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.686 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.357 - actor/lr:0.000 - critic/score/mean:1.505 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.505 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.005 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:218.934 - response_length/max:938.000 - response_length/min:78.000 - response_length/clip_ratio:0.000 - prompt_length/mean:298.656 - prompt_length/max:433.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.543 - timing_s/old_log_prob:5.556 - timing_s/ref:5.928 - timing_s/adv:0.290 - timing_s/update_actor:34.701 - timing_s/step:71.041 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.146 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:397509.000 - perf/time_per_step:71.041 - perf/throughput:699.438
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:69 - global_seqlen/min:48709.000 - global_seqlen/max:54485.000 - global_seqlen/minmax_diff:5776.000 - global_seqlen/balanced_min:50722.000 - global_seqlen/balanced_max:50723.000 - global_seqlen/mean:50722.125 - actor/entropy_loss:0.517 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:-0.032 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.747 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.375 - actor/lr:0.000 - critic/score/mean:1.552 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.552 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.184 - response_length/max:528.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.172 - prompt_length/max:614.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.006 - timing_s/old_log_prob:5.646 - timing_s/ref:5.972 - timing_s/adv:0.290 - timing_s/update_actor:35.230 - timing_s/step:66.173 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:405777.000 - perf/time_per_step:66.173 - perf/throughput:766.504
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„ç›¸å…³è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†æ˜¯ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å­˜åœ¨å…±åŒçŠ¯ç½ªçš„æ•…æ„å’Œè¡Œä¸ºï¼Œå› æ­¤å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œåº”å½“æŒ‰ç…§é—´è°ç½ªè¿›è¡Œå®šç½ªå¤„ç½šï¼Œé€‰é¡¹Cæ­£ç¡®ã€‚å¯¹äºä¹™æŸï¼Œåº”å½“æŒ‰ç…§éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè¿›è¡Œå®šç½ªå¤„ç½šï¼Œé€‰é¡¹Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/132 [1:33:41<1:50:50, 107.27s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 71/132 [1:34:54<1:38:52, 97.26s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [1:36:02<1:28:24, 88.41s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 73/132 [1:37:16<1:22:37, 84.02s/it]
[36m(TaskRunner pid=1923599)[0m step:70 - global_seqlen/min:47326.000 - global_seqlen/max:52266.000 - global_seqlen/minmax_diff:4940.000 - global_seqlen/balanced_min:50428.000 - global_seqlen/balanced_max:50428.000 - global_seqlen/mean:50428.000 - actor/entropy_loss:0.494 - actor/kl_loss:0.131 - actor/kl_coef:0.001 - actor/pg_loss:-0.073 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.738 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.338 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.538 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.538 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.538 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.538 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.538 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.538 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.517 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.517 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:216.089 - response_length/max:528.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.203 - prompt_length/max:542.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.519 - timing_s/old_log_prob:5.631 - timing_s/ref:5.980 - timing_s/adv:0.289 - timing_s/update_actor:35.314 - timing_s/testing:130.076 - timing_s/step:195.830 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:403424.000 - perf/time_per_step:195.830 - perf/throughput:257.508
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:71 - global_seqlen/min:47120.000 - global_seqlen/max:54028.000 - global_seqlen/minmax_diff:6908.000 - global_seqlen/balanced_min:51240.000 - global_seqlen/balanced_max:51240.000 - global_seqlen/mean:51240.000 - actor/entropy_loss:0.486 - actor/kl_loss:0.115 - actor/kl_coef:0.001 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.000 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.561 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.448 - actor/lr:0.000 - critic/score/mean:1.600 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.600 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.013 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.013 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:221.469 - response_length/max:1024.000 - response_length/min:59.000 - response_length/clip_ratio:0.001 - prompt_length/mean:312.281 - prompt_length/max:771.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.945 - timing_s/old_log_prob:5.693 - timing_s/ref:5.986 - timing_s/adv:0.311 - timing_s/update_actor:35.918 - timing_s/step:73.882 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:409920.000 - perf/time_per_step:73.882 - perf/throughput:693.537
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:72 - global_seqlen/min:48786.000 - global_seqlen/max:53924.000 - global_seqlen/minmax_diff:5138.000 - global_seqlen/balanced_min:50998.000 - global_seqlen/balanced_max:50999.000 - global_seqlen/mean:50998.250 - actor/entropy_loss:0.506 - actor/kl_loss:0.139 - actor/kl_coef:0.001 - actor/pg_loss:0.057 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.641 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.035 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:220.490 - response_length/max:651.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.742 - prompt_length/max:480.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.586 - timing_s/old_log_prob:5.572 - timing_s/ref:5.942 - timing_s/adv:0.296 - timing_s/update_actor:35.334 - timing_s/step:67.752 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:407986.000 - perf/time_per_step:67.752 - perf/throughput:752.724
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:73 - global_seqlen/min:49984.000 - global_seqlen/max:53335.000 - global_seqlen/minmax_diff:3351.000 - global_seqlen/balanced_min:51533.000 - global_seqlen/balanced_max:51629.000 - global_seqlen/mean:51545.125 - actor/entropy_loss:0.529 - actor/kl_loss:0.111 - actor/kl_coef:0.001 - actor/pg_loss:0.092 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.766 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.114 - actor/lr:0.000 - critic/score/mean:1.589 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.589 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.020 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.020 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:225.647 - response_length/max:1024.000 - response_length/min:77.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.281 - prompt_length/max:534.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.256 - timing_s/old_log_prob:5.701 - timing_s/ref:5.925 - timing_s/adv:0.293 - timing_s/update_actor:35.542 - timing_s/step:73.737 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:412361.000 - perf/time_per_step:73.737 - perf/throughput:699.040
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 74/132 [1:38:24<1:16:35, 79.23s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 75/132 [1:39:32<1:12:03, 75.85s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [1:40:42<1:09:12, 74.15s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/132 [1:41:52<1:06:40, 72.74s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 78/132 [1:42:59<1:03:52, 70.98s/it]
[36m(TaskRunner pid=1923599)[0m step:74 - global_seqlen/min:49685.000 - global_seqlen/max:53948.000 - global_seqlen/minmax_diff:4263.000 - global_seqlen/balanced_min:51432.000 - global_seqlen/balanced_max:51432.000 - global_seqlen/mean:51432.000 - actor/entropy_loss:0.487 - actor/kl_loss:0.157 - actor/kl_coef:0.001 - actor/pg_loss:-0.040 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.561 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.140 - actor/lr:0.000 - critic/score/mean:1.495 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.495 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:227.133 - response_length/max:605.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.617 - prompt_length/max:563.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.039 - timing_s/old_log_prob:5.678 - timing_s/ref:6.027 - timing_s/adv:0.293 - timing_s/update_actor:35.980 - timing_s/step:68.041 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:411456.000 - perf/time_per_step:68.041 - perf/throughput:755.894
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:75 - global_seqlen/min:46991.000 - global_seqlen/max:54749.000 - global_seqlen/minmax_diff:7758.000 - global_seqlen/balanced_min:51291.000 - global_seqlen/balanced_max:51292.000 - global_seqlen/mean:51291.125 - actor/entropy_loss:0.501 - actor/kl_loss:0.124 - actor/kl_coef:0.001 - actor/pg_loss:0.098 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.635 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:50.979 - actor/lr:0.000 - critic/score/mean:1.582 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.582 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:221.462 - response_length/max:668.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.820 - prompt_length/max:679.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.159 - timing_s/old_log_prob:5.674 - timing_s/ref:6.019 - timing_s/adv:0.296 - timing_s/update_actor:34.766 - timing_s/step:67.934 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:410329.000 - perf/time_per_step:67.934 - perf/throughput:755.017
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:76 - global_seqlen/min:50431.000 - global_seqlen/max:54285.000 - global_seqlen/minmax_diff:3854.000 - global_seqlen/balanced_min:52374.000 - global_seqlen/balanced_max:52375.000 - global_seqlen/mean:52374.500 - actor/entropy_loss:0.493 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.705 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:50.930 - actor/lr:0.000 - critic/score/mean:1.477 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.477 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:228.576 - response_length/max:721.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.992 - prompt_length/max:585.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.925 - timing_s/old_log_prob:5.812 - timing_s/ref:6.128 - timing_s/adv:0.300 - timing_s/update_actor:35.959 - timing_s/step:70.145 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:418996.000 - perf/time_per_step:70.145 - perf/throughput:746.661
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:77 - global_seqlen/min:46458.000 - global_seqlen/max:53062.000 - global_seqlen/minmax_diff:6604.000 - global_seqlen/balanced_min:50634.000 - global_seqlen/balanced_max:50635.000 - global_seqlen/mean:50634.500 - actor/entropy_loss:0.471 - actor/kl_loss:0.114 - actor/kl_coef:0.001 - actor/pg_loss:-0.069 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.635 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:51.103 - actor/lr:0.000 - critic/score/mean:1.557 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.557 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:222.044 - response_length/max:693.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.398 - prompt_length/max:532.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.289 - timing_s/old_log_prob:5.644 - timing_s/ref:5.977 - timing_s/adv:0.292 - timing_s/update_actor:36.208 - timing_s/step:69.435 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:405076.000 - perf/time_per_step:69.435 - perf/throughput:729.241
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:78 - global_seqlen/min:49935.000 - global_seqlen/max:54979.000 - global_seqlen/minmax_diff:5044.000 - global_seqlen/balanced_min:51601.000 - global_seqlen/balanced_max:51602.000 - global_seqlen/mean:51601.750 - actor/entropy_loss:0.485 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.754 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.777 - perf/cpu_memory_used_gb:50.978 - actor/lr:0.000 - critic/score/mean:1.606 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.606 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:226.182 - response_length/max:569.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.336 - prompt_length/max:546.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.227 - timing_s/old_log_prob:5.729 - timing_s/ref:6.028 - timing_s/adv:0.295 - timing_s/update_actor:35.542 - timing_s/step:66.840 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:412814.000 - perf/time_per_step:66.840 - perf/throughput:772.015
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 79/132 [1:44:08<1:02:26, 70.68s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [1:47:32<1:35:50, 110.59s/it]
[36m(TaskRunner pid=1923599)[0m step:79 - global_seqlen/min:47506.000 - global_seqlen/max:55722.000 - global_seqlen/minmax_diff:8216.000 - global_seqlen/balanced_min:52280.000 - global_seqlen/balanced_max:52281.000 - global_seqlen/mean:52280.750 - actor/entropy_loss:0.473 - actor/kl_loss:0.143 - actor/kl_coef:0.001 - actor/pg_loss:0.049 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.654 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:50.903 - actor/lr:0.000 - critic/score/mean:1.562 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.562 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:235.419 - response_length/max:675.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.172 - prompt_length/max:495.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.357 - timing_s/old_log_prob:5.738 - timing_s/ref:6.077 - timing_s/adv:0.297 - timing_s/update_actor:36.484 - timing_s/step:69.974 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:418246.000 - perf/time_per_step:69.974 - perf/throughput:747.146
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„ç›¸å…³è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œè€Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†æ˜¯ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…å­˜åœ¨å…±åŒçŠ¯ç½ªçš„æ•…æ„å’Œè¡Œä¸ºï¼Œå› æ­¤å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œåº”å½“æŒ‰ç…§é—´è°ç½ªè¿›è¡Œå®šç½ªå¤„ç½šï¼Œé€‰é¡¹Cæ­£ç¡®ã€‚å¯¹äºä¹™æŸï¼Œåº”å½“æŒ‰ç…§éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè¿›è¡Œå®šç½ªå¤„ç½šï¼Œé€‰é¡¹Dæ­£ç¡®ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:80 - global_seqlen/min:48862.000 - global_seqlen/max:55227.000 - global_seqlen/minmax_diff:6365.000 - global_seqlen/balanced_min:52933.000 - global_seqlen/balanced_max:52934.000 - global_seqlen/mean:52933.500 - actor/entropy_loss:0.512 - actor/kl_loss:0.146 - actor/kl_coef:0.001 - actor/pg_loss:-0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.630 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.131 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.545 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.545 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.545 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.545 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.545 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.545 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.559 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.559 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:234.555 - response_length/max:792.000 - response_length/min:87.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.836 - prompt_length/max:561.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.987 - timing_s/old_log_prob:5.922 - timing_s/ref:6.234 - timing_s/adv:0.298 - timing_s/update_actor:36.940 - timing_s/testing:131.291 - timing_s/step:203.700 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:423468.000 - perf/time_per_step:203.700 - perf/throughput:259.861
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 81/132 [1:48:46<1:24:40, 99.61s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/132 [1:49:57<1:15:41, 90.83s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/132 [1:51:12<1:10:18, 86.09s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 84/132 [1:52:25<1:05:52, 82.34s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/132 [1:53:41<1:02:52, 80.27s/it]
[36m(TaskRunner pid=1923599)[0m step:81 - global_seqlen/min:50752.000 - global_seqlen/max:55475.000 - global_seqlen/minmax_diff:4723.000 - global_seqlen/balanced_min:52895.000 - global_seqlen/balanced_max:53014.000 - global_seqlen/mean:52910.500 - actor/entropy_loss:0.500 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.112 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.764 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.145 - actor/lr:0.000 - critic/score/mean:1.535 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.535 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.964 - response_length/max:1024.000 - response_length/min:87.000 - response_length/clip_ratio:0.001 - prompt_length/mean:312.188 - prompt_length/max:566.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.149 - timing_s/old_log_prob:5.772 - timing_s/ref:6.103 - timing_s/adv:0.300 - timing_s/update_actor:35.608 - timing_s/step:73.963 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:423284.000 - perf/time_per_step:73.963 - perf/throughput:715.363
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:82 - global_seqlen/min:47678.000 - global_seqlen/max:54626.000 - global_seqlen/minmax_diff:6948.000 - global_seqlen/balanced_min:52317.000 - global_seqlen/balanced_max:52318.000 - global_seqlen/mean:52317.125 - actor/entropy_loss:0.489 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.065 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.596 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.000 - actor/lr:0.000 - critic/score/mean:1.541 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.541 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.962 - response_length/max:698.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.008 - prompt_length/max:505.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.261 - timing_s/old_log_prob:5.765 - timing_s/ref:6.110 - timing_s/adv:0.307 - timing_s/update_actor:36.848 - timing_s/step:70.318 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:418537.000 - perf/time_per_step:70.318 - perf/throughput:744.011
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:83 - global_seqlen/min:50873.000 - global_seqlen/max:54999.000 - global_seqlen/minmax_diff:4126.000 - global_seqlen/balanced_min:52647.000 - global_seqlen/balanced_max:52841.000 - global_seqlen/mean:52671.500 - actor/entropy_loss:0.512 - actor/kl_loss:0.140 - actor/kl_coef:0.001 - actor/pg_loss:0.106 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.598 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.056 - actor/lr:0.000 - critic/score/mean:1.609 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.609 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:238.849 - response_length/max:1024.000 - response_length/min:55.000 - response_length/clip_ratio:0.001 - prompt_length/mean:309.812 - prompt_length/max:551.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.687 - timing_s/old_log_prob:5.766 - timing_s/ref:6.101 - timing_s/adv:0.303 - timing_s/update_actor:36.127 - timing_s/step:75.003 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:421372.000 - perf/time_per_step:75.003 - perf/throughput:702.262
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:84 - global_seqlen/min:50502.000 - global_seqlen/max:57179.000 - global_seqlen/minmax_diff:6677.000 - global_seqlen/balanced_min:53687.000 - global_seqlen/balanced_max:53730.000 - global_seqlen/mean:53692.500 - actor/entropy_loss:0.495 - actor/kl_loss:0.151 - actor/kl_coef:0.001 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.694 - perf/mfu/actor:0.387 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.198 - actor/lr:0.000 - critic/score/mean:1.596 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.596 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.867 - response_length/max:946.000 - response_length/min:77.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.430 - prompt_length/max:502.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.497 - timing_s/old_log_prob:5.912 - timing_s/ref:6.188 - timing_s/adv:0.306 - timing_s/update_actor:35.625 - timing_s/step:73.553 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.136 - timing_per_token_ms/update_actor:0.083 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:429540.000 - perf/time_per_step:73.553 - perf/throughput:729.987
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:85 - global_seqlen/min:48808.000 - global_seqlen/max:56147.000 - global_seqlen/minmax_diff:7339.000 - global_seqlen/balanced_min:52947.000 - global_seqlen/balanced_max:53180.000 - global_seqlen/mean:52976.125 - actor/entropy_loss:0.495 - actor/kl_loss:0.149 - actor/kl_coef:0.001 - actor/pg_loss:0.183 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.731 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.173 - actor/lr:0.000 - critic/score/mean:1.586 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.586 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:240.046 - response_length/max:1024.000 - response_length/min:70.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.789 - prompt_length/max:630.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.531 - timing_s/old_log_prob:5.810 - timing_s/ref:6.132 - timing_s/adv:0.306 - timing_s/update_actor:36.620 - timing_s/step:75.423 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:423809.000 - perf/time_per_step:75.423 - perf/throughput:702.383
[36m(TaskRunner pid=1923599)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 86/132 [1:54:58<1:00:52, 79.40s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 87/132 [1:56:14<58:43, 78.30s/it]  
[36m(TaskRunner pid=1923599)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [1:57:25<55:57, 76.30s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/132 [1:58:39<54:11, 75.61s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:86 - global_seqlen/min:52385.000 - global_seqlen/max:58565.000 - global_seqlen/minmax_diff:6180.000 - global_seqlen/balanced_min:55602.000 - global_seqlen/balanced_max:55690.000 - global_seqlen/mean:55613.750 - actor/entropy_loss:0.520 - actor/kl_loss:0.144 - actor/kl_coef:0.001 - actor/pg_loss:-0.113 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.619 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.257 - actor/lr:0.000 - critic/score/mean:1.517 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.517 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:252.591 - response_length/max:999.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:326.719 - prompt_length/max:615.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.615 - timing_s/old_log_prob:6.141 - timing_s/ref:6.354 - timing_s/adv:0.316 - timing_s/update_actor:37.908 - timing_s/step:77.353 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:444910.000 - perf/time_per_step:77.353 - perf/throughput:718.963
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:87 - global_seqlen/min:50514.000 - global_seqlen/max:56013.000 - global_seqlen/minmax_diff:5499.000 - global_seqlen/balanced_min:53885.000 - global_seqlen/balanced_max:53895.000 - global_seqlen/mean:53887.000 - actor/entropy_loss:0.521 - actor/kl_loss:0.141 - actor/kl_coef:0.001 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.713 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.302 - actor/lr:0.000 - critic/score/mean:1.514 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.514 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:243.260 - response_length/max:1024.000 - response_length/min:74.000 - response_length/clip_ratio:0.001 - prompt_length/mean:318.062 - prompt_length/max:522.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.715 - timing_s/old_log_prob:5.915 - timing_s/ref:6.126 - timing_s/adv:0.299 - timing_s/update_actor:36.627 - timing_s/step:75.712 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:431096.000 - perf/time_per_step:75.712 - perf/throughput:711.734
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:88 - global_seqlen/min:50615.000 - global_seqlen/max:55506.000 - global_seqlen/minmax_diff:4891.000 - global_seqlen/balanced_min:53258.000 - global_seqlen/balanced_max:53272.000 - global_seqlen/mean:53259.875 - actor/entropy_loss:0.493 - actor/kl_loss:0.153 - actor/kl_coef:0.001 - actor/pg_loss:0.072 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.643 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.358 - actor/lr:0.000 - critic/score/mean:1.598 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.598 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:242.759 - response_length/max:808.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.031 - prompt_length/max:593.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.359 - timing_s/old_log_prob:5.852 - timing_s/ref:6.104 - timing_s/adv:0.315 - timing_s/update_actor:35.959 - timing_s/step:71.608 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:426079.000 - perf/time_per_step:71.608 - perf/throughput:743.768
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:89 - global_seqlen/min:49036.000 - global_seqlen/max:55475.000 - global_seqlen/minmax_diff:6439.000 - global_seqlen/balanced_min:52129.000 - global_seqlen/balanced_max:52323.000 - global_seqlen/mean:52153.250 - actor/entropy_loss:0.478 - actor/kl_loss:0.123 - actor/kl_coef:0.001 - actor/pg_loss:0.135 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.624 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.354 - actor/lr:0.000 - critic/score/mean:1.602 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.602 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:237.286 - response_length/max:1024.000 - response_length/min:62.000 - response_length/clip_ratio:0.001 - prompt_length/mean:305.977 - prompt_length/max:529.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.500 - timing_s/old_log_prob:5.728 - timing_s/ref:5.987 - timing_s/adv:0.302 - timing_s/update_actor:35.431 - timing_s/step:73.973 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.145 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:417226.000 - perf/time_per_step:73.973 - perf/throughput:705.027
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 90/132 [2:02:06<1:20:24, 114.88s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 91/132 [2:03:13<1:08:43, 100.56s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [2:04:26<1:01:32, 92.30s/it] 
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠå›½å®¶ç§˜å¯†çš„è·å–ã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™æŸä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚æ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººæ‰€çŠ¯çš„ç½ªåä¸åŒï¼Œåº”å½“æŒ‰ç…§ä»–ä»¬å„è‡ªæ‰€çŠ¯çš„ç½ªååˆ†åˆ«å®šç½ªå¤„ç½šã€‚å› æ­¤ï¼Œç”²æŸçš„è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªï¼Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Bã€Cã€Dæ˜¯æ­£ç¡®çš„ï¼Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:90 - global_seqlen/min:48910.000 - global_seqlen/max:57157.000 - global_seqlen/minmax_diff:8247.000 - global_seqlen/balanced_min:52684.000 - global_seqlen/balanced_max:52812.000 - global_seqlen/mean:52708.375 - actor/entropy_loss:0.453 - actor/kl_loss:0.146 - actor/kl_coef:0.001 - actor/pg_loss:0.066 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.555 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.473 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.551 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.551 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.551 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.551 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.551 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.551 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.598 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.598 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:231.655 - response_length/max:1024.000 - response_length/min:66.000 - response_length/clip_ratio:0.001 - prompt_length/mean:317.391 - prompt_length/max:647.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.404 - timing_s/old_log_prob:5.808 - timing_s/ref:6.128 - timing_s/adv:0.311 - timing_s/update_actor:36.782 - timing_s/testing:131.029 - timing_s/step:206.484 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.148 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:421667.000 - perf/time_per_step:206.484 - perf/throughput:255.266
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:91 - global_seqlen/min:45081.000 - global_seqlen/max:57549.000 - global_seqlen/minmax_diff:12468.000 - global_seqlen/balanced_min:51280.000 - global_seqlen/balanced_max:51281.000 - global_seqlen/mean:51280.250 - actor/entropy_loss:0.448 - actor/kl_loss:0.172 - actor/kl_coef:0.001 - actor/pg_loss:-0.075 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.549 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.431 - actor/lr:0.000 - critic/score/mean:1.575 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.575 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:230.154 - response_length/max:590.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:536.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.611 - timing_s/old_log_prob:5.658 - timing_s/ref:6.013 - timing_s/adv:0.295 - timing_s/update_actor:35.521 - timing_s/step:67.132 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:410242.000 - perf/time_per_step:67.132 - perf/throughput:763.866
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:92 - global_seqlen/min:48384.000 - global_seqlen/max:55003.000 - global_seqlen/minmax_diff:6619.000 - global_seqlen/balanced_min:52325.000 - global_seqlen/balanced_max:52326.000 - global_seqlen/mean:52325.625 - actor/entropy_loss:0.455 - actor/kl_loss:0.151 - actor/kl_coef:0.001 - actor/pg_loss:-0.007 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.541 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.541 - actor/lr:0.000 - critic/score/mean:1.527 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.527 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.021 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.021 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:225.059 - response_length/max:942.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.000 - prompt_length/max:798.000 - prompt_length/min:236.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.697 - timing_s/old_log_prob:5.749 - timing_s/ref:6.008 - timing_s/adv:0.295 - timing_s/update_actor:36.212 - timing_s/step:72.989 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:418605.000 - perf/time_per_step:72.989 - perf/throughput:716.902
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 93/132 [2:05:36<55:39, 85.63s/it]  
[36m(TaskRunner pid=1923599)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 94/132 [2:06:46<51:19, 81.05s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/132 [2:07:54<47:28, 76.98s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 96/132 [2:09:07<45:25, 75.72s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 97/132 [2:10:14<42:42, 73.21s/it]
[36m(TaskRunner pid=1923599)[0m step:93 - global_seqlen/min:50332.000 - global_seqlen/max:56383.000 - global_seqlen/minmax_diff:6051.000 - global_seqlen/balanced_min:52934.000 - global_seqlen/balanced_max:52942.000 - global_seqlen/mean:52935.625 - actor/entropy_loss:0.458 - actor/kl_loss:0.128 - actor/kl_coef:0.001 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.627 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.691 - actor/lr:0.000 - critic/score/mean:1.528 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.528 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:234.053 - response_length/max:692.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.359 - prompt_length/max:522.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.451 - timing_s/old_log_prob:5.901 - timing_s/ref:6.189 - timing_s/adv:0.295 - timing_s/update_actor:36.194 - timing_s/step:70.051 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:423485.000 - perf/time_per_step:70.051 - perf/throughput:755.676
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:94 - global_seqlen/min:49486.000 - global_seqlen/max:54051.000 - global_seqlen/minmax_diff:4565.000 - global_seqlen/balanced_min:51857.000 - global_seqlen/balanced_max:51858.000 - global_seqlen/mean:51857.250 - actor/entropy_loss:0.448 - actor/kl_loss:0.135 - actor/kl_coef:0.001 - actor/pg_loss:-0.106 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.578 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.388 - actor/lr:0.000 - critic/score/mean:1.550 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.550 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:225.320 - response_length/max:811.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.859 - prompt_length/max:798.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.206 - timing_s/old_log_prob:5.686 - timing_s/ref:5.988 - timing_s/adv:0.297 - timing_s/update_actor:35.117 - timing_s/step:70.324 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.134 - timing_per_token_ms/update_actor:0.085 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:414858.000 - perf/time_per_step:70.324 - perf/throughput:737.408
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:95 - global_seqlen/min:46626.000 - global_seqlen/max:53954.000 - global_seqlen/minmax_diff:7328.000 - global_seqlen/balanced_min:51135.000 - global_seqlen/balanced_max:51136.000 - global_seqlen/mean:51135.875 - actor/entropy_loss:0.443 - actor/kl_loss:0.127 - actor/kl_coef:0.001 - actor/pg_loss:0.140 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.687 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.481 - actor/lr:0.000 - critic/score/mean:1.571 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.571 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:225.072 - response_length/max:586.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.594 - prompt_length/max:507.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.691 - timing_s/old_log_prob:5.643 - timing_s/ref:6.018 - timing_s/adv:0.292 - timing_s/update_actor:35.809 - timing_s/step:67.479 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:409087.000 - perf/time_per_step:67.479 - perf/throughput:757.799
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:96 - global_seqlen/min:49214.000 - global_seqlen/max:53890.000 - global_seqlen/minmax_diff:4676.000 - global_seqlen/balanced_min:51136.000 - global_seqlen/balanced_max:51137.000 - global_seqlen/mean:51136.250 - actor/entropy_loss:0.423 - actor/kl_loss:0.152 - actor/kl_coef:0.001 - actor/pg_loss:0.008 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.719 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.413 - actor/lr:0.000 - critic/score/mean:1.525 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.525 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:219.599 - response_length/max:646.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.070 - prompt_length/max:583.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.315 - timing_s/old_log_prob:5.722 - timing_s/ref:6.041 - timing_s/adv:0.285 - timing_s/update_actor:35.364 - timing_s/step:72.753 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.150 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:409090.000 - perf/time_per_step:72.753 - perf/throughput:702.879
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:97 - global_seqlen/min:50969.000 - global_seqlen/max:56094.000 - global_seqlen/minmax_diff:5125.000 - global_seqlen/balanced_min:52127.000 - global_seqlen/balanced_max:52128.000 - global_seqlen/mean:52127.875 - actor/entropy_loss:0.423 - actor/kl_loss:0.124 - actor/kl_coef:0.001 - actor/pg_loss:0.079 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.630 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.480 - actor/lr:0.000 - critic/score/mean:1.616 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.616 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:223.788 - response_length/max:561.000 - response_length/min:83.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.211 - prompt_length/max:820.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.488 - timing_s/old_log_prob:5.790 - timing_s/ref:6.050 - timing_s/adv:0.304 - timing_s/update_actor:35.671 - timing_s/step:67.323 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:417023.000 - perf/time_per_step:67.323 - perf/throughput:774.295
[36m(TaskRunner pid=1923599)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 98/132 [2:11:29<41:48, 73.78s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 99/132 [2:12:39<39:53, 72.53s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:98 - global_seqlen/min:50054.000 - global_seqlen/max:56601.000 - global_seqlen/minmax_diff:6547.000 - global_seqlen/balanced_min:52628.000 - global_seqlen/balanced_max:52649.000 - global_seqlen/mean:52631.250 - actor/entropy_loss:0.426 - actor/kl_loss:0.126 - actor/kl_coef:0.001 - actor/pg_loss:0.131 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.630 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.536 - actor/lr:0.000 - critic/score/mean:1.547 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.547 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.023 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.023 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:234.297 - response_length/max:1024.000 - response_length/min:79.000 - response_length/clip_ratio:0.001 - prompt_length/mean:313.945 - prompt_length/max:552.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.476 - timing_s/old_log_prob:5.820 - timing_s/ref:6.133 - timing_s/adv:0.312 - timing_s/update_actor:36.334 - timing_s/step:75.102 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:421050.000 - perf/time_per_step:75.102 - perf/throughput:700.800
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:99 - global_seqlen/min:47655.000 - global_seqlen/max:56918.000 - global_seqlen/minmax_diff:9263.000 - global_seqlen/balanced_min:50587.000 - global_seqlen/balanced_max:50588.000 - global_seqlen/mean:50587.875 - actor/entropy_loss:0.450 - actor/kl_loss:0.130 - actor/kl_coef:0.001 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.673 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.428 - actor/lr:0.000 - critic/score/mean:1.549 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.549 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.009 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.009 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:217.246 - response_length/max:776.000 - response_length/min:73.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.711 - prompt_length/max:590.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.562 - timing_s/old_log_prob:5.682 - timing_s/ref:6.038 - timing_s/adv:0.297 - timing_s/update_actor:34.975 - timing_s/step:69.576 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.135 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:404703.000 - perf/time_per_step:69.576 - perf/throughput:727.085
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„ç›¸å…³è§„å®šï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚è™½ç„¶ç”²ä¹™äºŒäººçš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œåº”ä»¥é—´è°ç½ªè®ºå¤„ï¼Œé€‰é¡¹Cæ­£ç¡®ã€‚å¯¹äºä¹™æŸï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œé€‰é¡¹Dæ­£ç¡®ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯BCDã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100
[36m(WorkerDict pid=1926909)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1926909)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1926909)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=1923599)[0m Training Progress:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 100/132 [2:16:20<1:02:30, 117.21s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 101/132 [2:17:33<53:39, 103.86s/it]  
[36m(TaskRunner pid=1923599)[0m Training Progress:  77%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹  | 102/132 [2:18:45<47:09, 94.30s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 103/132 [2:19:50<41:16, 85.41s/it]
[36m(TaskRunner pid=1923599)[0m step:100 - global_seqlen/min:47249.000 - global_seqlen/max:53382.000 - global_seqlen/minmax_diff:6133.000 - global_seqlen/balanced_min:50297.000 - global_seqlen/balanced_max:50297.000 - global_seqlen/mean:50297.000 - actor/entropy_loss:0.440 - actor/kl_loss:0.150 - actor/kl_coef:0.001 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.618 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.570 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.571 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.571 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.571 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.571 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.571 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.571 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.582 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.582 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.935 - response_length/max:583.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.992 - prompt_length/max:628.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.271 - timing_s/old_log_prob:5.672 - timing_s/ref:6.011 - timing_s/adv:0.291 - timing_s/update_actor:35.037 - timing_s/testing:129.694 - timing_s/save_checkpoint:25.409 - timing_s/step:221.411 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:402376.000 - perf/time_per_step:221.411 - perf/throughput:227.166
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_100/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:101 - global_seqlen/min:45606.000 - global_seqlen/max:53700.000 - global_seqlen/minmax_diff:8094.000 - global_seqlen/balanced_min:48976.000 - global_seqlen/balanced_max:49098.000 - global_seqlen/mean:49005.625 - actor/entropy_loss:0.429 - actor/kl_loss:0.179 - actor/kl_coef:0.001 - actor/pg_loss:0.033 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.649 - perf/mfu/actor:0.360 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.899 - actor/lr:0.000 - critic/score/mean:1.557 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.557 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:210.264 - response_length/max:1024.000 - response_length/min:56.000 - response_length/clip_ratio:0.003 - prompt_length/mean:300.211 - prompt_length/max:503.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.190 - timing_s/old_log_prob:5.380 - timing_s/ref:5.879 - timing_s/adv:0.293 - timing_s/update_actor:34.894 - timing_s/step:72.669 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.162 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:392045.000 - perf/time_per_step:72.669 - perf/throughput:674.370
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:102 - global_seqlen/min:47874.000 - global_seqlen/max:53148.000 - global_seqlen/minmax_diff:5274.000 - global_seqlen/balanced_min:49844.000 - global_seqlen/balanced_max:50024.000 - global_seqlen/mean:49871.125 - actor/entropy_loss:0.438 - actor/kl_loss:0.159 - actor/kl_coef:0.001 - actor/pg_loss:-0.016 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.670 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.826 - perf/cpu_memory_used_gb:51.914 - actor/lr:0.000 - critic/score/mean:1.566 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.566 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.116 - response_length/max:1010.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.375 - prompt_length/max:514.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.088 - timing_s/old_log_prob:5.513 - timing_s/ref:5.900 - timing_s/adv:0.298 - timing_s/update_actor:34.167 - timing_s/step:71.987 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.163 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:398969.000 - perf/time_per_step:71.987 - perf/throughput:692.781
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:103 - global_seqlen/min:47378.000 - global_seqlen/max:50845.000 - global_seqlen/minmax_diff:3467.000 - global_seqlen/balanced_min:49345.000 - global_seqlen/balanced_max:49345.000 - global_seqlen/mean:49345.000 - actor/entropy_loss:0.426 - actor/kl_loss:0.158 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.791 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.715 - actor/lr:0.000 - critic/score/mean:1.635 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.635 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.015 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.015 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:209.487 - response_length/max:523.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.523 - prompt_length/max:565.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.430 - timing_s/old_log_prob:5.456 - timing_s/ref:5.834 - timing_s/adv:0.292 - timing_s/update_actor:34.597 - timing_s/step:64.634 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:394760.000 - perf/time_per_step:64.634 - perf/throughput:763.448
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  79%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 104/132 [2:20:54<36:56, 79.15s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰  | 105/132 [2:21:59<33:41, 74.88s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 106/132 [2:23:12<32:10, 74.23s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 107/132 [2:24:20<30:13, 72.56s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 108/132 [2:25:28<28:26, 71.11s/it]
[36m(TaskRunner pid=1923599)[0m step:104 - global_seqlen/min:46466.000 - global_seqlen/max:51718.000 - global_seqlen/minmax_diff:5252.000 - global_seqlen/balanced_min:48107.000 - global_seqlen/balanced_max:48108.000 - global_seqlen/mean:48107.375 - actor/entropy_loss:0.443 - actor/kl_loss:0.168 - actor/kl_coef:0.001 - actor/pg_loss:-0.067 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.657 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.656 - actor/lr:0.000 - critic/score/mean:1.632 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.632 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:200.478 - response_length/max:538.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:581.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.730 - timing_s/old_log_prob:5.375 - timing_s/ref:5.834 - timing_s/adv:0.285 - timing_s/update_actor:34.280 - timing_s/step:64.524 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:384859.000 - perf/time_per_step:64.524 - perf/throughput:745.569
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:105 - global_seqlen/min:44485.000 - global_seqlen/max:52105.000 - global_seqlen/minmax_diff:7620.000 - global_seqlen/balanced_min:49616.000 - global_seqlen/balanced_max:49617.000 - global_seqlen/mean:49616.750 - actor/entropy_loss:0.473 - actor/kl_loss:0.161 - actor/kl_coef:0.001 - actor/pg_loss:0.000 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.642 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.725 - actor/lr:0.000 - critic/score/mean:1.562 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.562 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:201.521 - response_length/max:574.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.320 - prompt_length/max:613.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.949 - timing_s/old_log_prob:5.515 - timing_s/ref:5.850 - timing_s/adv:0.288 - timing_s/update_actor:34.284 - timing_s/step:64.906 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:396934.000 - perf/time_per_step:64.906 - perf/throughput:764.443
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:106 - global_seqlen/min:46225.000 - global_seqlen/max:53034.000 - global_seqlen/minmax_diff:6809.000 - global_seqlen/balanced_min:50092.000 - global_seqlen/balanced_max:50349.000 - global_seqlen/mean:50124.375 - actor/entropy_loss:0.451 - actor/kl_loss:0.168 - actor/kl_coef:0.001 - actor/pg_loss:-0.028 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.681 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.701 - actor/lr:0.000 - critic/score/mean:1.526 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.526 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:204.504 - response_length/max:1024.000 - response_length/min:55.000 - response_length/clip_ratio:0.001 - prompt_length/mean:317.625 - prompt_length/max:820.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.938 - timing_s/old_log_prob:5.550 - timing_s/ref:5.908 - timing_s/adv:0.322 - timing_s/update_actor:34.947 - timing_s/step:72.689 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.165 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:400995.000 - perf/time_per_step:72.689 - perf/throughput:689.573
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:107 - global_seqlen/min:44755.000 - global_seqlen/max:52530.000 - global_seqlen/minmax_diff:7775.000 - global_seqlen/balanced_min:48685.000 - global_seqlen/balanced_max:48775.000 - global_seqlen/mean:48696.875 - actor/entropy_loss:0.482 - actor/kl_loss:0.160 - actor/kl_coef:0.001 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.770 - perf/mfu/actor:0.355 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.719 - actor/lr:0.000 - critic/score/mean:1.570 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.570 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:200.564 - response_length/max:767.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.695 - prompt_length/max:539.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.834 - timing_s/old_log_prob:5.444 - timing_s/ref:5.850 - timing_s/adv:0.286 - timing_s/update_actor:35.175 - timing_s/step:68.617 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.142 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:389575.000 - perf/time_per_step:68.617 - perf/throughput:709.691
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:108 - global_seqlen/min:46588.000 - global_seqlen/max:52588.000 - global_seqlen/minmax_diff:6000.000 - global_seqlen/balanced_min:49538.000 - global_seqlen/balanced_max:49539.000 - global_seqlen/mean:49538.875 - actor/entropy_loss:0.466 - actor/kl_loss:0.173 - actor/kl_coef:0.001 - actor/pg_loss:-0.048 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.563 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.741 - actor/lr:0.000 - critic/score/mean:1.667 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.667 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:210.358 - response_length/max:759.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.672 - prompt_length/max:531.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.235 - timing_s/old_log_prob:5.356 - timing_s/ref:5.788 - timing_s/adv:0.292 - timing_s/update_actor:34.014 - timing_s/step:67.706 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.138 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:396311.000 - perf/time_per_step:67.706 - perf/throughput:731.677
[36m(TaskRunner pid=1923599)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 109/132 [2:26:33<26:31, 69.20s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  83%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 110/132 [2:29:48<39:12, 106.93s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:109 - global_seqlen/min:47051.000 - global_seqlen/max:53794.000 - global_seqlen/minmax_diff:6743.000 - global_seqlen/balanced_min:50044.000 - global_seqlen/balanced_max:50045.000 - global_seqlen/mean:50044.625 - actor/entropy_loss:0.506 - actor/kl_loss:0.148 - actor/kl_coef:0.001 - actor/pg_loss:-0.057 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.651 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.987 - actor/lr:0.000 - critic/score/mean:1.576 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.576 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.011 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.011 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:212.290 - response_length/max:520.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.008 - prompt_length/max:685.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.601 - timing_s/old_log_prob:5.546 - timing_s/ref:5.816 - timing_s/adv:0.286 - timing_s/update_actor:34.436 - timing_s/step:64.710 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:400357.000 - perf/time_per_step:64.710 - perf/throughput:773.367
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠå›½å®¶ç§˜å¯†çš„éæ³•è·å–ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººçš„è¡Œä¸ºåœ¨åˆ‘æ³•ä¸Šå¯ä»¥å½’å…¥åŒä¸€ç½ªåï¼Œåˆ™å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸçš„è¡Œä¸ºå¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œç”±äºå…¶è¡Œä¸ºç¬¦åˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œåº”å½“ä»¥è¯¥ç½ªåå®šç½ªå¤„ç½šã€‚å¯¹äºä¹™æŸï¼Œå…¶è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œåº”å½“ä»¥è¯¥ç½ªåå®šç½ªå¤„ç½šã€‚å› æ­¤ï¼Œé€‰é¡¹Cå’ŒDéƒ½æ­£ç¡®ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:110 - global_seqlen/min:47441.000 - global_seqlen/max:53031.000 - global_seqlen/minmax_diff:5590.000 - global_seqlen/balanced_min:50130.000 - global_seqlen/balanced_max:50131.000 - global_seqlen/mean:50130.250 - actor/entropy_loss:0.493 - actor/kl_loss:0.162 - actor/kl_coef:0.001 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.753 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.871 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.575 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.575 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.575 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.575 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.575 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.575 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.573 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.573 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:207.339 - response_length/max:666.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.852 - prompt_length/max:545.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.273 - timing_s/old_log_prob:5.572 - timing_s/ref:5.953 - timing_s/adv:0.292 - timing_s/update_actor:34.709 - timing_s/testing:128.132 - timing_s/step:194.952 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:401042.000 - perf/time_per_step:194.952 - perf/throughput:257.142
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 111/132 [2:30:54<33:07, 94.64s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  85%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 112/132 [2:31:58<28:29, 85.50s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 113/132 [2:33:00<24:52, 78.55s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 114/132 [2:34:04<22:12, 74.01s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  87%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹ | 115/132 [2:35:08<20:07, 71.04s/it]
[36m(TaskRunner pid=1923599)[0m step:111 - global_seqlen/min:46749.000 - global_seqlen/max:52139.000 - global_seqlen/minmax_diff:5390.000 - global_seqlen/balanced_min:49537.000 - global_seqlen/balanced_max:49538.000 - global_seqlen/mean:49537.625 - actor/entropy_loss:0.488 - actor/kl_loss:0.202 - actor/kl_coef:0.001 - actor/pg_loss:-0.019 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.608 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.787 - actor/lr:0.000 - critic/score/mean:1.561 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.561 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:208.040 - response_length/max:614.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.977 - prompt_length/max:640.000 - prompt_length/min:232.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.494 - timing_s/old_log_prob:5.630 - timing_s/ref:5.860 - timing_s/adv:0.358 - timing_s/update_actor:34.538 - timing_s/step:65.963 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:396301.000 - perf/time_per_step:65.963 - perf/throughput:750.986
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:112 - global_seqlen/min:44067.000 - global_seqlen/max:51344.000 - global_seqlen/minmax_diff:7277.000 - global_seqlen/balanced_min:48587.000 - global_seqlen/balanced_max:48588.000 - global_seqlen/mean:48587.500 - actor/entropy_loss:0.463 - actor/kl_loss:0.193 - actor/kl_coef:0.001 - actor/pg_loss:-0.049 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.618 - perf/mfu/actor:0.356 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.884 - actor/lr:0.000 - critic/score/mean:1.634 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.634 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:197.698 - response_length/max:472.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.422 - prompt_length/max:574.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.563 - timing_s/old_log_prob:5.438 - timing_s/ref:5.822 - timing_s/adv:0.331 - timing_s/update_actor:34.910 - timing_s/step:64.122 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388700.000 - perf/time_per_step:64.122 - perf/throughput:757.731
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:113 - global_seqlen/min:45858.000 - global_seqlen/max:49490.000 - global_seqlen/minmax_diff:3632.000 - global_seqlen/balanced_min:47622.000 - global_seqlen/balanced_max:47623.000 - global_seqlen/mean:47622.875 - actor/entropy_loss:0.451 - actor/kl_loss:0.178 - actor/kl_coef:0.001 - actor/pg_loss:0.065 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.659 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.940 - actor/lr:0.000 - critic/score/mean:1.604 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.604 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:190.087 - response_length/max:446.000 - response_length/min:53.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.984 - prompt_length/max:487.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.029 - timing_s/old_log_prob:5.265 - timing_s/ref:5.730 - timing_s/adv:0.290 - timing_s/update_actor:33.949 - timing_s/step:62.296 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:380983.000 - perf/time_per_step:62.296 - perf/throughput:764.456
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:114 - global_seqlen/min:43104.000 - global_seqlen/max:50865.000 - global_seqlen/minmax_diff:7761.000 - global_seqlen/balanced_min:47208.000 - global_seqlen/balanced_max:47209.000 - global_seqlen/mean:47208.625 - actor/entropy_loss:0.454 - actor/kl_loss:0.219 - actor/kl_coef:0.001 - actor/pg_loss:-0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.706 - perf/mfu/actor:0.356 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.731 - actor/lr:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.741 - response_length/max:523.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:512.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.086 - timing_s/old_log_prob:5.256 - timing_s/ref:5.786 - timing_s/adv:0.286 - timing_s/update_actor:33.952 - timing_s/step:63.397 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:377669.000 - perf/time_per_step:63.397 - perf/throughput:744.652
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:115 - global_seqlen/min:44310.000 - global_seqlen/max:51936.000 - global_seqlen/minmax_diff:7626.000 - global_seqlen/balanced_min:47627.000 - global_seqlen/balanced_max:47628.000 - global_seqlen/mean:47627.125 - actor/entropy_loss:0.454 - actor/kl_loss:0.187 - actor/kl_coef:0.001 - actor/pg_loss:-0.107 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.725 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.854 - actor/lr:0.000 - critic/score/mean:1.580 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.580 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:190.905 - response_length/max:550.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.211 - prompt_length/max:516.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.709 - timing_s/old_log_prob:5.348 - timing_s/ref:5.731 - timing_s/adv:0.290 - timing_s/update_actor:33.959 - timing_s/step:64.066 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:381017.000 - perf/time_per_step:64.066 - perf/throughput:743.408
[36m(TaskRunner pid=1923599)[0m Training Progress:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 116/132 [2:36:15<18:36, 69.76s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 117/132 [2:37:24<17:23, 69.55s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  89%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰ | 118/132 [2:38:27<15:48, 67.75s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 119/132 [2:39:30<14:21, 66.28s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:116 - global_seqlen/min:44712.000 - global_seqlen/max:53622.000 - global_seqlen/minmax_diff:8910.000 - global_seqlen/balanced_min:47668.000 - global_seqlen/balanced_max:47669.000 - global_seqlen/mean:47668.500 - actor/entropy_loss:0.446 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:-0.042 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.713 - perf/mfu/actor:0.356 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.807 - actor/lr:0.000 - critic/score/mean:1.617 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.617 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.055 - response_length/max:747.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.492 - prompt_length/max:808.000 - prompt_length/min:212.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.105 - timing_s/old_log_prob:5.318 - timing_s/ref:5.748 - timing_s/adv:0.283 - timing_s/update_actor:34.283 - timing_s/step:66.763 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:381348.000 - perf/time_per_step:66.763 - perf/throughput:713.992
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:117 - global_seqlen/min:45786.000 - global_seqlen/max:52546.000 - global_seqlen/minmax_diff:6760.000 - global_seqlen/balanced_min:49009.000 - global_seqlen/balanced_max:49031.000 - global_seqlen/mean:49012.500 - actor/entropy_loss:0.447 - actor/kl_loss:0.185 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.712 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.892 - actor/lr:0.000 - critic/score/mean:1.617 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.617 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:190.172 - response_length/max:856.000 - response_length/min:66.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.375 - prompt_length/max:609.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.392 - timing_s/old_log_prob:5.403 - timing_s/ref:5.790 - timing_s/adv:0.313 - timing_s/update_actor:34.091 - timing_s/step:69.016 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.160 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:392100.000 - perf/time_per_step:69.016 - perf/throughput:710.163
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:118 - global_seqlen/min:45435.000 - global_seqlen/max:50637.000 - global_seqlen/minmax_diff:5202.000 - global_seqlen/balanced_min:47521.000 - global_seqlen/balanced_max:47522.000 - global_seqlen/mean:47521.750 - actor/entropy_loss:0.419 - actor/kl_loss:0.184 - actor/kl_coef:0.001 - actor/pg_loss:0.067 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.619 - perf/mfu/actor:0.354 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.697 - actor/lr:0.000 - critic/score/mean:1.568 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.568 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:191.151 - response_length/max:481.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.867 - prompt_length/max:512.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.685 - timing_s/old_log_prob:5.392 - timing_s/ref:5.763 - timing_s/adv:0.303 - timing_s/update_actor:34.365 - timing_s/step:63.529 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/update_actor:0.090 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:380174.000 - perf/time_per_step:63.529 - perf/throughput:748.038
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:119 - global_seqlen/min:43515.000 - global_seqlen/max:50959.000 - global_seqlen/minmax_diff:7444.000 - global_seqlen/balanced_min:48355.000 - global_seqlen/balanced_max:48356.000 - global_seqlen/mean:48355.875 - actor/entropy_loss:0.435 - actor/kl_loss:0.207 - actor/kl_coef:0.001 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.899 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.319 - actor/lr:0.000 - critic/score/mean:1.670 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.670 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:185.129 - response_length/max:460.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:318.578 - prompt_length/max:611.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:16.975 - timing_s/old_log_prob:5.475 - timing_s/ref:5.811 - timing_s/adv:0.319 - timing_s/update_actor:34.212 - timing_s/step:62.817 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.119 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:386847.000 - perf/time_per_step:62.817 - perf/throughput:769.787
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m Training Progress:  91%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 120/132 [2:42:47<21:05, 105.43s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 121/132 [2:43:59<17:28, 95.30s/it] 
[36m(TaskRunner pid=1923599)[0m Training Progress:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 122/132 [2:45:07<14:31, 87.10s/it]
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºæ€§è´¨ç›¸åŒï¼Œå¯ä»¥ä»¥å…±åŒçŠ¯ç½ªè®ºå¤„ã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥é€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ï¼Œé€‰é¡¹Cå’Œé€‰é¡¹Dæ­£ç¡®ã€‚å› æ­¤ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m step:120 - global_seqlen/min:45195.000 - global_seqlen/max:50117.000 - global_seqlen/minmax_diff:4922.000 - global_seqlen/balanced_min:48174.000 - global_seqlen/balanced_max:48225.000 - global_seqlen/mean:48180.875 - actor/entropy_loss:0.412 - actor/kl_loss:0.220 - actor/kl_coef:0.001 - actor/pg_loss:0.014 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.768 - perf/mfu/actor:0.360 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.712 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.580 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.580 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.580 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.580 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.580 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.580 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.648 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.648 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:192.400 - response_length/max:823.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.484 - prompt_length/max:550.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.535 - timing_s/old_log_prob:5.345 - timing_s/ref:5.741 - timing_s/adv:0.290 - timing_s/update_actor:34.302 - timing_s/testing:128.518 - timing_s/step:196.753 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:385447.000 - perf/time_per_step:196.753 - perf/throughput:244.880
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:121 - global_seqlen/min:46193.000 - global_seqlen/max:49739.000 - global_seqlen/minmax_diff:3546.000 - global_seqlen/balanced_min:48554.000 - global_seqlen/balanced_max:48860.000 - global_seqlen/mean:48593.000 - actor/entropy_loss:0.376 - actor/kl_loss:0.197 - actor/kl_coef:0.001 - actor/pg_loss:0.153 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.700 - perf/mfu/actor:0.359 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.843 - actor/lr:0.000 - critic/score/mean:1.585 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.585 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:195.318 - response_length/max:1024.000 - response_length/min:72.000 - response_length/clip_ratio:0.001 - prompt_length/mean:310.859 - prompt_length/max:443.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.574 - timing_s/old_log_prob:5.335 - timing_s/ref:5.750 - timing_s/adv:0.288 - timing_s/update_actor:34.657 - timing_s/step:71.636 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.170 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:388744.000 - perf/time_per_step:71.636 - perf/throughput:678.336
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:122 - global_seqlen/min:44749.000 - global_seqlen/max:50782.000 - global_seqlen/minmax_diff:6033.000 - global_seqlen/balanced_min:48128.000 - global_seqlen/balanced_max:48129.000 - global_seqlen/mean:48128.625 - actor/entropy_loss:0.407 - actor/kl_loss:0.215 - actor/kl_coef:0.001 - actor/pg_loss:-0.034 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.601 - perf/mfu/actor:0.358 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.968 - actor/lr:0.000 - critic/score/mean:1.632 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.632 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.006 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.006 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:187.176 - response_length/max:827.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.164 - prompt_length/max:640.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.082 - timing_s/old_log_prob:5.372 - timing_s/ref:5.786 - timing_s/adv:0.283 - timing_s/update_actor:34.422 - timing_s/step:67.966 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/update_actor:0.089 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:385029.000 - perf/time_per_step:67.966 - perf/throughput:708.128
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m Training Progress:  93%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 123/132 [2:46:14<12:12, 81.34s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 124/132 [2:47:20<10:13, 76.72s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 125/132 [2:48:33<08:47, 75.37s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 126/132 [2:49:41<07:19, 73.20s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 127/132 [2:50:47<05:55, 71.12s/it]
[36m(TaskRunner pid=1923599)[0m step:123 - global_seqlen/min:47609.000 - global_seqlen/max:53821.000 - global_seqlen/minmax_diff:6212.000 - global_seqlen/balanced_min:50737.000 - global_seqlen/balanced_max:50738.000 - global_seqlen/mean:50737.500 - actor/entropy_loss:0.391 - actor/kl_loss:0.186 - actor/kl_coef:0.001 - actor/pg_loss:-0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.680 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.910 - actor/lr:0.000 - critic/score/mean:1.586 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.586 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:204.750 - response_length/max:668.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.766 - prompt_length/max:541.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.697 - timing_s/old_log_prob:5.642 - timing_s/ref:6.014 - timing_s/adv:0.297 - timing_s/update_actor:35.192 - timing_s/step:67.868 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.132 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:405900.000 - perf/time_per_step:67.868 - perf/throughput:747.590
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:124 - global_seqlen/min:47535.000 - global_seqlen/max:50564.000 - global_seqlen/minmax_diff:3029.000 - global_seqlen/balanced_min:48926.000 - global_seqlen/balanced_max:48927.000 - global_seqlen/mean:48926.250 - actor/entropy_loss:0.376 - actor/kl_loss:0.181 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.595 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.836 - actor/lr:0.000 - critic/score/mean:1.619 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.619 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.002 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:205.828 - response_length/max:651.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.820 - prompt_length/max:555.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.294 - timing_s/old_log_prob:5.389 - timing_s/ref:5.768 - timing_s/adv:0.287 - timing_s/update_actor:34.137 - timing_s/step:65.896 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:391410.000 - perf/time_per_step:65.896 - perf/throughput:742.473
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:125 - global_seqlen/min:46499.000 - global_seqlen/max:54204.000 - global_seqlen/minmax_diff:7705.000 - global_seqlen/balanced_min:49868.000 - global_seqlen/balanced_max:49978.000 - global_seqlen/mean:49882.000 - actor/entropy_loss:0.379 - actor/kl_loss:0.183 - actor/kl_coef:0.001 - actor/pg_loss:0.055 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.597 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.774 - actor/lr:0.000 - critic/score/mean:1.634 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.634 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:214.854 - response_length/max:962.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.750 - prompt_length/max:583.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.226 - timing_s/old_log_prob:5.603 - timing_s/ref:5.858 - timing_s/adv:0.301 - timing_s/update_actor:35.175 - timing_s/step:72.184 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.153 - timing_per_token_ms/update_actor:0.088 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:399056.000 - perf/time_per_step:72.184 - perf/throughput:691.044
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:126 - global_seqlen/min:47376.000 - global_seqlen/max:55712.000 - global_seqlen/minmax_diff:8336.000 - global_seqlen/balanced_min:50905.000 - global_seqlen/balanced_max:50906.000 - global_seqlen/mean:50905.500 - actor/entropy_loss:0.389 - actor/kl_loss:0.229 - actor/kl_coef:0.001 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.640 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.759 - actor/lr:0.000 - critic/score/mean:1.586 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.586 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.003 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:218.203 - response_length/max:664.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.062 - prompt_length/max:567.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.047 - timing_s/old_log_prob:5.570 - timing_s/ref:5.903 - timing_s/adv:0.300 - timing_s/update_actor:35.278 - timing_s/step:68.121 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:407244.000 - perf/time_per_step:68.121 - perf/throughput:747.279
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:127 - global_seqlen/min:48628.000 - global_seqlen/max:51594.000 - global_seqlen/minmax_diff:2966.000 - global_seqlen/balanced_min:50133.000 - global_seqlen/balanced_max:50134.000 - global_seqlen/mean:50133.125 - actor/entropy_loss:0.408 - actor/kl_loss:0.192 - actor/kl_coef:0.001 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.555 - perf/mfu/actor:0.374 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.671 - actor/lr:0.000 - critic/score/mean:1.602 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.602 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.001 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:213.712 - response_length/max:631.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.508 - prompt_length/max:604.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.209 - timing_s/old_log_prob:5.499 - timing_s/ref:5.824 - timing_s/adv:0.286 - timing_s/update_actor:34.371 - timing_s/step:66.214 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:401065.000 - perf/time_per_step:66.214 - perf/throughput:757.142
[36m(TaskRunner pid=1923599)[0m Training Progress:  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 128/132 [2:51:53<04:38, 69.65s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 129/132 [2:52:59<03:25, 68.37s/it]
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:128 - global_seqlen/min:48277.000 - global_seqlen/max:53320.000 - global_seqlen/minmax_diff:5043.000 - global_seqlen/balanced_min:50920.000 - global_seqlen/balanced_max:50921.000 - global_seqlen/mean:50920.625 - actor/entropy_loss:0.404 - actor/kl_loss:0.199 - actor/kl_coef:0.001 - actor/pg_loss:-0.079 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.670 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.709 - actor/lr:0.000 - critic/score/mean:1.644 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.644 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:217.337 - response_length/max:543.000 - response_length/min:81.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.086 - prompt_length/max:789.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.000 - timing_s/old_log_prob:5.646 - timing_s/ref:5.971 - timing_s/adv:0.291 - timing_s/update_actor:35.267 - timing_s/step:66.200 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:407365.000 - perf/time_per_step:66.200 - perf/throughput:769.194
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:129 - global_seqlen/min:46940.000 - global_seqlen/max:52062.000 - global_seqlen/minmax_diff:5122.000 - global_seqlen/balanced_min:49697.000 - global_seqlen/balanced_max:49698.000 - global_seqlen/mean:49697.500 - actor/entropy_loss:0.421 - actor/kl_loss:0.201 - actor/kl_coef:0.001 - actor/pg_loss:-0.031 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.642 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.907 - actor/lr:0.000 - critic/score/mean:1.574 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.574 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.008 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:0.008 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:212.878 - response_length/max:562.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.805 - prompt_length/max:441.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.327 - timing_s/old_log_prob:5.475 - timing_s/ref:5.875 - timing_s/adv:0.292 - timing_s/update_actor:34.362 - timing_s/step:65.350 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:397580.000 - perf/time_per_step:65.350 - perf/throughput:760.480
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºä¾µçŠ¯å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚ç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºæ€§è´¨ç›¸åŒï¼Œå¯ä»¥æŒ‰ç…§ä¸€ä¸ªå…±åŒçŠ¯ç½ªå¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”²æŸå’Œä¹™æŸçš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤ä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªï¼Œè€Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œåº”ä»¥ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œé€‰é¡¹Cæ­£ç¡®ã€‚å¯¹äºä¹™æŸï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œé€‰é¡¹Dæ­£ç¡®ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m Training Progress:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 130/132 [2:56:12<03:31, 105.99s/it]
[36m(TaskRunner pid=1923599)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [2:57:18<01:34, 94.01s/it] 
[36m(TaskRunner pid=1923599)[0m step:130 - global_seqlen/min:48625.000 - global_seqlen/max:52552.000 - global_seqlen/minmax_diff:3927.000 - global_seqlen/balanced_min:50959.000 - global_seqlen/balanced_max:50960.000 - global_seqlen/mean:50959.875 - actor/entropy_loss:0.433 - actor/kl_loss:0.187 - actor/kl_coef:0.001 - actor/pg_loss:0.028 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.533 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.824 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.585 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.585 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.585 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.585 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.585 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.585 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.613 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.613 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.000 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.668 - response_length/max:475.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.164 - prompt_length/max:765.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.689 - timing_s/old_log_prob:5.617 - timing_s/ref:5.873 - timing_s/adv:0.308 - timing_s/update_actor:34.315 - timing_s/testing:129.929 - timing_s/step:193.754 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/update_actor:0.084 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:407679.000 - perf/time_per_step:193.754 - perf/throughput:263.014
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m step:131 - global_seqlen/min:49392.000 - global_seqlen/max:52420.000 - global_seqlen/minmax_diff:3028.000 - global_seqlen/balanced_min:50857.000 - global_seqlen/balanced_max:50858.000 - global_seqlen/mean:50857.500 - actor/entropy_loss:0.431 - actor/kl_loss:0.190 - actor/kl_coef:0.001 - actor/pg_loss:-0.013 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.562 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.818 - actor/lr:0.000 - critic/score/mean:1.626 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.626 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.007 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.007 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:215.492 - response_length/max:562.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.273 - prompt_length/max:445.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.215 - timing_s/old_log_prob:5.518 - timing_s/ref:5.853 - timing_s/adv:0.291 - timing_s/update_actor:35.115 - timing_s/step:66.024 - timing_per_token_ms/ref:0.014 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/update_actor:0.086 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:406860.000 - perf/time_per_step:66.024 - perf/throughput:770.292
[36m(TaskRunner pid=1923599)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1923599)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1923599)[0m validation generation end
[36m(TaskRunner pid=1923599)[0m [prompt] system
[36m(TaskRunner pid=1923599)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1923599)[0m user
[36m(TaskRunner pid=1923599)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1923599)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1923599)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1923599)[0m assistant
[36m(TaskRunner pid=1923599)[0m 
[36m(TaskRunner pid=1923599)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½å±äºä¾µçŠ¯å›½å®¶ç§˜å¯†çš„è¡Œä¸ºã€‚ç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººçš„æ•…æ„å†…å®¹ä¸åŒï¼Œä½†è¡Œä¸ºæ€§è´¨ç›¸åŒï¼Œå¯ä»¥æŒ‰ç…§ä¸€ä¸ªå…±åŒçŠ¯ç½ªå¤„ç†ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç”²æŸå’Œä¹™æŸçš„è¡Œä¸ºéƒ½å±äºéæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤ä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªï¼Œè€Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚å› æ­¤ï¼Œé€‰é¡¹Aé”™è¯¯ï¼Œé€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œåº”ä»¥ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œé€‰é¡¹Cæ­£ç¡®ã€‚å¯¹äºä¹™æŸï¼Œåº”ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œé€‰é¡¹Dæ­£ç¡®ã€‚æ‰€ä»¥ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1923599)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1923599)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1923599)[0m [score] 2.0
[36m(TaskRunner pid=1923599)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1923599)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_4.pt
[36m(WorkerDict pid=1932620)[0m [rank-4]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_4.pt
[36m(TaskRunner pid=1923599)[0m Training Progress:  99%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰| 131/132 [3:01:01<01:22, 82.91s/it]
[36m(WorkerDict pid=1932615)[0m *** SIGSEGV received at time=1745566498 on cpu 117 ***
[36m(WorkerDict pid=1932615)[0m PC: @     0x7fd65008e7be  (unknown)  ray::gcs::TaskInfoAccessor::AsyncAddTaskEventData()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd651702520       3680  (unknown)
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64ff6f975       1392  ray::core::worker::TaskEventBufferImpl::FlushEvents()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64fef86ec       1488  ray::core::CoreWorker::Disconnect()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64fef8a9d       1152  ray::core::CoreWorker::ForceExit()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64fef8ecf       1680  ray::core::CoreWorker::HandleKillActor()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64fef03d4        192  ray::rpc::ServerCallImpl<>::HandleRequestImpl()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd65027dbc8       1168  EventTracker::RecordExecution()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd650261ffe         48  std::_Function_handler<>::_M_invoke()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd650262476        112  boost::asio::detail::completion_handler<>::do_complete()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd6509288db        128  boost::asio::detail::scheduler::do_run_one()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd65092a259        288  boost::asio::detail::scheduler::run()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd65092a962         96  boost::asio::io_context::run()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd64fe510b1       1280  ray::core::CoreWorker::RunIOService()
[36m(WorkerDict pid=1932615)[0m     @     0x7fd65036f4e0         64  thread_proxy
[36m(WorkerDict pid=1932615)[0m     @     0x7fd651754ac3  (unknown)  (unknown)
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484: *** SIGSEGV received at time=1745566498 on cpu 117 ***
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484: PC: @     0x7fd65008e7be  (unknown)  ray::gcs::TaskInfoAccessor::AsyncAddTaskEventData()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd651702520       3680  (unknown)
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64ff6f975       1392  ray::core::worker::TaskEventBufferImpl::FlushEvents()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64fef86ec       1488  ray::core::CoreWorker::Disconnect()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64fef8a9d       1152  ray::core::CoreWorker::ForceExit()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64fef8ecf       1680  ray::core::CoreWorker::HandleKillActor()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64fef03d4        192  ray::rpc::ServerCallImpl<>::HandleRequestImpl()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd65027dbc8       1168  EventTracker::RecordExecution()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd650261ffe         48  std::_Function_handler<>::_M_invoke()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd650262476        112  boost::asio::detail::completion_handler<>::do_complete()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd6509288db        128  boost::asio::detail::scheduler::do_run_one()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd65092a259        288  boost::asio::detail::scheduler::run()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd65092a962         96  boost::asio::io_context::run()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd64fe510b1       1280  ray::core::CoreWorker::RunIOService()
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd65036f4e0         64  thread_proxy
[36m(WorkerDict pid=1932615)[0m [2025-04-25 07:34:58,689 E 1932615 1932708] logging.cc:484:     @     0x7fd651754ac3  (unknown)  (unknown)
[36m(WorkerDict pid=1932615)[0m Fatal Python error: Segmentation fault
[36m(WorkerDict pid=1932615)[0m 
[36m(WorkerDict pid=1932615)[0m 
[36m(WorkerDict pid=1932615)[0m Extension modules: msgpack._cmsgpack, google._upb._message, psutil._psutil_linux, psutil._psutil_posix, setproctitle, yaml._yaml, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, uvloop.loop, ray._raylet, numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pyarrow.lib, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._mt19937, numpy.random.mtrand, numpy.random._philox, numpy.random._pcg64, numpy.random._sfc64, numpy.random._generator, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, markupsafe._speedups, PIL._imaging, PIL._imagingft, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_sqrtm_triu, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpack, scipy.sparse.linalg._propack._spropack, scipy.sparse.linalg._propack._dpropack, scipy.sparse.linalg._propack._cpropack, scipy.sparse.linalg._propack._zpropack, scipy.sparse.csgraph._tools, scipy.sparse.csgraph._shortest_path, scipy.sparse.csgraph._traversal, scipy.sparse.csgraph._min_spanning_tree, scipy.sparse.csgraph._flow, scipy.sparse.csgraph._matching, scipy.sparse.csgraph._reordering, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._cobyla, scipy.optimize._slsqp, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy.optimize._cython_nnls, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.special._ellip_harm_2, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._distance_wrap, scipy.spatial._hausdorff, scipy.spatial.transform._rotation, scipy.optimize._direct, msgspec._core, zmq.backend.cython._zmq, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, sentencepiece._sentencepiece
[36m(WorkerDict pid=1932615)[0m , regex._regex
[36m(WorkerDict pid=1932615)[0m , pyarrow._json
[36m(WorkerDict pid=1932615)[0m , vllm.cumem_allocator, numba.core.typeconv._typeconv, numba._helperlib, numba._dynfunc, numba._dispatcher, numba.core.typing.builtins.itertools, numba.cpython.builtins.math, numba.core.runtime._nrt_python, numba.np.ufunc._internal, numba.experimental.jitclass._box, cuda_utils, __triton_launcher (total: 158)
[36m(TaskRunner pid=1923599)[0m step:132 - global_seqlen/min:48769.000 - global_seqlen/max:54176.000 - global_seqlen/minmax_diff:5407.000 - global_seqlen/balanced_min:51105.000 - global_seqlen/balanced_max:51106.000 - global_seqlen/mean:51105.625 - actor/entropy_loss:0.439 - actor/kl_loss:0.195 - actor/kl_coef:0.001 - actor/pg_loss:0.017 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.722 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:43.654 - perf/max_memory_reserved_gb:56.830 - perf/cpu_memory_used_gb:51.877 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.594 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.594 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.594 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.594 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.594 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.594 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.554 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.554 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:2.041 - critic/advantages/min:-2.041 - critic/returns/mean:-0.004 - critic/returns/max:2.041 - critic/returns/min:-2.041 - response_length/mean:218.569 - response_length/max:665.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.781 - prompt_length/max:498.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.780 - timing_s/old_log_prob:5.650 - timing_s/ref:6.010 - timing_s/adv:0.304 - timing_s/update_actor:35.588 - timing_s/testing:129.408 - timing_s/save_checkpoint:24.634 - timing_s/step:222.406 - timing_per_token_ms/ref:0.015 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/update_actor:0.087 - timing_per_token_ms/adv:0.001 - perf/total_num_tokens:408845.000 - perf/time_per_step:222.406 - perf/throughput:229.785
[36m(TaskRunner pid=1923599)[0m ("Final validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(1.5943682013785618), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(1.5943682013785618), '
[36m(TaskRunner pid=1923599)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(1.5943682013785618), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': np.float64(1.594368196876479), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(1.594368196876479), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(4.1928914985843585e-17), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(1.594368196876479), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=1923599)[0m  'np.float64(4.1928914985843585e-17), '
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=1923599)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/model_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1932618)[0m [rank-2]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_132/actor/extra_state_world_size_8_rank_2.pt[32m [repeated 7x across cluster][0m
[33m(raylet)[0m A worker died or was killed while executing a task by an unexpected system error. To troubleshoot the problem, check the logs for the dead worker. RayTask ID: ffffffffffffffff42c785a96331935c7151e35801000000 Worker ID: 1f6d1d78d3b3e13fb63ccdf87e8550dcecd801a0886ca6dd4455433d Node ID: 6153db947e35e5b7c000523cb466fe46c4bcd319c2539cc5c9db5d62 Worker IP address: 222.29.51.203 Worker port: 44417 Worker PID: 1932615 Worker exit type: SYSTEM_ERROR Worker exit detail: Worker exits unexpectedly by a signal. SystemExit is raised (sys.exit is called). Exit code: 1. The process receives a SIGTERM.
