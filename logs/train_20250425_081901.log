2025-04-25 08:19:08,059	INFO worker.py:1832 -- Started a local Ray instance. View the dashboard at [1m[32m127.0.0.1:8265 [39m[22m
[36m(TaskRunner pid=1464402)[0m {'actor_rollout_ref': {'actor': {'checkpoint': {'contents': ['model',
[36m(TaskRunner pid=1464402)[0m                                                              'optimizer',
[36m(TaskRunner pid=1464402)[0m                                                              'extra']},
[36m(TaskRunner pid=1464402)[0m                                  'clip_ratio': 0.2,
[36m(TaskRunner pid=1464402)[0m                                  'clip_ratio_c': 3.0,
[36m(TaskRunner pid=1464402)[0m                                  'clip_ratio_high': 0.2,
[36m(TaskRunner pid=1464402)[0m                                  'clip_ratio_low': 0.2,
[36m(TaskRunner pid=1464402)[0m                                  'entropy_coeff': 0,
[36m(TaskRunner pid=1464402)[0m                                  'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1464402)[0m                                                  'optimizer_offload': False,
[36m(TaskRunner pid=1464402)[0m                                                  'param_offload': False,
[36m(TaskRunner pid=1464402)[0m                                                  'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1464402)[0m                                  'grad_clip': 1.0,
[36m(TaskRunner pid=1464402)[0m                                  'kl_loss_coef': 0.001,
[36m(TaskRunner pid=1464402)[0m                                  'kl_loss_type': 'low_var_kl',
[36m(TaskRunner pid=1464402)[0m                                  'loss_agg_mode': 'seq-mean-token-sum-norm',
[36m(TaskRunner pid=1464402)[0m                                  'optim': {'lr': 1e-06,
[36m(TaskRunner pid=1464402)[0m                                            'lr_warmup_steps': -1,
[36m(TaskRunner pid=1464402)[0m                                            'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1464402)[0m                                            'min_lr_ratio': None,
[36m(TaskRunner pid=1464402)[0m                                            'total_training_steps': -1,
[36m(TaskRunner pid=1464402)[0m                                            'warmup_style': 'constant',
[36m(TaskRunner pid=1464402)[0m                                            'weight_decay': 0.01},
[36m(TaskRunner pid=1464402)[0m                                  'ppo_epochs': 1,
[36m(TaskRunner pid=1464402)[0m                                  'ppo_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1464402)[0m                                  'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m                                  'ppo_micro_batch_size_per_gpu': 16,
[36m(TaskRunner pid=1464402)[0m                                  'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1464402)[0m                                  'shuffle': False,
[36m(TaskRunner pid=1464402)[0m                                  'strategy': 'fsdp',
[36m(TaskRunner pid=1464402)[0m                                  'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1464402)[0m                                  'use_dynamic_bsz': False,
[36m(TaskRunner pid=1464402)[0m                                  'use_kl_loss': False,
[36m(TaskRunner pid=1464402)[0m                                  'use_torch_compile': True},
[36m(TaskRunner pid=1464402)[0m                        'hybrid_engine': True,
[36m(TaskRunner pid=1464402)[0m                        'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1464402)[0m                                  'external_lib': None,
[36m(TaskRunner pid=1464402)[0m                                  'override_config': {},
[36m(TaskRunner pid=1464402)[0m                                  'path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1464402)[0m                                  'use_liger': False,
[36m(TaskRunner pid=1464402)[0m                                  'use_remove_padding': True},
[36m(TaskRunner pid=1464402)[0m                        'ref': {'fsdp_config': {'param_offload': True,
[36m(TaskRunner pid=1464402)[0m                                                'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1464402)[0m                                'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1464402)[0m                                'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m                                'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1464402)[0m                                'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1464402)[0m                                'strategy': 'fsdp',
[36m(TaskRunner pid=1464402)[0m                                'ulysses_sequence_parallel_size': 1},
[36m(TaskRunner pid=1464402)[0m                        'rollout': {'disable_log_stats': True,
[36m(TaskRunner pid=1464402)[0m                                    'do_sample': True,
[36m(TaskRunner pid=1464402)[0m                                    'dtype': 'bfloat16',
[36m(TaskRunner pid=1464402)[0m                                    'enable_chunked_prefill': True,
[36m(TaskRunner pid=1464402)[0m                                    'enforce_eager': True,
[36m(TaskRunner pid=1464402)[0m                                    'engine_kwargs': {'swap_space': None},
[36m(TaskRunner pid=1464402)[0m                                    'free_cache_engine': True,
[36m(TaskRunner pid=1464402)[0m                                    'gpu_memory_utilization': 0.6,
[36m(TaskRunner pid=1464402)[0m                                    'ignore_eos': False,
[36m(TaskRunner pid=1464402)[0m                                    'load_format': 'dummy_dtensor',
[36m(TaskRunner pid=1464402)[0m                                    'log_prob_max_token_len_per_gpu': 16384,
[36m(TaskRunner pid=1464402)[0m                                    'log_prob_micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m                                    'log_prob_micro_batch_size_per_gpu': 32,
[36m(TaskRunner pid=1464402)[0m                                    'log_prob_use_dynamic_bsz': False,
[36m(TaskRunner pid=1464402)[0m                                    'max_model_len': None,
[36m(TaskRunner pid=1464402)[0m                                    'max_num_batched_tokens': 8192,
[36m(TaskRunner pid=1464402)[0m                                    'max_num_seqs': 1024,
[36m(TaskRunner pid=1464402)[0m                                    'n': 6,
[36m(TaskRunner pid=1464402)[0m                                    'name': 'vllm',
[36m(TaskRunner pid=1464402)[0m                                    'prompt_length': 1024,
[36m(TaskRunner pid=1464402)[0m                                    'response_length': 1024,
[36m(TaskRunner pid=1464402)[0m                                    'temperature': 1.0,
[36m(TaskRunner pid=1464402)[0m                                    'tensor_model_parallel_size': 2,
[36m(TaskRunner pid=1464402)[0m                                    'top_k': -1,
[36m(TaskRunner pid=1464402)[0m                                    'top_p': 1,
[36m(TaskRunner pid=1464402)[0m                                    'use_fire_sampling': False,
[36m(TaskRunner pid=1464402)[0m                                    'val_kwargs': {'do_sample': False,
[36m(TaskRunner pid=1464402)[0m                                                   'n': 1,
[36m(TaskRunner pid=1464402)[0m                                                   'temperature': 0,
[36m(TaskRunner pid=1464402)[0m                                                   'top_k': -1,
[36m(TaskRunner pid=1464402)[0m                                                   'top_p': 1.0}}},
[36m(TaskRunner pid=1464402)[0m  'algorithm': {'adv_estimator': 'grpo',
[36m(TaskRunner pid=1464402)[0m                'gamma': 1.0,
[36m(TaskRunner pid=1464402)[0m                'kl_ctrl': {'horizon': 10000,
[36m(TaskRunner pid=1464402)[0m                            'kl_coef': 0,
[36m(TaskRunner pid=1464402)[0m                            'target_kl': 0.1,
[36m(TaskRunner pid=1464402)[0m DeprecationWarning: `ray.state.available_resources_per_node` is a private attribute and access will be removed in a future Ray version.
[36m(TaskRunner pid=1464402)[0m WARNING:2025-04-25 08:19:18,190:Waiting for register center actor 9vDmkO_register_center to be ready. Elapsed time: 0 seconds out of 300 seconds.
[36m(WorkerDict pid=1473401)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`
[36m(WorkerDict pid=1473401)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.
[36m(WorkerDict pid=1473404)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
[36m(TaskRunner pid=1464402)[0m                            'type': 'fixed'},
[36m(TaskRunner pid=1464402)[0m                'kl_penalty': 'kl',
[36m(TaskRunner pid=1464402)[0m                'lam': 1.0,
[36m(TaskRunner pid=1464402)[0m                'norm_adv_by_std_in_grpo': False,
[36m(TaskRunner pid=1464402)[0m                'use_kl_in_reward': False},
[36m(TaskRunner pid=1464402)[0m  'critic': {'checkpoint': {'contents': ['model', 'optimizer', 'extra']},
[36m(TaskRunner pid=1464402)[0m             'cliprange_value': 0.5,
[36m(TaskRunner pid=1464402)[0m             'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1464402)[0m             'forward_micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m             'forward_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1464402)[0m             'grad_clip': 1.0,
[36m(TaskRunner pid=1464402)[0m             'model': {'enable_gradient_checkpointing': True,
[36m(TaskRunner pid=1464402)[0m                       'external_lib': None,
[36m(TaskRunner pid=1464402)[0m                       'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1464402)[0m                                       'optimizer_offload': False,
[36m(TaskRunner pid=1464402)[0m                                       'param_offload': False,
[36m(TaskRunner pid=1464402)[0m                                       'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1464402)[0m                       'override_config': {},
[36m(TaskRunner pid=1464402)[0m                       'path': '~/models/deepseek-llm-7b-chat',
[36m(TaskRunner pid=1464402)[0m                       'tokenizer_path': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1464402)[0m                       'use_remove_padding': False},
[36m(TaskRunner pid=1464402)[0m             'optim': {'lr': 1e-05,
[36m(TaskRunner pid=1464402)[0m                       'lr_warmup_steps_ratio': 0.0,
[36m(TaskRunner pid=1464402)[0m                       'min_lr_ratio': None,
[36m(TaskRunner pid=1464402)[0m                       'total_training_steps': -1,
[36m(TaskRunner pid=1464402)[0m                       'warmup_style': 'constant',
[36m(TaskRunner pid=1464402)[0m                       'weight_decay': 0.01},
[36m(TaskRunner pid=1464402)[0m             'ppo_epochs': 1,
[36m(TaskRunner pid=1464402)[0m             'ppo_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1464402)[0m             'ppo_micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m             'ppo_micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1464402)[0m             'ppo_mini_batch_size': 64,
[36m(TaskRunner pid=1464402)[0m             'rollout_n': 6,
[36m(TaskRunner pid=1464402)[0m             'shuffle': False,
[36m(TaskRunner pid=1464402)[0m             'strategy': 'fsdp',
[36m(TaskRunner pid=1464402)[0m             'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1464402)[0m             'use_dynamic_bsz': False},
[36m(TaskRunner pid=1464402)[0m  'custom_reward_function': {'name': 'compute_score', 'path': None},
[36m(TaskRunner pid=1464402)[0m  'data': {'custom_cls': {'name': None, 'path': None},
[36m(TaskRunner pid=1464402)[0m           'filter_overlong_prompts': False,
[36m(TaskRunner pid=1464402)[0m           'filter_overlong_prompts_workers': 1,
[36m(TaskRunner pid=1464402)[0m           'image_key': 'images',
[36m(TaskRunner pid=1464402)[0m           'max_prompt_length': 1024,
[36m(TaskRunner pid=1464402)[0m           'max_response_length': 1024,
[36m(TaskRunner pid=1464402)[0m           'prompt_key': 'prompt',
[36m(TaskRunner pid=1464402)[0m           'return_raw_chat': False,
[36m(TaskRunner pid=1464402)[0m           'return_raw_input_ids': False,
[36m(TaskRunner pid=1464402)[0m           'reward_fn_key': 'data_source',
[36m(TaskRunner pid=1464402)[0m           'shuffle': True,
[36m(TaskRunner pid=1464402)[0m           'tokenizer': None,
[36m(TaskRunner pid=1464402)[0m           'train_batch_size': 128,
[36m(TaskRunner pid=1464402)[0m           'train_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/train.parquet',
[36m(TaskRunner pid=1464402)[0m           'truncation': 'error',
[36m(TaskRunner pid=1464402)[0m           'val_batch_size': 1312,
[36m(TaskRunner pid=1464402)[0m           'val_files': '/home/wangyc/verl/data/jec-qa-1-multi-choice/test.parquet',
[36m(TaskRunner pid=1464402)[0m           'video_key': 'videos'},
[36m(TaskRunner pid=1464402)[0m  'ray_init': {'num_cpus': None},
[36m(TaskRunner pid=1464402)[0m  'reward_model': {'enable': False,
[36m(TaskRunner pid=1464402)[0m                   'forward_max_token_len_per_gpu': 32768,
[36m(TaskRunner pid=1464402)[0m                   'max_length': None,
[36m(TaskRunner pid=1464402)[0m                   'micro_batch_size': None,
[36m(TaskRunner pid=1464402)[0m                   'micro_batch_size_per_gpu': None,
[36m(TaskRunner pid=1464402)[0m                   'model': {'external_lib': None,
[36m(TaskRunner pid=1464402)[0m                             'fsdp_config': {'fsdp_size': -1,
[36m(TaskRunner pid=1464402)[0m                                             'param_offload': False,
[36m(TaskRunner pid=1464402)[0m                                             'wrap_policy': {'min_num_params': 0}},
[36m(TaskRunner pid=1464402)[0m                             'input_tokenizer': '/home/wangyc/verl/Qwen/Qwen2.5-7B-Instruct',
[36m(TaskRunner pid=1464402)[0m                             'path': '~/models/FsfairX-LLaMA3-RM-v0.1',
[36m(TaskRunner pid=1464402)[0m                             'use_remove_padding': False},
[36m(TaskRunner pid=1464402)[0m                   'reward_manager': 'naive',
[36m(TaskRunner pid=1464402)[0m                   'strategy': 'fsdp',
[36m(TaskRunner pid=1464402)[0m                   'ulysses_sequence_parallel_size': 1,
[36m(TaskRunner pid=1464402)[0m                   'use_dynamic_bsz': False},
[36m(TaskRunner pid=1464402)[0m  'trainer': {'balance_batch': True,
[36m(TaskRunner pid=1464402)[0m              'critic_warmup': 0,
[36m(TaskRunner pid=1464402)[0m              'default_hdfs_dir': None,
[36m(TaskRunner pid=1464402)[0m              'default_local_dir': 'checkpoints/qwen2.5-7b-grpo-hard-mcq',
[36m(TaskRunner pid=1464402)[0m              'del_local_ckpt_after_load': False,
[36m(TaskRunner pid=1464402)[0m              'experiment_name': 'qwen2.5-7b-grpo-mcq',
[36m(TaskRunner pid=1464402)[0m              'log_val_generations': 0,
[36m(TaskRunner pid=1464402)[0m              'logger': ['console'],
[36m(TaskRunner pid=1464402)[0m              'max_actor_ckpt_to_keep': None,
[36m(TaskRunner pid=1464402)[0m              'max_critic_ckpt_to_keep': None,
[36m(TaskRunner pid=1464402)[0m              'n_gpus_per_node': 8,
[36m(TaskRunner pid=1464402)[0m              'nnodes': 1,
[36m(TaskRunner pid=1464402)[0m              'project_name': 'Lawyer-Zero',
[36m(TaskRunner pid=1464402)[0m              'ray_wait_register_center_timeout': 300,
[36m(TaskRunner pid=1464402)[0m              'resume_from_path': None,
[36m(TaskRunner pid=1464402)[0m              'resume_mode': 'auto',
[36m(TaskRunner pid=1464402)[0m              'save_freq': 50,
[36m(TaskRunner pid=1464402)[0m              'test_freq': 10,
[36m(TaskRunner pid=1464402)[0m              'total_epochs': 2,
[36m(TaskRunner pid=1464402)[0m              'total_training_steps': None,
[36m(TaskRunner pid=1464402)[0m              'val_before_train': True}}
[36m(TaskRunner pid=1464402)[0m WARNING: val_batch_size is deprecated. Validation datasets are sent to inference engines as a whole batch, which will schedule the memory themselves.
[36m(TaskRunner pid=1464402)[0m [validate_config] All configuration checks passed successfully!
[36m(TaskRunner pid=1464402)[0m dataset len: 8448
[36m(TaskRunner pid=1464402)[0m dataset len: 2113
[36m(TaskRunner pid=1464402)[0m Size of train dataloader: 66
[36m(TaskRunner pid=1464402)[0m Total training steps: 132
[36m(WorkerDict pid=1467435)[0m Model config after override: Qwen2Config {
[36m(WorkerDict pid=1473406)[0m Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.41s/it]
[36m(WorkerDict pid=1467435)[0m Flash Attention 2.0 only supports torch.float16 and torch.bfloat16 dtypes, but the current dype in Qwen2ForCausalLM is torch.float32. You should run training or inference using Automatic Mixed-Precision via the `with torch.autocast(device_type='torch_device'):` decorator, or load the model with the `torch_dtype` argument. Example: `model = AutoModel.from_pretrained("openai/whisper-tiny", attn_implementation="flash_attention_2", torch_dtype=torch.float16)`[32m [repeated 7x across cluster] (Ray deduplicates logs by default. Set RAY_DEDUP_LOGS=0 to disable log deduplication, or see https://docs.ray.io/en/master/ray-observability/user-guides/configure-logging.html#log-deduplication for more options.)[0m
[36m(WorkerDict pid=1467435)[0m You are attempting to use Flash Attention 2.0 with a model not initialized on GPU. Make sure to move the model to GPU after initializing it on CPU with `model.to('cuda')`.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473406)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.39s/it][32m [repeated 16x across cluster][0m
[36m(WorkerDict pid=1473406)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.28s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:13<00:00,  3.32s/it]
[36m(WorkerDict pid=1473406)[0m [rank7]:[W425 08:19:46.392996201 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 7]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[36m(WorkerDict pid=1473402)[0m Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.82s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .
[36m(WorkerDict pid=1467435)[0m   warnings.warn(
[36m(WorkerDict pid=1473402)[0m Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.73s/it]Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:15<00:00,  3.77s/it][32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473402)[0m [rank3]:[W425 08:19:49.685405295 ProcessGroupNCCL.cpp:4561] [PG ID 0 PG GUID 0 Rank 3]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m   "architectures": [
[36m(WorkerDict pid=1467435)[0m     "Qwen2ForCausalLM"
[36m(WorkerDict pid=1467435)[0m   ],
[36m(WorkerDict pid=1467435)[0m   "attention_dropout": 0.0,
[36m(WorkerDict pid=1467435)[0m   "eos_token_id": 151645,
[36m(WorkerDict pid=1467435)[0m   "hidden_act": "silu",
[36m(WorkerDict pid=1467435)[0m   "hidden_size": 3584,
[36m(WorkerDict pid=1467435)[0m   "initializer_range": 0.02,
[36m(WorkerDict pid=1467435)[0m   "intermediate_size": 18944,
[36m(WorkerDict pid=1467435)[0m   "max_position_embeddings": 32768,
[36m(WorkerDict pid=1467435)[0m   "max_window_layers": 28,
[36m(WorkerDict pid=1467435)[0m   "model_type": "qwen2",
[36m(WorkerDict pid=1467435)[0m   "num_attention_heads": 28,
[36m(WorkerDict pid=1467435)[0m   "num_hidden_layers": 28,
[36m(WorkerDict pid=1467435)[0m   "num_key_value_heads": 4,
[36m(WorkerDict pid=1467435)[0m   "pad_token_id": 151643,
[36m(WorkerDict pid=1467435)[0m   "rms_norm_eps": 1e-06,
[36m(WorkerDict pid=1467435)[0m   "rope_scaling": null,
[36m(WorkerDict pid=1467435)[0m   "rope_theta": 1000000.0,
[36m(WorkerDict pid=1467435)[0m   "sliding_window": 131072,
[36m(WorkerDict pid=1467435)[0m   "tie_word_embeddings": false,
[36m(WorkerDict pid=1467435)[0m   "torch_dtype": "bfloat16",
[36m(WorkerDict pid=1467435)[0m   "transformers_version": "4.51.3",
[36m(WorkerDict pid=1467435)[0m   "use_cache": true,
[36m(WorkerDict pid=1467435)[0m   "use_sliding_window": false,
[36m(WorkerDict pid=1467435)[0m   "vocab_size": 152064
[36m(WorkerDict pid=1467435)[0m }
[36m(WorkerDict pid=1467435)[0m 
[36m(WorkerDict pid=1473406)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention
[36m(WorkerDict pid=1467435)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1467435)[0m Qwen2ForCausalLM contains 7.62B parameters
[36m(WorkerDict pid=1467435)[0m wrap_policy: functools.partial(<function _or_policy at 0x7f899272a8c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7f899272a7a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])
[36m(WorkerDict pid=1473400)[0m Total steps: 132, num_warmup_steps: 0
[36m(WorkerDict pid=1473400)[0m Actor use_remove_padding=True
[36m(WorkerDict pid=1473402)[0m Monkey patch _flash_attention_forward in transformers.integrations.flash_attention[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473403)[0m wrap_policy: functools.partial(<function _or_policy at 0x7faa73ef68c0>, policies=[functools.partial(<function transformer_auto_wrap_policy at 0x7faa73ef67a0>, transformer_layer_cls={<class 'transformers.models.qwen2.modeling_qwen2.Qwen2DecoderLayer'>})])[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m Before building vllm rollout, memory allocated (GB): 3.570071220397949, memory reserved (GB): 17.36328125
[36m(WorkerDict pid=1473406)[0m WARNING 04-25 08:20:15 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used
[36m(WorkerDict pid=1467435)[0m Total steps: 132, num_warmup_steps: 0[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m Actor use_remove_padding=True[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473406)[0m WARNING 04-25 08:20:16 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f71cc1464d0>
[36m(WorkerDict pid=1473405)[0m NCCL version 2.21.5+cuda12.4
[36m(WorkerDict pid=1467435)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}
[36m(WorkerDict pid=1467435)[0m After building vllm rollout, memory allocated (GB): 20.051848888397217, memory reserved (GB): 20.453125
[36m(WorkerDict pid=1467435)[0m After building sharding manager, memory allocated (GB): 20.051848888397217, memory reserved (GB): 20.453125
[36m(WorkerDict pid=1467435)[0m WARNING 04-25 08:20:17 [cuda.py:96] To see benefits of async output processing, enable CUDA graph. Since, enforce-eager is enabled, async output processor cannot be used[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1467435)[0m WARNING 04-25 08:20:18 [utils.py:2413] Methods determine_num_available_blocks,device_config,get_cache_block_size_bytes,initialize_cache not implemented in <vllm.v1.worker.gpu_worker.Worker object at 0x7f887cf547c0>[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473403)[0m NCCL version 2.21.5+cuda12.4[32m [repeated 2x across cluster][0m
[36m(TaskRunner pid=1464402)[0m Using LocalLogger is deprecated. The constructor API will change 
[36m(TaskRunner pid=1464402)[0m Checkpoint tracker file does not exist: %s /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/latest_checkpointed_iteration.txt
[36m(TaskRunner pid=1464402)[0m Training from scratch
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(WorkerDict pid=1473403)[0m kwargs: {'n': 6, 'logprobs': 0, 'max_tokens': 1024, 'detokenize': False, 'temperature': 1.0, 'top_k': -1, 'top_p': 1, 'ignore_eos': False}[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> æœ¬é¢˜è€ƒæŸ¥å…±åŒçŠ¯ç½ªçš„è®¤å®šã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè™½ç„¶ä¸¤äººçš„æ•…æ„ä¸åŒï¼Œä½†éƒ½æ¶‰åŠçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºç¬¦åˆä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ï¼Œä¹™çš„è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚å› æ­¤ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> é€‰é¡¹Bã€Cã€Déƒ½æ˜¯æ­£ç¡®çš„ã€‚ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä½†åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚{BCD}
[36m(TaskRunner pid=1464402)[0m Training Progress:   0%|          | 0/132 [00:00<?, ?it/s]
[36m(WorkerDict pid=1473403)[0m /home/wangyc/miniconda3/envs/verl/lib/python3.10/site-packages/torch/distributed/fsdp/fully_sharded_data_parallel.py:690: FutureWarning: FSDP.state_dict_type() and FSDP.set_state_dict_type() are being deprecated. Please use APIs, get_state_dict() and set_state_dict(), which can support different parallelisms, FSDP1, FSDP2, DDP. API doc: https://pytorch.org/docs/stable/distributed.checkpoint.html#torch.distributed.checkpoint.state_dict.get_state_dict .Tutorial: https://pytorch.org/tutorials/recipes/distributed_checkpoint_recipe.html .[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473403)[0m   warnings.warn([32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1464402)[0m Training Progress:   1%|          | 1/132 [01:08<2:28:38, 68.08s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   2%|â–         | 2/132 [02:16<2:27:51, 68.24s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   2%|â–         | 3/132 [03:24<2:26:40, 68.22s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   3%|â–         | 4/132 [04:32<2:25:11, 68.06s/it]
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 1.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 0.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m ("Initial validation metrics: {'val-core/jec-qa-1-multi-choice/reward/mean@1': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/reward/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1464402)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/mean': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1464402)[0m  "'val-core/jec-qa-1-multi-choice/reward/best@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/mean': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(0.8994320913500488), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/reward/worst@1/std': np.float64(0.0), "
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/mean@1': np.float64(0.899432087079981), "
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/std@1': np.float64(0.0), "
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/mean': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(0.899432087079981), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/best@1/std': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(4.12852693610609e-17), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/mean': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(0.899432087079981), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/score/worst@1/std': "
[36m(TaskRunner pid=1464402)[0m  'np.float64(4.12852693610609e-17), '
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score@1': np.float64(0.0), "
[36m(TaskRunner pid=1464402)[0m  "'val-aux/jec-qa-1-multi-choice/extra_info/score/std@1': np.float64(0.0)}")
[36m(TaskRunner pid=1464402)[0m step:0 - val-core/jec-qa-1-multi-choice/reward/mean@1:0.899 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:0.899 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:0.899 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:0.899 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:1 - global_seqlen/min:57077.000 - global_seqlen/max:61927.000 - global_seqlen/minmax_diff:4850.000 - global_seqlen/balanced_min:59187.000 - global_seqlen/balanced_max:59188.000 - global_seqlen/mean:59187.375 - actor/entropy_loss:279.365 - actor/pg_loss:0.179 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:3.026 - perf/mfu/actor:0.417 - perf/max_memory_allocated_gb:46.025 - perf/max_memory_reserved_gb:59.434 - perf/cpu_memory_used_gb:40.799 - actor/lr:0.000 - critic/score/mean:0.811 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.811 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.500 - critic/advantages/min:-1.333 - critic/returns/mean:-0.005 - critic/returns/max:1.500 - critic/returns/min:-1.333 - response_length/mean:312.270 - response_length/max:834.000 - response_length/min:103.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.266 - prompt_length/max:471.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.294 - timing_s/old_log_prob:6.554 - timing_s/adv:0.307 - timing_s/update_actor:36.471 - timing_s/step:67.649 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.077 - perf/total_num_tokens:473499.000 - perf/time_per_step:67.649 - perf/throughput:874.920
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:2 - global_seqlen/min:57249.000 - global_seqlen/max:63404.000 - global_seqlen/minmax_diff:6155.000 - global_seqlen/balanced_min:59924.000 - global_seqlen/balanced_max:59924.000 - global_seqlen/mean:59924.000 - actor/entropy_loss:289.871 - actor/pg_loss:0.023 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.305 - perf/mfu/actor:0.405 - perf/max_memory_allocated_gb:46.845 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.071 - actor/lr:0.000 - critic/score/mean:0.810 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:0.810 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:1.500 - critic/advantages/min:-1.517 - critic/returns/mean:-0.002 - critic/returns/max:1.500 - critic/returns/min:-1.517 - response_length/mean:319.029 - response_length/max:721.000 - response_length/min:119.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.180 - prompt_length/max:521.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.657 - timing_s/old_log_prob:6.367 - timing_s/adv:0.314 - timing_s/update_actor:37.988 - timing_s/step:68.344 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:479392.000 - perf/time_per_step:68.344 - perf/throughput:876.795
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:3 - global_seqlen/min:57627.000 - global_seqlen/max:60635.000 - global_seqlen/minmax_diff:3008.000 - global_seqlen/balanced_min:59052.000 - global_seqlen/balanced_max:59053.000 - global_seqlen/mean:59052.250 - actor/entropy_loss:267.841 - actor/pg_loss:-0.015 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:2.923 - perf/mfu/actor:0.405 - perf/max_memory_allocated_gb:46.845 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:39.871 - actor/lr:0.000 - critic/score/mean:1.053 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.053 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:1.500 - critic/advantages/min:-1.583 - critic/returns/mean:-0.005 - critic/returns/max:1.500 - critic/returns/min:-1.583 - response_length/mean:312.714 - response_length/max:779.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.414 - prompt_length/max:491.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.013 - timing_s/old_log_prob:6.347 - timing_s/adv:0.303 - timing_s/update_actor:37.507 - timing_s/step:68.188 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:472418.000 - perf/time_per_step:68.188 - perf/throughput:866.019
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:   4%|â–         | 5/132 [05:41<2:25:11, 68.59s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   5%|â–         | 6/132 [06:50<2:23:52, 68.51s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   5%|â–Œ         | 7/132 [08:00<2:23:45, 69.00s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   6%|â–Œ         | 8/132 [09:10<2:23:37, 69.50s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   7%|â–‹         | 9/132 [10:19<2:21:52, 69.21s/it]
[36m(TaskRunner pid=1464402)[0m step:4 - global_seqlen/min:55374.000 - global_seqlen/max:60761.000 - global_seqlen/minmax_diff:5387.000 - global_seqlen/balanced_min:58390.000 - global_seqlen/balanced_max:58391.000 - global_seqlen/mean:58390.375 - actor/entropy_loss:268.657 - actor/pg_loss:-0.251 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.986 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:47.089 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:39.993 - actor/lr:0.000 - critic/score/mean:1.255 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.255 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:1.450 - critic/advantages/min:-1.333 - critic/returns/mean:0.002 - critic/returns/max:1.450 - critic/returns/min:-1.333 - response_length/mean:302.600 - response_length/max:719.000 - response_length/min:112.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.633 - prompt_length/max:513.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.266 - timing_s/old_log_prob:6.346 - timing_s/adv:0.301 - timing_s/update_actor:37.849 - timing_s/step:67.782 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:467123.000 - perf/time_per_step:67.782 - perf/throughput:861.438
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:5 - global_seqlen/min:55860.000 - global_seqlen/max:64651.000 - global_seqlen/minmax_diff:8791.000 - global_seqlen/balanced_min:59921.000 - global_seqlen/balanced_max:59922.000 - global_seqlen/mean:59921.875 - actor/entropy_loss:258.539 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.411 - perf/mfu/actor:0.406 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.276 - actor/lr:0.000 - critic/score/mean:1.280 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.280 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.967 - critic/advantages/min:-1.667 - critic/returns/mean:-0.006 - critic/returns/max:0.967 - critic/returns/min:-1.667 - response_length/mean:316.022 - response_length/max:778.000 - response_length/min:122.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.164 - prompt_length/max:499.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.714 - timing_s/old_log_prob:6.569 - timing_s/adv:0.309 - timing_s/update_actor:37.897 - timing_s/step:69.506 - timing_per_token_ms/gen:0.102 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:479375.000 - perf/time_per_step:69.506 - perf/throughput:862.116
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:6 - global_seqlen/min:57711.000 - global_seqlen/max:62150.000 - global_seqlen/minmax_diff:4439.000 - global_seqlen/balanced_min:59893.000 - global_seqlen/balanced_max:59894.000 - global_seqlen/mean:59893.875 - actor/entropy_loss:255.189 - actor/pg_loss:-0.001 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.419 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.145 - actor/lr:0.000 - critic/score/mean:1.370 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.370 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.850 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.850 - response_length/mean:311.582 - response_length/max:737.000 - response_length/min:136.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.312 - prompt_length/max:547.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.435 - timing_s/old_log_prob:6.521 - timing_s/adv:0.308 - timing_s/update_actor:38.058 - timing_s/step:68.341 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:479151.000 - perf/time_per_step:68.341 - perf/throughput:876.391
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:7 - global_seqlen/min:56940.000 - global_seqlen/max:63651.000 - global_seqlen/minmax_diff:6711.000 - global_seqlen/balanced_min:60391.000 - global_seqlen/balanced_max:60392.000 - global_seqlen/mean:60391.500 - actor/entropy_loss:258.846 - actor/pg_loss:0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.300 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.264 - actor/lr:0.000 - critic/score/mean:1.339 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.339 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:319.109 - response_length/max:798.000 - response_length/min:129.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.969 - prompt_length/max:505.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.129 - timing_s/old_log_prob:6.630 - timing_s/adv:0.310 - timing_s/update_actor:37.898 - timing_s/step:69.988 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - perf/total_num_tokens:483132.000 - perf/time_per_step:69.988 - perf/throughput:862.880
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:8 - global_seqlen/min:57657.000 - global_seqlen/max:60916.000 - global_seqlen/minmax_diff:3259.000 - global_seqlen/balanced_min:59108.000 - global_seqlen/balanced_max:59180.000 - global_seqlen/mean:59117.000 - actor/entropy_loss:244.513 - actor/pg_loss:0.219 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.457 - perf/mfu/actor:0.408 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.266 - actor/lr:0.000 - critic/score/mean:1.366 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.366 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.950 - critic/advantages/min:-1.050 - critic/returns/mean:0.002 - critic/returns/max:0.950 - critic/returns/min:-1.050 - response_length/mean:315.161 - response_length/max:934.000 - response_length/min:126.000 - response_length/clip_ratio:0.000 - prompt_length/mean:300.641 - prompt_length/max:446.000 - prompt_length/min:200.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.469 - timing_s/old_log_prob:6.496 - timing_s/adv:0.300 - timing_s/update_actor:37.243 - timing_s/step:70.536 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:472936.000 - perf/time_per_step:70.536 - perf/throughput:838.116
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:   8%|â–Š         | 10/132 [13:47<3:47:36, 111.94s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:   8%|â–Š         | 11/132 [14:54<3:18:08, 98.26s/it] 
[36m(TaskRunner pid=1464402)[0m step:9 - global_seqlen/min:58221.000 - global_seqlen/max:63455.000 - global_seqlen/minmax_diff:5234.000 - global_seqlen/balanced_min:61025.000 - global_seqlen/balanced_max:61026.000 - global_seqlen/mean:61025.250 - actor/entropy_loss:244.506 - actor/pg_loss:-0.190 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.194 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.309 - actor/lr:0.000 - critic/score/mean:1.375 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.375 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:320.328 - response_length/max:675.000 - response_length/min:141.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.352 - prompt_length/max:514.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.224 - timing_s/old_log_prob:6.609 - timing_s/adv:0.317 - timing_s/update_actor:38.377 - timing_s/step:68.544 - timing_per_token_ms/gen:0.094 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:488202.000 - perf/time_per_step:68.544 - perf/throughput:890.303
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨æœ¬é¢˜ä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æŒ‡å‘çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹Aï¼šç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯é”™è¯¯çš„ï¼Œå› ä¸ºè™½ç„¶ä»–ä»¬çš„æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹Bï¼šç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œå¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹Cï¼šå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºç”²æŸçš„æ•…æ„æ˜¯ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹Dï¼šå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚è¿™ä¸ªé€‰é¡¹æ˜¯æ­£ç¡®çš„ï¼Œå› ä¸ºä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œæ ¹æ®å…¶æ•…æ„ï¼Œåº”ä»¥è¯¥ç½ªåè®ºå¤„ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m step:10 - global_seqlen/min:59218.000 - global_seqlen/max:66960.000 - global_seqlen/minmax_diff:7742.000 - global_seqlen/balanced_min:61802.000 - global_seqlen/balanced_max:61803.000 - global_seqlen/mean:61802.625 - actor/entropy_loss:252.036 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.158 - perf/mfu/actor:0.420 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.765 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.376 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.376 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.376 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.376 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.376 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.376 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.294 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.294 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.003 - critic/advantages/max:1.000 - critic/advantages/min:-1.667 - critic/returns/mean:-0.003 - critic/returns/max:1.000 - critic/returns/min:-1.667 - response_length/mean:324.137 - response_length/max:725.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.641 - prompt_length/max:640.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.232 - timing_s/old_log_prob:6.661 - timing_s/adv:0.311 - timing_s/update_actor:37.845 - timing_s/testing:139.515 - timing_s/step:207.585 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.077 - perf/total_num_tokens:494421.000 - perf/time_per_step:207.585 - perf/throughput:297.723
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:   9%|â–‰         | 12/132 [16:03<2:58:39, 89.33s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  10%|â–‰         | 13/132 [17:09<2:43:28, 82.42s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  11%|â–ˆ         | 14/132 [18:18<2:34:09, 78.38s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  11%|â–ˆâ–        | 15/132 [19:32<2:30:20, 77.10s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  12%|â–ˆâ–        | 16/132 [20:39<2:23:07, 74.03s/it]
[36m(TaskRunner pid=1464402)[0m step:11 - global_seqlen/min:57747.000 - global_seqlen/max:65724.000 - global_seqlen/minmax_diff:7977.000 - global_seqlen/balanced_min:60916.000 - global_seqlen/balanced_max:60922.000 - global_seqlen/mean:60917.250 - actor/entropy_loss:246.618 - actor/pg_loss:0.026 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.507 - perf/mfu/actor:0.411 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.482 - actor/lr:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:320.820 - response_length/max:691.000 - response_length/min:136.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.734 - prompt_length/max:613.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.310 - timing_s/old_log_prob:6.480 - timing_s/adv:0.309 - timing_s/update_actor:38.095 - timing_s/step:67.216 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - perf/total_num_tokens:487338.000 - perf/time_per_step:67.216 - perf/throughput:906.288
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:12 - global_seqlen/min:55761.000 - global_seqlen/max:64321.000 - global_seqlen/minmax_diff:8560.000 - global_seqlen/balanced_min:60603.000 - global_seqlen/balanced_max:60604.000 - global_seqlen/mean:60603.375 - actor/entropy_loss:234.526 - actor/pg_loss:-0.063 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.243 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.497 - actor/lr:0.000 - critic/score/mean:1.347 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.347 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-1.167 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-1.167 - response_length/mean:311.480 - response_length/max:755.000 - response_length/min:138.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.805 - prompt_length/max:647.000 - prompt_length/min:191.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.942 - timing_s/old_log_prob:6.504 - timing_s/adv:0.305 - timing_s/update_actor:38.110 - timing_s/step:68.878 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:484827.000 - perf/time_per_step:68.878 - perf/throughput:879.866
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:13 - global_seqlen/min:57815.000 - global_seqlen/max:63792.000 - global_seqlen/minmax_diff:5977.000 - global_seqlen/balanced_min:60120.000 - global_seqlen/balanced_max:60121.000 - global_seqlen/mean:60120.500 - actor/entropy_loss:234.521 - actor/pg_loss:0.100 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.241 - perf/mfu/actor:0.409 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.018 - perf/cpu_memory_used_gb:40.531 - actor/lr:0.000 - critic/score/mean:1.357 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.357 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.983 - critic/advantages/min:-1.083 - critic/returns/mean:-0.002 - critic/returns/max:0.983 - critic/returns/min:-1.083 - response_length/mean:316.208 - response_length/max:637.000 - response_length/min:133.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.047 - prompt_length/max:509.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.883 - timing_s/old_log_prob:6.520 - timing_s/adv:0.306 - timing_s/update_actor:37.785 - timing_s/step:66.515 - timing_per_token_ms/gen:0.090 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:480964.000 - perf/time_per_step:66.515 - perf/throughput:903.865
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:14 - global_seqlen/min:56621.000 - global_seqlen/max:62350.000 - global_seqlen/minmax_diff:5729.000 - global_seqlen/balanced_min:59373.000 - global_seqlen/balanced_max:59374.000 - global_seqlen/mean:59373.375 - actor/entropy_loss:222.423 - actor/pg_loss:0.007 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.242 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:48.257 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.460 - actor/lr:0.000 - critic/score/mean:1.363 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.363 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:313.871 - response_length/max:761.000 - response_length/min:130.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.602 - prompt_length/max:614.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.586 - timing_s/old_log_prob:6.625 - timing_s/adv:0.303 - timing_s/update_actor:38.495 - timing_s/step:69.033 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:474987.000 - perf/time_per_step:69.033 - perf/throughput:860.073
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:15 - global_seqlen/min:58218.000 - global_seqlen/max:63202.000 - global_seqlen/minmax_diff:4984.000 - global_seqlen/balanced_min:60785.000 - global_seqlen/balanced_max:60903.000 - global_seqlen/mean:60799.750 - actor/entropy_loss:240.877 - actor/pg_loss:0.117 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.425 - perf/mfu/actor:0.404 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.485 - actor/lr:0.000 - critic/score/mean:1.411 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.411 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:0.833 - critic/advantages/min:-1.350 - critic/returns/mean:-0.007 - critic/returns/max:0.833 - critic/returns/min:-1.350 - response_length/mean:321.409 - response_length/max:1024.000 - response_length/min:126.000 - response_length/clip_ratio:0.001 - prompt_length/mean:311.922 - prompt_length/max:562.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:28.576 - timing_s/old_log_prob:6.523 - timing_s/adv:0.307 - timing_s/update_actor:38.679 - timing_s/step:74.102 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:486398.000 - perf/time_per_step:74.102 - perf/throughput:820.484
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  13%|â–ˆâ–        | 17/132 [21:46<2:17:48, 71.90s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  14%|â–ˆâ–        | 18/132 [22:51<2:12:44, 69.86s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  14%|â–ˆâ–        | 19/132 [24:01<2:11:26, 69.79s/it]
[36m(TaskRunner pid=1464402)[0m step:16 - global_seqlen/min:57741.000 - global_seqlen/max:62838.000 - global_seqlen/minmax_diff:5097.000 - global_seqlen/balanced_min:59951.000 - global_seqlen/balanced_max:59952.000 - global_seqlen/mean:59951.125 - actor/entropy_loss:227.491 - actor/pg_loss:0.158 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.292 - perf/mfu/actor:0.402 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.546 - actor/lr:0.000 - critic/score/mean:1.368 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.368 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:312.780 - response_length/max:590.000 - response_length/min:120.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.711 - prompt_length/max:820.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.866 - timing_s/old_log_prob:6.417 - timing_s/adv:0.305 - timing_s/update_actor:38.272 - timing_s/step:66.880 - timing_per_token_ms/gen:0.091 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:479609.000 - perf/time_per_step:66.880 - perf/throughput:896.398
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:17 - global_seqlen/min:56262.000 - global_seqlen/max:62772.000 - global_seqlen/minmax_diff:6510.000 - global_seqlen/balanced_min:59018.000 - global_seqlen/balanced_max:59019.000 - global_seqlen/mean:59018.250 - actor/entropy_loss:214.244 - actor/pg_loss:-0.028 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.265 - perf/mfu/actor:0.398 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.574 - actor/lr:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:0.100 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:0.100 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-1.117 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-1.117 - response_length/mean:303.102 - response_length/max:646.000 - response_length/min:123.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:798.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.108 - timing_s/old_log_prob:6.360 - timing_s/adv:0.303 - timing_s/update_actor:38.104 - timing_s/step:66.895 - timing_per_token_ms/gen:0.095 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:472146.000 - perf/time_per_step:66.895 - perf/throughput:882.255
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:18 - global_seqlen/min:57466.000 - global_seqlen/max:61910.000 - global_seqlen/minmax_diff:4444.000 - global_seqlen/balanced_min:59260.000 - global_seqlen/balanced_max:59261.000 - global_seqlen/mean:59260.250 - actor/entropy_loss:216.028 - actor/pg_loss:0.232 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.231 - perf/mfu/actor:0.412 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.755 - actor/lr:0.000 - critic/score/mean:1.424 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.424 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:304.755 - response_length/max:579.000 - response_length/min:116.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.539 - prompt_length/max:574.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.436 - timing_s/old_log_prob:6.351 - timing_s/adv:0.303 - timing_s/update_actor:36.997 - timing_s/step:65.108 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - perf/total_num_tokens:474082.000 - perf/time_per_step:65.108 - perf/throughput:910.185
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:19 - global_seqlen/min:57302.000 - global_seqlen/max:65257.000 - global_seqlen/minmax_diff:7955.000 - global_seqlen/balanced_min:59934.000 - global_seqlen/balanced_max:59935.000 - global_seqlen/mean:59934.250 - actor/entropy_loss:214.354 - actor/pg_loss:-0.344 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.102 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.125 - perf/cpu_memory_used_gb:40.570 - actor/lr:0.000 - critic/score/mean:1.382 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.382 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:316.096 - response_length/max:762.000 - response_length/min:115.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.219 - prompt_length/max:638.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:24.036 - timing_s/old_log_prob:6.495 - timing_s/adv:0.306 - timing_s/update_actor:38.754 - timing_s/step:69.610 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:479474.000 - perf/time_per_step:69.610 - perf/throughput:860.996
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m Training Progress:  15%|â–ˆâ–Œ        | 20/132 [27:26<3:26:09, 110.44s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  16%|â–ˆâ–Œ        | 21/132 [28:33<3:00:04, 97.34s/it] 
[36m(TaskRunner pid=1464402)[0m Training Progress:  17%|â–ˆâ–‹        | 22/132 [29:39<2:41:00, 87.82s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  17%|â–ˆâ–‹        | 23/132 [30:47<2:28:45, 81.88s/it]
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦æ»¡è¶³å…±åŒçš„çŠ¯ç½ªæ•…æ„å’Œå…±åŒçš„è¡Œä¸ºã€‚åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ˜¯ä¸ºäº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè¿™åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ã€‚å› æ­¤ï¼Œä»–ä»¬å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™æŸçš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºç›®æ ‡æ˜¯ä¸€è‡´çš„ï¼Œå³è·å–å›½å®¶ç§˜å¯†ã€‚å› æ­¤ï¼Œç”²æŸå’Œä¹™æŸçš„è¡Œä¸ºå¯ä»¥è¢«è®¤å®šä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Aé”™è¯¯ï¼Œå› ä¸ºç”²ä¹™è™½ç„¶æ•…æ„ä¸åŒï¼Œä½†å¯ä»¥åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚é€‰é¡¹Bæ­£ç¡®ã€‚å¯¹äºç”²æŸï¼Œè™½ç„¶ä»–çš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œä½†æ ¹æ®åˆ‘æ³•çš„è§„å®šï¼Œè¿™ç§è¡Œä¸ºå¯ä»¥è¢«è®¤å®šä¸ºéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œå› æ­¤é€‰é¡¹Cé”™è¯¯ã€‚å¯¹äºä¹™æŸï¼Œä»–çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œå› æ­¤é€‰é¡¹Dæ­£ç¡®ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæ­£ç¡®çš„é€‰é¡¹æ˜¯Bå’ŒDã€‚
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 1.1
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 0.09999999999999998}
[36m(TaskRunner pid=1464402)[0m step:20 - global_seqlen/min:56565.000 - global_seqlen/max:62132.000 - global_seqlen/minmax_diff:5567.000 - global_seqlen/balanced_min:59563.000 - global_seqlen/balanced_max:59564.000 - global_seqlen/mean:59563.875 - actor/entropy_loss:206.811 - actor/pg_loss:-0.225 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.349 - perf/mfu/actor:0.402 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.527 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.434 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.434 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.434 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.434 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.434 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.434 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.378 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.378 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:309.926 - response_length/max:665.000 - response_length/min:112.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.531 - prompt_length/max:516.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.987 - timing_s/old_log_prob:6.485 - timing_s/adv:0.311 - timing_s/update_actor:38.096 - timing_s/testing:138.247 - timing_s/step:205.145 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:476511.000 - perf/time_per_step:205.145 - perf/throughput:290.350
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:21 - global_seqlen/min:56680.000 - global_seqlen/max:61968.000 - global_seqlen/minmax_diff:5288.000 - global_seqlen/balanced_min:59628.000 - global_seqlen/balanced_max:59628.000 - global_seqlen/mean:59628.000 - actor/entropy_loss:204.522 - actor/pg_loss:0.056 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.297 - perf/mfu/actor:0.401 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.570 - actor/lr:0.000 - critic/score/mean:1.398 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.398 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-1.500 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-1.500 - response_length/mean:307.289 - response_length/max:674.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.836 - prompt_length/max:555.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.809 - timing_s/old_log_prob:6.410 - timing_s/adv:0.301 - timing_s/update_actor:38.208 - timing_s/step:66.757 - timing_per_token_ms/gen:0.092 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.080 - perf/total_num_tokens:477024.000 - perf/time_per_step:66.757 - perf/throughput:893.208
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:22 - global_seqlen/min:56906.000 - global_seqlen/max:60237.000 - global_seqlen/minmax_diff:3331.000 - global_seqlen/balanced_min:58037.000 - global_seqlen/balanced_max:58037.000 - global_seqlen/mean:58037.000 - actor/entropy_loss:190.679 - actor/pg_loss:-0.089 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.264 - perf/mfu/actor:0.395 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.548 - actor/lr:0.000 - critic/score/mean:1.416 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.416 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:296.521 - response_length/max:599.000 - response_length/min:110.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.031 - prompt_length/max:480.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.265 - timing_s/old_log_prob:6.279 - timing_s/adv:0.295 - timing_s/update_actor:37.749 - timing_s/step:65.606 - timing_per_token_ms/gen:0.093 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:464296.000 - perf/time_per_step:65.606 - perf/throughput:884.628
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  18%|â–ˆâ–Š        | 24/132 [31:51<2:17:46, 76.54s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  19%|â–ˆâ–‰        | 25/132 [32:56<2:10:22, 73.11s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  20%|â–ˆâ–‰        | 26/132 [34:00<2:04:27, 70.45s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  20%|â–ˆâ–ˆ        | 27/132 [35:06<2:00:47, 69.02s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  21%|â–ˆâ–ˆ        | 28/132 [36:09<1:56:26, 67.18s/it]
[36m(TaskRunner pid=1464402)[0m step:23 - global_seqlen/min:54122.000 - global_seqlen/max:64183.000 - global_seqlen/minmax_diff:10061.000 - global_seqlen/balanced_min:59216.000 - global_seqlen/balanced_max:59217.000 - global_seqlen/mean:59216.500 - actor/entropy_loss:190.052 - actor/pg_loss:-0.088 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.206 - perf/mfu/actor:0.396 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.560 - actor/lr:0.000 - critic/score/mean:1.396 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.396 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.900 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.900 - response_length/mean:293.557 - response_length/max:677.000 - response_length/min:89.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.281 - prompt_length/max:511.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.700 - timing_s/old_log_prob:6.518 - timing_s/adv:0.303 - timing_s/update_actor:38.472 - timing_s/step:68.016 - timing_per_token_ms/gen:0.101 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:473732.000 - perf/time_per_step:68.016 - perf/throughput:870.630
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:24 - global_seqlen/min:54498.000 - global_seqlen/max:59614.000 - global_seqlen/minmax_diff:5116.000 - global_seqlen/balanced_min:56928.000 - global_seqlen/balanced_max:56929.000 - global_seqlen/mean:56928.375 - actor/entropy_loss:169.687 - actor/pg_loss:-0.102 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.111 - perf/mfu/actor:0.397 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.664 - actor/lr:0.000 - critic/score/mean:1.402 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.402 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:280.770 - response_length/max:574.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.234 - prompt_length/max:798.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.671 - timing_s/old_log_prob:6.251 - timing_s/adv:0.292 - timing_s/update_actor:36.813 - timing_s/step:64.051 - timing_per_token_ms/gen:0.096 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.081 - perf/total_num_tokens:455427.000 - perf/time_per_step:64.051 - perf/throughput:888.796
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:25 - global_seqlen/min:56292.000 - global_seqlen/max:62813.000 - global_seqlen/minmax_diff:6521.000 - global_seqlen/balanced_min:58751.000 - global_seqlen/balanced_max:58752.000 - global_seqlen/mean:58751.500 - actor/entropy_loss:183.379 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.127 - perf/mfu/actor:0.412 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.750 - actor/lr:0.000 - critic/score/mean:1.345 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.345 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:290.385 - response_length/max:657.000 - response_length/min:109.000 - response_length/clip_ratio:0.000 - prompt_length/mean:321.609 - prompt_length/max:561.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.771 - timing_s/old_log_prob:6.316 - timing_s/adv:0.301 - timing_s/update_actor:36.664 - timing_s/step:65.071 - timing_per_token_ms/gen:0.098 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.078 - perf/total_num_tokens:470012.000 - perf/time_per_step:65.071 - perf/throughput:902.880
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:26 - global_seqlen/min:54329.000 - global_seqlen/max:65228.000 - global_seqlen/minmax_diff:10899.000 - global_seqlen/balanced_min:58350.000 - global_seqlen/balanced_max:58351.000 - global_seqlen/mean:58350.250 - actor/entropy_loss:163.709 - actor/pg_loss:0.037 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.241 - perf/mfu/actor:0.408 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.860 - actor/lr:0.000 - critic/score/mean:1.428 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.428 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:279.729 - response_length/max:605.000 - response_length/min:104.000 - response_length/clip_ratio:0.000 - prompt_length/mean:328.086 - prompt_length/max:765.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.833 - timing_s/old_log_prob:6.287 - timing_s/adv:0.297 - timing_s/update_actor:36.771 - timing_s/step:64.211 - timing_per_token_ms/gen:0.097 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.079 - perf/total_num_tokens:466802.000 - perf/time_per_step:64.211 - perf/throughput:908.731
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:27 - global_seqlen/min:53406.000 - global_seqlen/max:59992.000 - global_seqlen/minmax_diff:6586.000 - global_seqlen/balanced_min:56247.000 - global_seqlen/balanced_max:56247.000 - global_seqlen/mean:56247.000 - actor/entropy_loss:159.832 - actor/pg_loss:0.082 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.209 - perf/mfu/actor:0.390 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.748 - actor/lr:0.000 - critic/score/mean:1.423 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.423 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:276.984 - response_length/max:693.000 - response_length/min:94.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.922 - prompt_length/max:551.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.181 - timing_s/old_log_prob:6.149 - timing_s/adv:0.290 - timing_s/update_actor:37.047 - timing_s/step:65.687 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:449976.000 - perf/time_per_step:65.687 - perf/throughput:856.294
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  22%|â–ˆâ–ˆâ–       | 29/132 [37:13<1:53:56, 66.37s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 30/132 [40:30<2:59:21, 105.51s/it]
[36m(TaskRunner pid=1464402)[0m step:28 - global_seqlen/min:50163.000 - global_seqlen/max:57294.000 - global_seqlen/minmax_diff:7131.000 - global_seqlen/balanced_min:53750.000 - global_seqlen/balanced_max:53751.000 - global_seqlen/mean:53750.500 - actor/entropy_loss:151.787 - actor/pg_loss:-0.142 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.198 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.825 - actor/lr:0.000 - critic/score/mean:1.432 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.432 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:262.464 - response_length/max:596.000 - response_length/min:59.000 - response_length/clip_ratio:0.000 - prompt_length/mean:297.438 - prompt_length/max:536.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.115 - timing_s/old_log_prob:5.922 - timing_s/adv:0.287 - timing_s/update_actor:36.500 - timing_s/step:62.846 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:430004.000 - perf/time_per_step:62.846 - perf/throughput:855.276
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:29 - global_seqlen/min:50979.000 - global_seqlen/max:58838.000 - global_seqlen/minmax_diff:7859.000 - global_seqlen/balanced_min:55667.000 - global_seqlen/balanced_max:55668.000 - global_seqlen/mean:55667.375 - actor/entropy_loss:147.560 - actor/pg_loss:0.134 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.995 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.872 - actor/lr:0.000 - critic/score/mean:1.386 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.386 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:269.150 - response_length/max:578.000 - response_length/min:78.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.719 - prompt_length/max:548.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.377 - timing_s/old_log_prob:6.283 - timing_s/adv:0.290 - timing_s/update_actor:37.483 - timing_s/step:64.457 - timing_per_token_ms/gen:0.099 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:445339.000 - perf/time_per_step:64.457 - perf/throughput:863.641
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚å…±åŒçŠ¯ç½ªçš„æˆç«‹éœ€è¦å…±åŒçš„çŠ¯ç½ªæ•…æ„ã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œè€Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¸¤äººçš„æ•…æ„å†…å®¹ä¸åŒã€‚ä½†æ˜¯ï¼Œä»–ä»¬å…±åŒå®æ–½äº†çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„è¡Œä¸ºï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…ï¼Œä»–ä»¬å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚å¯¹äºç”²æŸï¼Œç”±äºå…¶è¡Œä¸ºå¯èƒ½è§¦çŠ¯äº†æ›´ä¸ºä¸¥é‡çš„ç½ªåï¼Œå³ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªï¼Œå› æ­¤åº”å½“æŒ‰ç…§æ›´ä¸ºä¸¥é‡çš„ç½ªåå®šç½ªå¤„ç½šã€‚å¯¹äºä¹™æŸï¼Œå…¶è¡Œä¸ºç¬¦åˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„æ„æˆè¦ä»¶ã€‚æ‰€ä»¥ï¼Œé€‰é¡¹Bå’ŒCã€Déƒ½æ˜¯æ­£ç¡®çš„ï¼Œè€Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m Training Progress:  23%|â–ˆâ–ˆâ–       | 31/132 [41:30<2:34:25, 91.73s/it] 
[36m(TaskRunner pid=1464402)[0m Training Progress:  24%|â–ˆâ–ˆâ–       | 32/132 [42:32<2:18:15, 82.95s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  25%|â–ˆâ–ˆâ–Œ       | 33/132 [43:32<2:05:42, 76.19s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  26%|â–ˆâ–ˆâ–Œ       | 34/132 [44:33<1:56:38, 71.42s/it]
[36m(TaskRunner pid=1464402)[0m step:30 - global_seqlen/min:49741.000 - global_seqlen/max:56589.000 - global_seqlen/minmax_diff:6848.000 - global_seqlen/balanced_min:53151.000 - global_seqlen/balanced_max:53152.000 - global_seqlen/mean:53151.625 - actor/entropy_loss:136.946 - actor/pg_loss:-0.155 - actor/pg_clipfrac:0.003 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.137 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.877 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.468 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.468 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.468 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.468 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.468 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.468 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.339 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.339 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:252.077 - response_length/max:557.000 - response_length/min:86.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.586 - prompt_length/max:567.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.021 - timing_s/old_log_prob:5.918 - timing_s/adv:0.288 - timing_s/update_actor:36.109 - timing_s/testing:134.448 - timing_s/step:196.808 - timing_per_token_ms/gen:0.103 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:425213.000 - perf/time_per_step:196.808 - perf/throughput:270.068
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:31 - global_seqlen/min:50510.000 - global_seqlen/max:57117.000 - global_seqlen/minmax_diff:6607.000 - global_seqlen/balanced_min:51978.000 - global_seqlen/balanced_max:51979.000 - global_seqlen/mean:51978.625 - actor/entropy_loss:125.255 - actor/pg_loss:0.002 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.132 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:41.013 - actor/lr:0.000 - critic/score/mean:1.456 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.456 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:238.358 - response_length/max:508.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.086 - prompt_length/max:513.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.353 - timing_s/old_log_prob:5.646 - timing_s/adv:0.289 - timing_s/update_actor:35.250 - timing_s/step:59.565 - timing_per_token_ms/gen:0.100 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:415829.000 - perf/time_per_step:59.565 - perf/throughput:872.634
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:32 - global_seqlen/min:51033.000 - global_seqlen/max:53776.000 - global_seqlen/minmax_diff:2743.000 - global_seqlen/balanced_min:52978.000 - global_seqlen/balanced_max:52979.000 - global_seqlen/mean:52978.375 - actor/entropy_loss:127.989 - actor/pg_loss:0.098 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.945 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.836 - actor/lr:0.000 - critic/score/mean:1.460 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.460 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:239.803 - response_length/max:618.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.055 - prompt_length/max:522.000 - prompt_length/min:227.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.390 - timing_s/old_log_prob:5.764 - timing_s/adv:0.288 - timing_s/update_actor:35.973 - timing_s/step:62.439 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:423827.000 - perf/time_per_step:62.439 - perf/throughput:848.482
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:33 - global_seqlen/min:48417.000 - global_seqlen/max:53449.000 - global_seqlen/minmax_diff:5032.000 - global_seqlen/balanced_min:50758.000 - global_seqlen/balanced_max:50759.000 - global_seqlen/mean:50758.375 - actor/entropy_loss:116.892 - actor/pg_loss:0.050 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.123 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.919 - actor/lr:0.000 - critic/score/mean:1.514 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.514 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:227.194 - response_length/max:543.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.539 - prompt_length/max:521.000 - prompt_length/min:228.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.882 - timing_s/old_log_prob:5.543 - timing_s/adv:0.283 - timing_s/update_actor:35.632 - timing_s/step:60.361 - timing_per_token_ms/gen:0.108 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:406067.000 - perf/time_per_step:60.361 - perf/throughput:840.908
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 35/132 [45:40<1:53:24, 70.15s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  27%|â–ˆâ–ˆâ–‹       | 36/132 [46:40<1:47:33, 67.23s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  28%|â–ˆâ–ˆâ–Š       | 37/132 [47:41<1:43:26, 65.34s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  29%|â–ˆâ–ˆâ–‰       | 38/132 [48:39<1:38:54, 63.14s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  30%|â–ˆâ–ˆâ–‰       | 39/132 [49:38<1:35:35, 61.67s/it]
[36m(TaskRunner pid=1464402)[0m step:34 - global_seqlen/min:48521.000 - global_seqlen/max:54531.000 - global_seqlen/minmax_diff:6010.000 - global_seqlen/balanced_min:51850.000 - global_seqlen/balanced_max:51851.000 - global_seqlen/mean:51850.250 - actor/entropy_loss:114.006 - actor/pg_loss:-0.037 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.208 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.811 - actor/lr:0.000 - critic/score/mean:1.410 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.410 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:226.169 - response_length/max:604.000 - response_length/min:78.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.938 - prompt_length/max:558.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.774 - timing_s/old_log_prob:5.693 - timing_s/adv:0.288 - timing_s/update_actor:34.488 - timing_s/step:60.263 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:414802.000 - perf/time_per_step:60.263 - perf/throughput:860.397
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:35 - global_seqlen/min:50056.000 - global_seqlen/max:53517.000 - global_seqlen/minmax_diff:3461.000 - global_seqlen/balanced_min:51812.000 - global_seqlen/balanced_max:52076.000 - global_seqlen/mean:51845.625 - actor/entropy_loss:112.497 - actor/pg_loss:0.207 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.047 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.820 - actor/lr:0.000 - critic/score/mean:1.465 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.465 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.900 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.900 - response_length/mean:225.918 - response_length/max:1024.000 - response_length/min:88.000 - response_length/clip_ratio:0.001 - prompt_length/mean:314.141 - prompt_length/max:544.000 - prompt_length/min:230.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:26.323 - timing_s/old_log_prob:5.626 - timing_s/adv:0.281 - timing_s/update_actor:34.912 - timing_s/step:67.164 - timing_per_token_ms/gen:0.152 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:414765.000 - perf/time_per_step:67.164 - perf/throughput:771.931
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:36 - global_seqlen/min:50654.000 - global_seqlen/max:55375.000 - global_seqlen/minmax_diff:4721.000 - global_seqlen/balanced_min:53050.000 - global_seqlen/balanced_max:53051.000 - global_seqlen/mean:53050.625 - actor/entropy_loss:112.874 - actor/pg_loss:0.202 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.062 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:40.822 - actor/lr:0.000 - critic/score/mean:1.439 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.439 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:232.478 - response_length/max:549.000 - response_length/min:81.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.133 - prompt_length/max:567.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.057 - timing_s/old_log_prob:5.778 - timing_s/adv:0.286 - timing_s/update_actor:35.227 - timing_s/step:60.369 - timing_per_token_ms/gen:0.107 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:424405.000 - perf/time_per_step:60.369 - perf/throughput:878.768
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:37 - global_seqlen/min:48382.000 - global_seqlen/max:53496.000 - global_seqlen/minmax_diff:5114.000 - global_seqlen/balanced_min:51722.000 - global_seqlen/balanced_max:51723.000 - global_seqlen/mean:51722.750 - actor/entropy_loss:109.708 - actor/pg_loss:0.048 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.115 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.563 - actor/lr:0.000 - critic/score/mean:1.476 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.476 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:223.677 - response_length/max:598.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.102 - prompt_length/max:462.000 - prompt_length/min:229.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.545 - timing_s/old_log_prob:5.669 - timing_s/adv:0.283 - timing_s/update_actor:35.383 - timing_s/step:60.903 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:413782.000 - perf/time_per_step:60.903 - perf/throughput:849.264
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:38 - global_seqlen/min:47440.000 - global_seqlen/max:52821.000 - global_seqlen/minmax_diff:5381.000 - global_seqlen/balanced_min:51421.000 - global_seqlen/balanced_max:51422.000 - global_seqlen/mean:51421.500 - actor/entropy_loss:105.454 - actor/pg_loss:0.107 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.155 - perf/mfu/actor:0.385 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.696 - actor/lr:0.000 - critic/score/mean:1.449 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.449 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:220.086 - response_length/max:484.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.555 - prompt_length/max:504.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.803 - timing_s/old_log_prob:5.610 - timing_s/adv:0.286 - timing_s/update_actor:34.265 - timing_s/step:57.985 - timing_per_token_ms/gen:0.105 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:411372.000 - perf/time_per_step:57.985 - perf/throughput:886.811
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  30%|â–ˆâ–ˆâ–ˆ       | 40/132 [52:54<2:36:28, 102.05s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  31%|â–ˆâ–ˆâ–ˆ       | 41/132 [53:58<2:17:31, 90.68s/it] 
[36m(TaskRunner pid=1464402)[0m step:39 - global_seqlen/min:46204.000 - global_seqlen/max:56308.000 - global_seqlen/minmax_diff:10104.000 - global_seqlen/balanced_min:51510.000 - global_seqlen/balanced_max:51511.000 - global_seqlen/mean:51510.125 - actor/entropy_loss:98.351 - actor/pg_loss:-0.031 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.970 - perf/mfu/actor:0.389 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.525 - actor/lr:0.000 - critic/score/mean:1.439 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.439 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-1.183 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-1.183 - response_length/mean:217.275 - response_length/max:496.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.289 - prompt_length/max:789.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.292 - timing_s/old_log_prob:5.699 - timing_s/adv:0.285 - timing_s/update_actor:33.939 - timing_s/step:58.238 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.082 - perf/total_num_tokens:412081.000 - perf/time_per_step:58.238 - perf/throughput:884.472
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜è€ƒæŸ¥çš„æ˜¯å…±åŒçŠ¯ç½ªçš„è®¤å®šä»¥åŠä¸åŒæ•…æ„çš„å¤„ç†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä¸¤è€…çš„æ•…æ„ä¸åŒï¼Œä½†éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…ï¼Œå› æ­¤å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚æ ¹æ®åˆ‘æ³•çš„è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œåº”å½“æŒ‰ç…§å…±åŒçŠ¯ç½ªçš„è¡Œä¸ºæ€§è´¨å®šç½ªï¼Œå› æ­¤å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥é€‰é¡¹Bå’ŒCã€Dæ˜¯æ­£ç¡®çš„ï¼Œè€Œé€‰é¡¹Aæ˜¯é”™è¯¯çš„ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m step:40 - global_seqlen/min:45588.000 - global_seqlen/max:55517.000 - global_seqlen/minmax_diff:9929.000 - global_seqlen/balanced_min:51766.000 - global_seqlen/balanced_max:51767.000 - global_seqlen/mean:51766.250 - actor/entropy_loss:100.416 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.128 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.494 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.475 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.475 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.475 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.475 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.475 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.475 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.464 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.464 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:227.458 - response_length/max:602.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.773 - prompt_length/max:595.000 - prompt_length/min:219.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.846 - timing_s/old_log_prob:5.711 - timing_s/adv:0.279 - timing_s/update_actor:35.744 - timing_s/testing:134.645 - timing_s/step:196.248 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:414130.000 - perf/time_per_step:196.248 - perf/throughput:263.780
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  32%|â–ˆâ–ˆâ–ˆâ–      | 42/132 [55:00<2:03:09, 82.11s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 43/132 [56:00<1:51:55, 75.46s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  33%|â–ˆâ–ˆâ–ˆâ–      | 44/132 [57:01<1:44:08, 71.01s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  34%|â–ˆâ–ˆâ–ˆâ–      | 45/132 [58:00<1:38:07, 67.67s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  35%|â–ˆâ–ˆâ–ˆâ–      | 46/132 [59:00<1:33:27, 65.20s/it]
[36m(TaskRunner pid=1464402)[0m step:41 - global_seqlen/min:49863.000 - global_seqlen/max:53507.000 - global_seqlen/minmax_diff:3644.000 - global_seqlen/balanced_min:51221.000 - global_seqlen/balanced_max:51221.000 - global_seqlen/mean:51221.000 - actor/entropy_loss:99.418 - actor/pg_loss:0.001 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.065 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.267 - actor/lr:0.000 - critic/score/mean:1.473 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.473 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:225.083 - response_length/max:786.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.469 - prompt_length/max:583.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:22.402 - timing_s/old_log_prob:5.525 - timing_s/adv:0.281 - timing_s/update_actor:35.878 - timing_s/step:64.107 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:409768.000 - perf/time_per_step:64.107 - perf/throughput:798.993
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:42 - global_seqlen/min:49480.000 - global_seqlen/max:56548.000 - global_seqlen/minmax_diff:7068.000 - global_seqlen/balanced_min:52824.000 - global_seqlen/balanced_max:52825.000 - global_seqlen/mean:52824.125 - actor/entropy_loss:100.617 - actor/pg_loss:0.118 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.081 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.352 - actor/lr:0.000 - critic/score/mean:1.482 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.482 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:231.009 - response_length/max:605.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.242 - prompt_length/max:628.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.960 - timing_s/old_log_prob:5.884 - timing_s/adv:0.282 - timing_s/update_actor:35.931 - timing_s/step:62.081 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:422593.000 - perf/time_per_step:62.081 - perf/throughput:850.893
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:43 - global_seqlen/min:50046.000 - global_seqlen/max:54463.000 - global_seqlen/minmax_diff:4417.000 - global_seqlen/balanced_min:52164.000 - global_seqlen/balanced_max:52165.000 - global_seqlen/mean:52164.250 - actor/entropy_loss:101.184 - actor/pg_loss:-0.127 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.080 - perf/mfu/actor:0.388 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.234 - actor/lr:0.000 - critic/score/mean:1.409 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.409 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:229.956 - response_length/max:597.000 - response_length/min:75.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.422 - prompt_length/max:535.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.501 - timing_s/old_log_prob:5.685 - timing_s/adv:0.283 - timing_s/update_actor:34.435 - timing_s/step:59.925 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:417314.000 - perf/time_per_step:59.925 - perf/throughput:870.489
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:44 - global_seqlen/min:48863.000 - global_seqlen/max:57011.000 - global_seqlen/minmax_diff:8148.000 - global_seqlen/balanced_min:51849.000 - global_seqlen/balanced_max:51850.000 - global_seqlen/mean:51849.500 - actor/entropy_loss:102.466 - actor/pg_loss:0.272 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.202 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.217 - actor/lr:0.000 - critic/score/mean:1.520 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.520 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:228.427 - response_length/max:529.000 - response_length/min:79.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.672 - prompt_length/max:808.000 - prompt_length/min:221.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.651 - timing_s/old_log_prob:5.706 - timing_s/adv:0.297 - timing_s/update_actor:35.904 - timing_s/step:60.590 - timing_per_token_ms/gen:0.106 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:414796.000 - perf/time_per_step:60.590 - perf/throughput:855.747
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:45 - global_seqlen/min:49086.000 - global_seqlen/max:54114.000 - global_seqlen/minmax_diff:5028.000 - global_seqlen/balanced_min:50745.000 - global_seqlen/balanced_max:50745.000 - global_seqlen/mean:50745.000 - actor/entropy_loss:95.378 - actor/pg_loss:-0.142 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.982 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.250 - actor/lr:0.000 - critic/score/mean:1.502 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.502 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:217.203 - response_length/max:593.000 - response_length/min:63.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.391 - prompt_length/max:611.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.556 - timing_s/old_log_prob:5.547 - timing_s/adv:0.290 - timing_s/update_actor:34.448 - timing_s/step:59.860 - timing_per_token_ms/gen:0.117 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:405960.000 - perf/time_per_step:59.860 - perf/throughput:847.722
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 47/132 [59:58<1:29:09, 62.94s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  36%|â–ˆâ–ˆâ–ˆâ–‹      | 48/132 [1:00:56<1:26:18, 61.64s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 49/132 [1:01:56<1:24:40, 61.21s/it]
[36m(TaskRunner pid=1464402)[0m step:46 - global_seqlen/min:44467.000 - global_seqlen/max:52021.000 - global_seqlen/minmax_diff:7554.000 - global_seqlen/balanced_min:49409.000 - global_seqlen/balanced_max:49411.000 - global_seqlen/mean:49409.500 - actor/entropy_loss:88.321 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.882 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.220 - actor/lr:0.000 - critic/score/mean:1.440 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.440 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:210.495 - response_length/max:605.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.188 - prompt_length/max:485.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.541 - timing_s/old_log_prob:5.475 - timing_s/adv:0.279 - timing_s/update_actor:34.086 - timing_s/step:59.406 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:395276.000 - perf/time_per_step:59.406 - perf/throughput:831.728
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:47 - global_seqlen/min:46264.000 - global_seqlen/max:52382.000 - global_seqlen/minmax_diff:6118.000 - global_seqlen/balanced_min:49322.000 - global_seqlen/balanced_max:49323.000 - global_seqlen/mean:49322.125 - actor/entropy_loss:91.956 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.898 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.254 - actor/lr:0.000 - critic/score/mean:1.479 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.479 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:211.553 - response_length/max:534.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:302.219 - prompt_length/max:455.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.201 - timing_s/old_log_prob:5.454 - timing_s/adv:0.280 - timing_s/update_actor:33.685 - timing_s/step:57.644 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:394577.000 - perf/time_per_step:57.644 - perf/throughput:855.639
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:48 - global_seqlen/min:47278.000 - global_seqlen/max:55089.000 - global_seqlen/minmax_diff:7811.000 - global_seqlen/balanced_min:50507.000 - global_seqlen/balanced_max:50508.000 - global_seqlen/mean:50507.375 - actor/entropy_loss:93.932 - actor/pg_loss:0.103 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.073 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.250 - actor/lr:0.000 - critic/score/mean:1.526 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.526 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.750 - critic/returns/mean:0.004 - critic/returns/max:0.833 - critic/returns/min:-0.750 - response_length/mean:220.142 - response_length/max:535.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:485.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.500 - timing_s/old_log_prob:5.580 - timing_s/adv:0.286 - timing_s/update_actor:34.220 - timing_s/step:58.607 - timing_per_token_ms/gen:0.109 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:404059.000 - perf/time_per_step:58.607 - perf/throughput:861.803
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:49 - global_seqlen/min:47531.000 - global_seqlen/max:54002.000 - global_seqlen/minmax_diff:6471.000 - global_seqlen/balanced_min:50685.000 - global_seqlen/balanced_max:50686.000 - global_seqlen/mean:50685.500 - actor/entropy_loss:96.829 - actor/pg_loss:0.010 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.862 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.196 - actor/lr:0.000 - critic/score/mean:1.484 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.484 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:217.818 - response_length/max:574.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.156 - prompt_length/max:503.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.307 - timing_s/old_log_prob:5.617 - timing_s/adv:0.289 - timing_s/update_actor:34.906 - timing_s/step:60.149 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:405484.000 - perf/time_per_step:60.149 - perf/throughput:842.670
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m Training Progress:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 50/132 [1:05:38<2:29:21, 109.29s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–Š      | 51/132 [1:06:38<2:07:36, 94.52s/it] 
[36m(TaskRunner pid=1464402)[0m Training Progress:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 52/132 [1:07:38<1:52:24, 84.31s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 53/132 [1:08:36<1:40:32, 76.36s/it]
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜æ¶‰åŠå…±åŒçŠ¯ç½ªçš„è®¤å®šä»¥åŠä¸åŒæ•…æ„åœ¨å…±åŒçŠ¯ç½ªä¸­çš„å¤„ç†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä¸¤äººçš„è¡Œä¸ºåœ¨å®¢è§‚ä¸Šæ˜¯ç›¸åŒçš„ï¼Œå³å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æ ¹æ®åˆ‘æ³•ç†è®ºï¼Œå…±åŒçŠ¯ç½ªçš„æ•…æ„åªè¦æ±‚åœ¨å…±åŒçŠ¯ç½ªè¡Œä¸ºçš„èŒƒå›´å†…æœ‰å…±åŒçš„æ•…æ„å³å¯ï¼Œè€Œä¸è¦æ±‚åœ¨çŠ¯ç½ªç›®çš„ä¸Šå®Œå…¨ä¸€è‡´ã€‚å› æ­¤ï¼Œç”²ä¹™äºŒäººçš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m local_global_step_folder: checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50
[36m(WorkerDict pid=1467435)[0m [rank-0]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1467435)[0m [rank-0]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_0.pt
[36m(WorkerDict pid=1467435)[0m [rank-0]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_0.pt
[36m(TaskRunner pid=1464402)[0m step:50 - global_seqlen/min:48228.000 - global_seqlen/max:54133.000 - global_seqlen/minmax_diff:5905.000 - global_seqlen/balanced_min:51511.000 - global_seqlen/balanced_max:51512.000 - global_seqlen/mean:51511.250 - actor/entropy_loss:92.583 - actor/pg_loss:0.015 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.175 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:39.231 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.495 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.495 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.495 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.495 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.468 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.468 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:216.568 - response_length/max:641.000 - response_length/min:80.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.008 - prompt_length/max:771.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.243 - timing_s/old_log_prob:5.841 - timing_s/adv:0.283 - timing_s/update_actor:35.592 - timing_s/testing:134.573 - timing_s/save_checkpoint:24.897 - timing_s/step:221.453 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:412090.000 - perf/time_per_step:221.453 - perf/throughput:232.606
[36m(WorkerDict pid=1473402)[0m [rank-3]: Saving model to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473402)[0m [rank-3]: Saving checkpoint to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/model_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(WorkerDict pid=1473402)[0m [rank-3]: Saving extra_state to /home/wangyc/verl/checkpoints/qwen2.5-7b-grpo-hard-mcq/global_step_50/actor/extra_state_world_size_8_rank_3.pt[32m [repeated 7x across cluster][0m
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:51 - global_seqlen/min:47419.000 - global_seqlen/max:52971.000 - global_seqlen/minmax_diff:5552.000 - global_seqlen/balanced_min:50810.000 - global_seqlen/balanced_max:50811.000 - global_seqlen/mean:50810.750 - actor/entropy_loss:90.032 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.125 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:43.690 - actor/lr:0.000 - critic/score/mean:1.454 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.454 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:221.216 - response_length/max:508.000 - response_length/min:76.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.062 - prompt_length/max:477.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.224 - timing_s/old_log_prob:5.542 - timing_s/adv:0.272 - timing_s/update_actor:34.975 - timing_s/step:60.046 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:406486.000 - perf/time_per_step:60.046 - perf/throughput:846.204
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:52 - global_seqlen/min:48820.000 - global_seqlen/max:56612.000 - global_seqlen/minmax_diff:7792.000 - global_seqlen/balanced_min:52089.000 - global_seqlen/balanced_max:52090.000 - global_seqlen/mean:52089.125 - actor/entropy_loss:85.614 - actor/pg_loss:-0.118 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.047 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.232 - actor/lr:0.000 - critic/score/mean:1.540 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.540 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:219.431 - response_length/max:560.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:323.164 - prompt_length/max:578.000 - prompt_length/min:206.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.939 - timing_s/old_log_prob:5.708 - timing_s/adv:0.280 - timing_s/update_actor:35.493 - timing_s/step:60.445 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:416713.000 - perf/time_per_step:60.445 - perf/throughput:861.757
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 54/132 [1:09:42<1:35:10, 73.21s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 55/132 [1:10:42<1:28:43, 69.13s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 56/132 [1:11:43<1:24:47, 66.94s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 57/132 [1:12:43<1:20:58, 64.78s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 58/132 [1:13:46<1:19:17, 64.28s/it]
[36m(TaskRunner pid=1464402)[0m step:53 - global_seqlen/min:47075.000 - global_seqlen/max:56030.000 - global_seqlen/minmax_diff:8955.000 - global_seqlen/balanced_min:50008.000 - global_seqlen/balanced_max:50009.000 - global_seqlen/mean:50008.625 - actor/entropy_loss:78.361 - actor/pg_loss:-0.086 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.927 - perf/mfu/actor:0.382 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.089 - actor/lr:0.000 - critic/score/mean:1.527 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.527 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.007 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.007 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:212.009 - response_length/max:551.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.914 - prompt_length/max:542.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.567 - timing_s/old_log_prob:5.411 - timing_s/adv:0.274 - timing_s/update_actor:33.512 - timing_s/step:57.785 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:400069.000 - perf/time_per_step:57.785 - perf/throughput:865.419
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:54 - global_seqlen/min:46529.000 - global_seqlen/max:55037.000 - global_seqlen/minmax_diff:8508.000 - global_seqlen/balanced_min:50657.000 - global_seqlen/balanced_max:50682.000 - global_seqlen/mean:50660.875 - actor/entropy_loss:74.160 - actor/pg_loss:0.222 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.092 - perf/mfu/actor:0.380 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.142 - actor/lr:0.000 - critic/score/mean:1.502 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.502 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.867 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.867 - response_length/mean:213.858 - response_length/max:1024.000 - response_length/min:68.000 - response_length/clip_ratio:0.001 - prompt_length/mean:313.859 - prompt_length/max:563.000 - prompt_length/min:214.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.824 - timing_s/old_log_prob:5.586 - timing_s/adv:0.274 - timing_s/update_actor:34.140 - timing_s/step:65.846 - timing_per_token_ms/gen:0.157 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:405287.000 - perf/time_per_step:65.846 - perf/throughput:769.383
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:55 - global_seqlen/min:48218.000 - global_seqlen/max:52397.000 - global_seqlen/minmax_diff:4179.000 - global_seqlen/balanced_min:50849.000 - global_seqlen/balanced_max:50850.000 - global_seqlen/mean:50849.625 - actor/entropy_loss:71.940 - actor/pg_loss:-0.003 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.861 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.285 - actor/lr:0.000 - critic/score/mean:1.529 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.529 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:214.020 - response_length/max:544.000 - response_length/min:67.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.664 - prompt_length/max:615.000 - prompt_length/min:204.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.139 - timing_s/old_log_prob:5.678 - timing_s/adv:0.282 - timing_s/update_actor:34.495 - timing_s/step:59.615 - timing_per_token_ms/gen:0.116 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:406797.000 - perf/time_per_step:59.615 - perf/throughput:852.969
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:56 - global_seqlen/min:47254.000 - global_seqlen/max:54323.000 - global_seqlen/minmax_diff:7069.000 - global_seqlen/balanced_min:50753.000 - global_seqlen/balanced_max:50753.000 - global_seqlen/mean:50753.000 - actor/entropy_loss:73.697 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.966 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.250 - actor/lr:0.000 - critic/score/mean:1.470 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.470 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:227.357 - response_length/max:619.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:301.320 - prompt_length/max:679.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.973 - timing_s/old_log_prob:5.712 - timing_s/adv:0.279 - timing_s/update_actor:35.802 - timing_s/step:61.791 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:406024.000 - perf/time_per_step:61.791 - perf/throughput:821.362
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:57 - global_seqlen/min:49348.000 - global_seqlen/max:53745.000 - global_seqlen/minmax_diff:4397.000 - global_seqlen/balanced_min:51433.000 - global_seqlen/balanced_max:51434.000 - global_seqlen/mean:51433.375 - actor/entropy_loss:72.592 - actor/pg_loss:0.093 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.173 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.214 - actor/lr:0.000 - critic/score/mean:1.489 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.489 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:222.421 - response_length/max:557.000 - response_length/min:71.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.344 - prompt_length/max:685.000 - prompt_length/min:234.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.984 - timing_s/old_log_prob:5.640 - timing_s/adv:0.281 - timing_s/update_actor:34.800 - timing_s/step:59.729 - timing_per_token_ms/gen:0.111 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:411467.000 - perf/time_per_step:59.729 - perf/throughput:861.116
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 59/132 [1:14:53<1:19:10, 65.07s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 60/132 [1:18:06<2:04:12, 103.51s/it]
[36m(TaskRunner pid=1464402)[0m step:58 - global_seqlen/min:47969.000 - global_seqlen/max:54655.000 - global_seqlen/minmax_diff:6686.000 - global_seqlen/balanced_min:51410.000 - global_seqlen/balanced_max:51411.000 - global_seqlen/mean:51410.625 - actor/entropy_loss:74.896 - actor/pg_loss:0.021 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.047 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.201 - actor/lr:0.000 - critic/score/mean:1.495 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.495 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:225.215 - response_length/max:710.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.312 - prompt_length/max:540.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.323 - timing_s/old_log_prob:5.723 - timing_s/adv:0.280 - timing_s/update_actor:35.756 - timing_s/step:63.109 - timing_per_token_ms/gen:0.123 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:411285.000 - perf/time_per_step:63.109 - perf/throughput:814.632
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:59 - global_seqlen/min:45613.000 - global_seqlen/max:53672.000 - global_seqlen/minmax_diff:8059.000 - global_seqlen/balanced_min:50327.000 - global_seqlen/balanced_max:50328.000 - global_seqlen/mean:50327.500 - actor/entropy_loss:74.999 - actor/pg_loss:0.024 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.996 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.076 - actor/lr:0.000 - critic/score/mean:1.499 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.499 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.012 - critic/advantages/max:0.833 - critic/advantages/min:-1.517 - critic/returns/mean:-0.012 - critic/returns/max:0.833 - critic/returns/min:-1.517 - response_length/mean:218.706 - response_length/max:1024.000 - response_length/min:67.000 - response_length/clip_ratio:0.001 - prompt_length/mean:305.539 - prompt_length/max:585.000 - prompt_length/min:217.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.946 - timing_s/old_log_prob:5.639 - timing_s/adv:0.281 - timing_s/update_actor:34.997 - timing_s/step:66.888 - timing_per_token_ms/gen:0.154 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:402620.000 - perf/time_per_step:66.888 - perf/throughput:752.414
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜è€ƒå¯Ÿçš„æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹æ¡ä»¶ä»¥åŠä¸åŒæ•…æ„å…±åŒçŠ¯ç½ªçš„å¤„ç†åŸåˆ™ã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„è§„å®šï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²ä¹™äºŒäººçš„è¡Œä¸ºè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†æ˜¯éƒ½åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…ï¼Œå› æ­¤å¯ä»¥æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä»¥å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ç­”æ¡ˆæ˜¯{BCD}ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m Training Progress:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 61/132 [1:19:04<1:46:18, 89.84s/it] 
[36m(TaskRunner pid=1464402)[0m Training Progress:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 62/132 [1:20:09<1:35:47, 82.11s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 63/132 [1:21:09<1:27:05, 75.73s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 64/132 [1:22:08<1:20:01, 70.61s/it]
[36m(TaskRunner pid=1464402)[0m step:60 - global_seqlen/min:47464.000 - global_seqlen/max:54873.000 - global_seqlen/minmax_diff:7409.000 - global_seqlen/balanced_min:51499.000 - global_seqlen/balanced_max:51500.000 - global_seqlen/mean:51499.750 - actor/entropy_loss:75.557 - actor/pg_loss:0.167 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.000 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.076 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.523 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.523 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.523 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.523 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.468 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.468 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:219.659 - response_length/max:597.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.797 - prompt_length/max:604.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.414 - timing_s/old_log_prob:5.797 - timing_s/adv:0.266 - timing_s/update_actor:35.461 - timing_s/testing:132.221 - timing_s/step:193.181 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:411998.000 - perf/time_per_step:193.181 - perf/throughput:266.589
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:61 - global_seqlen/min:45219.000 - global_seqlen/max:50977.000 - global_seqlen/minmax_diff:5758.000 - global_seqlen/balanced_min:49273.000 - global_seqlen/balanced_max:49274.000 - global_seqlen/mean:49273.500 - actor/entropy_loss:70.242 - actor/pg_loss:-0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.860 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.187 - actor/lr:0.000 - critic/score/mean:1.559 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.559 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:209.281 - response_length/max:616.000 - response_length/min:72.000 - response_length/clip_ratio:0.000 - prompt_length/mean:303.984 - prompt_length/max:576.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.989 - timing_s/old_log_prob:5.319 - timing_s/adv:0.269 - timing_s/update_actor:33.328 - timing_s/step:57.935 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:394188.000 - perf/time_per_step:57.935 - perf/throughput:850.501
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:62 - global_seqlen/min:46644.000 - global_seqlen/max:56284.000 - global_seqlen/minmax_diff:9640.000 - global_seqlen/balanced_min:50415.000 - global_seqlen/balanced_max:50415.000 - global_seqlen/mean:50415.000 - actor/entropy_loss:71.423 - actor/pg_loss:-0.077 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.101 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.023 - actor/lr:0.000 - critic/score/mean:1.499 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.499 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.007 - critic/advantages/max:0.800 - critic/advantages/min:-0.917 - critic/returns/mean:-0.007 - critic/returns/max:0.800 - critic/returns/min:-0.917 - response_length/mean:211.047 - response_length/max:838.000 - response_length/min:82.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.109 - prompt_length/max:640.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.212 - timing_s/old_log_prob:5.623 - timing_s/adv:0.277 - timing_s/update_actor:34.920 - timing_s/step:64.053 - timing_per_token_ms/gen:0.143 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:403320.000 - perf/time_per_step:64.053 - perf/throughput:787.082
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:63 - global_seqlen/min:46144.000 - global_seqlen/max:53734.000 - global_seqlen/minmax_diff:7590.000 - global_seqlen/balanced_min:50609.000 - global_seqlen/balanced_max:50610.000 - global_seqlen/mean:50609.500 - actor/entropy_loss:75.196 - actor/pg_loss:-0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.940 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.006 - actor/lr:0.000 - critic/score/mean:1.493 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.493 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:213.432 - response_length/max:695.000 - response_length/min:70.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.750 - prompt_length/max:820.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.786 - timing_s/old_log_prob:5.534 - timing_s/adv:0.278 - timing_s/update_actor:34.214 - timing_s/step:60.833 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:404876.000 - perf/time_per_step:60.833 - perf/throughput:831.940
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 65/132 [1:23:09<1:15:33, 67.67s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 66/132 [1:24:09<1:12:02, 65.50s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 67/132 [1:25:09<1:09:09, 63.84s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 68/132 [1:26:10<1:07:01, 62.83s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 69/132 [1:27:11<1:05:26, 62.32s/it]
[36m(TaskRunner pid=1464402)[0m step:64 - global_seqlen/min:48233.000 - global_seqlen/max:55136.000 - global_seqlen/minmax_diff:6903.000 - global_seqlen/balanced_min:50242.000 - global_seqlen/balanced_max:50243.000 - global_seqlen/mean:50242.500 - actor/entropy_loss:72.412 - actor/pg_loss:-0.080 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.769 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.133 - actor/lr:0.000 - critic/score/mean:1.508 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.508 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:211.242 - response_length/max:493.000 - response_length/min:62.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.117 - prompt_length/max:518.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.899 - timing_s/old_log_prob:5.614 - timing_s/adv:0.278 - timing_s/update_actor:34.815 - timing_s/step:58.633 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:401940.000 - perf/time_per_step:58.633 - perf/throughput:856.896
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:65 - global_seqlen/min:48914.000 - global_seqlen/max:52748.000 - global_seqlen/minmax_diff:3834.000 - global_seqlen/balanced_min:50964.000 - global_seqlen/balanced_max:50965.000 - global_seqlen/mean:50964.750 - actor/entropy_loss:72.665 - actor/pg_loss:0.019 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.167 - perf/mfu/actor:0.381 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.103 - actor/lr:0.000 - critic/score/mean:1.537 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.537 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:222.586 - response_length/max:670.000 - response_length/min:81.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.297 - prompt_length/max:492.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.628 - timing_s/old_log_prob:5.612 - timing_s/adv:0.277 - timing_s/update_actor:34.256 - timing_s/step:60.794 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:407718.000 - perf/time_per_step:60.794 - perf/throughput:838.312
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:66 - global_seqlen/min:46311.000 - global_seqlen/max:54172.000 - global_seqlen/minmax_diff:7861.000 - global_seqlen/balanced_min:50602.000 - global_seqlen/balanced_max:50603.000 - global_seqlen/mean:50602.500 - actor/entropy_loss:71.221 - actor/pg_loss:-0.033 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.971 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.099 - actor/lr:0.000 - critic/score/mean:1.546 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.546 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.004 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.004 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:220.078 - response_length/max:534.000 - response_length/min:69.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.031 - prompt_length/max:609.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.650 - timing_s/old_log_prob:5.612 - timing_s/adv:0.282 - timing_s/update_actor:35.832 - timing_s/step:60.396 - timing_per_token_ms/gen:0.110 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.089 - perf/total_num_tokens:404820.000 - perf/time_per_step:60.396 - perf/throughput:837.841
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:67 - global_seqlen/min:48748.000 - global_seqlen/max:53362.000 - global_seqlen/minmax_diff:4614.000 - global_seqlen/balanced_min:50860.000 - global_seqlen/balanced_max:50861.000 - global_seqlen/mean:50860.750 - actor/entropy_loss:69.630 - actor/pg_loss:0.111 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.966 - perf/mfu/actor:0.378 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:41.943 - actor/lr:0.000 - critic/score/mean:1.502 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.502 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:221.128 - response_length/max:558.000 - response_length/min:68.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.672 - prompt_length/max:576.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.030 - timing_s/old_log_prob:5.607 - timing_s/adv:0.283 - timing_s/update_actor:34.527 - timing_s/step:59.496 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:406886.000 - perf/time_per_step:59.496 - perf/throughput:854.856
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:68 - global_seqlen/min:46154.000 - global_seqlen/max:53087.000 - global_seqlen/minmax_diff:6933.000 - global_seqlen/balanced_min:49402.000 - global_seqlen/balanced_max:49403.000 - global_seqlen/mean:49402.500 - actor/entropy_loss:70.596 - actor/pg_loss:-0.008 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.952 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.127 - actor/lr:0.000 - critic/score/mean:1.531 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.531 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:215.953 - response_length/max:675.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:298.656 - prompt_length/max:433.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.551 - timing_s/old_log_prob:5.518 - timing_s/adv:0.276 - timing_s/update_actor:34.063 - timing_s/step:60.431 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:395220.000 - perf/time_per_step:60.431 - perf/throughput:817.508
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 70/132 [1:30:28<1:46:06, 102.69s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 71/132 [1:31:30<1:32:01, 90.51s/it] 
[36m(TaskRunner pid=1464402)[0m step:69 - global_seqlen/min:50281.000 - global_seqlen/max:55204.000 - global_seqlen/minmax_diff:4923.000 - global_seqlen/balanced_min:51574.000 - global_seqlen/balanced_max:51575.000 - global_seqlen/mean:51574.750 - actor/entropy_loss:75.495 - actor/pg_loss:-0.033 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.044 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.153 - actor/lr:0.000 - critic/score/mean:1.543 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.543 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:224.065 - response_length/max:555.000 - response_length/min:81.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.172 - prompt_length/max:614.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.831 - timing_s/old_log_prob:5.771 - timing_s/adv:0.282 - timing_s/update_actor:35.207 - timing_s/step:61.117 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:412598.000 - perf/time_per_step:61.117 - perf/throughput:843.868
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜è€ƒå¯Ÿçš„æ˜¯å…±åŒçŠ¯ç½ªçš„æ„æˆè¦ä»¶ä»¥åŠä¸åŒæ•…æ„åœ¨å…±åŒçŠ¯ç½ªä¸­çš„å¤„ç†ã€‚ç”²æŸå’Œä¹™æŸè™½ç„¶æ•…æ„ä¸åŒï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºéƒ½æ¶‰åŠå›½å®¶ç§˜å¯†çš„è·å–ï¼Œç”²æŸçš„ç›®çš„æ˜¯ä¸ºäº†å¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ï¼Œè€Œä¹™æŸçš„ç›®çš„æ˜¯ä¸ºäº†éæ³•è·å–ã€‚æ ¹æ®ã€Šä¸­åäººæ°‘å…±å’Œå›½åˆ‘æ³•ã€‹çš„è§„å®šï¼Œå¯¹äºå…±åŒçŠ¯ç½ªï¼Œå¦‚æœå„å…±çŠ¯äººæ‰€çŠ¯ä¹‹ç½ªåä¸åŒï¼Œåº”å½“æ ¹æ®å„è‡ªçš„è¡Œä¸ºå®šç½ªå¤„ç½šã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆé—´è°ç½ªï¼Œä¹™æŸçš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚ä½†æ˜¯ï¼Œä»–ä»¬åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯å…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ç­”æ¡ˆæ˜¯Bã€Cã€Dã€‚ </æ€è€ƒ><å›ç­”> ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªï¼Œå¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ï¼Œå¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„ã€‚æ‰€ä»¥ç­”æ¡ˆæ˜¯{BCD}ã€‚ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m step:70 - global_seqlen/min:49754.000 - global_seqlen/max:54454.000 - global_seqlen/minmax_diff:4700.000 - global_seqlen/balanced_min:52707.000 - global_seqlen/balanced_max:52708.000 - global_seqlen/mean:52707.125 - actor/entropy_loss:76.099 - actor/pg_loss:-0.253 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.046 - perf/mfu/actor:0.386 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.208 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.534 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.534 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.534 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.534 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.534 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.534 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.538 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.538 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:239.829 - response_length/max:551.000 - response_length/min:74.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.203 - prompt_length/max:542.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.151 - timing_s/old_log_prob:5.751 - timing_s/adv:0.286 - timing_s/update_actor:35.039 - timing_s/testing:136.627 - timing_s/step:196.874 - timing_per_token_ms/gen:0.104 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.083 - perf/total_num_tokens:421657.000 - perf/time_per_step:196.874 - perf/throughput:267.720
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 72/132 [1:32:31<1:21:45, 81.76s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  55%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 73/132 [1:33:33<1:14:30, 75.78s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 74/132 [1:34:37<1:09:54, 72.31s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  57%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 75/132 [1:35:37<1:05:03, 68.48s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 76/132 [1:36:36<1:01:19, 65.71s/it]
[36m(TaskRunner pid=1464402)[0m step:71 - global_seqlen/min:49645.000 - global_seqlen/max:54875.000 - global_seqlen/minmax_diff:5230.000 - global_seqlen/balanced_min:53021.000 - global_seqlen/balanced_max:53022.000 - global_seqlen/mean:53021.500 - actor/entropy_loss:71.091 - actor/pg_loss:0.035 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.052 - perf/mfu/actor:0.384 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.127 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.006 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.006 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:240.026 - response_length/max:671.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.281 - prompt_length/max:771.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.655 - timing_s/old_log_prob:5.645 - timing_s/adv:0.283 - timing_s/update_actor:35.444 - timing_s/step:62.060 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.084 - perf/total_num_tokens:424172.000 - perf/time_per_step:62.060 - perf/throughput:854.355
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:72 - global_seqlen/min:49009.000 - global_seqlen/max:53579.000 - global_seqlen/minmax_diff:4570.000 - global_seqlen/balanced_min:51071.000 - global_seqlen/balanced_max:51072.000 - global_seqlen/mean:51071.625 - actor/entropy_loss:68.259 - actor/pg_loss:0.193 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.936 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.200 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:221.254 - response_length/max:676.000 - response_length/min:52.000 - response_length/clip_ratio:0.000 - prompt_length/mean:310.742 - prompt_length/max:480.000 - prompt_length/min:205.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.755 - timing_s/old_log_prob:5.562 - timing_s/adv:0.282 - timing_s/update_actor:34.709 - timing_s/step:61.332 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:408573.000 - perf/time_per_step:61.332 - perf/throughput:832.711
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:73 - global_seqlen/min:48377.000 - global_seqlen/max:52167.000 - global_seqlen/minmax_diff:3790.000 - global_seqlen/balanced_min:50242.000 - global_seqlen/balanced_max:50243.000 - global_seqlen/mean:50242.375 - actor/entropy_loss:66.101 - actor/pg_loss:0.012 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.965 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.224 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:212.077 - response_length/max:679.000 - response_length/min:48.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.281 - prompt_length/max:534.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:20.832 - timing_s/old_log_prob:5.546 - timing_s/adv:0.275 - timing_s/update_actor:35.109 - timing_s/step:61.785 - timing_per_token_ms/gen:0.128 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:401939.000 - perf/time_per_step:61.785 - perf/throughput:813.178
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:74 - global_seqlen/min:48829.000 - global_seqlen/max:52594.000 - global_seqlen/minmax_diff:3765.000 - global_seqlen/balanced_min:50628.000 - global_seqlen/balanced_max:50629.000 - global_seqlen/mean:50628.250 - actor/entropy_loss:63.784 - actor/pg_loss:-0.041 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.929 - perf/mfu/actor:0.375 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.141 - actor/lr:0.000 - critic/score/mean:1.469 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.469 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:218.760 - response_length/max:854.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:308.617 - prompt_length/max:563.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.676 - timing_s/old_log_prob:5.587 - timing_s/adv:0.278 - timing_s/update_actor:34.636 - timing_s/step:64.201 - timing_per_token_ms/gen:0.141 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:405026.000 - perf/time_per_step:64.201 - perf/throughput:788.588
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:75 - global_seqlen/min:46648.000 - global_seqlen/max:53371.000 - global_seqlen/minmax_diff:6723.000 - global_seqlen/balanced_min:50245.000 - global_seqlen/balanced_max:50246.000 - global_seqlen/mean:50245.500 - actor/entropy_loss:62.545 - actor/pg_loss:0.099 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.952 - perf/mfu/actor:0.376 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.181 - actor/lr:0.000 - critic/score/mean:1.574 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.574 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:210.570 - response_length/max:617.000 - response_length/min:65.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.820 - prompt_length/max:679.000 - prompt_length/min:213.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.446 - timing_s/old_log_prob:5.515 - timing_s/adv:0.274 - timing_s/update_actor:34.267 - timing_s/step:59.522 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:401964.000 - perf/time_per_step:59.522 - perf/throughput:844.154
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 77/132 [1:37:34<58:06, 63.39s/it]  
[36m(TaskRunner pid=1464402)[0m Training Progress:  59%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 78/132 [1:38:33<55:51, 62.06s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰    | 79/132 [1:39:32<53:55, 61.05s/it]
[36m(TaskRunner pid=1464402)[0m step:76 - global_seqlen/min:48696.000 - global_seqlen/max:53201.000 - global_seqlen/minmax_diff:4505.000 - global_seqlen/balanced_min:51135.000 - global_seqlen/balanced_max:51136.000 - global_seqlen/mean:51135.250 - actor/entropy_loss:66.747 - actor/pg_loss:0.188 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.763 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.215 - actor/lr:0.000 - critic/score/mean:1.510 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.510 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:215.667 - response_length/max:555.000 - response_length/min:64.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.992 - prompt_length/max:585.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.562 - timing_s/old_log_prob:5.569 - timing_s/adv:0.283 - timing_s/update_actor:34.757 - timing_s/step:59.191 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:409082.000 - perf/time_per_step:59.191 - perf/throughput:863.905
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:77 - global_seqlen/min:46934.000 - global_seqlen/max:49986.000 - global_seqlen/minmax_diff:3052.000 - global_seqlen/balanced_min:48883.000 - global_seqlen/balanced_max:48884.000 - global_seqlen/mean:48883.500 - actor/entropy_loss:60.104 - actor/pg_loss:-0.062 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.856 - perf/mfu/actor:0.372 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.212 - actor/lr:0.000 - critic/score/mean:1.580 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.580 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:203.805 - response_length/max:558.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.398 - prompt_length/max:532.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.498 - timing_s/old_log_prob:5.510 - timing_s/adv:0.277 - timing_s/update_actor:33.648 - timing_s/step:57.959 - timing_per_token_ms/gen:0.118 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:391068.000 - perf/time_per_step:57.959 - perf/throughput:843.419
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:78 - global_seqlen/min:48250.000 - global_seqlen/max:52524.000 - global_seqlen/minmax_diff:4274.000 - global_seqlen/balanced_min:49405.000 - global_seqlen/balanced_max:49406.000 - global_seqlen/mean:49405.500 - actor/entropy_loss:58.957 - actor/pg_loss:-0.030 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.855 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.363 - actor/lr:0.000 - critic/score/mean:1.602 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.602 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:203.305 - response_length/max:582.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.336 - prompt_length/max:546.000 - prompt_length/min:202.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.024 - timing_s/old_log_prob:5.511 - timing_s/adv:0.280 - timing_s/update_actor:34.093 - timing_s/step:58.927 - timing_per_token_ms/gen:0.122 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:395244.000 - perf/time_per_step:58.927 - perf/throughput:838.423
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:79 - global_seqlen/min:45049.000 - global_seqlen/max:52145.000 - global_seqlen/minmax_diff:7096.000 - global_seqlen/balanced_min:48728.000 - global_seqlen/balanced_max:48729.000 - global_seqlen/mean:48728.875 - actor/entropy_loss:56.539 - actor/pg_loss:0.033 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.830 - perf/mfu/actor:0.368 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.168 - actor/lr:0.000 - critic/score/mean:1.564 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.564 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:198.421 - response_length/max:560.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.172 - prompt_length/max:495.000 - prompt_length/min:203.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.018 - timing_s/old_log_prob:5.466 - timing_s/adv:0.272 - timing_s/update_actor:33.893 - timing_s/step:58.670 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:389831.000 - perf/time_per_step:58.670 - perf/throughput:830.560
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 80/132 [1:42:42<1:26:39, 99.98s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  61%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 81/132 [1:43:40<1:14:16, 87.39s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 82/132 [1:44:39<1:05:40, 78.81s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  63%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 83/132 [1:45:36<58:52, 72.09s/it]  
[36m(TaskRunner pid=1464402)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 84/132 [1:46:34<54:17, 67.87s/it]
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜è€ƒå¯Ÿçš„æ˜¯å…±åŒçŠ¯ç½ªçš„æˆç«‹æ¡ä»¶ä»¥åŠä¸åŒæ•…æ„æƒ…å†µä¸‹å¦‚ä½•å®šç½ªçš„é—®é¢˜ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„æ˜¯ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œè€Œä¹™çš„æ•…æ„æ˜¯éæ³•è·å–å›½å®¶ç§˜å¯†ï¼Œä½†ä»–ä»¬çš„è¡Œä¸ºåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ªã€‚ç”²æŸçš„è¡Œä¸ºæ„æˆä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°ã€éæ³•æä¾›å›½å®¶ç§˜å¯†ã€æƒ…æŠ¥ç½ªï¼Œä¹™çš„è¡Œä¸ºæ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m step:80 - global_seqlen/min:44666.000 - global_seqlen/max:52228.000 - global_seqlen/minmax_diff:7562.000 - global_seqlen/balanced_min:48597.000 - global_seqlen/balanced_max:48597.000 - global_seqlen/mean:48597.000 - actor/entropy_loss:56.320 - actor/pg_loss:-0.072 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.999 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.307 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.554 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.554 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.554 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.554 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.554 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.554 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.550 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.550 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:189.383 - response_length/max:559.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:316.836 - prompt_length/max:561.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.493 - timing_s/old_log_prob:5.430 - timing_s/adv:0.271 - timing_s/update_actor:34.273 - timing_s/testing:132.319 - timing_s/step:190.812 - timing_per_token_ms/gen:0.127 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:388776.000 - perf/time_per_step:190.812 - perf/throughput:254.685
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:81 - global_seqlen/min:45346.000 - global_seqlen/max:50357.000 - global_seqlen/minmax_diff:5011.000 - global_seqlen/balanced_min:47721.000 - global_seqlen/balanced_max:47722.000 - global_seqlen/mean:47721.625 - actor/entropy_loss:50.900 - actor/pg_loss:0.020 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.942 - perf/mfu/actor:0.364 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.321 - actor/lr:0.000 - critic/score/mean:1.556 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.556 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:184.913 - response_length/max:621.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.188 - prompt_length/max:566.000 - prompt_length/min:209.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.886 - timing_s/old_log_prob:5.183 - timing_s/adv:0.270 - timing_s/update_actor:33.592 - timing_s/step:57.960 - timing_per_token_ms/gen:0.133 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:381773.000 - perf/time_per_step:57.960 - perf/throughput:823.353
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:82 - global_seqlen/min:42834.000 - global_seqlen/max:50627.000 - global_seqlen/minmax_diff:7793.000 - global_seqlen/balanced_min:47351.000 - global_seqlen/balanced_max:47352.000 - global_seqlen/mean:47351.125 - actor/entropy_loss:53.620 - actor/pg_loss:-0.092 - actor/pg_clipfrac:0.000 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.692 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.215 - actor/lr:0.000 - critic/score/mean:1.528 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.528 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:187.233 - response_length/max:655.000 - response_length/min:56.000 - response_length/clip_ratio:0.000 - prompt_length/mean:306.008 - prompt_length/max:505.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.687 - timing_s/old_log_prob:5.294 - timing_s/adv:0.264 - timing_s/update_actor:33.495 - timing_s/step:58.768 - timing_per_token_ms/gen:0.137 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:378809.000 - perf/time_per_step:58.768 - perf/throughput:805.736
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:83 - global_seqlen/min:44560.000 - global_seqlen/max:50633.000 - global_seqlen/minmax_diff:6073.000 - global_seqlen/balanced_min:47628.000 - global_seqlen/balanced_max:47628.000 - global_seqlen/mean:47628.000 - actor/entropy_loss:51.414 - actor/pg_loss:0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.766 - perf/mfu/actor:0.363 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.153 - actor/lr:0.000 - critic/score/mean:1.608 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.608 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:186.312 - response_length/max:496.000 - response_length/min:43.000 - response_length/clip_ratio:0.000 - prompt_length/mean:309.812 - prompt_length/max:551.000 - prompt_length/min:207.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.192 - timing_s/old_log_prob:5.276 - timing_s/adv:0.267 - timing_s/update_actor:33.624 - timing_s/step:56.378 - timing_per_token_ms/gen:0.120 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:381024.000 - perf/time_per_step:56.378 - perf/throughput:844.791
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 85/132 [1:47:32<50:51, 64.92s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  65%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 86/132 [1:48:32<48:36, 63.41s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 87/132 [1:49:37<48:01, 64.04s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 88/132 [1:50:34<45:24, 61.91s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  67%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹   | 89/132 [1:51:31<43:17, 60.40s/it]
[36m(TaskRunner pid=1464402)[0m step:84 - global_seqlen/min:45077.000 - global_seqlen/max:52164.000 - global_seqlen/minmax_diff:7087.000 - global_seqlen/balanced_min:48887.000 - global_seqlen/balanced_max:48888.000 - global_seqlen/mean:48887.500 - actor/entropy_loss:52.609 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.845 - perf/mfu/actor:0.379 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.234 - actor/lr:0.000 - critic/score/mean:1.620 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.620 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.883 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.883 - response_length/mean:193.815 - response_length/max:580.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:315.430 - prompt_length/max:502.000 - prompt_length/min:223.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.264 - timing_s/old_log_prob:5.348 - timing_s/adv:0.280 - timing_s/update_actor:33.086 - timing_s/step:57.997 - timing_per_token_ms/gen:0.129 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:391100.000 - perf/time_per_step:57.997 - perf/throughput:842.933
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:85 - global_seqlen/min:44395.000 - global_seqlen/max:51628.000 - global_seqlen/minmax_diff:7233.000 - global_seqlen/balanced_min:48081.000 - global_seqlen/balanced_max:48082.000 - global_seqlen/mean:48081.875 - actor/entropy_loss:50.639 - actor/pg_loss:0.160 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.975 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.144 - actor/lr:0.000 - critic/score/mean:1.601 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.601 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:189.064 - response_length/max:562.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:311.789 - prompt_length/max:630.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.348 - timing_s/old_log_prob:5.388 - timing_s/adv:0.268 - timing_s/update_actor:33.987 - timing_s/step:58.017 - timing_per_token_ms/gen:0.126 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:384655.000 - perf/time_per_step:58.017 - perf/throughput:828.757
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:86 - global_seqlen/min:48935.000 - global_seqlen/max:54067.000 - global_seqlen/minmax_diff:5132.000 - global_seqlen/balanced_min:51141.000 - global_seqlen/balanced_max:51142.000 - global_seqlen/mean:51141.125 - actor/entropy_loss:58.063 - actor/pg_loss:0.056 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.982 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.461 - actor/lr:0.000 - critic/score/mean:1.545 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.545 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:206.001 - response_length/max:528.000 - response_length/min:45.000 - response_length/clip_ratio:0.000 - prompt_length/mean:326.719 - prompt_length/max:615.000 - prompt_length/min:226.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:18.069 - timing_s/old_log_prob:5.670 - timing_s/adv:0.276 - timing_s/update_actor:35.813 - timing_s/step:59.849 - timing_per_token_ms/gen:0.114 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:409129.000 - perf/time_per_step:59.849 - perf/throughput:854.509
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:87 - global_seqlen/min:45527.000 - global_seqlen/max:51804.000 - global_seqlen/minmax_diff:6277.000 - global_seqlen/balanced_min:49362.000 - global_seqlen/balanced_max:49591.000 - global_seqlen/mean:49391.875 - actor/entropy_loss:55.205 - actor/pg_loss:0.119 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.947 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.256 - actor/lr:0.000 - critic/score/mean:1.511 - critic/score/max:2.000 - critic/score/min:0.000 - critic/rewards/mean:1.511 - critic/rewards/max:2.000 - critic/rewards/min:0.000 - critic/advantages/mean:-0.005 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.005 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:196.436 - response_length/max:1024.000 - response_length/min:50.000 - response_length/clip_ratio:0.001 - prompt_length/mean:318.062 - prompt_length/max:522.000 - prompt_length/min:215.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:25.605 - timing_s/old_log_prob:5.477 - timing_s/adv:0.272 - timing_s/update_actor:34.113 - timing_s/step:65.487 - timing_per_token_ms/gen:0.170 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:395135.000 - perf/time_per_step:65.487 - perf/throughput:754.220
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:88 - global_seqlen/min:46413.000 - global_seqlen/max:50705.000 - global_seqlen/minmax_diff:4292.000 - global_seqlen/balanced_min:48440.000 - global_seqlen/balanced_max:48441.000 - global_seqlen/mean:48440.250 - actor/entropy_loss:51.392 - actor/pg_loss:-0.078 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:1.068 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.394 - actor/lr:0.000 - critic/score/mean:1.616 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.616 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:192.555 - response_length/max:516.000 - response_length/min:49.000 - response_length/clip_ratio:0.000 - prompt_length/mean:312.031 - prompt_length/max:593.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.942 - timing_s/old_log_prob:5.295 - timing_s/adv:0.268 - timing_s/update_actor:33.404 - timing_s/step:56.929 - timing_per_token_ms/gen:0.121 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:387522.000 - perf/time_per_step:56.929 - perf/throughput:850.885
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 90/132 [1:54:43<1:09:59, 99.99s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 91/132 [1:55:42<59:50, 87.58s/it]  
[36m(TaskRunner pid=1464402)[0m step:89 - global_seqlen/min:45034.000 - global_seqlen/max:51616.000 - global_seqlen/minmax_diff:6582.000 - global_seqlen/balanced_min:48550.000 - global_seqlen/balanced_max:48550.000 - global_seqlen/mean:48550.000 - actor/entropy_loss:52.394 - actor/pg_loss:-0.014 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.836 - perf/mfu/actor:0.365 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.414 - actor/lr:0.000 - critic/score/mean:1.625 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.625 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:199.753 - response_length/max:457.000 - response_length/min:60.000 - response_length/clip_ratio:0.000 - prompt_length/mean:305.977 - prompt_length/max:529.000 - prompt_length/min:225.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.183 - timing_s/old_log_prob:5.346 - timing_s/adv:0.269 - timing_s/update_actor:34.036 - timing_s/step:56.857 - timing_per_token_ms/gen:0.112 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.088 - perf/total_num_tokens:388400.000 - perf/time_per_step:56.857 - perf/throughput:853.902
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m test_gen_batch meta info: {'eos_token_id': 151645, 'pad_token_id': 151643, 'recompute_log_prob': False, 'do_sample': False, 'validate': True}
[36m(TaskRunner pid=1464402)[0m validation generation end
[36m(TaskRunner pid=1464402)[0m [prompt] system
[36m(TaskRunner pid=1464402)[0m ç”¨æˆ·å’ŒåŠ©æ‰‹ä¹‹é—´çš„å¯¹è¯ã€‚ç”¨æˆ·æå‡ºä¸€ä¸ªé—®é¢˜ï¼Œç”±åŠ©æ‰‹æ¥å›ç­”ã€‚åŠ©æ‰‹é¦–å…ˆåœ¨è„‘æµ·ä¸­é€æ­¥æ€è€ƒæ¨ç†è¿‡ç¨‹ï¼Œç„¶åå‘ç”¨æˆ·æä¾›ç­”æ¡ˆã€‚æ¨ç†è¿‡ç¨‹å’Œç­”æ¡ˆåˆ†åˆ«ç”¨<æ€è€ƒ> </æ€è€ƒ>å’Œ<å›ç­”> </å›ç­”>æ ‡ç­¾æ‹¬èµ·æ¥ï¼Œå³ï¼Œ<æ€è€ƒ> æ¨ç†è¿‡ç¨‹ </æ€è€ƒ><å›ç­”> ç­”æ¡ˆ </å›ç­”>
[36m(TaskRunner pid=1464402)[0m user
[36m(TaskRunner pid=1464402)[0m ä½ æ˜¯ä¸€åæ³•å­¦ä¸“å®¶ã€‚ç°åœ¨è¯·ä½ è§£ç­”å¸æ³•è€ƒè¯•ä¸­çš„ä¸€é“é€‰æ‹©é¢˜ï¼Œè¯·ä½ æ‰¾å‡ºæ‰€æœ‰æ­£ç¡®çš„é€‰é¡¹ã€‚æ¯é“é¢˜å¯èƒ½æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ­£ç¡®ç­”æ¡ˆã€‚åœ¨è§£ç­”ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆé’ˆå¯¹æ¯ä¸ªæä¾›çš„é€‰é¡¹ç»™å‡ºè¯¦ç»†çš„è§£é‡Šã€‚ä½ éœ€è¦åœ¨å›ç­”çš„æœ€åç”¨å¤§æ‹¬å·åœˆå‡ºç»™å‡ºçš„ç­”æ¡ˆï¼Œä¾‹å¦‚"{B}"æˆ–è€…"{ABD}"ã€‚
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é—®é¢˜ï¼šç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ï¼Œå¯¹äºç”²ä¹™äºŒäººçš„è¡Œä¸ºçš„è®¤å®šï¼Œä¸‹åˆ—æ­£ç¡®çš„é€‰é¡¹æ˜¯:
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m é€‰é¡¹ï¼š
[36m(TaskRunner pid=1464402)[0m A: ç”²ä¸ä¹™å› æ•…æ„ä¸åŒï¼Œä¸æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m B: ç”²ä¸ä¹™è™½æ•…æ„ä¸åŒï¼Œä»åœ¨éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªçš„èŒƒå›´å†…æˆç«‹å…±åŒçŠ¯ç½ª
[36m(TaskRunner pid=1464402)[0m C: å¯¹ç”²åº”ä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m D: å¯¹ä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†ç½ªè®ºå¤„
[36m(TaskRunner pid=1464402)[0m assistant
[36m(TaskRunner pid=1464402)[0m 
[36m(TaskRunner pid=1464402)[0m [response] <æ€è€ƒ> è¯¥é¢˜è€ƒå¯Ÿçš„æ˜¯å…±åŒçŠ¯ç½ªçš„æ„æˆè¦ä»¶ä»¥åŠä¸åŒæ•…æ„åœ¨å…±åŒçŠ¯ç½ªä¸­çš„å¤„ç†ã€‚æ ¹æ®æˆ‘å›½åˆ‘æ³•ï¼Œå…±åŒçŠ¯ç½ªæ˜¯æŒ‡äºŒäººä»¥ä¸Šå…±åŒæ•…æ„çŠ¯ç½ªã€‚ç”²æŸä»¥ä¸ºå¢ƒå¤–çªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œä¹™ä»¥éæ³•è·å–å›½å®¶ç§˜å¯†çš„æ•…æ„ï¼Œå…±è°‹å…±åŒçªƒå–ã€åˆºæ¢ã€æ”¶ä¹°å›½å®¶ç§˜å¯†ã€‚ç”²æŸçš„æ•…æ„è¶…å‡ºäº†ä¹™çš„æ•…æ„èŒƒå›´ï¼Œä½†ä¹™çš„æ•…æ„åœ¨ç”²æŸæ•…æ„çš„èŒƒå›´å†…ï¼Œå› æ­¤ç”²æŸæ„æˆé—´è°ç½ªï¼Œä¹™æ„æˆéæ³•è·å–å›½å®¶ç§˜å¯†ç½ªï¼Œä½†ä¸¤äººåœ¨éæ³•è·å–å›½å®¶ç§˜å¯†çš„èŒƒå›´å†…æ„æˆå…±åŒçŠ¯ç½ªã€‚æ‰€ä»¥æ­£ç¡®çš„é€‰é¡¹æ˜¯Bã€Cã€Dã€‚ç­”æ¡ˆä¸ºBã€Cã€Dã€‚ </æ€è€ƒ><å›ç­”> {BCD} </å›ç­”>
[36m(TaskRunner pid=1464402)[0m [ground_truth] ['B', 'C', 'D']
[36m(TaskRunner pid=1464402)[0m [score] 2.0
[36m(TaskRunner pid=1464402)[0m [extra_info] {'format_reward': 1.0, 'answer_reward': 1.0}
[36m(TaskRunner pid=1464402)[0m step:90 - global_seqlen/min:46208.000 - global_seqlen/max:51995.000 - global_seqlen/minmax_diff:5787.000 - global_seqlen/balanced_min:48851.000 - global_seqlen/balanced_max:48852.000 - global_seqlen/mean:48851.625 - actor/entropy_loss:49.260 - actor/pg_loss:0.108 - actor/pg_clipfrac:0.002 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.806 - perf/mfu/actor:0.377 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.328 - actor/lr:0.000 - val-core/jec-qa-1-multi-choice/reward/mean@1:1.566 - val-aux/jec-qa-1-multi-choice/reward/std@1:0.000 - val-core/jec-qa-1-multi-choice/reward/best@1/mean:1.566 - val-core/jec-qa-1-multi-choice/reward/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/reward/worst@1/mean:1.566 - val-aux/jec-qa-1-multi-choice/reward/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/mean@1:1.566 - val-aux/jec-qa-1-multi-choice/score/std@1:0.000 - val-aux/jec-qa-1-multi-choice/score/best@1/mean:1.566 - val-aux/jec-qa-1-multi-choice/score/best@1/std:0.000 - val-aux/jec-qa-1-multi-choice/score/worst@1/mean:1.566 - val-aux/jec-qa-1-multi-choice/score/worst@1/std:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score@1:0.000 - val-aux/jec-qa-1-multi-choice/extra_info/score/std@1:0.000 - critic/score/mean:1.568 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.568 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.817 - critic/advantages/min:-0.750 - critic/returns/mean:0.001 - critic/returns/max:0.817 - critic/returns/min:-0.750 - response_length/mean:191.480 - response_length/max:729.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.391 - prompt_length/max:647.000 - prompt_length/min:224.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.213 - timing_s/old_log_prob:5.488 - timing_s/adv:0.277 - timing_s/update_actor:33.201 - timing_s/testing:132.117 - timing_s/step:192.323 - timing_per_token_ms/gen:0.144 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.085 - perf/total_num_tokens:390813.000 - perf/time_per_step:192.323 - perf/throughput:254.008
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:91 - global_seqlen/min:43467.000 - global_seqlen/max:52562.000 - global_seqlen/minmax_diff:9095.000 - global_seqlen/balanced_min:48195.000 - global_seqlen/balanced_max:48196.000 - global_seqlen/mean:48195.750 - actor/entropy_loss:50.658 - actor/pg_loss:0.039 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.737 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.321 - actor/lr:0.000 - critic/score/mean:1.571 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.571 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:198.023 - response_length/max:653.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:304.016 - prompt_length/max:536.000 - prompt_length/min:210.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.785 - timing_s/old_log_prob:5.277 - timing_s/adv:0.269 - timing_s/update_actor:33.244 - timing_s/step:58.609 - timing_per_token_ms/gen:0.130 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:385566.000 - perf/time_per_step:58.609 - perf/throughput:822.325
[36m(TaskRunner pid=1464402)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 92/132 [1:56:39<52:17, 78.43s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 93/132 [1:57:41<47:46, 73.49s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  71%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 94/132 [1:58:45<44:47, 70.72s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 95/132 [1:59:45<41:31, 67.34s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 96/132 [2:00:42<38:40, 64.45s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  73%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 97/132 [2:01:43<36:53, 63.24s/it]
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:92 - global_seqlen/min:46828.000 - global_seqlen/max:51619.000 - global_seqlen/minmax_diff:4791.000 - global_seqlen/balanced_min:49752.000 - global_seqlen/balanced_max:49753.000 - global_seqlen/mean:49752.750 - actor/entropy_loss:48.095 - actor/pg_loss:-0.011 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.764 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.303 - actor/lr:0.000 - critic/score/mean:1.534 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.534 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:198.258 - response_length/max:460.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:320.000 - prompt_length/max:798.000 - prompt_length/min:236.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.153 - timing_s/old_log_prob:5.414 - timing_s/adv:0.277 - timing_s/update_actor:34.168 - timing_s/step:57.032 - timing_per_token_ms/gen:0.113 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:398022.000 - perf/time_per_step:57.032 - perf/throughput:872.370
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:93 - global_seqlen/min:47763.000 - global_seqlen/max:52255.000 - global_seqlen/minmax_diff:4492.000 - global_seqlen/balanced_min:49897.000 - global_seqlen/balanced_max:49897.000 - global_seqlen/mean:49897.000 - actor/entropy_loss:49.925 - actor/pg_loss:0.101 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.891 - perf/mfu/actor:0.370 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.297 - actor/lr:0.000 - critic/score/mean:1.517 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.517 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:202.401 - response_length/max:746.000 - response_length/min:58.000 - response_length/clip_ratio:0.000 - prompt_length/mean:317.359 - prompt_length/max:522.000 - prompt_length/min:211.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.540 - timing_s/old_log_prob:5.526 - timing_s/adv:0.275 - timing_s/update_actor:34.572 - timing_s/step:61.932 - timing_per_token_ms/gen:0.139 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:399176.000 - perf/time_per_step:61.932 - perf/throughput:805.675
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:94 - global_seqlen/min:47108.000 - global_seqlen/max:52682.000 - global_seqlen/minmax_diff:5574.000 - global_seqlen/balanced_min:50147.000 - global_seqlen/balanced_max:50148.000 - global_seqlen/mean:50147.500 - actor/entropy_loss:49.210 - actor/pg_loss:0.018 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.803 - perf/mfu/actor:0.369 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.341 - actor/lr:0.000 - critic/score/mean:1.595 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.595 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.002 - critic/advantages/max:0.750 - critic/advantages/min:-0.833 - critic/returns/mean:0.002 - critic/returns/max:0.750 - critic/returns/min:-0.833 - response_length/mean:207.510 - response_length/max:851.000 - response_length/min:55.000 - response_length/clip_ratio:0.000 - prompt_length/mean:314.859 - prompt_length/max:798.000 - prompt_length/min:208.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:23.428 - timing_s/old_log_prob:5.633 - timing_s/adv:0.272 - timing_s/update_actor:34.874 - timing_s/step:64.242 - timing_per_token_ms/gen:0.147 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:401180.000 - perf/time_per_step:64.242 - perf/throughput:780.601
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:95 - global_seqlen/min:44902.000 - global_seqlen/max:52954.000 - global_seqlen/minmax_diff:8052.000 - global_seqlen/balanced_min:49102.000 - global_seqlen/balanced_max:49102.000 - global_seqlen/mean:49102.000 - actor/entropy_loss:47.401 - actor/pg_loss:0.022 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.795 - perf/mfu/actor:0.366 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.312 - actor/lr:0.000 - critic/score/mean:1.571 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.571 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:203.885 - response_length/max:624.000 - response_length/min:53.000 - response_length/clip_ratio:0.000 - prompt_length/mean:307.594 - prompt_length/max:507.000 - prompt_length/min:220.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.404 - timing_s/old_log_prob:5.390 - timing_s/adv:0.277 - timing_s/update_actor:34.345 - timing_s/step:59.437 - timing_per_token_ms/gen:0.124 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:392816.000 - perf/time_per_step:59.437 - perf/throughput:826.123
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:96 - global_seqlen/min:46781.000 - global_seqlen/max:53853.000 - global_seqlen/minmax_diff:7072.000 - global_seqlen/balanced_min:49529.000 - global_seqlen/balanced_max:49530.000 - global_seqlen/mean:49529.250 - actor/entropy_loss:46.871 - actor/pg_loss:-0.038 - actor/pg_clipfrac:0.002 - actor/ppo_kl:0.001 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.899 - perf/mfu/actor:0.373 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.322 - actor/lr:0.000 - critic/score/mean:1.531 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.531 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.001 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.001 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:202.859 - response_length/max:501.000 - response_length/min:51.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.070 - prompt_length/max:583.000 - prompt_length/min:222.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:17.853 - timing_s/old_log_prob:5.479 - timing_s/adv:0.277 - timing_s/update_actor:34.029 - timing_s/step:57.658 - timing_per_token_ms/gen:0.115 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:396234.000 - perf/time_per_step:57.658 - perf/throughput:859.018
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m Training Progress:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 98/132 [2:02:46<35:51, 63.27s/it]
[36m(TaskRunner pid=1464402)[0m Training Progress:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 99/132 [2:03:47<34:23, 62.52s/it]
[36m(TaskRunner pid=1464402)[0m step:97 - global_seqlen/min:48980.000 - global_seqlen/max:51918.000 - global_seqlen/minmax_diff:2938.000 - global_seqlen/balanced_min:50346.000 - global_seqlen/balanced_max:50347.000 - global_seqlen/mean:50346.625 - actor/entropy_loss:48.192 - actor/pg_loss:-0.031 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.964 - perf/mfu/actor:0.371 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.301 - actor/lr:0.000 - critic/score/mean:1.618 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.618 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.003 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.003 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:205.233 - response_length/max:593.000 - response_length/min:61.000 - response_length/clip_ratio:0.000 - prompt_length/mean:319.211 - prompt_length/max:820.000 - prompt_length/min:216.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:19.660 - timing_s/old_log_prob:5.617 - timing_s/adv:0.280 - timing_s/update_actor:34.827 - timing_s/step:60.407 - timing_per_token_ms/gen:0.125 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.086 - perf/total_num_tokens:402773.000 - perf/time_per_step:60.407 - perf/throughput:833.457
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:98 - global_seqlen/min:48457.000 - global_seqlen/max:55877.000 - global_seqlen/minmax_diff:7420.000 - global_seqlen/balanced_min:50963.000 - global_seqlen/balanced_max:50964.000 - global_seqlen/mean:50963.875 - actor/entropy_loss:50.200 - actor/pg_loss:0.079 - actor/pg_clipfrac:0.001 - actor/ppo_kl:0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.903 - perf/mfu/actor:0.367 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.340 - actor/lr:0.000 - critic/score/mean:1.567 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.567 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:0.000 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:0.000 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:216.928 - response_length/max:742.000 - response_length/min:57.000 - response_length/clip_ratio:0.000 - prompt_length/mean:313.945 - prompt_length/max:552.000 - prompt_length/min:218.000 - prompt_length/clip_ratio:0.000 - timing_s/gen:21.814 - timing_s/old_log_prob:5.592 - timing_s/adv:0.282 - timing_s/update_actor:35.580 - timing_s/step:63.311 - timing_per_token_ms/gen:0.131 - timing_per_token_ms/adv:0.001 - timing_per_token_ms/update_actor:0.087 - perf/total_num_tokens:407711.000 - perf/time_per_step:63.311 - perf/throughput:804.981
[36m(TaskRunner pid=1464402)[0m list(reward_extra_infos_dict.keys())=['score', 'extra_info']
[36m(TaskRunner pid=1464402)[0m step:99 - global_seqlen/min:46134.000 - global_seqlen/max:53411.000 - global_seqlen/minmax_diff:7277.000 - global_seqlen/balanced_min:49203.000 - global_seqlen/balanced_max:49204.000 - global_seqlen/mean:49203.500 - actor/entropy_loss:46.059 - actor/pg_loss:0.177 - actor/pg_clipfrac:0.001 - actor/ppo_kl:-0.000 - actor/pg_clipfrac_lower:0.000 - actor/grad_norm:0.845 - perf/mfu/actor:0.362 - perf/max_memory_allocated_gb:48.638 - perf/max_memory_reserved_gb:60.236 - perf/cpu_memory_used_gb:42.276 - actor/lr:0.000 - critic/score/mean:1.563 - critic/score/max:2.000 - critic/score/min:1.000 - critic/rewards/mean:1.563 - critic/rewards/max:2.000 - critic/rewards/min:1.000 - critic/advantages/mean:-0.002 - critic/advantages/max:0.833 - critic/advantages/min:-0.833 - critic/returns/mean:-0.002 - critic/returns/max:0.833 - critic/returns/min:-0.833 - response_length/mean:202.826 - response_length/max:641.000 - response_length/min:65.000 - response_length/c